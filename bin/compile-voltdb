#!/bin/sh -e
export CLASSPATH=`bin/classpath`

rm -rf classes
mkdir classes

#XXX we need to  make this a bit less gnarly... ideally a listing of the files in the dir
#will generate this compile list on the fly

# compile clojure procedures and utilities
echo "(compile 'utils.common)" | bin/clojure -
echo "(compile 'select-user)" | bin/clojure -

# compile java procedures
javac voltdb/procs/*.java -d classes

# finally hand voltdb compiler everything
/usr/local/voltdb/bin/voltdb compile -c $CLASSPATH -o voltdb/pb-schema.jar voltdb/pb-schema.sql
