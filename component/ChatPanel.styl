line_color = tint(dark_theme_color, 35%)

body.scrolled
  .footer
    bottom 72px
  .ChatPanel
    bottom -25px
    .middle
      .messages
        padding 46px 0 0 0
    .footer
      bottom 72px
      .message-box
        height 19px
        padding-top 8px

.ChatPanel
  position absolute
  bottom 0
  top 0
  right 0
  margin 0
  background-color dark_theme_color
  box-shadow 0 0 15px #999
  .header
    border-bottom 1px solid line_color
    padding 1px
    height 47px
    .onclick-messages
      display block!important
      position absolute
      top 11px
      right 50px
      font-size 2.8em
      color #eee
      transition color .2s ease-out
      z-index 1
      cursor pointer
      &:hover
        transition none
        color #fff
    h5
      padding-bottom 14px
      margin-left 17px
      margin-top 14px
      a
        text-transform capitalize
        color #eee
        font-weight 300
        font-size 1.25em
  .middle
    position relative
    .messages
      background-color #fff
      margin 5px 4px 5px 5px
      //border 1px solid theme_color
      padding 20px 0 0 0
      left 0
      height 100%
      list-style-type none
      overflow-y scroll
      // header top shadow
      &:after
        content ''
        position absolute
        left 6px
        right 6px
        top 0
        height 25px
        background-image linear-gradient(to bottom, rgba(255,255,255,.9) 5%, rgba(255,255,255,0))
      p
        margin 0
      img
        max-width 90%
      li:last-child
        padding-bottom 13px

    .messages > li
      position relative
      padding .4em .9em
      width 60%
      font-size .9em
      clear both
      float right
      margin-right 16px
      margin-left 42px
      text-align right
      word-wrap break-word
      background-color tint(dark_theme_color, 5%)
      border-radius 3px
      margin-top 1px
      if dark(dark_theme_color)
        color #fff
      else
        color dark_text
      a
        color @color
        padding 0.12em 0.7em
      .profile.photo
        display none
    .messages > li:not(.break):last-child
      margin-bottom (grid*2)
    .messages > li.other
      font-size .85em
      float left
      text-align left
      background-color #f5f5f5
      color #333
      padding-right (grid*2)
      a
        color dark_text
    .messages > li.break
      border-radius 0
      background-color transparent
      color dark_text
      font-size .75em
      margin-bottom 3px
      b
        font-weight 400

    // first grouped message (mine)
    .messages li.other + li:not(.other):not(.break)
      margin-top grid
      border-top-right-radius 6px
      border-top-left-radius 6px
      &:after
        content ''
        position absolute
        top 3px
        right -16px
        border 10px solid transparent
        border-left 10px solid tint(dark_theme_color, 5%)
    // last grouped message (mine)
    .messages > li.other ~ li:not(.other):last-child
      border-bottom-left-radius 6px
      border-bottom-right-radius 6px
    // first grouped message (theirs)
    .messages li:not(.other) + li.other
      margin-top grid
      border-top-right-radius 6px
      border-top-left-radius 6px
      &:after
        content ''
        position absolute
        top 5px
        left -17px
        border 10px solid transparent
        border-right 10px solid #f5f5f5
      .profile.photo 
        display block
        position absolute
        left -32px
        height 27px
        width 27px
    // last grouped message (theirs)
    .messages > li:not(.other) ~ li.other:last-child
      border-bottom-left-radius 6px
      border-bottom-right-radius 6px
  .footer
    position absolute
    bottom 98px
    right 4px
    left 5px
    overflow hidden
    border-top 1px solid dark_theme_color
    &:after
      position absolute
      bottom 0
      right 5px
      content 'SHIFT + ENTER for Newline'
      font-size .7em
      color #ccc
    .message-box
      overflow hidden
      border-radius 0
      padding 8px 10px!important
      border 0
      font-size 14px
      height 19px
      resize none
      bottom 0
      left 0!important
      &:hover
        border 0
        box-shadow none
