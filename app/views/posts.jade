
mixin post(p, i)
  .post
    a.mutant(href=p.slug)!= p.title
    p.body!= p.body
    if p.subposts
      each sp,ii in p.subposts
        mixin subpost(p, sp, ii)

mixin subpost(p, sp, i)
  .subpost(id="subpost#{sp.id}", class=(i % 2) ? 'odd' : 'even')
    h4.title!= sp.title
    .user= sp.user_name
    .date= sp.created
    p.body!= sp.body

//- main
//- ---------
if forums
  each f,i in forums
    img.bg(id="forum_bg_#{f.id}", src="#{cache_url}/images/bg_#{f.id}.jpg")
    .forum(id="forum_#{f.id}", class="#{f.classes || ''} #{i%2 ? 'odd' : 'even'}")
      .header
        .description= f.description
      .container
        if f.posts
          each t,ii in f.posts
            mixin post(f, t, ii)
          .up(class='scroll-to', data-scroll-to="#forum_#{f.id}", title="Scroll top of #{f.title}!")

if posts
  each p, i in posts
    mixin subpost(forums[0], p, i)

//- vim:fdm=marker
