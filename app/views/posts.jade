
mixin post(p, i)
  .post
    a.mutant(href=p.uri)!= p.title
    p.body!= p.body
    if p.subposts
      each sp,ii in p.subposts
        mixin subpost(p, sp, ii)

mixin subpost(p, sp, i)
  .subpost(id="subpost#{sp.id}", class=(i % 2) ? 'odd' : 'even')
    h4.title!= sp.title
    .user= sp.user_name
    .date= sp.created
    p.body!= sp.body

//- XXX - && typeof(forums) !== 'undefined' is a temporary hack to get the page to load
if typeof(subPost) !== 'undefined'
  .forum
    .breadcrumb breadcrumb
    each p, i in subPost.posts
      mixin subpost(subPost, p, i)

//- vim:fdm=marker
