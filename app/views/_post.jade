include _post_actions
include _post_profile

mixin _post(p, i)
  .post(id="post_#{p.id}", data-user-id=p.user_id, data-post-id=p.id, data-thread-id=p.thread_id,
  data-forum-id=p.forum_id)
    if p.thread_uri
      h4.title
        a.mutant(href=p.thread_uri)= p.title
    else
      h4.title= p.title
    mixin _post_profile(p)
    .date(data-time=p.created_iso)!= p.created_human
    if p.html
      p.body!= p.html
    .reply
    mixin _post_actions(p)
  .children
    if p.posts && p.posts.length
      each pp, ii in p.posts
        mixin _post(pp, ii)
    else if p.morePosts
      a(href='#') Load more posts ...
