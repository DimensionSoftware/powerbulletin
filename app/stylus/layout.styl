@import 'common'

// XXX below defines the layout's skeleton
// XXX decoration & embellishments belong in the theme.styl
// XXX eventually each forum will have its own theme.{styl,css}

header-height          = 50px
header-scrolled-height = 30px
forum-header-height = 0
footer-height       = 32px
left-content-width  = 200px
max-post-height     = 2000px

grid = 10px

//{{{Mutant States
html.homepage
  .left-content
    display none
  
html.forum
  body.scrolled
    #left_content.container
      bottom 0
  body.searching
    #left_content.left-content
      padding-top 90px!important
      transition padding-top .2s ease-out
      .handle
        top 63px
        transition top .2s ease-out
    #main_content.main-content
      padding-top 30px!important
      transition padding-top .2s ease-out
  .left-content
    display block
  .left-chrome
    display none
//}}}

section
  box-sizing border-box

body
  grid(90%,100%)
  overflow visible!important
  a
    cursor pointer
  .scroll-to, .scroll-to-top
    cursor pointer

.invisible
  opacity 0
  transition opacity .4s ease-out

//{{{ Structure applied after body scrolls
body.searching header
  .menu
    .row
      line-height 30px!important
      font-size 16px!important
body.scrolled
  .logo
    a
      top -(grid/2)
      font-size .68em
  header
    height header-scrolled-height
    .container
      .menu
        > .row:hover
          .submenu
            top 33px
        .row
          line-height 30px
          font-size 16px
      .search
        top 0!important
        right 0!important
        .query
          font-size 1em
          width 340px!important
          height 15px
  .left-chrome
    .user-profile
      left -2px!important
  #left_content.container
    padding-top (grid * 4)
    transition padding-top .2s ease-out
    .handle
      top (header-scrolled-height - (grid+5))
      transition top .2s ease-out
  footer
    opacity 1
    font-size .85em
    bottom -(grid)
    line-height 16px
//}}}
//{{{ Structure applied when body is collapsed
body.collapsed
  .logo a
    left 56px
  .left-content.container
    width grid!important
    transition width .1s
    .handle
      transform rotate(180deg)
    .create a
      display none!important
  .main-content
    .forum
      padding-left (grid*2)!important
      transition padding-left .2s ease-out
//}}}
//{{{ Structure applied when header is expanded for search
body.searching
  header
    menu
      > .row:hover
        .submenu
          top (header-scrolled-height+3)!important
body.searching
  .stuck
    display none!important
  header
    height 80px!important
    transition background-color .25s ease-out, height .2s ease-out
    .container
      .search::before
        content ''
        border-top 8px solid transparent
        border-bottom 8px solid transparent
        position absolute
        top 25px
        left 0
      .search
        top -7px!important
        right auto!important
        #query.query
          position relative
          z-index 9
          font-size 31px
          padding 5px 20px
          letter-spacing 3px
          font-weight 100
          height 51px
          width 500px!important
      .advanced
        right 100px
        top 5px
        transition right .2s ease-out
        .check, label
          cursor pointer
    .close
      cursor pointer
      position absolute
      right 12px
      top grid
      display block
//}}}

//{{{ Background layer
img.bg
  position fixed
  height 100%
  width 100%
  z-index 0
  left 0
  display none
  top 300px
img.bg.active
  top 0!important
  transition top .3s
  z-index 1!important
  //transition opacity .8s ease-out
  //opacity 1
  //display block
//}}}

//{{{ Header
.logo
  a
    margin-top 15px
    vertical-align top
    font-size .75em
    text-decoration none
    font-weight 200
    letter-spacing -2px
    position fixed
    top 1px
    left 15px
    z-index 9
    strong
      letter-spacing -1px
      font-weight 500
      padding-left 4px
header
  position fixed
  height header-height
  top 0
  z-index 7
  .close
    display none
  .container
    width 800px
    margin 0 auto
    .menu
      padding 0
      margin -3px auto 0 auto
      display inline-block
      position absolute
      bottom 0
      > .row
          position relative!important
          z-index 50!important
        .title
          display inline-block
          text-transform capitalize
          padding 0 19px
      .row.active, .row:hover
        z-index 7
        .submenu
          opacity 1
          top 53px
          min-width 250px
          transition top .25s ease-out .3s, opacity .4s ease-out .4s
          .row:hover
            text-indent 19px
            transition text-indent .1s ease-out
      .row
        cursor pointer
        display inline-block
        line-height header-height
        font-size 16px
        .title
          position relative
          z-index 55
        .submenu
          z-index 51
          top -600px
          max-height 450px
          overflow-y scroll
          opacity 0
          position absolute
          padding 0
          margin 0
          .row:first-child
            padding-top (grid/2)
          .row:last-child
            padding-bottom (grid/2)
          .row
            display block
            font-size 14px
            text-indent (grid * 2)
            a
              display block
    .search
      top 13px
      right 12px
      position absolute 
      .query
        width 300px
        font-size 1.3em
    .advanced
      position absolute
      right -800px
//}}}
//{{{ Left side
#left_content.container
  position fixed
  left 0
  bottom 0
  top 0
  height auto
  width left-content-width
  width 200px
  //overflow-x hidden
  //overflow-y scroll
  z-index 8
  padding grid
  padding-top (grid*6)
  .handle
    border-radius 20px
    line-height 28px
    font-size .9em
    height 30px
    width 30px
    top (header-height - (grid*2))
    right -20px
    cursor pointer
    position absolute
    text-align center
    cursor pointer
    z-index 95
  .create
    margin (grid*2) 4px
    a
      text-decoration none
      animation-name none
      padding 8px 10px
      display block
  .threads
    overflow-y scroll
    height 100%
    margin 0
    padding-left (grid/2)
    .thread
      .title
        overflow hidden
        max-height 65px
        text-transform capitalize
        margin grid 0 0 0
      .username
        font-size .7em
        em
          font-weight 600
          margin-left (grid/2)
          font-size 1.1em
      .created
        font-size .9em
      .created, .username, .post-count
        white-space nowrap
        text-overflow ellipsis
        margin-bottom -6px
      .post-count, .views
        font-weight bold
        font-size .8em
      .post-count, .views
        i
          font-weight 100
          font-size .9em
          margin 0 grid 0 (grid/2)

    .thread:last-child
      margin-bottom (grid*10)

section.left-chrome
  z-index 7
  top 80px
  width 175px
  position fixed
  .user-profile
    position absolute
    top 35px
    left 0
    width 150px
    height 95px
    .photo
      overflow hidden
      margin-bottom 5px
      width 148px
      height 100px
      img
        width 100%
    .arrow
      content ''
      position absolute
      top 87px
      right -16px
      border-bottom 20px solid transparent
      border-top 20px solid transparent
      height 0
      width 0
    .sort::before
      content ''
      width 1px
      height 1px
      position absolute
      left 0
      top 11px
      z-index 3
      border-top-color transparent
      border-right-color transparent
      border-bottom-color transparent
    .sort
      position relative
      height 95px
      overflow hidden
      cursor pointer
      #sort
        position relative
        box-sizing border-box
        padding (grid) (grid) (grid*7) (grid*2)
        text-align center
        overflow-y scroll
        height 109px
        margin 0
        list-style none
        li
          font-size .8em
          padding 0 0 1px 0
          margin 0 0 5px 0
      .indicator
        top 21px
        position absolute
        left 0
        width 140px
        height 1px
  .scroll-to-top:hover
    border-bottom 10px solid #777
  .scroll-to-top
    position absolute
    right 1px
    bottom 0
    border-left 8px solid transparent
    border-right 8px solid transparent
    border-bottom 10px solid #555
//}}}
//{{{ Main Content
.col1
  width 425px
.col2
  width 425px

#main_content.container
  grid(100%, 800px)
  padding forum-header-height 0 0 0!important
  z-index 5
  .forum:first-child
    padding-top (grid * 7)!important
  .forum
    position relative
    clear both
    min-height 650px
    padding-left left-content-width
    .breadcrumb.stuck
      text-align center
      text-indent grid
      border-bottom-left-radius 5px
      border-bottom-right-radius 5px
      padding (grid/2+2) (grid*2) 2px (grid*2)
    .breadcrumb
      text-transform capitalize
      font-size .9em
      a
        padding-right (grid/2)
        margin-right 3px
        letter-spacing -1px
      em
        margin-left (grid/2)
    .container
      z-index 6
    .header.stuck::before
      opacity 1!important
    .header.stuck, .breadcrumb.stuck
      position fixed
      top header-scrolled-height
      left 50px
      z-index 7
      overflow hidden
    .header
      width 95%
      overflow visible
      text-align center
      .description
        text-rendering optimizelegibility
        text-transform capitalize
        overflow hidden
        text-overflow ellipsis
        width 45%
        left 19%
        position relative
        z-index 2
    .scroll-to
      position absolute
      right 0
      bottom -30px
    .post:hover
      //transform translateY(-15px)
      position relative
      z-index 4
      transition all .1s ease-out 1.3s
    .container
      position absolute
      height 100%
      width 100%
      background-color #fff
      .post-edit
        .title
          display block
        .body
          width 90%
          display block
          margin grid 0
          min-height 40px
    .post, .subpost
      .photo
        overflow hidden
        float left
        padding 2px
        margin-right grid
        width 35px
        height 35px
        float left
        img
          width 100%
    .post
      float left
      margin 0 grid grid grid
      overflow hidden
      //max-height max-post-height
      img
        max-width 100%
    .post.editing, .subpost.editing
      min-height 200px
      padding-left (grid/2)
    .post, .subpost
      position relative
      clear both
      overflow hidden
      margin-left (grid*4)
      margin-top (grid/2)
      margin-bottom grid
      .title
        margin 0
        font-size 1.5em
      .body
        margin 0
      .actions
        opacity 0
        letter-spacing -10px
        margin-top (grid+2)
        line-height 15px
        font-size .9em
        color #444
        a
          margin-right grid
        .edit
          display none
    .subpost:last-child
      margin-bottom (grid*3)
    .post:hover, .subpost:hover
      .actions
        opacity 1
        letter-spacing 0
        transition opacity .3s, letter-spacing .09s
    .subpost
      padding-bottom grid
      .date
        font-size .8em
        color #555
      p
        margin 0
    .children
      .children
        margin-left (grid*3)
        margin-bottom (grid*3)
        .user, .date
          display inline-block
        .date
          margin-left grid
        .subpost
          margin-left (grid*2)
          padding grid
          font-size .85em
        .photo
          overflow hidden
          width 15px
          height 15px
          float left
        img
          max-width 100%
        .body
          blockquote
            margin (grid/2)
            padding 0
  .scroll-to-top
      clear both
//}}}
//{{{ Footer
footer
  text-align center
  position fixed
  bottom 0
  right 0
  left 0
  height footer-height
  z-index 7
//}}}

//{{{ RESPONSIVEness
@media screen and (max-width: 800px)
  .logo
    font-size 1.1em!important
    margin-top 4px!important
  header
    height 30px
    .menu
      .row
        line-height 30px!important
    .search
      float right!important
      position relative!important
      top 0!important
      right 0!important
      .query
        height 9px
  body
    grid(100%,475px)
    .left-chrome
      display none!important
    #main_content.container
      margin 0 auto 0 grid!important
      .forum
        padding-left 0!important
  
@media screen and (max-width: 500px)
  header
    font-size 0.8em
    display none
  body
    grid(100%,320px)
    #main_content.container
      margin-left 0!important
      padding 25px 15px!important
      .forum
        margin-bottom grid!important
        padding-left 0!important
  body.scrolled
    .container
      margin-left 0!important
      padding 25px 15px!important
    .left-chrome
      display none!important
// }}}

//{{{ Login
.fancybox-wrap.on-register
  #auth
    .register
      display block!important
    .choose, .login, .forgot
      display none!important
.fancybox-wrap.on-choose
  #auth
    h3
    .choose
      display block!important
    .login, .forgot
      display none!important
    .msg
      visibility hidden
.fancybox-wrap.on-forgot
  #auth
    .forgot
      display block!important
    .login, .choose
      display none!important
.fancybox-wrap.on-error
  #auth
    .msg
      height 30px
      opacity 1
      transition height .5s, opacity 1s
#auth
  .choose, .forgot, .register
    h3
      margin-top (grid+2)
      float right
    input[type='submit']
      margin-top 3px
  .error
    display none
  h2
    margin 15px 0 20px 15px
    letter-spacing 1px
  h3
    margin 0 0 10px 0
  .social
    margin 20px auto
    width 313px
    a
      text-decoration none
  fieldset
    padding 20px 102px
  input[name="email"]
    width 286px
    padding 15px
  input[name="username"]
    width 300px
    display block
  input[name="password"]
    width 300px
  input[type="submit"]
    height 42px
    width 314px
    margin-left 2px
    margin-top 13px
    display block
//}}}
// vim:fdm=marker
