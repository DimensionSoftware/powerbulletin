@import 'common'

// XXX below defines the layout's skeleton
// XXX decoration & embellishments belong in the theme.styl
// XXX eventually each forum will have its own theme.{styl,css}

header-height          = 50px
header-scrolled-height = 30px
forum-header-height = 0
footer-height       = 32px
left-content-width  = 200px
max-post-height     = 2000px

grid = 10px

//{{{Mutant States
html.homepage
  .left-content
    display none
  
html.forum
  body.scrolled
    #left_content.container
      bottom 0
      top -(grid)
  body.expanded
    #left_content.left-content
      padding-top 70px!important
      transition padding-top .3s ease-out
    #main_content.main-content
      padding-top 100px!important
      transition padding-top .3s ease-out
  .left-content
    display block
  .left-chrome
    display none
//  #main_content
//    padding forum-header-height 0 0 (left-content-width / 2)!important
//}}}

section
  box-sizing border-box

body
  grid(90%,100%)
  overflow visible!important
  a
    cursor pointer
  .scroll-to, .scroll-to-top
    cursor pointer

.invisible
  opacity 0
  transition opacity .4s ease-out

//{{{ Structure applied after body scrolls
body.expanded header
  .menu
    .row
      line-height 30px!important
      font-size 16px!important
body.scrolled
  header
    height header-scrolled-height
    .container
      .menu
        .row:hover
          .submenu
            top 33px
        .row
          line-height 30px
          font-size 16px
      .search
        top 0!important
        right 0!important
        .query
          font-size 1em
          width 340px!important
          height 12px
  .left-chrome
    .user-profile
      left -2px!important
  footer
    opacity 1
    font-size .85em
    bottom -(grid)
    line-height 16px

  #main_content.container
    .forum
      .header::before
        position absolute
        opacity .8
//}}}
//{{{ Structure applied when header is expanded
body.expanded
  .stuck
    display none!important
  header
    height 80px!important
    transition background-color .25s ease-out, height .2s ease-out
    .container
      .search::before
        content ''
        border-top 8px solid transparent
        border-bottom 8px solid transparent
        position absolute
        top 25px
        left 0
      .menu
        .row
          .submenu
            top 33px!important
      .search
        top -7px!important
        right auto!important
        #query.query
          position relative
          z-index 9
          font-size 31px
          padding 5px 20px
          letter-spacing 3px
          font-weight 100
          height 51px
          width 500px!important
      .advanced
        display block
        position absolute
        right 10%
        top 5px
        .check, label
          cursor pointer
    .close
      cursor pointer
      position absolute
      right 12px
      top grid
      display block
//}}}

//{{{ Background layer
img.bg
  position fixed
  height 100%
  width 100%
  z-index 0
  left 0
  display none
  top 300px
img.bg.active
  top 0!important
  transition top .3s
  z-index 1!important
  //transition opacity .8s ease-out
  //opacity 1
  //display block
//}}}

//{{{ Header
header
  position fixed
  height header-height
  top 0
  z-index 7
  .close
    display none
  .container
    width 800px
    margin 0 auto
    .menu
      margin -3px auto 0 auto
      display inline-block
      position absolute
      bottom 0
      .row.active, .row:hover
        z-index 7
        .submenu
          opacity 1
          top 53px
          transition top .25s ease-out .3s, opacity .4s ease-out .4s
          .row:hover
            text-indent 19px
            transition text-indent .1s ease-out
      .row
        cursor pointer
        display inline-block
        line-height header-height
        font-size 16px
        .title
          position relative
          z-index 55
        .submenu
          z-index 51
          top -500px
          max-height 450px
          overflow-y scroll
          opacity 0
          position absolute
          padding 0
          margin 0
          .row:first-child
            padding-top (grid/2)
          .row:last-child
            padding-bottom (grid/2)
          .row
            display block
            font-size 14px
            text-indent (grid * 2)
            a
              display block
    .search
      top 13px
      right 12px
      position absolute 
      .query
        width 300px
        font-size 1.3em
    .advanced
      display none
//}}}
//{{{ Left side
#left_content.container
  position fixed
  left 0
  bottom 0
  top (header-height + 2)
  height auto
  width left-content-width
  overflow-x hidden
  overflow-y scroll
  z-index 6
  .handle
    background-color #eee
    border 3px solid #fff
    height 15px
    width 15px
    top 20px
    right -5px
    cursor pointer
    border-radius 15px
    position absolute
  .title
    text-overflow ellipsis
    overflow hidden
    max-height 65px
    text-transform capitalize
    margin-bottom 8px
  .create
    margin (grid*2) 0 (grid*2) 5px
  .threads
    margin 0
  .forum 
    margin 0 0 (grid*2) 0
    padding 0
    list-style none
    li
      font-size .9em

section.left-chrome
  z-index 7
  top 80px
  width 175px
  position fixed
  .user-profile
    position absolute
    top 35px
    left 0
    width 150px
    height 95px
    .photo
      overflow hidden
      margin-bottom 5px
      width 148px
      height 100px
      img
        width 100%
    .arrow
      content ''
      position absolute
      top 87px
      right -16px
      border-bottom 20px solid transparent
      border-top 20px solid transparent
      height 0
      width 0
    .sort::before
      content ''
      width 1px
      height 1px
      position absolute
      left 0
      top 11px
      z-index 3
      border-top-color transparent
      border-right-color transparent
      border-bottom-color transparent
    .sort
      position relative
      height 95px
      overflow hidden
      cursor pointer
      #sort
        position relative
        box-sizing border-box
        padding (grid) (grid) (grid*7) (grid*2)
        text-align center
        overflow-y scroll
        height 109px
        margin 0
        list-style none
        li
          font-size .8em
          padding 0 0 1px 0
          margin 0 0 5px 0
      .indicator
        top 21px
        position absolute
        left 0
        width 140px
        height 1px
  .scroll-to-top:hover
    border-bottom 10px solid #777
  .scroll-to-top
    position absolute
    right 1px
    bottom 0
    border-left 8px solid transparent
    border-right 8px solid transparent
    border-bottom 10px solid #555
//}}}
//{{{ Main Content
.col1
  width 425px
.col2
  width 425px

#main_content.container
  grid(100%, 800px)
  padding forum-header-height 0 0 0!important
  z-index 5
  .forum:first-child
    padding-top (grid * 7)!important
  .forum
    position relative
    clear both
    min-height 650px
    padding-left left-content-width
    .container
      z-index 6
    .header.stuck::before
      opacity 1!important
    .header.stuck
      position fixed
      top header-scrolled-height
      left 50px
      z-index 7
      overflow hidden
    .header
      width 95%
      overflow visible
      text-align center
      .description
        text-rendering optimizelegibility
        text-transform capitalize
        overflow hidden
        text-overflow ellipsis
        width 45%
        left 19%
        position relative
        z-index 2
    .scroll-to
      position absolute
      right 0
      bottom -30px
    .post:hover
      //transform translateY(-15px)
      position relative
      z-index 4
      transition all .1s ease-out 1.3s
      .comment
        height 30px
        transition height .05s ease-out 1.6s
    .post
      float left
      margin grid
      overflow hidden
      //max-height max-post-height
      .photo
        float left
        width 25px
      img
        max-width 100%
    .comment 
      margin-top 2px
      padding 3px 7px
      height 0
      .msg
        font-size .9em
        font-style italic
        width 70%
    .subpost
      position relative
      clear both
      overflow hidden
      //max-height (max-post-height / 2)
      .photo
        overflow hidden
        width 40px
        float left
      img
        max-width 100%
  .scroll-to-top
      clear both
//}}}
//{{{ Footer
footer
  text-align center
  position fixed
  bottom 0
  right 0
  left 0
  height footer-height
  z-index 7
//}}}

//{{{ RESPONSIVEness
@media screen and (max-width: 800px)
  header
    height 30px
    .logo
      font-size 1.1em!important
      margin-top 4px!important
    .menu
      .row
        line-height 30px!important
    .search
      float right!important
      position relative!important
      top 0!important
      right 0!important
      .query
        height 9px
  body
    grid(100%,475px)
    .left-chrome
      display none!important
    #main_content.container
      margin 0 auto 0 grid!important
      .forum
        padding-left 0!important
  
@media screen and (max-width: 500px)
  header
    font-size 0.8em
    display none
  body
    grid(100%,320px)
    #main_content.container
      margin-left 0!important
      padding 25px 15px!important
      .forum
        margin-bottom grid!important
        padding-left 0!important
  body.scrolled
    .container
      margin-left 0!important
      padding 25px 15px!important
    .left-chrome
      display none!important
// }}}
// vim:fdm=marker
