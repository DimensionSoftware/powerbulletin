(function(){var require=function(e,t){var r=require.resolve(e,t||"/"),n=require.modules[r];if(!n)throw Error("Failed to resolve module "+e+", tried "+r);var s=require.cache[r],i=s?s.exports:n();return i};require.paths=[],require.modules={},require.cache={},require.extensions=[".js",".coffee",".json",".ls"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(e,t){function r(e){if(e=u.normalize(e),require.modules[e])return e;for(var t=0;require.extensions.length>t;t++){var r=require.extensions[t];if(require.modules[e+r])return e+r}}function n(e){e=e.replace(/\/+$/,"");var t=u.normalize(e+"/package.json");if(require.modules[t]){var n=require.modules[t](),s=n.browserify;if("object"==typeof s&&s.main){var i=r(u.resolve(e,s.main));if(i)return i}else if("string"==typeof s){var i=r(u.resolve(e,s));if(i)return i}else if(n.main){var i=r(u.resolve(e,n.main));if(i)return i}}return r(e+"/index")}function s(e,t){for(var s=i(t),u=0;s.length>u;u++){var a=s[u],o=r(a+"/"+e);if(o)return o;var l=n(a+"/"+e);if(l)return l}var o=r(e);return o?o:void 0}function i(e){var t;t="/"===e?[""]:u.normalize(e).split("/");for(var r=[],n=t.length-1;n>=0;n--)if("node_modules"!==t[n]){var s=t.slice(0,n+1).join("/")+"/node_modules";r.push(s)}return r}if(t||(t="/"),require._core[e])return e;var u=require.modules.path();t=u.resolve("/",t);var a=t||"/";if(e.match(/^(?:\.\.?\/|\/)/)){var o=r(u.resolve(a,e))||n(u.resolve(a,e));if(o)return o}var l=s(e,a);if(l)return l;throw Error("Cannot find module '"+e+"'")}}(),require.alias=function(e,t){var r=require.modules.path(),n=null;try{n=require.resolve(e+"/package.json","/")}catch(s){n=require.resolve(e,"/")}for(var i=r.dirname(n),u=(Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t})(require.modules),a=0;u.length>a;a++){var o=u[a];if(o.slice(0,i.length+1)===i+"/"){var l=o.slice(i.length);require.modules[t+l]=require.modules[i+l]}else o===i&&(require.modules[t]=require.modules[i])}},function(){var e={},t="undefined"!=typeof window?window:{},r=!1;require.define=function(n,s){!r&&require.modules.__browserify_process&&(e=require.modules.__browserify_process(),r=!0);var i=require._core[n]?"":require.modules.path().dirname(n),u=function(e){var t=require(e,i),r=require.cache[require.resolve(e,i)];return r&&null===r.parent&&(r.parent=a),t};u.resolve=function(e){return require.resolve(e,i)},u.modules=require.modules,u.define=require.define,u.cache=require.cache;var a={id:n,filename:n,exports:{},loaded:!1,parent:null};require.modules[n]=function(){return require.cache[n]=a,s.call(a.exports,u,a,a.exports,i,n,e,t),a.loaded=!0,a.exports}}}(),require.define("path",function(e,t,r,n,s,i){function u(e,t){for(var r=[],n=0;e.length>n;n++)t(e[n],n,e)&&r.push(e[n]);return r}function a(e,t){for(var r=0,n=e.length;n>=0;n--){var s=e[n];"."==s?e.splice(n,1):".."===s?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var o=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;r.resolve=function(){for(var e="",t=!1,r=arguments.length;r>=-1&&!t;r--){var n=r>=0?arguments[r]:i.cwd();"string"==typeof n&&n&&(e=n+"/"+e,t="/"===n.charAt(0))}return e=a(u(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},r.normalize=function(e){var t="/"===e.charAt(0),r="/"===e.slice(-1);return e=a(u(e.split("/"),function(e){return!!e}),!t).join("/"),e||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(u(e,function(e){return e&&"string"==typeof e}).join("/"))},r.dirname=function(e){var t=o.exec(e)[1]||"",r=!1;return t?1===t.length||r&&3>=t.length&&":"===t.charAt(1)?t:t.substring(0,t.length-1):"."},r.basename=function(e,t){var r=o.exec(e)[2]||"";return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},r.extname=function(e){return o.exec(e)[3]||""}}),require.define("__browserify_process",function(e,t,r,n,s,i){var i=t.exports={};i.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var r=[];return window.addEventListener("message",function(e){if(e.source===window&&"browserify-tick"===e.data&&(e.stopPropagation(),r.length>0)){var t=r.shift();t()}},!0),function(e){r.push(e),window.postMessage("browserify-tick","*")}}return function(e){setTimeout(e,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.binding=function(t){if("evals"===t)return e("vm");throw Error("No such module. (Possibly not yet loaded)")},function(){var t,r="/";i.cwd=function(){return r},i.chdir=function(n){t||(t=e("path")),r=t.resolve(n,r)}}()}),require.define("/lib/mutant/package.json",function(e,t){t.exports={main:"index.js"}}),require.define("/lib/mutant/mutant.ls",function(e){(function(){var t,r,n;"undefined"!=typeof window&&null!==window||(t=e("jsdom"),r=function(e,r){var n,s,i;return n=["../../public/local/jquery-1.8.3.min.js"],s={html:e,scripts:n},i=function(e,t){return e?r(e):(t.$=t.jQuery,r(null,t))},t.env(s,i)}),this.run=function(t,n,s){var i,u,a,o,l,c,d,f;if(null==s&&(s=function(){}),i=n.initial,u=n.locals||{},a=n.html,o=n.user,l=t.onLoad||function(e,t){return t(null)},c=t.onInitial||function(e,t){return t(null)},d=t.onMutate||function(e,t){return t(null)},f=t.onPersonalize||function(e,t,r){return r(null)},e("../../app/views/mutants.js"),"undefined"!=typeof window&&null!==window)return i?l.call(u,window,function(e){return e?s(e):c.call(u,window,function(e){return e?s(e):o?f.call(u,window,o,function(e){return e?s(e):void 0}):void 0})}):(window.renderMutant=function(e,t){return s(null,jade.render(window.document.getElementById(e),t,u))},window.marshal=function(e,t){return window[e]=t},t["static"].call(u,window,function(e){return e?s(e):l.call(u,window,function(e){return e?s(e):d.call(u,window,function(e){return e?s(e):o?f.call(u,window,o,function(e){return e?s(e):void 0}):void 0})})}));if(a)return r(a,function(e,r){return e?s(e):(r.renderMutant=function(e,t){return jade.render(r.document.getElementById(e),t,u)},r.marshal=function(e,t){var n;return n=r.document.createElement("script"),r.$(n).attr("type","text/javascript"),r.$(n).text("window['"+e+"'] = "+JSON.stringify(t)+";"),r.document.body.appendChild(n)},t["static"].call(u,r,function(e){return e?s(e):(r.$("script.jsdom").remove(),s(null,"<!doctype html>"+r.document.outerHTML))}))});throw Error("need html for serverside")},n=function(e){return e.callbacks.some(function(e){return e.surfable})},this.surfableRoutes=function(e){var t,r,s,i,u=[];for(t=0,s=(r=e.routes.get).length;s>t;++t)i=r[t],n(i)&&u.push(""+i.regexp);return u}}).call(this)}),require.define("/app/views/mutants.js",function(require,module,exports,__dirname,__filename,process,global){jade=function(e){function t(e){return null!=e}return Array.isArray||(Array.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),e.merge=function(e,r){var n=e["class"],s=r["class"];(n||s)&&(n=n||[],s=s||[],Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]),n=n.filter(t),s=s.filter(t),e["class"]=n.concat(s).join(" "));for(var i in r)"class"!=i&&(e[i]=r[i]);return e},e.attrs=function(t,r){var n=[],s=t.terse;delete t.terse;var i=Object.keys(t),u=i.length;if(u){n.push("");for(var a=0;u>a;++a){var o=i[a],l=t[o];"boolean"==typeof l||null==l?l&&(s?n.push(o):n.push(o+'="'+o+'"')):0==o.indexOf("data")&&"string"!=typeof l?n.push(o+"='"+JSON.stringify(l)+"'"):"class"==o&&Array.isArray(l)?n.push(o+'="'+e.escape(l.join(" "))+'"'):r&&r[o]?n.push(o+'="'+e.escape(l)+'"'):n.push(o+'="'+l+'"')}}return n.join(" ")},e.escape=function(e){return(e+"").replace(/&(?!(\w+|\#\d+);)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e.rethrow=function(e,t,r){if(!t)throw e;var n=3,s=require("fs").readFileSync(t,"utf8"),i=s.split("\n"),u=Math.max(r-n,0),a=Math.min(i.length,r+n),n=i.slice(u,a).map(function(e,t){var n=t+u+1;return(n==r?"  > ":"    ")+n+"| "+e}).join("\n");throw e.path=t,e.message=(t||"Jade")+":"+r+"\n"+n+"\n\n"+e.message,e},e}({}),jade.templates={},jade.render=function(e,t,r){var n=jade.templates[t](r);e.innerHTML=n},jade.templates.homepage=function(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp,forum_mixin=function(e,t){this.block,this.attributes||{},this.escaped||{},buf.push("<img"),buf.push(attrs({id:"forum_bg_"+e.id,src:""+cache_url+"/images/bg_"+e.id+".jpg","class":"bg initial"},{"class":!0,id:!0,src:!0})),buf.push("/><div"),buf.push(attrs({id:"forum_"+e.id,"class":"forum "+(""+(e.classes||"")+" "+(t%2?"odd":"even"))},{"class":!0,id:!0})),buf.push("><a"),buf.push(attrs({name:"forum_"+e.id},{name:!0})),buf.push('></a><div class="header"><div class="description"><a'),buf.push(attrs({href:e.uri,"class":"mutant"},{href:!0})),buf.push(">");var r=e.description;buf.push(escape(null==r?"":r)),buf.push('</a></div></div><div class="container">'),e.posts&&(function(){if("number"==typeof e.posts.length)for(var t=0,r=e.posts.length;r>t;t++){var n=e.posts[t];post_mixin(e,n,t)}else for(var t in e.posts){var n=e.posts[t];post_mixin(e,n,t)}}.call(this),buf.push("<div"),buf.push(attrs({"data-scroll-to":"#forum_"+e.id,title:"Scroll top of "+e.title+"!","class":"up scroll-to"},{"class":!0,"data-scroll-to":!0,title:!0})),buf.push("></div>")),buf.push("</div></div>")},post_mixin=function(e,t){this.block,this.attributes||{},this.escaped||{},buf.push("<div"),buf.push(attrs({id:"post_"+t.id,"class":"post "+("col"+Math.ceil(2*Math.random()))},{"class":!0,id:!0})),buf.push("><a"),buf.push(attrs({href:t.uri,"class":"mutant"},{href:!0})),buf.push('><h5 class="title">');var r=t.title;buf.push(null==r?"":r),buf.push('<span class="date">'+escape(null==(interp=t.date)?"":interp)+'</span></h5></a><p class="body">');var r=t.body;buf.push(null==r?"":r),buf.push("</p>"),t.posts&&function(){if("number"==typeof t.posts.length)for(var e=0,r=t.posts.length;r>e;e++){var n=t.posts[e];subpost_mixin(n,e)}else for(var e in t.posts){var n=t.posts[e];subpost_mixin(n,e)}}.call(this),buf.push('<div class="comment"><div class="photo"><img'),buf.push(attrs({src:""+cache_url+"/images/profile.jpg"},{src:!0})),buf.push('/></div><input type="text" placeholder="Say it ..." class="msg"/></div></div>')},subpost_mixin=function(e,t){this.block,this.attributes||{},this.escaped||{},buf.push("<div"),buf.push(attrs({id:"subpost_"+e.id,"class":"subpost "+(t%2?"odd":"even")},{"class":!0,id:!0})),buf.push('><div class="photo"><img'),buf.push(attrs({src:""+cache_url+"/images/profile.jpg"},{src:!0})),buf.push('/></div><p class="body">');var r=e.body;buf.push(null==r?"":r),buf.push('</p><div class="signature"><span class="username">- '+escape(null==(interp=e.user_name)?"":interp)+'</span><span class="date">');var r=e.date;buf.push(escape(null==r?"":r)),buf.push("</span></div></div>")};forums?function(){if("number"==typeof forums.length)for(var e=0,t=forums.length;t>e;e++){var r=forums[e];forum_mixin(r,e)}else for(var e in forums){var r=forums[e];forum_mixin(r,e)}}.call(this):buf.push("<p>Create a forum first<i>!</i></p>")}return buf.join("")},jade.templates.nav=function(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var thread_mixin=function(e){this.block,this.attributes||{},this.escaped||{},buf.push('<li><h4 class="title"><a'),buf.push(attrs({href:e.uri,"class":"mutant"},{href:!0})),buf.push(">");var t=e.title;buf.push(escape(null==t?"":t)),buf.push("</a></h4></li>")};buf.push('<div id="handle" title="Toggle" class="handle">&lt;</div><div class="create"><a class="button onclick-add-post-dialog">Create Thread</a></div><ul class="threads">'),function(){if("number"==typeof topThreads.length)for(var e=0,t=topThreads.length;t>e;e++){var r=topThreads[e];thread_mixin(r)}else for(var e in topThreads){var r=topThreads[e];thread_mixin(r)}}.call(this),buf.push("</ul>")}return buf.join("")},jade.templates.posts=function(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var breadcrumb_mixin=function(e){var t=(this.block,this.attributes||{},this.escaped||{},""),r=e.uri.split("/"),r=r.splice(1,r.length-2);(function(){if("number"==typeof r.length)for(var e=0,n=r.length;n>e;e++){var s=r[e];if("t"!=s){buf.push("<span>/</span><a"),buf.push(attrs({href:""+t+s,"class":"mutant"},{href:!0})),buf.push(">");var i=s.replace("-"," ");buf.push(escape(null==i?"":i)),buf.push("</a>")}t=t+s+"/"}else for(var e in r){var s=r[e];if("t"!=s){buf.push("<span>/</span><a"),buf.push(attrs({href:""+t+s,"class":"mutant"},{href:!0})),buf.push(">");var i=s.replace("-"," ");buf.push(escape(null==i?"":i)),buf.push("</a>")}t=t+s+"/"}}).call(this),buf.push("<span>/</span><em>");var n=e.title;buf.push(escape(null==n?"":n)),buf.push("</em>")},post_mixin=function(e){if(this.block,this.attributes||{},this.escaped||{},buf.push("<div"),buf.push(attrs({id:"post_"+e.id,"data-post-id":""+e.id,"class":"post"},{id:!0,"data-post-id":!0})),buf.push(">"),e.title){buf.push('<h3 class="title">');var t=e.title;buf.push(escape(null==t?"":t)),buf.push("</h3>")}buf.push('<div class="user">');var t=e.user_name;buf.push(escape(null==t?"":t)),buf.push('</div><div class="date">');var t=e.created;if(buf.push(escape(null==t?"":t)),buf.push('</div><div class="breadcrumb">'),breadcrumb_mixin(e),buf.push("</div>"),e.body){buf.push('<p class="body">');var t=e.body;buf.push(null==t?"":t),buf.push("</p>")}buf.push('<div class="actions"><a class="onclick-append-reply-ui">Reply</a> <a'),buf.push(attrs({href:e.uri},{href:!0})),buf.push('>Permalink</a></div><div class="reply"></div></div>'),e.posts&&e.posts.length&&subpost_mixin(e,-1)},subpost_mixin=function(e,t){if(this.block,this.attributes||{},this.escaped||{},t>-1){if(buf.push("<div"),buf.push(attrs({id:"subpost_"+e.id,"data-post-id":""+e.id,"class":"subpost "+(t%2?"odd":"even")},{"class":!0,id:!0,"data-post-id":!0})),buf.push(">"),e.title){buf.push('<h4 class="title">');var r=e.title;buf.push(escape(null==r?"":r)),buf.push("</h4>")}buf.push('<div class="user">');var r=e.user_name;buf.push(escape(null==r?"":r)),buf.push('</div><div class="date">');var r=e.created;if(buf.push(escape(null==r?"":r)),buf.push("</div>"),e.body){buf.push('<p class="body">');var r=e.body;buf.push(null==r?"":r),buf.push("</p>")}buf.push('<div class="actions"><a class="onclick-append-reply-ui">Reply</a><a'),buf.push(attrs({href:""+e.uri.replace(/\/\d+$/,"")+"/new/"+e.id,"class":"mutant"},{href:!0})),buf.push(">Edit</a> <a"),buf.push(attrs({href:e.uri},{href:!0})),buf.push('>Permalink</a></div><div class="reply"></div></div>')}e.posts&&e.posts.length&&(buf.push('<div class="children">'),function(){if("number"==typeof e.posts.length)for(var t=0,r=e.posts.length;r>t;t++){var n=e.posts[t];subpost_mixin(n,t)}else for(var t in e.posts){var n=e.posts[t];subpost_mixin(n,t)}}.call(this),buf.push("</div>"))};"undefined"!=typeof subPost&&(buf.push('<div class="forum">'),post_mixin(subPost),buf.push("</div>"))}return buf.join("")},jade.templates.post_edit=function(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var post_edit_mixin=function(e){this.block,this.attributes||{},this.escaped||{},buf.push("<div"),buf.push(attrs({id:"post_edit_"+e.id,"class":"post-edit"},{id:!0})),buf.push('><form id="add-post-form" action="/resources/posts" method="post"></form><label for="post_title">Title</label><input id="post_title" type="text" class="title"/><textarea class="body">');var t=e.body;buf.push(escape(null==t?"":t)),buf.push("</textarea><input"),buf.push(attrs({type:"hidden",name:"forum_id",value:e.id},{type:!0,name:!0,value:!0})),buf.push("/><input"),buf.push(attrs({type:"hidden",name:"csrf",value:e.csrf},{type:!0,name:!0,value:!0})),buf.push('/><input type="submit" value="Save" class="button"/><button class="cancel">Cancel</button><div class="preview"></div></div>')};"undefined"!=typeof post&&post_edit_mixin(post)}return buf.join("")}}),require.define("fs",function(){}),require.define("/app/mutants.ls",function(){(function(){var e,t,r;e=function(e,t,r){var n;return n=r?" forum-"+r:"",e.$("html").attr("class",t+""+n),e.marshal("mutator",t),e.$(".bg-set").remove(),e.$(".bg").each(function(){return e.$(this).addClass("bg-set").remove().prependTo(e.$("body"))}),e.$("header .menu").find(".active").removeClass("active"),e.$("menu .row").has(".forum-"+r).find(".title").addClass("active")},t=function(e,t,r){var n,s;return null==r&&(r="down"),e.bgAnim&&clearTimeout(e.bgAnim),n=e.$(".bg.active"),s=e.$("#forum"+("_bg_"+t.data("id"))),s.css("display","block"),n.length?e.bgAnim=setTimeout(function(){return n.css("top","down"===r?-300:300),n.removeClass("active"),s.addClass("active"),e.bgAnim=0},100):s.addClass("active")},r=function(e,t,r,n){var s,i;return s=e.$(t),i=e.$("<div class='container'>"),i.hide(),s.prepend(i),jade.render(i[0],r,n),i.slideDown(300)},this.homepage={"static":function(t,r){return t.renderMutant("main_content","homepage"),e(t,"homepage",this.activeForumId),r()},onLoad:function(e,r){return e.$(".forum .container").masonry({itemSelector:".post",isAnimated:!0,isFitWidth:!0,isResizable:!0}),setTimeout(function(){var r;return r=e.$,r(".forum .header").waypoint("sticky",{offset:-70}),r(".forum").waypoint({offset:"25%",handler:function(n){var s,i,u,a;return s=r(this),i=s.attr("id"),(u="down"===n?i:r("#"+i).prevAll(".forum:first").attr("id"))?(r("header .menu").find(".active").removeClass("active"),a=r("header .menu").find("."+u.replace(/_/,"-")).addClass("active"),r(".forum .stuck").removeClass("stuck"),t(e,a,n)):void 0}})},100),r()},onUnload:function(e,t){return e.$(".forum .container").masonry("destroy"),e.$(".forum .header").waypoint("destroy"),e.$(".forum").waypoint("destroy"),t()},onPersonalize:function(e,t,r){return console.log(e,t),console.log("HARHAR"),r()}},this.forum={"static":function(t,r){return t.renderMutant("left_content","nav"),t.renderMutant("main_content","posts"),t.marshal("activeForumId",this.activeForumId),t.marshal("activePostId",this.activePostId),e(t,"forum",this.activeForumId),r()},onLoad:function(e,n){var s,i,u,a,o,l;return s=e.$("header .menu .forum-"+e.activeForumId),t(e,s),i=e.$,i(".forum .breadcrumb").waypoint("sticky",{offset:-70}),u=i("#main_content.container .forum"),a=i("#left_content"),a.resizable({minWidth:200,maxWidth:450,resize:function(t,r){return u.css("padding-left",r.size.width),e.saveUi()}}),u.css("padding-left",a.width()+20),o=e.location.pathname.match(/new\/?([\d+]*)/),o&&(l=o[1]||0,l=l?"#"+("subpost_"+l):"BOTTOM",r(e,l,"post_edit",{post:{id:123}})),n()},onMutate:function(e,t){return e.scrollToTop(),t()},onUnload:function(e,t){return e.$(".forum .breadcrumb").waypoint("destroy"),e.$("#left_content").resizable("destroy"),t()}},this.search={"static":function(e,t){return t()},onLoad:function(e,t){return t()},onInitial:function(e,t){return t()},onMutate:function(e,t){return t()}},this.admin={"static":function(e,t){return t()}}}).call(this)}),require.define("/app/layout.ls",function(e){(function(){function t(e,t){for(var r=-1,n=t.length>>>0;n>++r;)if(e===t[r]&&r in t)return!0;return!1}var r,n,s,i,u,a,o;r=$(window),n=$(document),s=!1||t("msTransform",document.documentElement.style),i=!1||t("MozBoxSizing",document.documentElement.style),u=!(!window.opera||!window.opera.version),a=10,window.mutant=e("../lib/mutant/mutant"),window.mutate=function(){var e,t;return(e=$(this).attr("href"))?null!=e&&e.match(/#/)?!0:(t={},History.pushState({searchParams:t},"",e),!1):!1},n.on("click","a.mutant",window.mutate),History.Adapter.bind(window,"statechange",function(){var e;return e=History.getPageUrl().replace(/\/$/,""),$.get(e,{_surf:1},function(e){var t,r;return null!=(t=e.locals)&&t.title&&n.attr("title",e.locals.title),r=window.mutants[window.mutator].onUnload||function(e,t){return t(null)},r(window,function(){var t;try{return window.mutant.run(window.mutants[e.mutant],{locals:e.locals,user:window.user})}catch(r){return t=r}})}),!1}),window.scrollToTop=function(){var e;if(0!==$(window).scrollTop())return e=$("html,body"),e.animate({scrollTop:$("body").offset().top},140,function(){return e.animate({scrollTop:$("body").offset().top+a},110,function(){return e.animate({scrollTop:$("body").offset().top},75,function(){})})})},o=function(){var e;return e=r.scrollTop(),$("body").toggleClass("scrolled",e>a)},setTimeout(function(){return r.on("scroll",function(){return o()}),o()},1300),window.awesomeScrollTo=function(e,t,r){var n,i,a,o;return r=function(){var e;return r?void 0:e=1},e=$(e),n=t||600,i=100,e.length?(s||u?(e[0].scrollIntoView(),r()):(a=Math.round(e.position().top)-i,o=window.scrollY,Math.abs(a-o)>30?$("html,body").animate({scrollTop:a},n,function(){}):r()),e):void 0},n.on("click",".scroll-to",function(){return awesomeScrollTo($(this).data("scroll-to")),!1}),n.on("mousedown",".scroll-to-top",function(){return $(this).attr("title","Scroll to Top!"),window.scrollToTop(),!1})}).call(this)}),require("/app/layout.ls"),require.define("/app/entry.ls",function(e){(function(){var t,r,n,s,i,u,a,o,l;t=$(window),r=$(document),window.mutants=e("./mutants"),n="-",window.saveUi=function(){var e,t,r,s,i,u,a;return e=200,t=$("#left_content").width(),r=$.cookie("s"),r&&(s=r.split(n),i=s[0],i=s[1],u=s[2]),t=t>e?t:u||e,a=[$("body").hasClass("searching")?1:0,$("body").hasClass("collapsed")?1:0,t],$.cookie("s",a.join(n))},window.loadUi=function(){var e,t,r,s,i;return e=$.cookie("s"),e&&(t=e.split(n),r=t[0],s=t[1],i=t[2],$("#left_content").width(parseInt(i)+20)),"0"!==r&&$("body").addClass("searching"),"0"!==s?$("body").addClass("collapsed"):void 0},r.on("click","#handle",function(){return $("body").toggleClass("collapsed"),$("#main_content.container .forum").css("padding-left",$("#left_content").width()+20),saveUi()}),t.resize(function(){return setTimeout(function(){return $.waypoints("refresh")},800)}),setTimeout(function(){return $("#sort li").waypoint({context:"ul",offset:30,handler:function(e){var t;return t=$(this),"up"===e&&(t=t.prev()),t.length||(t=$(this)),$("#sort li.active").removeClass("active"),t.addClass("active")}})},100),r.on("click","html.homepage header .menu a.title",function(){return awesomeScrollTo($(this).data("scroll-to")),!1}),r.on("click","html.forum header .menu a.title",window.mutate),r.on("click","header",function(e){return e.target.className.indexOf("toggler")>-1&&$("body").removeClass("searching"),$("#query").focus(),saveUi()}),r.on("keypress","#query",function(){return $("body").addClass("searching"),saveUi()}),s=function(){return $.fancybox.open("#auth"),setTimeout(function(){return $("#auth input[name=username]").focus()},100)},i=function(){var e,t,r,n;return e=$(this),t=e.find("input[name=username]"),r=e.find("input[name=password]"),n={username:t.val(),password:r.val()},$.post(e.attr("action"),n,function(r){var n;return r.success?window.location.reload():(n=e.parents(".fancybox-wrap:first"),n.removeClass("shake"),setTimeout(function(){return n.addClass("shake"),t.focus()},100))}),!1},u=function(e){return function(){return window.user?e.apply(this,arguments):(s(),!1)}},r.on("submit",".login form",i),loadUi(),$("#query").focus(),a=function(){var e;return e={fid:window.activeForumId},$.get("/resources/posts",e,function(e){return $.fancybox(e),!1})},o=function(){var e;return e=$("#add-post-form"),$.post("/resources/posts",e.serialize(),function(e,t,r){return console.log("success! post added",r),console.log("stub: do something fancy to confirm submission")}),!1},l=function(){var e,t,r;return e=$(this).parents(".subpost:first"),t=e.data("post-id"),r='<form method="post" action="/resources/posts">\n  <textarea name="body"></textarea>\n  <input type="hidden" name="forum_id" value="'+window.activeForumId+'">\n  <input type="hidden" name="parent_id" value="'+t+'">\n  <div>\n    <input type="submit" value="Post">\n  </div>\n</form>',0===e.find(".reply form").length?e.find(".reply:first").append(r):e.find(".reply:first form").remove()},r.on("click","#add-post-submit",u(o)),r.on("click",".onclick-add-post-dialog",a),r.on("click",".onclick-append-reply-ui",u(l)),$.getJSON("/auth/user",function(e){return window.user=e,window.mutant.run(window.mutants[window.initialMutant],{initial:!0,user:window.user})})}).call(this)}),require("/app/entry.ls")})();