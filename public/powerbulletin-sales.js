;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
module.exports=function(n,r,t){function e(t,i){if(!r[t]){if(!n[t]){var o=typeof require=="function"&&require;if(!i&&o)return o(t,!0);if(u)return u(t,!0);throw new Error("Cannot find module '"+t+"'")}var a=r[t]={exports:{}};n[t][0].call(a.exports,function(r){var u=n[t][1][r];return e(u?u:r)},a,a.exports)}return r[t].exports}var u=typeof require=="function"&&require;for(var i=0;i<t.length;i++)e(t[i]);return e}({"prelude-ls":[function(n,r,t){r.exports=n("bcmc1g")},{}],bcmc1g:[function(n,r,t){var e,u,i,o,a,c,f,l,s,p={}.toString;e=n("./Func.js");u=n("./List.js");i=n("./Obj.js");o=n("./Str.js");a=n("./Num.js");c=function(n){return n};f=h(function(n,r){return p.call(r).slice(8,-1)===n});l=h(function(n,r){var t,e=[];for(t=0;t<n;++t){e.push(r)}return e});o.empty=u.empty;o.slice=u.slice;o.take=u.take;o.drop=u.drop;o.splitAt=u.splitAt;o.takeWhile=u.takeWhile;o.dropWhile=u.dropWhile;o.span=u.span;o.breakStr=u.breakList;s={Func:e,List:u,Obj:i,Str:o,Num:a,id:c,isType:f,replicate:l};s.each=u.each;s.map=u.map;s.filter=u.filter;s.compact=u.compact;s.reject=u.reject;s.partition=u.partition;s.find=u.find;s.head=u.head;s.first=u.first;s.tail=u.tail;s.last=u.last;s.initial=u.initial;s.empty=u.empty;s.reverse=u.reverse;s.difference=u.difference;s.intersection=u.intersection;s.union=u.union;s.countBy=u.countBy;s.groupBy=u.groupBy;s.fold=u.fold;s.foldl=u.foldl;s.fold1=u.fold1;s.foldl1=u.foldl1;s.foldr=u.foldr;s.foldr1=u.foldr1;s.unfoldr=u.unfoldr;s.andList=u.andList;s.orList=u.orList;s.any=u.any;s.all=u.all;s.unique=u.unique;s.sort=u.sort;s.sortWith=u.sortWith;s.sortBy=u.sortBy;s.sum=u.sum;s.product=u.product;s.mean=u.mean;s.average=u.average;s.concat=u.concat;s.concatMap=u.concatMap;s.flatten=u.flatten;s.maximum=u.maximum;s.minimum=u.minimum;s.scan=u.scan;s.scanl=u.scanl;s.scan1=u.scan1;s.scanl1=u.scanl1;s.scanr=u.scanr;s.scanr1=u.scanr1;s.slice=u.slice;s.take=u.take;s.drop=u.drop;s.splitAt=u.splitAt;s.takeWhile=u.takeWhile;s.dropWhile=u.dropWhile;s.span=u.span;s.breakList=u.breakList;s.zip=u.zip;s.zipWith=u.zipWith;s.zipAll=u.zipAll;s.zipAllWith=u.zipAllWith;s.apply=e.apply;s.curry=e.curry;s.flip=e.flip;s.fix=e.fix;s.split=o.split;s.join=o.join;s.lines=o.lines;s.unlines=o.unlines;s.words=o.words;s.unwords=o.unwords;s.chars=o.chars;s.unchars=o.unchars;s.values=i.values;s.keys=i.keys;s.pairsToObj=i.pairsToObj;s.objToPairs=i.objToPairs;s.listsToObj=i.listsToObj;s.objToLists=i.objToLists;s.max=a.max;s.min=a.min;s.negate=a.negate;s.abs=a.abs;s.signum=a.signum;s.quot=a.quot;s.rem=a.rem;s.div=a.div;s.mod=a.mod;s.recip=a.recip;s.pi=a.pi;s.tau=a.tau;s.exp=a.exp;s.sqrt=a.sqrt;s.ln=a.ln;s.pow=a.pow;s.sin=a.sin;s.tan=a.tan;s.cos=a.cos;s.acos=a.acos;s.asin=a.asin;s.atan=a.atan;s.atan2=a.atan2;s.truncate=a.truncate;s.round=a.round;s.ceiling=a.ceiling;s.floor=a.floor;s.isItNaN=a.isItNaN;s.even=a.even;s.odd=a.odd;s.gcd=a.gcd;s.lcm=a.lcm;s.VERSION="1.0.0";r.exports=s;function h(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}},{"./Func.js":1,"./Obj.js":2,"./Num.js":3,"./List.js":4,"./Str.js":5}],1:[function(n,r,t){var e,u,i,o;e=function(n){return a(n)};u=a(function(n,r,t){return n(t,r)});i=function(n){return function(r,t){return function(){return n(r(r)).apply(null,arguments)}}(function(r,t){return function(){return n(r(r)).apply(null,arguments)}})};o=a(function(n,r){return n.apply(null,r)});r.exports={curry:e,flip:u,fix:i,apply:o};function a(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}},{}],2:[function(n,r,t){var e,u,i,o,a,c,f,l,s,p,h,g,v,m;e=function(n){var r,t,e=[];for(r in n){t=n[r];e.push(t)}return e};u=function(n){var r,t=[];for(r in n){t.push(r)}return t};i=function(n){var r,t,e,u={};for(r=0,t=n.length;r<t;++r){e=n[r];u[e[0]]=e[1]}return u};o=function(n){var r,t,e=[];for(r in n){t=n[r];e.push([r,t])}return e};a=d(function(n,r){var t,e,u,i,o={};for(t=0,e=n.length;t<e;++t){u=t;i=n[t];o[i]=r[u]}return o});c=function(n){var r,t,e,u;r=[];t=[];for(e in n){u=n[e];r.push(e);t.push(u)}return[r,t]};f=function(n){var r;for(r in n){return false}return true};l=d(function(n,r){var t,e;for(t in r){e=r[t];n(e)}return r});s=d(function(n,r){var t,e,u={};for(t in r){e=r[t];u[t]=n(e)}return u});p=d(function(n){var r,t,e={};for(r in n){t=n[r];if(t){e[r]=t}}return e});h=d(function(n,r){var t,e,u={};for(t in r){e=r[t];if(n(e)){u[t]=e}}return u});g=d(function(n,r){var t,e,u={};for(t in r){e=r[t];if(!n(e)){u[t]=e}}return u});v=d(function(n,r){var t,e,u,i;t={};e={};for(u in r){i=r[u];(n(i)?t:e)[u]=i}return[t,e]});m=d(function(n,r){var t,e;for(t in r){e=r[t];if(n(e)){return e}}});r.exports={values:e,keys:u,pairsToObj:i,objToPairs:o,listsToObj:a,objToLists:c,empty:f,each:l,map:s,filter:h,compact:p,reject:g,partition:v,find:m};function d(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}},{}],3:[function(n,r,t){var e,u,i,o,a,c,f,l,s,p,h,g,v,m,d,y,j,b,x,M,k,W,L,q,w,T,z,A,N,O,B,S;e=I(function(n,r){return n>r?n:r});u=I(function(n,r){return n<r?n:r});i=function(n){return-n};o=Math.abs;a=function(n){if(n<0){return-1}else if(n>0){return 1}else{return 0}};c=I(function(n,r){return~~(n/r)});f=I(function(n,r){return n%r});l=I(function(n,r){return Math.floor(n/r)});s=I(function(n,r){var t;return(n%(t=r)+t)%t});p=function(n){return 1/n};h=Math.PI;g=h*2;v=Math.exp;m=Math.sqrt;d=Math.log;y=I(function(n,r){return Math.pow(n,r)});j=Math.sin;b=Math.tan;x=Math.cos;M=Math.asin;k=Math.acos;W=Math.atan;L=I(function(n,r){return Math.atan2(n,r)});q=function(n){return~~n};w=Math.round;T=Math.ceil;z=Math.floor;A=function(n){return n!==n};N=function(n){return n%2===0};O=function(n){return n%2!==0};B=I(function(n,r){var t;n=Math.abs(n);r=Math.abs(r);while(r!==0){t=n%r;n=r;r=t}return n});S=I(function(n,r){return Math.abs(Math.floor(n/B(n,r)*r))});r.exports={max:e,min:u,negate:i,abs:o,signum:a,quot:c,rem:f,div:l,mod:s,recip:p,pi:h,tau:g,exp:v,sqrt:m,ln:d,pow:y,sin:j,tan:b,cos:x,acos:k,asin:M,atan:W,atan2:L,truncate:q,round:w,ceiling:T,floor:z,isItNaN:A,even:N,odd:O,gcd:B,lcm:S};function I(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}},{}],4:[function(n,r,t){var e,u,i,o,a,c,f,l,s,p,h,g,v,m,d,y,j,b,x,M,k,W,L,q,w,T,z,A,N,O,B,S,I,P,F,E,C,R,V,D,G,H,J,K,Q,U,X,Y,Z,$,_,nr,rr,tr,er,ur,ir,or,ar,cr,fr,lr=[].slice;e=sr(function(n,r){var t,e,u;for(t=0,e=r.length;t<e;++t){u=r[t];n(u)}return r});u=sr(function(n,r){var t,e,u,i=[];for(t=0,e=r.length;t<e;++t){u=r[t];i.push(n(u))}return i});i=sr(function(n){var r,t,e,u=[];for(r=0,t=n.length;r<t;++r){e=n[r];if(e){u.push(e)}}return u});o=sr(function(n,r){var t,e,u,i=[];for(t=0,e=r.length;t<e;++t){u=r[t];if(n(u)){i.push(u)}}return i});a=sr(function(n,r){var t,e,u,i=[];for(t=0,e=r.length;t<e;++t){u=r[t];if(!n(u)){i.push(u)}}return i});c=sr(function(n,r){var t,e,u,i,o;t=[];e=[];for(u=0,i=r.length;u<i;++u){o=r[u];(n(o)?t:e).push(o)}return[t,e]});f=sr(function(n,r){var t,e,u;for(t=0,e=r.length;t<e;++t){u=r[t];if(n(u)){return u}}});l=s=function(n){if(!n.length){return}return n[0]};p=function(n){if(!n.length){return}return n.slice(1)};h=function(n){if(!n.length){return}return n[n.length-1]};g=function(n){var r;r=n.length;if(!r){return}return n.slice(0,r-1)};v=function(n){return!n.length};m=function(n){return n.concat().reverse()};d=function(n){var r,t,e,u;r=[];for(t=0,e=n.length;t<e;++t){u=n[t];if(!pr(u,r)){r.push(u)}}return r};y=j=sr(function(n,r,t){var e,u,i;for(e=0,u=t.length;e<u;++e){i=t[e];r=n(r,i)}return r});b=x=sr(function(n,r){return y(n,r[0],r.slice(1))});M=sr(function(n,r,t){return y(n,r,t.concat().reverse())});k=sr(function(n,r){var t;t=r.concat().reverse();return y(n,t[0],t.slice(1))});W=sr(function(n,r){var t,e,u;t=[];e=r;while((u=n(e))!=null){t.push(u[0]);e=u[1]}return t});L=function(n){return[].concat.apply([],n)};q=sr(function(n,r){var t;return[].concat.apply([],function(){var e,u,i,o=[];for(e=0,i=(u=r).length;e<i;++e){t=u[e];o.push(n(t))}return o}())});w=sr(function(n){var r;return[].concat.apply([],function(){var t,e,u,i=[];for(t=0,u=(e=n).length;t<u;++t){r=e[t];if(r.length!=null){i.push(w(r))}else{i.push(r)}}return i}())});T=function(n){var r,t,e,u,i,o,a,c;r=lr.call(arguments,1);t=[];n:for(e=0,u=n.length;e<u;++e){i=n[e];for(o=0,a=r.length;o<a;++o){c=r[o];if(pr(i,c)){continue n}}t.push(i)}return t};z=function(n){var r,t,e,u,i,o,a,c;r=lr.call(arguments,1);t=[];n:for(e=0,u=n.length;e<u;++e){i=n[e];for(o=0,a=r.length;o<a;++o){c=r[o];if(!pr(i,c)){continue n}}t.push(i)}return t};A=function(){var n,r,t,e,u,i,o,a;n=lr.call(arguments);r=[];for(t=0,e=n.length;t<e;++t){u=n[t];for(i=0,o=u.length;i<o;++i){a=u[i];if(!pr(a,r)){r.push(a)}}}return r};N=sr(function(n,r){var t,e,u,i,o;t={};for(e=0,u=r.length;e<u;++e){i=r[e];o=n(i);if(o in t){t[o]+=1}else{t[o]=1}}return t});O=sr(function(n,r){var t,e,u,i,o;t={};for(e=0,u=r.length;e<u;++e){i=r[e];o=n(i);if(o in t){t[o].push(i)}else{t[o]=[i]}}return t});B=function(n){var r,t,e;for(r=0,t=n.length;r<t;++r){e=n[r];if(!e){return false}}return true};S=function(n){var r,t,e;for(r=0,t=n.length;r<t;++r){e=n[r];if(e){return true}}return false};I=sr(function(n,r){var t,e,u;for(t=0,e=r.length;t<e;++t){u=r[t];if(n(u)){return true}}return false});P=sr(function(n,r){var t,e,u;for(t=0,e=r.length;t<e;++t){u=r[t];if(!n(u)){return false}}return true});F=function(n){return n.concat().sort(function(n,r){if(n>r){return 1}else if(n<r){return-1}else{return 0}})};E=sr(function(n,r){if(!r.length){return[]}return r.concat().sort(n)});C=sr(function(n,r){if(!r.length){return[]}return r.concat().sort(function(r,t){if(n(r)>n(t)){return 1}else if(n(r)<n(t)){return-1}else{return 0}})});R=function(n){var r,t,e,u;r=0;for(t=0,e=n.length;t<e;++t){u=n[t];r+=u}return r};V=function(n){var r,t,e,u;r=1;for(t=0,e=n.length;t<e;++t){u=n[t];r*=u}return r};D=G=function(n){var r,t,e,u;r=0;t=n.length;for(e=0;e<t;++e){u=e;r+=n[u]}return r/t};H=function(n){var r,t,e,u,i;r=n[0];for(t=0,u=(e=n.slice(1)).length;t<u;++t){i=e[t];if(i>r){r=i}}return r};J=function(n){var r,t,e,u,i;r=n[0];for(t=0,u=(e=n.slice(1)).length;t<u;++t){i=e[t];if(i<r){r=i}}return r};K=Q=sr(function(n,r,t){var e,u;e=r;return[r].concat(function(){var r,i,o,a=[];for(r=0,o=(i=t).length;r<o;++r){u=i[r];a.push(e=n(e,u))}return a}())});U=X=sr(function(n,r){if(!r.length){return}return K(n,r[0],r.slice(1))});Y=sr(function(n,r,t){t=t.concat().reverse();return K(n,r,t).reverse()});Z=sr(function(n,r){if(!r.length){return}r=r.concat().reverse();return K(n,r[0],r.slice(1)).reverse()});$=sr(function(n,r,t){return t.slice(n,r)});_=sr(function(n,r){if(n<=0){return r.slice(0,0)}else if(!r.length){return r}else{return r.slice(0,n)}});nr=sr(function(n,r){if(n<=0||!r.length){return r}else{return r.slice(n)}});rr=sr(function(n,r){return[_(n,r),nr(n,r)]});tr=sr(function(n,r){var t,e,u;t=r.length;if(!t){return r}for(e=0;e<t;++e){u=e;if(!n(r[u])){break}}return r.slice(0,u)});er=sr(function(n,r){var t,e,u;t=r.length;if(!t){return r}for(e=0;e<t;++e){u=e;if(!n(r[u])){break}}return r.slice(u)});ur=sr(function(n,r){return[tr(n,r),er(n,r)]});ir=sr(function(n,r){return ur(hr([gr,n]),r)});or=sr(function(n,r){var t,e,u,i,o,a;t=[];e=r.length;for(u=0,i=n.length;u<i;++u){o=u;a=n[u];if(o===e){break}t.push([a,r[o]])}return t});ar=sr(function(n,r,t){var e,u,i,o,a,c;e=[];u=t.length;for(i=0,o=r.length;i<o;++i){a=i;c=r[i];if(a===u){break}e.push(n(c,t[a]))}return e});cr=function(){var n,r,t,e,u,i,o,a,c,f=[];n=lr.call(arguments);r=9e9;for(t=0,e=n.length;t<e;++t){u=n[t];r<=(i=u.length)||(r=i)}for(t=0;t<r;++t){o=t;a=[];for(c=0,e=n.length;c<e;++c){u=n[c];a.push(u[o])}f.push(a)}return f};fr=function(n){var r,t,e,u,i,o,a,c=[];r=lr.call(arguments,1);t=9e9;for(e=0,u=r.length;e<u;++e){i=r[e];t<=(o=i.length)||(t=o)}for(e=0;e<t;++e){a=e;c.push(n.apply(null,f()))}return c;function f(){var n,t,e,u=[];for(n=0,e=(t=r).length;n<e;++n){i=t[n];u.push(i[a])}return u}};r.exports={each:e,map:u,filter:o,compact:i,reject:a,partition:c,find:f,head:l,first:s,tail:p,last:h,initial:g,empty:v,reverse:m,difference:T,intersection:z,union:A,countBy:N,groupBy:O,fold:y,fold1:b,foldl:j,foldl1:x,foldr:M,foldr1:k,unfoldr:W,andList:B,orList:S,any:I,all:P,unique:d,sort:F,sortWith:E,sortBy:C,sum:R,product:V,mean:D,average:G,concat:L,concatMap:q,flatten:w,maximum:H,minimum:J,scan:K,scan1:U,scanl:Q,scanl1:X,scanr:Y,scanr1:Z,slice:$,take:_,drop:nr,splitAt:rr,takeWhile:tr,dropWhile:er,span:ur,breakList:ir,zip:or,zipWith:ar,zipAll:cr,zipAllWith:fr};function sr(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}function pr(n,r){var t=-1,e=r.length>>>0;while(++t<e)if(n===r[t]&&t in r)return true;return false}function hr(n){return function(){var r,t=arguments;for(r=n.length;r>0;--r){t=[n[r-1].apply(this,t)]}return t[0]}}function gr(n){return!n}},{}],5:[function(n,r,t){var e,u,i,o,a,c,f,l,s,p;e=h(function(n,r){return r.split(n)});u=h(function(n,r){return r.join(n)});i=function(n){if(!n.length){return[]}return n.split("\n")};o=function(n){return n.join("\n")};a=function(n){if(!n.length){return[]}return n.split(/[ ]+/)};c=function(n){return n.join(" ")};f=function(n){return n.split("")};l=function(n){return n.join("")};s=function(n){return n.split("").reverse().join("")};p=h(function(n,r){var t,e,u;e=[];for(u=0;u<n;++u){e.push(r)}t=e;return t.join("")});r.exports={split:e,join:u,lines:i,unlines:o,words:a,unwords:c,chars:f,unchars:l,reverse:s,repeat:p};function h(n,r){var t,e=function(u){return n.length>1?function(){var i=u?u.concat():[];t=r?t||this:this;return i.push.apply(i,arguments)<n.length&&arguments.length?e.call(t,i):n.apply(t,i)}:n};return e()}},{}]},{},[]);

},{}],2:[function(require,module,exports){
var $R, mutant, ch, $w, $d, isIe, isMoz, isOpera, isTouchable, threshold, lastReqId, hasScrolled, timeUpdater, showTimeoutId, hideTimeoutId;
window.helpers = require('./shared-helpers.ls');
window.mutants = require('./pb-mutants.ls');
$R = require('reactivejs');
window.rUser = $R.state();
mutant = require('../lib/mutant/mutant.ls');
ch = require('./client-helpers.ls');
window.Auth = require('../component/Auth.ls');
window.cors = {
  ajaxParams: {
    xhrFields: {
      withCredentials: true
    },
    success: function(){},
    error: function(){}
  },
  get: function(url, data, cb){
    var params;
    params = {};
    import$(params, this.ajaxParams);
    params.type = 'GET';
    params.url = url;
    params.data = data;
    if (cb) {
      params.success = cb;
    }
    return $.ajax(params);
  },
  post: function(url, data, cb){
    var params;
    params = {};
    import$(params, this.ajaxParams);
    params.type = 'POST';
    params.url = url;
    params.data = data;
    if (cb) {
      params.success = cb;
    }
    return $.ajax(params);
  }
};
window.hints = {
  last: {
    pathname: null,
    mutator: null
  },
  current: {
    pathname: window.location.pathname,
    mutator: window.mutator
  }
};
$w = $(window);
$d = $(document);
isIe = false || in$('msTransform', document.documentElement.style);
isMoz = false || in$('MozBoxSizing', document.documentElement.style);
isOpera = !!(window.opera && window.opera.version);
isTouchable = function(){
  var e;
  try {
    document.createEvent('TouchEvent');
    return true;
  } catch (e$) {
    e = e$;
    return false;
  }
}();
threshold = 15;
$d.on('click', 'a.mutant', ch.mutate);
window.lastStatechangeWasUser = true;
lastReqId = 0;
History.Adapter.bind(window, 'statechange', function(e){
  var statechangeWasUser, url, params, ref$, rc, surfParams, reqId, jqxhr;
  statechangeWasUser = window.lastStatechangeWasUser;
  window.lastStatechangeWasUser = true;
  url = History.getPageUrl().replace(/\/$/, '');
  params = History.getState().data;
  import$(window.hints.last, window.hints.current);
  ref$ = window.hints.current;
  ref$.pathname = window.location.pathname;
  ref$.mutator = null;
  if (window.hints.last.mutator === 'forum' && !window.location.pathname.match(/^\/(auth|admin|resources)/)) {
    rc = window.tasks.recommendation(window.location.pathname, window.hints.last.pathname);
  }
  if (!(params != null && params.noSurf)) {
    spin(true);
    surfParams = {
      _surf: mutator,
      _surfData: params != null ? params.surfData : void 8
    };
    if (rc != null && ((ref$ = rc.keep) != null && ref$.length)) {
      surfParams._surfTasks = rc.keep.sort().map(function(it){
        return tasks.cc(it);
      }).join(',');
    }
    reqId = ++lastReqId;
    jqxhr = $.get(url, surfParams, function(r){
      var ref$, onUnload;
      if (!r.mutant) {
        return;
      }
      if ((ref$ = r.locals) != null && ref$.title) {
        $d.attr('title', r.locals.title);
      }
      onUnload = mutants[window.mutator].onUnload || function(w, nextMutant, cb){
        return cb(null);
      };
      return onUnload(window, r.mutant, function(){
        var locals;
        if (reqId === lastReqId) {
          locals = import$({
            statechangeWasUser: statechangeWasUser
          }, r.locals);
          return mutant.run(mutants[r.mutant], {
            locals: locals,
            user: window.user
          }, function(){
            onloadResizable();
            window.hints.current.mutator = window.mutator;
            return spin(false);
          });
        }
      });
    });
    return jqxhr.fail(function(xhr, status, error){
      showTooltip($('#warning'), "Page Not Found", 8000);
      History.back();
      return window.spin(false);
    });
  }
});
window.onloadPersonalize = function(){
  var ref$;
  if (window.user) {
    $('.onclick-profile').each(function(){
      return this.href = "/user/" + window.user.name;
    });
    $('.onclick-login').hide();
    $('.onclick-logout').show();
    $('.onclick-profile').show();
    if (((typeof user != 'undefined' && user !== null) && ((ref$ = user.rights) != null && ref$['super'])) || ((typeof user != 'undefined' && user !== null) && ((ref$ = user.rights) != null && ref$.admin))) {
      return $('.admin-only').show();
    } else {
      return $('.admin-only').hide();
    }
  } else {
    $('.onclick-login').show();
    $('.onclick-logout').hide();
    $('.onclick-profile').hide();
    return $('.admin-only').hide();
  }
};
window.onloadResizable = function(){
  var leftOffset, $l, $r;
  leftOffset = 50;
  $l = $('#left_content');
  $r = $('#main_content .resizable');
  if ($r.length) {
    $l.resizable({
      minWidth: 200,
      maxWidth: 450,
      resize: function(e, ui){
        $l.toggleClass('wide', $l.width() > 300);
        $r.css('padding-left', ui.size.width + leftOffset);
        $l.find('.scrollable').getNiceScroll().resize();
        return window.saveUi();
      }
    });
    $l.find('.scrollable').niceScroll({
      bouncescroll: true,
      cursorcolor: '#bbb',
      cursorwidth: 6,
      hidecursordelay: 1000,
      mousescrollstep: 6,
      railoffset: true,
      railpadding: {
        bottom: 150
      }
    });
    return $r.css('padding-left', $l.width() + leftOffset);
  } else {
    try {
      return $l.resizable('destroy');
    } catch (e$) {}
  }
};
window.scrollToTop = function(cb){
  var $e;
  cb == null && (cb = function(){});
  if ($(window).scrollTop() === 0) {
    return;
  }
  $e = $('html,body');
  $e.animate({
    scrollTop: 0
  }, 250, function(){
    return $e.animate({
      scrollTop: threshold / 2
    }, 70, function(){
      return $e.animate({
        scrollTop: 0
      }, 55, function(){});
    });
  });
  return cb();
};
window.awesomeScrollTo = function(e, duration, cb){
  var ms, offset, dstScroll, curScroll;
  cb == null && (cb = function(){});
  e = $(e);
  ms = duration || 250;
  offset = 10;
  if (!e.length) {
    return;
  }
  if (isIe || isOpera) {
    e[0].scrollIntoView();
    cb();
  } else {
    dstScroll = Math.round(e.position().top) - offset;
    curScroll = window.scrollY;
    if (Math.abs(dstScroll - curScroll) > threshold * 2) {
      $('html,body').animate({
        scrollTop: dstScroll
      }, ms, function(){
        return $('html,body').animate({
          scrollTop: dstScroll + threshold / 2
        }, 70, function(){
          return $('html,body').animate({
            scrollTop: dstScroll
          }, 50, function(){
            return cb();
          });
        });
      });
    } else {
      cb();
    }
  }
  return e;
};
hasScrolled = function(){
  var st;
  st = $w.scrollTop();
  return $('body').toggleClass('scrolled', st > threshold);
};
setTimeout(function(){
  $w.on('scroll', function(){
    return hasScrolled();
  });
  return hasScrolled();
}, 600);
$('header.header').on('click', function(ev){
  var b;
  if ($(ev.target).hasClass('header')) {
    b = $('body');
    if ($w.scrollTop() > threshold) {
      b.toggleClass('scrolled');
      return setTimeout(function(){
        return $('#query').focus();
      }, 1);
    }
  }
});
$d.on('click', '.onclick-scroll-to', function(){
  awesomeScrollTo($(this).data('scroll-to'));
  return false;
});
$d.on('mousedown', '.onclick-scroll-top', function(){
  $(this).attr('title', 'Scroll to Top!');
  window.scrollToTop();
  return false;
});
window.shakeDialog = function($form, time){
  var $fancybox;
  $fancybox = $form.parents('.fancybox-wrap:first').removeClass('shake');
  return setTimeout(function(){
    return $fancybox.addClass('shake');
  }, 100);
};
Auth.afterLogin = function(){
  return $.getJSON('/auth/user', function(user){
    var ref$;
    window.user = user;
    onloadPersonalize();
    if (user && ((typeof mutants != 'undefined' && mutants !== null) && ((ref$ = mutants[window.mutator]) != null && ref$.onPersonalize))) {
      setProfile(user.photo);
      return typeof mutants != 'undefined' && mutants !== null ? (ref$ = mutants[window.mutator]) != null ? ref$.onPersonalize(window, user, function(){
        var ref$;
        if (typeof socket != 'undefined' && socket !== null) {
          socket.disconnect();
        }
        return typeof socket != 'undefined' && socket !== null ? (ref$ = socket.socket) != null ? ref$.connect() : void 8 : void 8;
      }) : void 8 : void 8;
    }
  });
};
window.logout = function(){
  window.location = '/auth/logout';
  return false;
};
$d.on('click', '.onclick-logout', function(){
  window.logout();
  return false;
});
$d.on('click', '.require-login', Auth.requireLogin(function(){
  return this.click;
}));
$d.on('click', '.onclick-login', function(){
  Auth.showLoginDialog();
  return false;
});
timeUpdater = function(){
  var now;
  now = new Date;
  return $('[data-time]').each(function(){
    var $el, d, elapsed, hr, lh;
    $el = $(this);
    d = new Date($el.data('time'));
    elapsed = (now - d) / 1000;
    hr = window.helpers.elapsedToHumanReadable(elapsed);
    lh = $el.data('last-human');
    $el.data('last-human', hr);
    if ($el.hasClass('time-title')) {
      return $el.attr('title', hr.replace(/<.*?\/?>/g, ''));
    } else {
      return $el.html(hr);
    }
  });
};
setInterval(timeUpdater, 30000);
window.spin = function(loading){
  var timeUntilShow, timeUntilHide, $b, show, hide;
  loading == null && (loading = true);
  timeUntilShow = 500;
  timeUntilHide = 6500;
  clearTimeout(showTimeoutId);
  clearTimeout(hideTimeoutId);
  $b || ($b = $('body'));
  show = function(){
    $b.addClass('waiting');
    return hideTimeoutId = setTimeout(hide, timeUntilHide);
  };
  hide = function(){
    return $b.removeClass('waiting');
  };
  if (loading) {
    return showTimeoutId = setTimeout(show, timeUntilShow);
  } else {
    return hide();
  }
};
onloadResizable();
$.getJSON('/auth/user', function(user){
  var m;
  window.user = user;
  setTimeout(function(){
    return window.rUser(window.user);
  }, 50);
  if (window.location.hash.match(/^\#recover=/)) {
    Auth.showResetPasswordDialog();
  }
  if (m = window.location.hash.match(/^\#invalid=(.+)/)) {
    Auth.showInfoDialog("Welcome back " + m[1] + "!");
  }
  switch (window.location.hash) {
  case '#invalid':
    Auth.showInfoDialog('Invalid invite code!');
    break;
  case '#validate':
    Auth.afterLogin();
    break;
  case '#once':
    Auth.loginWithToken();
  }
  onloadPersonalize();
  if (window.initialMutant) {
    return mutant.run(mutants[window.initialMutant], {
      initial: true,
      user: window.user
    }, function(){});
  }
});
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
function in$(x, arr){
  var i = -1, l = arr.length >>> 0;
  while (++i < l) if (x === arr[i] && i in arr) return true;
  return false;
}
},{"./shared-helpers.ls":3,"./client-helpers.ls":4,"./pb-mutants.ls":5,"../lib/mutant/mutant.ls":6,"../component/Auth.ls":7,"reactivejs":8}],9:[function(require,module,exports){
(function(global){var $R, SalesApp, Buy;
$R = require('reactivejs');
SalesApp = require('../component/SalesApp.ls');
Buy = require('../component/Buy.ls');
import$(global, require('prelude-ls/prelude-browser-min')('prelude-ls'));
window.component = {
  salesApp: new SalesApp({
    autoRender: false
  }, 'body').attach()
};
window.doBuy = function(){
  var ref$;
  (ref$ = window.component).buy || (ref$.buy = (new Buy).attach());
  return lazyLoadFancybox(function(){
    return $.fancybox(window.component.buy.$);
  });
};
$R(function(user){
  if (user) {
    return component.salesApp.login(user);
  } else {
    return component.salesApp.logout();
  }
}).bindTo(window.rUser);
$(window).on('scroll', function(){
  var offset, inverse;
  offset = $(window).scrollTop();
  inverse = 8 / Math.abs(offset + 0.01);
  if (inverse < 0) {
    0;
  } else {
    inverse;
  }
  $('#imagine').css('opacity', inverse);
  $('.logo').css('y', (0 - offset * 0.1) + "px");
  $('#register_top').css({
    opacity: inverse,
    y: (0 - offset * 2.7) + "px"
  });
  each(function(it){
    return $(it).css('y', (0 - offset * 0.68) + "px");
  })(
  $('.bg'));
  each(function(it){
    return $(it).css('y', (0 - offset * 0.82) + "px");
  })(
  $('.stick:odd'));
  return each(function(it){
    return $(it).css('y', (0 - offset * 0.77) + "px");
  })(
  $('.stick:even'));
});
setTimeout(function(){
  $('#register_top').transition({
    x: 25,
    opacity: 1
  }, 1000, 'easeOutExpo');
  $('.SiteRegister-subdomain:first').focus();
  return setTimeout(function(){
    return $('.SiteRegister h3').transition({
      opacity: 1,
      y: 30
    }, 400);
  }, 100);
}, 300);
if ($(window).scrollTop !== 0) {
  $('html,body').animate({
    scrollTop: 0
  }, 500, 'easeOutExpo');
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
})(window)
},{"../component/Buy.ls":10,"../component/SalesApp.ls":11,"prelude-ls/prelude-browser-min":1,"reactivejs":8}],8:[function(require,module,exports){
(function() {
  var defaultContext = this;
  var __id = 0;

  function $R(fnc, context) {
      var rf = function() {
        var dirtyNodes = topo(rf);
        var v = dirtyNodes[0].run.apply(rf, arguments);
        dirtyNodes.slice(1).forEach(function (n) { n.run() } );
        return v;
      };
      rf.id = __id++;
      rf.context = context || defaultContext;
      rf.fnc = fnc;
      rf.dependents = [];
      rf.dependencies = [];
      rf.memo = $R.empty;
      return $R.extend(rf, reactiveExtensions, $R.pluginExtensions);
  }
  $R._ = {};
  $R.empty = {};
  $R.state = function (initial) {
    var rFnc = $R(function () {
      if (arguments.length) {
        this.val = arguments[0];
      }
      return this.val;
    })
    rFnc.context = rFnc;
    rFnc.val = initial;
    return rFnc;
  }
  $R.extend = function(o) {
    var extensions = Array.prototype.slice.call(arguments, 1);
    extensions.forEach(function (extension) {
      if (extension) {
        for (var prop in extension) { o[prop] = extension[prop] }
      }
    });
    return o;
  };
  $R.pluginExtensions = {}

  var reactiveExtensions = {
    _isReactive: true,
    toString: function () { return this.fnc.toString() },
    get: function() { return this.memo === $R.empty ? this.run() : this.memo },
    run: function() {
      var unboundArgs = Array.prototype.slice.call(arguments);
      return this.memo = this.fnc.apply(this.context, this.argumentList(unboundArgs));
    },
    bindTo: function() {
      var newDependencies = Array.prototype.slice.call(arguments).map(wrap);
      var oldDependencies = this.dependencies;

      oldDependencies.forEach(function (d) {
        if (d !== $R._) { d.removeDependent(this) }
      }, this);

      newDependencies.forEach(function (d) {
        if (d !== $R._) { d.addDependent(this) }
      }, this);

      this.dependencies = newDependencies;
      return this;
    },
    removeDependent: function(rFnc) {
      this.dependents = this.dependents.filter(function (d) { return d !== rFnc });
    },
    addDependent: function(rFnc) {
      if (!this.dependents.some(function (d) { return d === rFnc })) {
        this.dependents.push(rFnc);
      }
    },
    argumentList: function(unboundArgs) {
      return this.dependencies.map(function(dependency) {
        if (dependency === $R._) {
          return unboundArgs.shift();
        } else if (dependency._isReactive) {
          return dependency.get();
        } else {
          return undefined;
        }
      }).concat(unboundArgs);
    }
  }

  if (typeof module !== 'undefined') {
    module.exports = $R;
  } else {
    defaultContext.$R = $R;
  }

  //Private
  function topo(rootFnc) {
    var explored = {};
    function search(rFnc) {
      if (explored[rFnc.id]) { return [] }
      explored[rFnc.id] = true;
      return rFnc.dependents.reduce(function (acc, dep) { return acc.concat(search(dep))},[]).concat(rFnc);
    }

    return search(rootFnc).reverse();
  }

  function wrap(v) {
    return v && (v._isReactive || v == $R._) ? v : $R(function () {return v});
  }
})();

},{}],4:[function(require,module,exports){
var postSuccess, ckSubmitForm, submitForm, setInlineEditor, focus, render, togglePost, editPost, loadCssCache, loadCss, lazyLoad, lazyLoadDeserialize, lazyLoadNestedSortable, lazyLoadHtml5Uploader, lazyLoadJcrop, lazyLoadEditor, lazyLoadFancybox, lazyLoadSocketio, fancyboxParams, respondResize, setWide, alignBreadcrumb, removeEditingUrl, mutate, timers, showTooltip, switchAndFocus, setOnlineUser, setProfile, out$ = typeof exports != 'undefined' && exports || this, this$ = this;
out$.postSuccess = postSuccess = function(ev, data){
  var f, p, t, ref$, meta;
  f = $(ev.target).closest('.post-edit');
  p = f.closest('.editing');
  t = $(f.find('.tooltip'));
  if (!data.success) {
    showTooltip(t, data != null ? (ref$ = data.errors) != null ? ref$.join('<br>') : void 8 : void 8);
  } else {
    p.find('.title').html((ref$ = data[0]) != null ? ref$.title : void 8);
    p.find('.body').html((ref$ = data[0]) != null ? ref$.body : void 8);
    f.removeClass('fadein').hide(300);
    meta = furl.parse(window.location.pathname);
    window.lastStatechangeWasUser = false;
    switch (meta.type) {
    case 'new-thread':
      History.replaceState({}, '', data.uri);
      break;
    case 'edit':
      removeEditingUrl(meta);
    }
  }
  return false;
};
out$.ckSubmitForm = ckSubmitForm = function(e){
  var editor, ref$, ev, $p;
  editor = e != null ? (ref$ = e.element) != null ? ref$.$ : void 8 : void 8;
  ev = {
    target: editor
  };
  if (!(editor != null && editor.id)) {
    $p = $(editor).closest('.post');
    return $.ajax({
      url: '/resources/posts/' + $p.data('post-id'),
      type: 'put',
      data: {
        id: $p.data('post-id'),
        forum_id: $p.data('forum-id'),
        parent_id: $p.data('thread-id'),
        body: e.getData()
      },
      success: function(data){
        e.fire('blur');
        return $p.find('[contentEditable=true]').blur();
      }
    });
  } else {
    return submitForm(ev, function(data){
      postSuccess(ev, data);
      $('footer').removeClass('expanded');
      return $('#post_new .fadein').remove();
    });
  }
};
out$.submitForm = submitForm = function(ev, fn){
  var $f, $s, body, e, ref$, input;
  $f = $(ev.target).closest('form');
  $s = $($f.find('[type=submit]:first'));
  if ($s) {
    $s.attr('disabled', 'disabled');
  }
  body = $f.find('textarea.body');
  e = typeof CKEDITOR != 'undefined' && CKEDITOR !== null ? (ref$ = CKEDITOR.instances) != null ? ref$[body.attr('id')] : void 8 : void 8;
  if (e) {
    input = e.getData();
    if (input != null && input.length) {
      body.val(input);
      e.setData('');
    }
  }
  $.ajax({
    url: $f.attr('action'),
    type: $f.attr('method'),
    data: $f.serialize(),
    dataType: 'json',
    success: function(data){
      $s.removeAttr('disabled');
      if ($('footer').hasClass('expanded')) {
        $('.onclick-footer-toggle:first').click();
      }
      if (fn) {
        return fn.call($f, data);
      }
    },
    error: function(data){
      $s.removeAttr('disabled');
      return showTooltip($($f.find('.tooltip')), data != null ? data.msg : void 8) || 'Try again!';
    }
  });
  return false;
};
out$.setInlineEditor = setInlineEditor = function(userId){
  $(".post[data-user-id=" + userId + "] .post-content").attr('contentEditable', true);
  return lazyLoadEditor(function(){
    var i$, ref$, len$, e;
    for (i$ = 0, len$ = (ref$ = CKEDITOR.instances).length; i$ < len$; ++i$) {
      e = ref$[i$];
      e.destroy(true);
    }
    try {
      return CKEDITOR.inlineAll();
    } catch (e$) {}
  });
};
focus = function($e){
  return setTimeout(function(){
    return $e.find('input[type="text"]').focus();
  }, 10);
};
render = function(sel, locals, cb){
  var $e;
  cb == null && (cb = function(){});
  $e = $(sel);
  return renderAndAppend(window, sel, 'post-edit', {
    user: user,
    post: locals
  }, function($e){
    cb();
    return focus($e);
  });
};
out$.togglePost = togglePost = function(ev){
  var data, e;
  if (!$(ev != null ? ev.target : void 8).hasClass('onclick-footer-toggle')) {
    return;
  }
  if (!user) {
    Auth.showLoginDialog();
    return;
  }
  data = {
    action: '/resources/posts',
    method: 'post'
  };
  e = $('footer');
  if (e.hasClass('expanded')) {
    e.removeClass('expanded');
    return $('#post_new .fadein').remove();
  } else {
    e.addClass('expanded');
    return render('#post_new', data, function(){
      return lazyLoadEditor(function(){
        if (!CKEDITOR.instances.post_new) {
          CKEDITOR.replace($('#post_new textarea')[0]);
        }
        e.find('form.post-new input[name="forum_id"]').val(window.activeForumId);
        return e.find('form.post-new input[name="parent_id"]').val(window.activeThreadId);
      });
    });
  }
};
out$.editPost = editPost = function(id, data){
  var sel, e;
  data == null && (data = {});
  if (id === true) {
    scrollToTop();
    data.action = '/resources/posts';
    data.method = 'post';
    return render('.forum', data, function(){
      return lazyLoadEditor(function(){
        return CKEDITOR.replace($('#editor')[0]);
      });
    });
  } else {
    sel = "#post_" + id;
    e = $(sel);
    if (!e.find("#post_edit_" + id + ":visible").length) {
      return $.get("/resources/posts/" + id, function(p){
        render(sel, p);
        return e.addClass('editing');
      });
    } else {
      return focus(e);
    }
  }
};
loadCssCache = {};
loadCss = function(href){
  if (loadCssCache[href]) {
    return;
  }
  $('head').append($('<link rel="stylesheet" type="text/css">').attr('href', href));
  return loadCssCache[href] = true;
};
out$.lazyLoad = lazyLoad = function(test, script, css, cb){
  var b;
  b = $('body');
  b.addClass('waiting');
  if (!test()) {
    if (css) {
      loadCss(css);
    }
    return headjs(script, function(){
      b.removeClass('waiting');
      return cb();
    });
  } else {
    b.removeClass('waiting');
    return cb();
  }
};
out$.lazyLoadDeserialize = lazyLoadDeserialize = function(cb){
  return lazyLoad(function(){
    var ref$;
    return (ref$ = window.$().deserialize) != null ? ref$.length : void 8;
  }, cacheUrl + "/local/jquery.deserialize.min.js", null, cb);
};
out$.lazyLoadNestedSortable = lazyLoadNestedSortable = function(cb){
  return lazyLoad(function(){
    var ref$;
    return (ref$ = window.$().nestedSortable) != null ? ref$.length : void 8;
  }, cacheUrl + "/local/jquery.mjs.nestedSortable.js", null, cb);
};
out$.lazyLoadHtml5Uploader = lazyLoadHtml5Uploader = function(cb){
  return lazyLoad(function(){
    var ref$;
    return (ref$ = window.$().html5Uploader) != null ? ref$.length : void 8;
  }, cacheUrl + "/local/jquery.html5uploader.js", cacheUrl + "/local/editor/skins/moono/editor.css", cb);
};
out$.lazyLoadJcrop = lazyLoadJcrop = function(cb){
  return lazyLoad(function(){
    var ref$;
    return (ref$ = window.$().Jcrop) != null ? ref$.length : void 8;
  }, cacheUrl + "/jcrop/js/jquery.Jcrop.min.js", cacheUrl + "/jcrop/css/jquery.Jcrop.min.css", cb);
};
out$.lazyLoadEditor = lazyLoadEditor = function(cb){
  return lazyLoad(function(){
    return typeof CKEDITOR != 'undefined' && CKEDITOR !== null ? CKEDITOR.version : void 8;
  }, cacheUrl + "/local/editor/ckeditor.js", null, cb);
};
out$.lazyLoadFancybox = lazyLoadFancybox = function(cb){
  return lazyLoad(function(){
    var ref$;
    return (ref$ = window.$().fancybox) != null ? ref$.length : void 8;
  }, cacheUrl + "/fancybox/jquery.fancybox.pack.js", cacheUrl + "/fancybox/jquery.fancybox.css", cb);
};
out$.lazyLoadSocketio = lazyLoadSocketio = function(cb){
  return lazyLoad(function(){
    return window.io;
  }, "/socket.io/socket.io.js", null, cb);
};
out$.fancyboxParams = fancyboxParams = {
  closeEffect: 'elastic',
  closeSpeed: 200,
  closeEasing: 'easeOutExpo',
  openEffect: 'fade',
  openSpeed: 450
};
out$.respondResize = respondResize = function(){
  var w;
  w = $(window);
  if (window.mutator !== 'admin') {
    if (w.width() <= 800) {
      return $('body').addClass('collapsed');
    }
  }
};
out$.setWide = setWide = function(){
  var l;
  l = $('#left_content');
  return l.toggleClass('wide', l.width() > 300);
};
out$.alignBreadcrumb = alignBreadcrumb = function(){
  var b, m, l, pos;
  b = $('#breadcrumb');
  m = $('#main_content');
  l = $('#left_content');
  pos = (m.width() - b.width()) / 2;
  return b.transition({
    left: pos < l.width() ? l.width() : pos
  }, 300, 'easeOutExpo');
};
out$.removeEditingUrl = removeEditingUrl = function(meta){
  return History.replaceState({
    noSurf: true
  }, '', meta.threadUri);
};
out$.mutate = mutate = function(){
  var $e, href, params;
  $e = $(this);
  if ($e.hasClass('require-login') && !user) {
    return;
  }
  href = $e.attr('href');
  if (!href) {
    return false;
  }
  if (href != null && href.match(/#/)) {
    return true;
  }
  params = {};
  if ($e.hasClass('no-surf')) {
    params.noSurf = true;
  }
  params.surfData = $e.data('surf') || window.surfData || void 8;
  window.lastStatechangeWasUser = false;
  History.pushState(params, '', href);
  return false;
};
timers = {};
out$.showTooltip = showTooltip = function($tooltip, msg, duration){
  var timer;
  duration == null && (duration = 4000);
  if (!(msg != null && msg.length)) {
    return;
  }
  timer = timers[msg];
  if (timer) {
    clearTimeout(timer);
  }
  $tooltip.html(msg).addClass('hover');
  return timers[msg] = setTimeout(function(){
    timers[msg] = void 8;
    return $tooltip.removeClass('hover');
  }, duration);
};
out$.switchAndFocus = switchAndFocus = function(remove, add, focusOn){
  var $e;
  $e = $('.fancybox-wrap');
  $e.removeClass(remove + " shake slide").addClass(add);
  return setTimeout(function(){
    $e.addClass('slide');
    return setTimeout(function(){
      return $(focusOn).focus();
    }, 250);
  }, 50);
};
out$.setOnlineUser = setOnlineUser = function(id){
  var x$;
  x$ = $("[data-user-id=" + id + "] .profile.photo");
  x$.addClass('online');
  x$.attr('title', 'Online!');
  return x$;
};
out$.setProfile = setProfile = function(src){
  var x$, y$;
  x$ = $('.photo');
  x$.attr('href', "/user/" + user.name);
  x$.addClass('online');
  y$ = $('#profile');
  y$.on('load', function(){
    return $('.profile').show();
  });
  y$.attr('src', window.cacheUrl + src);
  return y$;
};
},{}],12:[function(require,module,exports){

},{}],13:[function(require,module,exports){
// shim for using process in browser

var process = module.exports = {};

process.nextTick = (function () {
    var canSetImmediate = typeof window !== 'undefined'
    && window.setImmediate;
    var canPost = typeof window !== 'undefined'
    && window.postMessage && window.addEventListener
    ;

    if (canSetImmediate) {
        return function (f) { return window.setImmediate(f) };
    }

    if (canPost) {
        var queue = [];
        window.addEventListener('message', function (ev) {
            if (ev.source === window && ev.data === 'process-tick') {
                ev.stopPropagation();
                if (queue.length > 0) {
                    var fn = queue.shift();
                    fn();
                }
            }
        }, true);

        return function nextTick(fn) {
            queue.push(fn);
            window.postMessage('process-tick', '*');
        };
    }

    return function nextTick(fn) {
        setTimeout(fn, 0);
    };
})();

process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];

process.binding = function (name) {
    throw new Error('process.binding is not supported');
}

// TODO(shtylman)
process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};

},{}],5:[function(require,module,exports){
(function(process,global){var AdminUpgrade, AdminMenu, Paginator, PhotoCropper, layoutStatic, layoutOnPersonalize, pagerInit, homepage, forum, sameProfile, profile, admin, joinSearch, resetPaginator, endSearch, mkSearchPnumToHref, mkPostPnumToHref, search, page, privateSite, slice$ = [].slice, out$ = typeof exports != 'undefined' && exports || this;
global.furl = require('./forum-urls.ls');
import$(global, require('./shared-helpers.ls'));
AdminUpgrade = require('../component/AdminUpgrade.ls');
AdminMenu = require('../component/AdminMenu.ls');
Paginator = require('../component/Paginator.ls');
PhotoCropper = require('../component/PhotoCropper.ls');
function bench(subjectName, subjectBody){
  var bef, aft;
  if (process.env.NODE_ENV === 'production') {
    subjectBody();
  } else {
    bef = new Date;
    subjectBody();
    aft = new Date;
    partialize$.apply(this, [setTimeout, [void 8, 1], [0]])(function(){
      var dur;
      dur = aft - bef;
      return console.log("benchmarked '" + subjectName + "': took " + dur + "ms");
    });
  }
}
function renderComponent(win, target, name, klass, firstKlassArg){
  var wc, c, locals;
  wc = win.component || (win.component = {});
  if (c = wc[name]) {
    if (locals = firstKlassArg != null ? firstKlassArg.locals : void 8) {
      c.locals(locals);
    }
    c.reload();
  } else {
    c = wc[name] = new klass(firstKlassArg);
  }
  win.$(target).html('').append(c.$);
}
function paginatorComponent(w, locals, pnumToHref){
  var wc;
  wc = w.component || (w.component = {});
  if (wc.paginator) {
    wc.paginator.locals(locals);
    wc.paginator.pnumToHref(pnumToHref);
    wc.paginator.reload();
  } else {
    wc.paginator = new Paginator({
      locals: locals,
      pnumToHref: pnumToHref
    }, w.$('#pb_paginator'));
  }
}
function parseUrl(url){
  var a, p;
  if (typeof document != 'undefined' && document !== null) {
    a = document.createElement('a');
    a.href = url;
    return {
      search: a.search,
      pathname: a.pathname
    };
  } else {
    p = require('url').parse(url);
    return {
      search: p.search,
      pathname: p.pathname
    };
  }
}
function defaultPnumToHrefFun(uri){
  return function(pg){
    var parsed;
    parsed = parseUrl(uri);
    if (pg > 1) {
      return parsed.pathname + ("?page=" + pg);
    } else {
      return parsed.pathname;
    }
  };
}
layoutStatic = function(w, nextMutant, activeForumId){
  var forumClass, fid, p;
  activeForumId == null && (activeForumId = -1);
  forumClass = w.activeForumId ? " forum-" + w.activeForumId : '';
  w.$('html').attr('class', nextMutant + "" + forumClass);
  w.marshal('mutator', nextMutant);
  fid = activeForumId || w.activeForumId;
  w.$('header .menu').find('.active').removeClass('active');
  w.$("menu .row .forum-" + fid).addClass('active');
  p = w.$("menu .submenu .forum-" + fid);
  if (p.length) {
    p.parent().addClass('active');
    return w.$(last(p.parents('li'))).find('.title').addClass('active');
  }
};
layoutOnPersonalize = function(w, u){
  if (u) {
    setOnlineUser(u.id);
    setProfile(u.photo);
    switch (window.location.hash) {
    case '#choose':
      if (isEmail(typeof user != 'undefined' && user !== null ? user.name : void 8)) {
        Auth.showLoginDialog();
        return switchAndFocus('on-login', 'on-choose', '#auth input[name=username]');
      }
    }
  }
};
pagerInit = function(w){
  var pagerOpts;
  pagerOpts = {
    current: parseInt(w.page),
    last: parseInt(w.pagesCount),
    forumId: parseInt(w.activeForumId)
  };
  if (w.pager) {
    import$(w.pager, pagerOpts);
    w.pager.init();
  } else {
    w.pager = new w.Pager('#paginator', pagerOpts);
  }
  if (w.page) {
    return w.pager.setPage(w.page, false);
  }
};
out$.homepage = homepage = {
  'static': function(window, next){
    window.renderMutant('main_content', 'homepage');
    layoutStatic.call(this, window, 'homepage');
    return next();
  },
  onPersonalize: function(w, u, next){
    layoutOnPersonalize(w, u);
    return next();
  },
  onLoad: function(window, next){
    var active, ref$;
    try {
      window.$('.forum .container').masonry({
        itemSelector: '.post',
        isAnimated: true,
        animationOptions: {
          duration: 200
        },
        isFitWidth: true,
        isResizable: true
      });
    } catch (e$) {}
    active = ((ref$ = window.location.search.match(/order=(\w+)/)) != null ? ref$[1] : void 8) || 'recent';
    window.jade.render($('.extra:first')[0], 'order-control', {
      active: active
    });
    setTimeout(function(){
      var reorder;
      $('.forum').waypoint({
        offset: '25%',
        handler: function(direction){
          var e, eid, id, cur;
          e = $(this);
          eid = e.attr('id');
          id = direction === 'down'
            ? eid
            : $("#" + eid).prevAll('.forum:first').attr('id');
          if (!id) {
            return;
          }
          $('header .menu').find('.active').removeClass('active');
          cur = $('header .menu').find("." + id.replace(/_/, '-')).addClass('active');
          $('.forum .stuck').removeClass('stuck');
          return flipBackground(window, cur, direction);
        }
      });
      reorder = __.debounce(function(it){
        return History.pushState({}, '', it);
      }, 100);
      window.currentOrder = false;
      return $('#order li').waypoint({
        context: 'ul',
        offset: 30,
        handler: function(direction){
          var e, order, path;
          e = $(this);
          if (direction === 'up') {
            e = e.prev();
          }
          if (!e.length) {
            e = $(this);
          }
          $('#order li.active').removeClass('active');
          e.addClass('active');
          order = e.data('value');
          path = "/?order=" + order;
          if (window.currentOrder) {
            return reorder(path);
          } else {
            return window.currentOrder = order;
          }
        }
      });
    }, 100);
    return next();
  },
  onUnload: function(window, nextMutant, next){
    try {
      window.$('.forum .container').masonry('destroy');
      window.$('.forum .header').waypoint('destroy');
      window.$('.forum').waypoint('destroy');
      window.$('#order li').waypoint('destroy');
      window.$('.bg').remove();
      window.$($('.extra:first')).html('');
    } catch (e$) {}
    return next();
  }
};
function renderThreadPaginatorComponent(win, qty, step){
  var onPage, locals;
  onPage = function(page){
    return $.get("/resources/threads/" + window.activeForumId, {
      page: page
    }, function(topThreads, status){
      var container;
      container = win.$('#left_container .scrollable');
      return container.html(win.jade.templates.__threads({
        topThreads: topThreads
      }));
    });
  };
  locals = {
    qty: qty,
    step: step,
    activePage: 1
  };
  renderComponent(win, '#thread-paginator', 'threadPaginator', Paginator, {
    locals: locals,
    onPage: onPage
  });
}
out$.forum = forum = {
  'static': function(window, next){
    var prevMutant, this$ = this;
    prevMutant = window.mutator;
    window.renderMutant('main_content', isEditing(this.furl.path) === true
      ? 'post-new'
      : isForumHomepage(this.furl.path) ? 'homepage' : 'posts');
    if (this.topThreads) {
      window.renderMutant('left_container', 'nav');
      renderThreadPaginatorComponent(window, this.tQty, this.tStep);
      window.marshal('tQty', this.tQty);
      window.marshal('tStep', this.tStep);
    }
    window.marshal('activeForumId', this.activeForumId);
    window.marshal('activeThreadId', this.activeThreadId);
    window.marshal('page', this.page);
    window.marshal('pagesCount', this.pagesCount);
    window.marshal('prevPages', this.prevPages);
    (function(){
      var wc, locals, pnumToHref;
      if (!this$.post) {
        return;
      }
      wc = window.component || (window.component = {});
      locals = {
        step: this$.limit,
        qty: this$.qty,
        activePage: this$.page
      };
      pnumToHref = mkPostPnumToHref(this$.post.uri);
      return paginatorComponent(window, locals, pnumToHref);
    })();
    layoutStatic.call(this, window, 'forum', this.activeForumId);
    return next();
  },
  onLoad: function(window, next){
    var cur, $, $l, id, postId;
    cur = window.$("header .menu .forum-" + window.activeForumId);
    flipBackground(window, cur);
    $ = window.$;
    alignBreadcrumb();
    $l = $('#left_container');
    $l.find('.active').removeClass('active');
    $l.find(".thread[data-id='" + window.activeThreadId + "']").addClass('active');
    id = isEditing(window.location.pathname);
    if (id) {
      editPost(id, {
        forum_id: window.activeForumId
      });
    }
    $('body').on('click', togglePost);
    postId = $('#main_content .post:first').data('post-id');
    if (postId) {
      $.post("/resources/posts/" + postId + "/impression");
    }
    pagerInit(window);
    if (user) {
      setTimeout(function(){
        return $('.onclick-append-reply-ui:first').click();
      }, 300);
    }
    window.surfData = window.activeForumId;
    return next();
  },
  onInitial: function(window, next){
    setTimeout(function(){
      var threads, offset, cur, dst, ref$;
      threads = $('#left_container .threads');
      offset = -125;
      cur = threads.scrollTop();
      dst = Math.round((ref$ = $('#left_container .threads > .active').position()) != null ? ref$.top : void 8);
      if (dst) {
        return threads.animate({
          scrollTop: cur + dst + offset
        }, 500, 'easeOutExpo');
      }
    }, 500);
    renderThreadPaginatorComponent(window, window.tQty, window.tStep);
    return next();
  },
  onMutate: function(window, next){
    var ref$;
    scrollToTop();
    setWide();
    if ((ref$ = window.socket) != null) {
      ref$.emit('online-now');
    }
    return next();
  },
  onPersonalize: function(w, u, next){
    var ref$;
    if (u) {
      layoutOnPersonalize(w, u);
      $(".post[data-user-id=" + u.id + "] .censor").css('display', 'inline');
      if ((ref$ = u.rights) != null && ref$['super']) {
        $('.censor').css('display', 'inline');
      }
      setInlineEditor(u.id);
    }
    return next();
  },
  onUnload: function(win, nextMutant, next){
    $('body').off('click');
    try {
      win.$('#left_container').resizable('destroy');
    } catch (e$) {}
    if (nextMutant !== 'forum') {
      resetPaginator(win);
    }
    return next();
  }
};
sameProfile = function(hints){
  var ref$, l, c, p1, p2;
  ref$ = [hints.last, hints.current], l = ref$[0], c = ref$[1];
  if (l.mutator === null) {
    return false;
  }
  ref$ = [l.pathname.split('/'), c.pathname.split('/')], p1 = ref$[0], p2 = ref$[1];
  if (p1[1] === 'user' && p2[1] === 'user') {
    if (p1[2] === p2[2]) {
      return p1[2];
    }
  }
  return false;
};
out$.profile = profile = {
  'static': function(window, next){
    var this$ = this;
    if (window.hints) {
      if (!sameProfile(window.hints)) {
        window.renderMutant('left_container', 'profile');
      }
    } else {
      window.renderMutant('left_container', 'profile');
    }
    window.renderMutant('main_content', 'posts-by-user');
    window.marshal('step', this.step);
    window.marshal('qty', this.qty);
    window.marshal('page', this.page);
    window.marshal('pagesCount', this.pagesCount);
    (function(){
      var locals, pnumToHref;
      locals = {
        step: this$.limit,
        qty: this$.qty,
        activePage: this$.page
      };
      pnumToHref = mkPostPnumToHref("/user/" + this$.profile.name);
      window.marshal('uri', this$.uri);
      return paginatorComponent(window, locals, pnumToHref);
    })();
    layoutStatic.call(this, window, 'profile');
    return next();
  },
  onLoad: function(window, next){
    pagerInit(window);
    return next();
  },
  onMutate: function(window, next){
    scrollToTop();
    return next();
  },
  onPersonalize: function(w, u, next){
    return lazyLoadHtml5Uploader(function(){
      var photocropperStart, photocropperEnable, photocropperDisable, profileUserId;
      photocropperStart = function(ev){
        return PhotoCropper.start();
      };
      photocropperEnable = function(){
        var options;
        window.$('#left_content').addClass('editable');
        window.$('body').on('click', '#left_content.editable .avatar', photocropperStart);
        options = {
          name: 'avatar',
          postUrl: "/resources/users/" + window.user.id + "/avatar",
          onSuccess: function(r){
            return PhotoCropper.start({
              mode: 'crop'
            });
          }
        };
        return window.$('#left_content .avatar').html5Uploader(options);
      };
      photocropperDisable = function(){
        window.$('#left_content').removeClass('editable');
        return window.$('body').off('click', '#left_content.editable .avatar', photocropperStart);
      };
      if (u) {
        layoutOnPersonalize(w, u);
        profileUserId = window.$('#left_content .profile').data('userId');
        if (profileUserId === u.id) {
          photocropperEnable();
        } else {
          photocropperDisable();
        }
      } else {
        photocropperDisable();
      }
      return next();
    });
  },
  onUnload: function(window, nextMutant, next){
    if (nextMutant !== 'forum') {
      resetPaginator(window);
    }
    return next();
  },
  onInitial: function(window, next){
    var this$ = this;
    (function(){
      var locals, name, pnumToHref;
      locals = {
        step: window.step,
        qty: window.qty,
        activePage: window.page
      };
      name = window.location.pathname.split('/')[2];
      pnumToHref = mkPostPnumToHref("/user/" + name);
      return paginatorComponent(window, locals, pnumToHref);
    })();
    return next();
  }
};
function renderAdminComponents(action, site, win){
  switch (action) {
  case 'domains':
    try {
      win.renderMutant('main_content', 'admin-domains');
    } catch (e$) {}
    break;
  case 'invites':
    try {
      win.renderMutant('main_content', 'admin-invites');
    } catch (e$) {}
    break;
  case 'menu':
    renderComponent(win, '#main_content', 'admin-menu', AdminMenu, {
      locals: {
        site: site
      }
    });
    break;
  case 'upgrade':
    renderComponent(win, '#main_content', 'admin-upgrade', AdminUpgrade, {
      locals: {
        subscriptions: site.subscriptions
      }
    });
    break;
  default:
    try {
      win.renderMutant('main_content', 'admin-general');
    } catch (e$) {}
  }
}
out$.admin = admin = {
  'static': function(window, next){
    window.renderMutant('left_container', 'admin-nav');
    window.$('#left_container menu li').removeClass('active');
    window.$("#left_container menu ." + (this.action || 'general')).addClass('active');
    renderAdminComponents(this.action, this.site, window);
    window.marshal('action', this.action);
    window.marshal('site', this.site);
    layoutStatic.call(this, window, 'admin');
    return next();
  },
  onPersonalize: function(w, u, next){
    layoutOnPersonalize(w, u);
    return next();
  },
  onUnload: function(window, nextMutant, next){
    if (window.adminExpanded) {
      $('body').addClass('collapsed');
    }
    return next();
  },
  onLoad: function(window, next){
    var $b, this$ = this;
    $b = $('body');
    if (window.adminExpanded = $b.hasClass('collapsed')) {
      $b.removeClass('collapsed');
    }
    $('form input:first').focus().select();
    $('.domain').trigger('change');
    window.pagesCount = 0;
    pagerInit(window);
    return lazyLoadNestedSortable(function(){
      return lazyLoadDeserialize(function(){
        return next();
      });
    });
  },
  onInitial: function(win, next){
    renderAdminComponents(win.action, win.site, win);
    return next();
  },
  onMutate: function(window, next){
    scrollToTop();
    return next();
  }
};
joinSearch = function(sock){
  return sock.emit('search', window.searchopts);
};
resetPaginator = function(w){
  var ref$, x$;
  $('#pb_paginator').hide();
  if ((ref$ = w.component) != null && ref$.paginator) {
    x$ = w.component.paginator;
    x$.local('qty', 0);
    x$.reload();
    return x$;
  }
};
endSearch = function(w){
  resetPaginator(w);
  return socket.emit('search-end');
};
mkSearchPnumToHref = function(searchopts){
  return function(pnum){
    var query, rval, ref$, k, v;
    query = pnum === void 8 || parseInt(pnum) === 1
      ? (rval = import$({}, searchopts), delete rval.page, rval)
      : (ref$ = import$({}, searchopts), ref$.page = pnum, ref$);
    if (Object.keys(query).length) {
      return '/search?' + (function(){
        var ref$, results$ = [];
        for (k in ref$ = query) {
          v = ref$[k];
          results$.push(k + "=" + v);
        }
        return results$;
      }()).join('&');
    } else {
      return '/search';
    }
  };
};
mkPostPnumToHref = function(postUri){
  return function(pnum){
    if (pnum > 1) {
      return postUri + "/page/" + pnum;
    } else {
      return postUri;
    }
  };
};
out$.search = search = {
  'static': {
    prepare: function(window, next){
      var params, after, ref$, ref1$, $q, qEl, q;
      params = this;
      after = window.afterPrepare = [];
      window.marshal('page', this.page);
      window.marshal('pagesCount', this.pagesCount);
      window.marshal('searchopts', this.searchopts);
      window.marshal('newHits', 0);
      if (((ref$ = window.hints) != null ? (ref1$ = ref$.last) != null ? ref1$.mutator : void 8 : void 8) !== 'search') {
        (function(){
          var filtersHtml, $t;
          window.replaceHtml(window.$('#left_container'), '<div id="search_filters"></div><div id="search_facets"></div>');
          filtersHtml = window.render('search-filters');
          $t = window.$('#search_filters');
          return after.push(function(){
            return bench('search-filters', function(){
              return window.replaceHtml($t, filtersHtml);
            });
          });
        })();
      }
      (function(){
        var html, $t;
        html = window.render('search-facets');
        $t = window.$('#search_facets');
        return after.push(function(){
          return bench('search-facets', function(){
            return window.replaceHtml($t, html);
          });
        });
      })();
      (function(){
        var html, $t;
        html = window.render('search');
        $t = window.$('#main_content');
        return after.push(function(){
          return bench('search-content', function(){
            return window.replaceHtml($t, html);
          });
        });
      })();
      $q = window.$('#query');
      qEl = $q[0];
      q = this.searchopts.q;
      if (typeof History != 'undefined' && History !== null) {
        if (this.statechangeWasUser) {
          after.push(function(){
            return bench('query-string-update', function(){
              return qEl.value = q;
            });
          });
        }
      } else {
        after.push(function(){
          return bench('query-string-update', function(){
            return $q.val(q);
          });
        });
      }
      if (typeof History != 'undefined' && History !== null) {
        if (document.activeElement === qEl) {
          $q.blur();
          after.push(function(){
            return bench('re-focus', function(){
              return partialize$.apply(this, [setTimeout, [void 8, 1], [0]])(function(){
                return $q.focus();
              });
            });
          });
        }
      }
      return next();
    },
    draw: function(window, next){
      var after, i$, len$, f, this$ = this;
      after = window.afterPrepare;
      for (i$ = 0, len$ = after.length; i$ < len$; ++i$) {
        f = after[i$];
        f();
      }
      bench('filter-state', function(){
        window.$('#search_filters [name=forum_id]').val(this$.searchopts.forum_id);
        return window.$('#search_filters [name=within]').val(this$.searchopts.within);
      });
      (function(){
        var wc, locals, pnumToHref;
        wc = window.component || (window.component = {});
        locals = {
          step: 10,
          qty: this$.elres.total,
          activePage: this$.page
        };
        pnumToHref = mkSearchPnumToHref(this$.searchopts);
        return paginatorComponent(window, locals, pnumToHref);
      })();
      bench('layout-static', function(){
        return layoutStatic.call(this$, window, 'search');
      });
      return next();
    }
  },
  onInitial: function(w, next){
    $R(joinSearch).bindTo(w.rSocket);
    return next();
  },
  onMutate: function(w, next){
    joinSearch(w.socket);
    return next();
  },
  onLoad: function(w, next){
    window.$newHits = w.$('<div/>');
    alignBreadcrumb();
    pagerInit(w);
    return next();
  },
  onUnload: function(w, nextMutant, next){
    endSearch(w);
    delete w.searchopts;
    return next();
  }
};
out$.page = page = {
  'static': function(window, next){
    window.replaceHtml(window.$('#left_container'), '');
    window.replaceHtml(window.$('#main_content'), this.page.config.main_content);
    layoutStatic.call(this, window, 'page');
    return next();
  },
  onLoad: function(window, next){
    pagerInit(window);
    return next();
  },
  onMutate: function(window, next){
    scrollToTop();
    return next();
  }
};
out$.privateSite = privateSite = {
  'static': function(window, next){
    window.$('header').remove();
    window.$('footer').remove();
    window.$('#left_content').remove();
    window.$('#main_content').remove();
    return next();
  },
  onLoad: function(window, next){
    var ref$;
    ref$ = window.fancyboxParams;
    ref$.closeBtn = false;
    ref$.closeClick = false;
    ref$.modal = true;
    Auth.showLoginDialog();
    return next();
  }
};
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
function partialize$(f, args, where){
  var context = this;
  return function(){
    var params = slice$.call(arguments), i,
        len = params.length, wlen = where.length,
        ta = args ? args.concat() : [], tw = where ? where.concat() : [];
    for(i = 0; i < len; ++i) { ta[tw[0]] = params[i]; tw.shift(); }
    return len < wlen && len ?
      partialize$.apply(context, [f, ta, tw]) : f.apply(context, ta);
  };
}
})(require("__browserify_process"),window)
},{"url":12,"./shared-helpers.ls":3,"./forum-urls.ls":14,"../component/AdminMenu.ls":15,"../component/Paginator.ls":16,"../component/AdminUpgrade.ls":17,"../component/PhotoCropper.ls":18,"__browserify_process":13}],6:[function(require,module,exports){
var cheerio, useJsdom, domWindow, isSurfable, slice$ = [].slice;
if (typeof window != 'undefined' && window !== null) {
  true;
} else {
  cheerio = require('cheerio');
  useJsdom = false;
  domWindow = function(html, cb){
    var scripts, jsdom_opts, jsdom_done, this$ = this;
    scripts = ['../../public/local/jquery-1.9.1.min.js', '../../node_modules/reactivejs/src/reactive.js'];
    jsdom_opts = {
      html: html,
      scripts: scripts
    };
    jsdom_done = function(err, window){
      if (err) {
        return cb(err);
      }
      window.$ = window.jQuery;
      return cb(null, window);
    };
    return jsdom.env(jsdom_opts, jsdom_done);
  };
}
this.run = function(template, opts, cb){
  /*
  run returns void because it mutates the window object
  
  on the server side we need to know the base html before we can mutate it
  
  on the client side the callback returns nothing because the dom has been mutated already
  on the server side the callback will return html
  
  templates are objects with up to four methods:
  static, onLoad, onInitial, onMutate
  
  static is client or serverside and this phase is purely for html dom tree creation/manipulation
  
  onLoad happens when a mutant template is run, regardless of whether it is the initial pageload, or a mutation
  
  onInitial only happens on an initial pageload (not on mutation)
  
  onMutate only happens on a mutation (not on an initial pageload)
  */
  var initial_run, params, html, user, ref$, prepare, rawDraw, raf, draw, onLoad, onInitial, onMutate, onPersonalize, renderMutant, render, varStatements, marshal, runStatic, $;
  cb == null && (cb = function(){});
  initial_run = opts.initial;
  params = opts.locals || {};
  html = opts.html;
  user = opts.user;
  if (((ref$ = template['static']) != null && ref$.prepare) && ((ref$ = template['static']) != null && ref$.draw)) {
    prepare = ((ref$ = template['static']) != null ? ref$.prepare : void 8) || function(w, cb){
      return cb();
    };
    rawDraw = ((ref$ = template['static']) != null ? ref$.draw : void 8) || function(w, cb){
      return cb();
    };
  } else {
    prepare = function(w, cb){
      return cb();
    };
    rawDraw = template['static'] || function(w, cb){
      return cb();
    };
  }
  if (raf = typeof window != 'undefined' && window !== null ? window.requestAnimationFrame : void 8) {
    draw = function(w, cb){
      var params;
      params = this;
      return raf(function(){
        var beg;
        beg = new Date;
        return rawDraw.call(params, w, function(){
          var end;
          end = new Date;
          cb();
          return partialize$.apply(this, [setTimeout, [void 8, 1], [0]])(function(){
            var dur, info;
            dur = end - beg;
            if (true) {
              info = "request-animation-frame took " + dur + "ms in mutant static draw phase";
              return console.warn(info);
            }
          });
        });
      });
    };
  } else {
    draw = rawDraw;
  }
  onLoad = template.onLoad || function(w, cb){
    return cb();
  };
  onInitial = template.onInitial || function(w, cb){
    return cb();
  };
  onMutate = template.onMutate || function(w, cb){
    return cb();
  };
  onPersonalize = template.onPersonalize || function(w, u, cb){
    return cb();
  };
  require('../../build/client-jade.js');
  function replaceHtml($el, html){
    var el, newEl;
    if (typeof window != 'undefined' && window !== null) {
      el = $el[0];
      newEl = el.cloneNode(false);
      newEl.innerHTML = html;
      el.parentNode.replaceChild(newEl, el);
    } else {
      $el.html(html);
    }
  }
  renderMutant = function(id, tmpl){
    return replaceHtml($("#" + id), jade.templates[tmpl](params));
  };
  render = function(t){
    return jade.templates[t](params);
  };
  if (typeof window != 'undefined' && window !== null) {
    window.render = render;
    window.replaceHtml = replaceHtml;
    if (initial_run) {
      return onLoad.call(params, window, function(err){
        if (err) {
          return cb(err);
        }
        return onInitial.call(params, window, function(err){
          if (err) {
            return cb(err);
          }
          if (user) {
            return onPersonalize.call(params, window, user, cb);
          } else {
            return cb();
          }
        });
      });
    } else {
      window.renderMutant = function(target, tmpl){
        return jade.render(window.document.getElementById(target), tmpl, params);
      };
      window.marshal = function(key, val){
        return window[key] = val;
      };
      return prepare.call(params, window, function(err){
        var hasDraw, ref$;
        if (err) {
          return cb(err);
        }
        hasDraw = !!((ref$ = template['static']) != null && ref$.draw);
        return (hasDraw ? draw : rawDraw).call(params, window, function(err){
          if (err) {
            return cb(err);
          }
          return onLoad.call(params, window, function(err){
            if (err) {
              return cb(err);
            }
            return onMutate.call(params, window, function(err){
              if (err) {
                return cb(err);
              }
              if (user) {
                return onPersonalize.call(params, window, user, cb);
              } else {
                return cb();
              }
            });
          });
        });
      });
    }
  } else if (html) {
    varStatements = [];
    marshal = function(key, val){
      if (val !== void 8) {
        return varStatements.push("window['" + key + "']=" + JSON.stringify(val));
      }
    };
    runStatic = function(window){
      window.render = render;
      window.replaceHtml = replaceHtml;
      return prepare.call(params, window, function(err){
        if (err) {
          return cb(err);
        }
        return draw.call(params, window, function(err){
          var s;
          if (err) {
            return cb(err);
          }
          if (useJsdom) {
            window.$('script.jsdom').remove();
            s = window.document.createElement('script');
            window.$(s).attr('type', 'text/javascript');
            window.$(s).text(varStatements.join(';'));
            window.document.body.appendChild(s);
          } else {
            $('body').append("<script type=\"text/javascript\">" + varStatements.join(';') + "</script>");
          }
          return cb(null, useJsdom
            ? "<!doctype html>" + window.document.outerHTML
            : $.html());
        });
      });
    };
    if (useJsdom) {
      return domWindow(html, function(err, jsdomWindow){
        if (err) {
          return cb(err);
        }
        jsdomWindow.marshal = marshal;
        jsdomWindow.renderMutant = function(target, tmpl){
          return jade.render(jsdomWindow.document.getElementById(target), tmpl, params);
        };
        return runStatic(jsdomWindow);
      });
    } else {
      $ = cheerio.load(html);
      return runStatic({
        marshal: marshal,
        renderMutant: renderMutant,
        $: $
      });
    }
  } else {
    throw new Error("need html for serverside");
  }
};
isSurfable = function(r){
  return r.callbacks.some(function(m){
    return m.surfable;
  });
};
this.surfableRoutes = function(app){
  var i$, ref$, len$, r, results$ = [];
  for (i$ = 0, len$ = (ref$ = app.routes.get).length; i$ < len$; ++i$) {
    r = ref$[i$];
    if (isSurfable(r)) {
      results$.push(r.regexp.toString());
    }
  }
  return results$;
};
function partialize$(f, args, where){
  var context = this;
  return function(){
    var params = slice$.call(arguments), i,
        len = params.length, wlen = where.length,
        ta = args ? args.concat() : [], tw = where ? where.concat() : [];
    for(i = 0; i < len; ++i) { ta[tw[0]] = params[i]; tw.shift(); }
    return len < wlen && len ?
      partialize$.apply(context, [f, ta, tw]) : f.apply(context, ta);
  };
}
},{"cheerio":12,"../../build/client-jade.js":19}],7:[function(require,module,exports){
var Component, ch, templates, Auth;
Component = require('yacomponent');
ch = require('../app/client-helpers.ls');
templates = require('../build/component-jade.js').templates;
module.exports = Auth = (function(superclass){
  var prototype = extend$((import$(Auth, superclass).displayName = 'Auth', Auth), superclass).prototype, constructor = Auth;
  prototype.componentName = 'Auth';
  prototype.template = templates.Auth;
  Auth.showLoginDialog = function(cb){
    var this$ = this;
    cb == null && (cb = function(){});
    return ch.lazyLoadFancybox(function(){
      return ch.lazyLoad(function(){
        return window.$.fn.complexify;
      }, window.cacheUrl + "/local/jquery.complexify.min.js", null, function(){
        if (!window._auth) {
          window._auth = new Auth({
            locals: {
              siteName: window.siteName,
              inviteOnly: window.inviteOnly
            }
          }, $('#auth'));
          if (Auth.afterLogin) {
            window._auth.afterLogin = Auth.afterLogin;
          }
        }
        if (!$('.fancybox-overlay:visible').length) {
          $.fancybox.open('#auth', window.fancyboxParams);
        }
        setTimeout(function(){
          return $('#auth input[name=username]').focus();
        }, 100);
        window.COMPLEXIFY_BANLIST = ['god', 'money', 'password', 'love'];
        $('#auth [name="password"]').complexify({}, function(pass, percent){
          var e;
          e = $(this).parent();
          e.find('.strength-meter').toggleClass('strong', pass);
          return e.find('.strength').css({
            height: parseInt(percent) + '%'
          });
        });
        return cb(window._auth.$);
      });
    });
  };
  Auth.showInfoDialog = function(msg, msg2, remove, cb){
    msg2 == null && (msg2 = '');
    remove == null && (remove = '');
    cb == null && (cb = function(){});
    return Auth.showLoginDialog(function(){
      var fb;
      fb = $('.fancybox-wrap:first');
      fb.find('#msg').html(msg);
      fb.find('.dialog .msg2').html(msg2);
      ch.switchAndFocus(remove, 'on-dialog', '');
      return cb(window._auth.$);
    });
  };
  Auth.showRegisterDialog = function(remove, cb){
    remove == null && (remove = '');
    cb == null && (cb = function(){});
    return Auth.showLoginDialog(function(){
      ch.switchAndFocus(remove, 'on-register', '.register input:first');
      return cb(window._auth.$);
    });
  };
  Auth.showResetPasswordDialog = function(){
    return Auth.showLoginDialog(function($auth){
      var $form, hash;
      $form = $auth.find('.reset form');
      ch.switchAndFocus('', 'on-reset', '#auth .reset input:first');
      hash = location.hash.split('=')[1];
      $form.find('input[type=hidden]').val(hash);
      console.log(hash, $form, $auth);
      return $.post('/auth/forgot-user', {
        forgot: hash
      }, function(r){
        if (r.success) {
          $form.find('h2:first').html('Choose a New Password');
          return $form.find('input').prop('disabled', false);
        } else {
          return $form.find('h2:first').html("Couldn't find you. :(");
        }
      });
    });
  };
  Auth.loginWithToken = function(){
    return cors.get(authDomain + "/auth/once", {
      site_id: window.siteId
    }, function(r){
      if (r) {
        return $.post('/auth/once', {
          token: r.token
        }, function(rr){
          if (rr.success) {
            Auth.afterLogin();
            return window.location.hash = '';
          }
        });
      }
    });
  };
  Auth.requireLogin = function(fn){
    return function(){
      if (window.user) {
        return fn.apply(window, arguments);
      } else {
        Auth.showLoginDialog();
        return false;
      }
    };
  };
  Auth.requireRegistration = function(fn){
    return function(){
      if (window.user) {
        return fn.apply(window, arguments);
      } else {
        Auth.showRegisterDialog();
        return false;
      }
    };
  };
  function Auth(){
    this.choose = bind$(this, 'choose', prototype);
    this.togglePassword = bind$(this, 'togglePassword', prototype);
    this.resend = bind$(this, 'resend', prototype);
    this.resetPassword = bind$(this, 'resetPassword', prototype);
    this.forgotPassword = bind$(this, 'forgotPassword', prototype);
    this.register = bind$(this, 'register', prototype);
    this.afterLogin = bind$(this, 'afterLogin', prototype);
    this.login = bind$(this, 'login', prototype);
    this.onDetach = bind$(this, 'onDetach', prototype);
    this.onAttach = bind$(this, 'onAttach', prototype);
    Auth.superclass.apply(this, arguments);
  }
  prototype.onAttach = function(){
    this.$.find('.social a').click(this.openOauthWindow);
    this.$.on('submit', '.login form', this.login);
    this.$.on('submit', '.register form', this.register);
    this.$.on('submit', '.forgot form', this.forgotPassword);
    this.$.on('submit', '.reset form', this.resetPassword);
    this.$.on('click', '.toggle-password', this.togglePassword);
    this.$.on('submit', '.choose form', this.choose);
    this.$.on('click', '.dialog a.resend', this.resend);
    this.$.on('click', '.onclick-close-fancybox', function(){
      return $.fancybox.close();
    });
    this.$.on('click', '.onclick-show-login', function(){
      return ch.switchAndFocus('on-forgot on-register on-reset', 'on-login', '#auth input[name=username]');
    });
    this.$.on('click', '.onclick-show-forgot', function(){
      return ch.switchAndFocus('on-error', 'on-forgot', '#auth input[name=email]');
    });
    this.$.on('click', '.onclick-show-choose', function(){
      return ch.switchAndFocus('on-login', 'on-choose', '#auth input[name=username]');
    });
    this.$.on('click', '.onclick-show-register', function(){
      return ch.switchAndFocus('on-login', 'on-register', '#auth input[name=username]');
    });
    this.$.on('keyup', '.fancybox-inner input', function(it){
      if (it.which === 27) {
        $.fancybox.close();
        return false;
      }
    });
  };
  prototype.onDetach = function(){};
  prototype.openOauthWindow = function(ev){
    var url;
    url = $(this).attr('href');
    window.open(url, 'popup', "width=980,height=650,scrollbars=no,toolbar=no,location=no,directories=no,status=no,menubar=no");
    return false;
  };
  prototype.login = function(ev){
    var $form, u, p, s, params, this$ = this;
    $form = $(ev.target);
    u = $form.find('input[name=username]');
    p = $form.find('input[name=password]');
    s = $form.find('input[type=submit]');
    params = {
      username: u.val(),
      password: p.val()
    };
    s.attr('disabled', 'disabled');
    $.post($form.attr('action'), params, function(r){
      var resend, $fancybox;
      if (r.success) {
        $.fancybox.close();
        if (this$.afterLogin) {
          this$.afterLogin();
        }
        if (initialMutant === 'privateSite') {
          window.location.reload();
        }
      } else {
        if (r.type === 'unverified-user') {
          resend = "To resend your verification email, <a class=\"resend\" data-email=\"" + r.email + "\">click here</a>.";
          constructor.showInfoDialog('Please verify your account first.', resend, 'on-login');
        } else {
          $fancybox = $form.parents('.fancybox-wrap:first');
          $fancybox.addClass('on-error');
          $fancybox.removeClass('shake');
          ch.showTooltip($form.find('.tooltip'), 'Try again!');
          setTimeout(function(){
            $fancybox.addClass('shake');
            return u.focus();
          }, 10);
        }
      }
      return s.removeAttr('disabled');
    });
    return false;
  };
  prototype.afterLogin = function(){};
  prototype.register = function(ev){
    var $form, s, this$ = this;
    $form = $(ev.target);
    $form.find('input').removeClass('validation-error');
    s = $form.find('input[type=submit]');
    s.attr('disabled', 'disabled');
    $.post($form.attr('action'), $form.serialize(), function(r){
      var msgs, ref$;
      if (r.success) {
        $form.find("input:text,input:password").removeClass('validation-error').val('');
        ch.switchAndFocus('on-register', 'on-dialog', '');
        Auth.afterLogin();
        Auth.showInfoDialog("Welcome to " + siteName);
      } else {
        msgs = [];
        if ((ref$ = r.errors) != null) {
          ref$.forEach(function(e){
            var $e;
            $e = $form.find("input[name=" + e.param + "]");
            $e.addClass('validation-error').focus();
            return msgs.push(e.msg);
          });
        }
        ch.showTooltip($form.find('.tooltip'), unique(msgs).join('<br>'));
        shakeDialog($form, 100);
      }
      return s.removeAttr('disabled');
    });
    return false;
  };
  prototype.forgotPassword = function(ev){
    var $form, s, this$ = this;
    $form = $(ev.target);
    s = $form.find('input[type=submit]');
    s.attr('disabled', 'disabled');
    $.post($form.attr('action'), $form.serialize(), function(r){
      var msg, ref$, ref1$;
      if (r.success) {
        Auth.showInfoDialog('Check your inbox for reset link!', '', 'on-forgot');
      } else {
        $form.find('input:first').focus();
        msg = ((ref$ = r.errors) != null ? (ref1$ = ref$[0]) != null ? ref1$.name : void 8 : void 8) || ((ref$ = r.errors) != null ? (ref1$ = ref$[0]) != null ? ref1$.msg : void 8 : void 8) || 'Unable to find you';
        ch.showTooltip($form.find('.tooltip'), msg);
        shakeDialog($form, 100);
      }
      return s.removeAttr('disabled');
    });
    return false;
  };
  prototype.resetPassword = function(ev){
    var $form, password, s, this$ = this;
    $form = $(ev.target);
    password = $form.find('input[name=password]').val();
    if (password.match(/^\s*$/)) {
      ch.showTooltip($form.find('.tooltip'), "Password may not be blank");
      return false;
    }
    s = $form.find('input[type=submit]');
    s.attr('disabled', 'disabled');
    $.post($form.attr('action'), $form.serialize(), function(r){
      if (r.success) {
        $form.find('input').prop('disabled', true);
        ch.showTooltip($form.find('.tooltip'), "Password changed!");
        location.hash = '';
        $form.find('input[name=password]').val('');
        setTimeout(function(){
          ch.switchAndFocus('on-reset', 'on-login', '#auth .login input:first');
          return ch.showTooltip($('#auth .login form .tooltip'), "Now log in!");
        }, 1500);
      } else {
        ch.showTooltip($form.find('.tooltip'), "Choose a better password");
      }
      return s.removeAttr('disabled');
    });
    return false;
  };
  prototype.resend = function(ev){
    var email;
    email = $('.dialog a.resend').data('email');
    return $.post('/auth/resend', {
      email: email
    }, function(r){
      if (r.success) {
        return constructor.showInfoDialog('Verification email sent again.', 'Please check your email.  It might be in your spam.');
      } else {
        return constructor.showInfoDialog('There was a problem sending the email', 'Please try again.');
      }
    });
  };
  prototype.togglePassword = function(ev){
    var e, p;
    e = $(ev.target);
    p = e.prev('[name=password]');
    if (p.attr('type') === 'password') {
      e.html('Hide');
      p.attr('type', 'text');
    } else {
      e.html('Show');
      p.attr('type', 'password');
    }
    setTimeout(function(){
      return p.focus();
    }, 10);
    return false;
  };
  prototype.choose = function(ev){
    var $form, s, this$ = this;
    $form = $(ev.target);
    s = $form.find('input[type=submit]');
    s.attr('disabled', 'disabled');
    $.post($form.attr('action'), $form.serialize(), function(r){
      if (r.success) {
        $.fancybox.close();
        this$.afterLogin();
        window.location.hash = '';
      } else {
        $form.find('input:first').focus();
        ch.showTooltip($form.find('.tooltip'), r.msg);
        shakeDialog($form, 100);
      }
      return s.removeAttr('disabled');
    });
    return false;
  };
  return Auth;
}(Component));
function bind$(obj, key, target){
  return function(){ return (target || obj)[key].apply(obj, arguments) };
}
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../build/component-jade.js":20,"../app/client-helpers.ls":4,"yacomponent":21}],3:[function(require,module,exports){
var __, secondsToHumanReadable, dateFields;
__ = require('lodash');
this.addCommas = function(s){
  return Str.reverse(
  join(',')(
  filter(function(it){
    return it.length;
  })(
  split(/(\d{3})/)(
  Str.reverse(
  s.toString())))));
};
this.titleCase = function(s){
  return s != null ? s.replace(/[\w]\S*/g, function(word){
    if (word === word.toUpperCase()) {
      if (word.indexOf('.') > -1 || word.indexOf('-') > -1 || word.length < 6) {
        return word;
      }
    }
    if (word.length > 3) {
      return word[0].toUpperCase() + word.substr(1).toLowerCase();
    }
    return word;
  }) : void 8;
};
this.ellipse = function(s, len, suffix){
  suffix == null && (suffix = '...');
  if ((s != null ? s.length : void 8) > len) {
    s = s.substr(0, len);
    if (s.lastIndexOf(' ') > 0) {
      s = s.substr(0, s.lastIndexOf(' ')) + suffix;
    }
  }
  return s;
};
this.dayName = function(i){
  switch (i) {
  case 0:
    return 'sun';
  case 1:
    return 'mon';
  case 2:
    return 'tue';
  case 3:
    return 'wed';
  case 4:
    return 'thu';
  case 5:
    return 'fri';
  case 6:
    return 'sat';
  }
};
this.prettyDayName = function(i){
  switch (i) {
  case 0:
    return 'Sunday';
  case 1:
    return 'Monday';
  case 2:
    return 'Tuesday';
  case 3:
    return 'Wednesday';
  case 4:
    return 'Thursday';
  case 5:
    return 'Friday';
  case 6:
    return 'Saturday';
  }
};
secondsToHumanReadable = function(secs){
  var hours, minutes, seconds, timestring;
  hours = Math.floor(secs / (60 * 60));
  secs -= hours * (60 * 60);
  minutes = Math.floor(secs / 60);
  secs -= minutes * 60;
  seconds = secs;
  timestring = '';
  if (hours > 1) {
    timestring += hours + ' hours';
  } else if (hours === 1) {
    timestring += '1 hour';
  }
  if (minutes) {
    if (hours) {
      timestring += ', ';
    }
    if (minutes > 1) {
      timestring += minutes + ' minutes';
    } else if (minutes === 1) {
      timestring += '1 minute';
    }
  } else if (!hours) {
    if (secs === 1) {
      timestring = secs + " second";
    } else {
      timestring = secs + " seconds";
    }
  }
  return timestring;
};
this.elapsedToHumanReadable = function(secsAgo){
  var suffix, human, d, weeks, months, years;
  suffix = 'ago';
  human = secsAgo < 30
    ? 'Just now!'
    : secsAgo < 60
      ? "A moment " + suffix
      : secsAgo < 120
        ? "A minute " + suffix
        : secsAgo < 86400
          ? secondsToHumanReadable(secsAgo) + ' ' + suffix
          : secsAgo < 172800
            ? 'Yesterday'
            : secsAgo < 604800
              ? (d = new Date(), d.setTime(d.getTime() - secsAgo * 1000), this.prettyDayName(d.getDay()))
              : secsAgo < 2628000
                ? (weeks = Math.floor(secsAgo / 604800), weeks === 1
                  ? "A week " + suffix
                  : weeks + " weeks " + suffix)
                : secsAgo < 31446925
                  ? (months = Math.floor(secsAgo / 2628000), months === 1
                    ? "A month " + suffix
                    : months + " months " + suffix)
                  : (years = Math.floor(secsAgo / 31446925), years === 1
                    ? "A year " + suffix
                    : years + " years " + suffix);
  return human.replace(/(\d+)/g, '<b>$1</b>');
};
this.djb2Hash = function(str){
  var hash, i$, len$, i, char;
  hash = 5381;
  for (i$ = 0, len$ = str.length; i$ < len$; ++i$) {
    i = str[i$];
    char = str.charCodeAt(i);
    hash = ((hash << 5) + hash) + char;
  }
  return hash;
};
dateFields = ['created', 'updated'];
this.addDates = function(o){
  var now, i$, ref$, len$, df, sub, k, i, v;
  now = Date.now();
  if (!o) {
    return o;
  }
  switch (typeof o) {
  case 'object':
    for (i$ = 0, len$ = (ref$ = dateFields).length; i$ < len$; ++i$) {
      df = ref$[i$];
      if (o[df]) {
        o[df] = new Date(o[df]);
        o[df + "_human"] = this.elapsedToHumanReadable((now - o[df]) / 1000);
        o[df + "_iso"] = o[df].toISOString();
      }
    }
    sub = __.keys(o).filter(function(k){
      return typeof o[k] === 'array' || typeof o[k] === 'object';
    });
    for (i$ = 0, len$ = sub.length; i$ < len$; ++i$) {
      k = sub[i$];
      o[k] = this.addDates(o[k]);
    }
    return o;
  case 'array':
    for (i$ = 0, len$ = o.length; i$ < len$; ++i$) {
      i = i$;
      v = o[i$];
      if (typeof v === 'object') {
        o[i] = this.addDates(o[i]);
      }
    }
    return o;
  default:
    return o;
  }
};
this.renderAnd = curry$(function(fn, w, target, tmpl, params, cb){
  var $t, $b;
  $t = w.$(target);
  $b = w.$('<div>');
  $b.hide();
  $t[fn]($b);
  w.jade.render($b[0], tmpl, params);
  $b.show().addClass('fadein');
  return setTimeout(function(){
    return cb($b);
  }, 100);
});
this.renderAndAppend = this.renderAnd('append');
this.renderAndPrepend = this.renderAnd('prepend');
this.isEmail = function(name){
  return name.indexOf('@') !== -1;
};
this.isForumHomepage = function(path){
  return furl.parse(path).type === 'forum';
};
this.isEditing = function(path){
  var meta;
  meta = furl.parse(path);
  switch (meta.type) {
  case 'new-thread':
    return true;
  case 'edit':
    return meta.id;
  default:
    return false;
  }
};
this.flipBackground = function(w, cur, direction){
  var last, next;
  direction == null && (direction = 'down');
  if (w.bgAnim) {
    clearTimeout(w.bgAnim);
  }
  last = w.$('.bg.active');
  next = w.$('#forum_bg_' + cur.data('id'));
  next.css('display', 'block');
  if (!last.length) {
    return next.addClass('active');
  } else {
    return w.bgAnim = setTimeout(function(){
      last.css('top', direction === 'down' ? -300 : 300);
      last.removeClass('active');
      next.addClass('active');
      return w.bgAnim = 0;
    }, 100);
  }
};
this.rUnbind = function(rf){
  var i$, ref$, len$, d;
  for (i$ = 0, len$ = (ref$ = rf.dependencies).length; i$ < len$; ++i$) {
    d = ref$[i$];
    d.removeDependent();
  }
};
function curry$(f, bound){
  var context,
  _curry = function(args) {
    return f.length > 1 ? function(){
      var params = args ? args.concat() : [];
      context = bound ? context || this : this;
      return params.push.apply(params, arguments) <
          f.length && arguments.length ?
        _curry.call(context, params) : f.apply(context, params);
    } : f;
  };
  return _curry();
}
},{"lodash":22}],10:[function(require,module,exports){
var Component, templates, Buy;
Component = require('yacomponent');
templates = require('../build/component-jade.js').templates;
module.exports = Buy = (function(superclass){
  var prototype = extend$((import$(Buy, superclass).displayName = 'Buy', Buy), superclass).prototype, constructor = Buy;
  prototype.template = templates.Buy;
  prototype.init = function(){
    if (this.local('cardNeeded') === void 8) {
      return this.local('cardNeeded', true);
    }
  };
  prototype.onAttach = function(){
    var this$ = this;
    setTimeout(function(){
      return constructor.$('.Buy-card-number').focus();
    }, 100);
    this.$.on('click', '.Buy-change-card', function(){
      var $fb;
      this$.local('cardNeeded', true);
      this$.detach().render().attach();
      $fb = constructor.$('.fancybox-wrap:first');
      $fb.removeClass('slide');
      setTimeout(function(){
        return $fb.addClass('slide');
      }, 10);
      return false;
    });
    return this.$.on('click', '.Buy-checkout', function(ev){
      var data, product, reEnable;
      $(ev.target).attr('disabled', 'disabled');
      data = {
        number: this$.$.find('.Buy-card-number').val(),
        expmo: this$.$.find('.Buy-card-month').val(),
        expyear: this$.$.find('.Buy-card-year').val(),
        code: this$.$.find('.Buy-card-code').val()
      };
      product = this$.local('product').id;
      reEnable = function(){
        return $(ev.target).attr('disabled', null);
      };
      showTooltip(this$.$.find('.tooltip'), 'Securing a connection');
      constructor.$.post("/ajax/checkout/" + product, data, function(r){
        var ref$, cardNumber, i$, len$, e, $fb;
        if (r.success) {
          site.subscriptions.push(product);
          site.has_stripe = true;
          $("#" + product).focus();
          showTooltip(this$.$.find('.tooltip'), ['Sincere thanks!', "Awesome.  Go ahead!", 'You got it!', 'Thank you!'][parseInt(Math.random() * 5)]);
          return setTimeout(function(){
            reEnable();
            $("." + product + "-available").hide();
            $("." + product + "-purchased").show(500);
            return $.fancybox.close();
          }, 2000);
        } else {
          showTooltip(this$.$.find('.tooltip'), (ref$ = r.errors) != null && ref$.length ? r.errors.join("\n") : 'Invalid payment!');
          cardNumber = this$.$.find('.Buy-card-number');
          for (i$ = 0, len$ = (ref$ = [cardNumber, constructor.$('.Buy-card-code')]).length; i$ < len$; ++i$) {
            e = ref$[i$];
            e.addClass('has-error');
          }
          $fb = constructor.$('.fancybox-wrap:first');
          $fb.addClass('on-error');
          $fb.removeClass('shake');
          setTimeout(function(){
            $fb.addClass('shake');
            return cardNumber.focus();
          }, 10);
          return reEnable();
        }
      });
      return false;
    });
  };
  prototype.onDetach = function(){
    return this.$.off();
  };
  function Buy(){
    Buy.superclass.apply(this, arguments);
  }
  return Buy;
}(Component));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../build/component-jade.js":20,"yacomponent":21}],11:[function(require,module,exports){
var Component, Sales, templates, SalesApp;
Component = require('yacomponent');
Sales = require('./Sales.ls');
templates = require('../build/component-jade.js').templates;
module.exports = SalesApp = (function(superclass){
  var prototype = extend$((import$(SalesApp, superclass).displayName = 'SalesApp', SalesApp), superclass).prototype, constructor = SalesApp;
  prototype.template = templates.SalesApp;
  prototype.init = function(){
    return this.children = {
      sales: new Sales({}, '.SalesApp-content', this)
    };
  };
  prototype.onAttach = function(){
    return constructor.$('.Sales-subdomain:first').focus();
  };
  prototype.login = function(user){
    this.$.find('li.auth a.onclick-login').hide();
    return this.$.find('li.auth a.onclick-logout').show();
  };
  prototype.logout = function(){
    this.$.find('li.auth a.onclick-login').show();
    return this.$.find('li.auth a.onclick-logout').hide();
  };
  function SalesApp(){
    SalesApp.superclass.apply(this, arguments);
  }
  return SalesApp;
}(Component));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"./Sales.ls":23,"../build/component-jade.js":20,"yacomponent":21}],20:[function(require,module,exports){

module.exports = jade = (function(exports){
/*!
 * Jade - runtime
 * Copyright(c) 2010 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 */

/**
 * Lame Array.isArray() polyfill for now.
 */

if (!Array.isArray) {
  Array.isArray = function(arr){
    return '[object Array]' == Object.prototype.toString.call(arr);
  };
}

/**
 * Lame Object.keys() polyfill for now.
 */

if (!Object.keys) {
  Object.keys = function(obj){
    var arr = [];
    for (var key in obj) {
      if (obj.hasOwnProperty(key)) {
        arr.push(key);
      }
    }
    return arr;
  }
}

/**
 * Merge two attribute objects giving precedence
 * to values in object `b`. Classes are special-cased
 * allowing for arrays and merging/joining appropriately
 * resulting in a string.
 *
 * @param {Object} a
 * @param {Object} b
 * @return {Object} a
 * @api private
 */

exports.merge = function merge(a, b) {
  var ac = a['class'];
  var bc = b['class'];

  if (ac || bc) {
    ac = ac || [];
    bc = bc || [];
    if (!Array.isArray(ac)) ac = [ac];
    if (!Array.isArray(bc)) bc = [bc];
    ac = ac.filter(nulls);
    bc = bc.filter(nulls);
    a['class'] = ac.concat(bc).join(' ');
  }

  for (var key in b) {
    if (key != 'class') {
      a[key] = b[key];
    }
  }

  return a;
};

/**
 * Filter null `val`s.
 *
 * @param {Mixed} val
 * @return {Mixed}
 * @api private
 */

function nulls(val) {
  return val != null;
}

/**
 * Render the given attributes object.
 *
 * @param {Object} obj
 * @param {Object} escaped
 * @return {String}
 * @api private
 */

exports.attrs = function attrs(obj, escaped){
  var buf = []
    , terse = obj.terse;

  delete obj.terse;
  var keys = Object.keys(obj)
    , len = keys.length;

  if (len) {
    buf.push('');
    for (var i = 0; i < len; ++i) {
      var key = keys[i]
        , val = obj[key];

      if ('boolean' == typeof val || null == val) {
        if (val) {
          terse
            ? buf.push(key)
            : buf.push(key + '="' + key + '"');
        }
      } else if (0 == key.indexOf('data') && 'string' != typeof val) {
        buf.push(key + "='" + JSON.stringify(val) + "'");
      } else if ('class' == key && Array.isArray(val)) {
        buf.push(key + '="' + exports.escape(val.join(' ')) + '"');
      } else if (escaped && escaped[key]) {
        buf.push(key + '="' + exports.escape(val) + '"');
      } else {
        buf.push(key + '="' + val + '"');
      }
    }
  }

  return buf.join(' ');
};

/**
 * Escape the given string of `html`.
 *
 * @param {String} html
 * @return {String}
 * @api private
 */

exports.escape = function escape(html){
  return String(html)
    .replace(/&(?!(\w+|\#\d+);)/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;');
};

/**
 * Re-throw the given `err` in context to the
 * the jade in `filename` at the given `lineno`.
 *
 * @param {Error} err
 * @param {String} filename
 * @param {String} lineno
 * @api private
 */

exports.rethrow = function rethrow(err, filename, lineno){
  if (!filename) throw err;

  var context = 3
    , str = require('fs').readFileSync(filename, 'utf8')
    , lines = str.split('\n')
    , start = Math.max(lineno - context, 0)
    , end = Math.min(lines.length, lineno + context);

  // Error context
  var context = lines.slice(start, end).map(function(line, i){
    var curr = i + start + 1;
    return (curr == lineno ? '  > ' : '    ')
      + curr
      + '| '
      + line;
  }).join('\n');

  // Alter exception message
  err.path = filename;
  err.message = (filename || 'Jade') + ':' + lineno
    + '\n' + context + '\n\n' + err.message;
  throw err;
};

  return exports;

})({});

jade.templates = {};
jade.render = function(node, template, data) {
  var tmp = jade.templates[template](data);
  node.innerHTML = tmp;
};

jade.templates["AdminMenu"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<li class="default"><div><input type="text" placeholder="Title" class="row"/></div></li><form');
buf.push(attrs({ 'action':("/resources/sites/" + (site.id) + ""), 'method':("put"), "class": ('menus') + ' ' + ('onclick-submit') }, {"action":true,"method":true}));
buf.push('><input type="hidden" name="action" value="menu"/><div class="col1"><button class="onclick-add">Add</button><ol class="sortable"></ol></div><div class="col2"><fieldset><label class="type">Type</label><ul class="options"><li><label for="forum" class="header">Forum</label><input id="forum" type="radio" name="dialog" checked="checked" class="option"/><div class="dialog"><label for="forum_slug">Slug</label><input id="forum_slug" type="text" name="forumSlug"/><div class="note">URL suffix for this page</div><div class="break"></div><label for="locked">Admin Only</label><div class="box"><input id="locked" type="checkbox" value="checked" name="locked"/><label for="locked" class="switch-control"><div class="switch"></div></label><span class="label checked">Locked</span><div class="note">Lock entire forum (read-only except admin)</div></div><div class="break">   </div><label for="comments">Comments</label><div class="box"><input id="comments" type="checkbox" value="checked" name="comments"/><label for="comments" class="switch-control"><div class="switch"></div></label><span class="label checked">Yes</span><div class="note">Commentable forums are threaded like Reddit</div></div><div class="break">   </div><button type="submit" value="Save">Save</button><div class="tooltip"></div></div></li><li><label for="page" class="header">Page</label><input id="page" type="radio" name="dialog" class="option"/><div class="dialog"><label for="page_slug">Slug</label><input id="page_slug" type="text" name="pageSlug"/><div class="note">URL suffix for this page</div><div class="break"></div><label>Main Menu</label><div class="box"><input id="hide_menu" type="checkbox" value="checked" name="hideMenu"/><label for="hide_menu" class="switch-control"><div class="switch"></div></label><span class="label checked">On</span><div class="note">Shows &amp; hides the main menu for this page</div></div><div class="break"></div><label for="body">Body</label><textarea id="body" name="body"></textarea><div class="note">Paste the contents of the page above</div><div class="break">   </div><button type="submit" value="Save">Save</button><div class="tooltip"></div></div></li><li><label for="link" class="header">External Link</label><input id="link" type="radio" name="dialog" class="option"/><div class="dialog"><label for="url">Url</label><input id="url" type="text" name="url" placeholder="http://"/><div class="break"></div><label for="separate_tab">Separate Tab</label><div class="box"><input id="separate_tab" type="checkbox" value="checked" name="separateTab"/><label for="separate_tab" class="switch-control"><div class="switch"></div></label><span class="label checked">Yes</span><div class="note">Open link in separate window</div></div><div class="break">   </div><button type="submit" value="Save">Save</button><div class="tooltip"></div></div></li></ul></fieldset></div></form>');
}
return buf.join("");
}
jade.templates["AdminUpgrade"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var product_mixin = function(p, msg){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
if ( subscriptions.indexOf(p)==-1)
{
buf.push('<div');
buf.push(attrs({ "class": ("" + (p) + "-available") }, {"class":true}));
buf.push('><button');
buf.push(attrs({ 'type':('button'), 'data-product':(p), 'value':('Get It'), "class": ('onclick-buy') }, {"type":true,"data-product":true,"value":true}));
buf.push('>Get It</button></div><div');
buf.push(attrs({ "class": ("" + (p) + "-purchased hidden") }, {"class":true}));
buf.push('><p class="green">');
var __val__ = msg
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<span>&#x2713;</span></p></div>');
}
else
{
buf.push('<div');
buf.push(attrs({ "class": ("" + (p) + "-available hidden") }, {"class":true}));
buf.push('><button');
buf.push(attrs({ 'type':('button'), 'data-product':(p), 'value':('Get It'), "class": ('onclick-buy') }, {"type":true,"data-product":true,"value":true}));
buf.push('>Get It</button></div><div');
buf.push(attrs({ "class": ("" + (p) + "-purchased") }, {"class":true}));
buf.push('><p class="green">');
var __val__ = msg
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<span>&#x2713;</span></p></div>');
}
};
buf.push('<fieldset><h2>Custom Domain</h2><p>Add your own personal flair!  Get serious and aim any domain at your PowerBulletin site.</p>');
product_mixin('custom_domain', 'Custom Domain Purchased');
buf.push('<div class="notes"><a href="/admin/domains" class="mutant">Click here to bring your domains online!</a></div></fieldset><fieldset><h2>Go Private</h2><p>Privacy?  We got you covered.  This feature hides your content from Search Engines and the public.</p>');
product_mixin('private', 'Private Site Purchased');
buf.push('<div class="notes"><a href="/admin" class="mutant">Click here to toggle privacy settings!</a></div></fieldset><fieldset><h2>Analytics</h2><p>Your enterprising PowerBulletin community is bustling!  Know who, where and how with your favorite analytics tracker.</p>');
product_mixin('analytics', 'Analytics Purchased');
buf.push('<div class="notes"><a href="/admin" class="mutant">Get started with analytics here!</a></div></fieldset><fieldset><h2>Super Computing Instance</h2><p>Your site really took off and you\'d like more horsepower--speed is everything!  With your turbo-charged instance comes additional security, monitoring and peace of mind.</p>');
product_mixin('compute_instance', 'Super Computing Instance Purchased');
buf.push('<div class="notes"><p>A PowerBulletin team member will contact you after purchase!</p></div></fieldset><fieldset><h2>Engineering &amp; Creative</h2><p>Need extra personalization for your PowerBulletin community?  Our engineering ninjas entertain inventive ideas!</p>');
product_mixin('engineering', 'Engineering Purchased');
buf.push('<div class="notes"><p>A PowerBulletin team member will contact you after purchase!</p></div></fieldset>');
}
return buf.join("");
}
jade.templates["Auth"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div style="display:none;" class="reset"><form method="post" action="/auth/reset-password"><label for="password"><h2>Authenticating...</h2></label><fieldset><div class="tooltip"></div><input id="password" name="password" type="text" placeholder="Password" disabled="disabled" autocomplete="off"/><div class="toggle-password">Hide</div><div title="Stronger passwords are green" class="strength-meter"><div class="strength"></div></div><input type="hidden" name="forgot"/><button type="submit" value="Save" disabled="disabled">Save</button><a class="msg onclick-show-login"><h3>Back</h3></a></fieldset></form></div><div style="display:none;" class="choose"><form method="post" action="/auth/choose-username"><label for="username"><h2>Choose a User Name<i>!</i></h2></label><fieldset><div class="tooltip"></div><input id="username" name="username" type="text" placeholder="Username"/><button type="submit" value="Save">Save</button><a class="msg onclick-show-login"><h3>Back</h3></a></fieldset></form></div><div style="display:none;" class="forgot"><form method="post" action="/auth/forgot"><label for="email"><h2>Tell Us Your Email Address<i>!</i></h2></label><fieldset><div class="tooltip"></div><input id="email" name="email" type="text" placeholder="Email" maxlength="254"/><button type="submit" value="Send Reset">Send Reset</button><a class="msg onclick-show-login"><h3>Back</h3></a></fieldset></form></div><div style="display:none;" class="dialog"><h2 id="msg">Check your inbox for activation<i>!</i></h2><div class="msg2"></div><a class="msg onclick-close-fancybox"><h3>Close</h3></a></div><div style="display:none;" class="register"><form method="post" action="/auth/register"><label for="username"><h2>Welcome<i>!</i></h2></label><fieldset><div class="tooltip"></div><input id="username" name="username" type="text" placeholder="Username"/><input name="password" type="text" placeholder="Password" autocomplete="off"/><div class="toggle-password">Hide</div><div title="Stronger passwords are green" class="strength-meter"><div class="strength"></div></div><input name="email" type="text" placeholder="Email" maxlength="254" class="register-email"/><button type="submit" value="Register">Register</button><a class="msg onclick-show-login"><h3>I already have an account</h3></a></fieldset></form></div><div class="login"><form method="post" action="/auth/login"><label for="username"><h2>');
var __val__ = siteName
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h2></label><fieldset><a class="fmsg msg onclick-show-forgot"><h3>Forgot?</h3></a><div class="tooltip"></div><input id="username" name="username" type="text" placeholder="Username"/><input name="password" type="password" placeholder="Password" autocomplete="off"/><button type="submit" value="Login">Login</button>');
if (!( inviteOnly))
{
buf.push('<a class="msg onclick-show-register"><h3>Register<i>!</i></h3></a>');
}
buf.push('<a class="small msg onclick-show-forgot"><h3>Help<i>?</i></h3></a></fieldset></form>');
if (!( inviteOnly))
{
buf.push('<div class="social has-auth"><h3>Or Log In With</h3><a href="/auth/facebook" title="Facebook!" class="has-facebook"> <img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/facebook_32.png") }, {"src":true}));
buf.push('/></a><a href="/auth/google" title="Google+" class="has-google"> <img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/google_32.png") }, {"src":true}));
buf.push('/></a><a href="/auth/twitter" title="Twitter!" class="has-twitter"> <img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/twitter_32.png") }, {"src":true}));
buf.push('/></a></div>');
}
buf.push('</div>');
}
return buf.join("");
}
jade.templates["Buy"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var price = ((product.price / 100.0).toFixed(0));
buf.push('<h1>' + escape((interp = product.description) == null ? '' : interp) + '</h1><div class="right ccinfo"><form autocomplete="off"><div class="tooltip"></div>');
if ( cardNeeded)
{
buf.push('<div class="clear"></div><label for="card_number">Card Number</label><input id="card_number" type="text" placeholder="XXXX - XXXX - XXXX - XXXX" maxlength="19" class="Buy-card-number"/><div class="clear"></div><label for="card_month">Expiration</label><select id="card_month" class="Buy-card-month"><option disabled="disabled" selected="selected">- Month -</option><option value="1">Jan - 1</option><option value="2">Feb - 2</option><option value="3">Mar - 3</option><option value="4">Apr - 4</option><option value="5">May - 5</option><option value="6">Jun - 6</option><option value="7">Jul - 7</option><option value="8">Aug - 8</option><option value="9">Sept - 9</option><option value="10">Oct - 10</option><option value="11">Nov - 11</option><option value="12">Dec - 12</option></select><small>/</small><select id="card_year" class="Buy-card-year"><option disabled="disabled" selected="selected">- Year -</option>');
var d = (new Date().getFullYear());
 for (var i=0; i<=16; i++)
{
buf.push('<option>');
var __val__ = d + i
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</option>');
}
buf.push('</select><div class="clear"></div><label for="card_code">Security Code</label><input id="card_code" type="password" placeholder="CCV" maxlength="5" class="Buy-card-code"/><span class="code">?<div class="cvvinfo"><img');
buf.push(attrs({ 'src':(cacheUrl + '/images/cvv2_example.gif') }, {"src":true}));
buf.push('/><img');
buf.push(attrs({ 'src':(cacheUrl + '/images/cvv2_example_amex.gif') }, {"src":true}));
buf.push('/></div></span>');
}
else
{
buf.push('<h3>Your payment information is Ready-to-Go<i>!</i></h3><a href="#" class="Buy-change-card">Enter different credit card details</a><div class="clear"></div><em>Saves for all subscriptions</em>');
}
buf.push('<div class="clear"><button type="submit" value="CHECKOUT" class="Buy-checkout">CHECKOUT</button></div></form></div><div class="right features">');
if ( price && (price !== '0'))
{
buf.push('<h2>Only <b><small>$</small>');
var __val__ = price
buf.push(null == __val__ ? "" : __val__);
buf.push('</b><small>/mo</small></h2>');
}
else
{
buf.push('<h2><b>Free<i>!</i></b></h2>');
}
buf.push('<menu>');
// iterate product.config.features
;(function(){
  if ('number' == typeof product.config.features.length) {
    for (var $index = 0, $$l = product.config.features.length; $index < $$l; $index++) {
      var f = product.config.features[$index];

buf.push('<li>');
var __val__ = f
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
    }
  } else {
    for (var $index in product.config.features) {
      var f = product.config.features[$index];

buf.push('<li>');
var __val__ = f
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
   }
  }
}).call(this);

buf.push('</menu></div><div class="cards"><div class="jcb"></div><div class="dinersclub"></div><div class="discover"></div><div class="amex"></div><div class="mastercard"></div><div class="visa"></div></div>');
}
return buf.join("");
}
jade.templates["Chat"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="header"><div class="profile"><div');
buf.push(attrs({ 'title':(others[0].name), "class": ('minimize') }, {"title":true}));
buf.push('>');
if ( others[0].photo.match(/^https?\:/) || others[0].photo.match(/\/\//))
{
buf.push('<img');
buf.push(attrs({ 'src':(others[0].photo) }, {"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (others[0].photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></div><h2>' + escape((interp = others[0].name) == null ? '' : interp) + '</h2><div title="Close" class="close onclick-close">X</div></div><div class="container"><div class="messages"><div style="display:none;" class="load-more">load more...</div></div><div style="display:none;" class="msg"><div class="from"><a class="from-name mutant"></a></div><div class="body"></div></div></div><div class="footer"><form><textarea name="body"></textarea></form></div>');
}
return buf.join("");
}
jade.templates["Paginator"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
if ( pages.length >= 2)
{
// iterate pages
;(function(){
  if ('number' == typeof pages.length) {
    for (var $index = 0, $$l = pages.length; $index < $$l; $index++) {
      var p = pages[$index];

if ( p.active)
{
buf.push('<strong class="Paginator-page">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</strong>');
}
else
{
buf.push('<a');
buf.push(attrs({ 'href':(p.href), 'data-page':(p.num), "class": ('mutant') + ' ' + ('Paginator-page') }, {"href":true,"data-page":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a>');
}
    }
  } else {
    for (var $index in pages) {
      var p = pages[$index];

if ( p.active)
{
buf.push('<strong class="Paginator-page">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</strong>');
}
else
{
buf.push('<a');
buf.push(attrs({ 'href':(p.href), 'data-page':(p.num), "class": ('mutant') + ' ' + ('Paginator-page') }, {"href":true,"data-page":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a>');
}
   }
  }
}).call(this);

}
}
return buf.join("");
}
jade.templates["PhotoCropper"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="upload"><h1>');
var __val__ = title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h1><div><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (photo) + "") }, {"src":true}));
buf.push('/></div><div><form');
buf.push(attrs({ 'method':("POST"), 'action':("" + (endpointUrl) + ""), 'enctype':("multipart/form-data") }, {"method":true,"action":true,"enctype":true}));
buf.push('><div class="button"> <span>Upload Image</span><input type="file" name="avatar"/></div></form></div></div><div style="display:none;" class="crop"><h1>');
var __val__ = title + " (crop)"
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h1><div><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (photo) + "") }, {"src":true}));
buf.push('/></div><div class="button"><span>Crop Image</span></div></div>');
}
return buf.join("");
}
jade.templates["Sales"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="logo"><h1>Power<b>Bulletin</b></h1><em>The Official Real-Time Community Builder</em></div><h2 id="imagine" class="stick">Imagine real-time communities at the click of a button.</h2><div id="register_top"></div><h2 id="features" class="stick">Why you\'ll love PowerBulletin ...</h2><section class="translucent stick"><article><h4>Breakthrough Navigation</h4><p>From SEO technology that speedily transmits page delta instead of reloading browsers,\nto a split-thread &amp; post interface, the PowerBulletin experience is always secure, fast &amp; fluid.</p></article></section><section class="bg first"></section><section class="stick"><article><h4>Unmatched Responsive Design</h4><p>A modern, responsive interface that scales from to your phone,\ntablet and PC to wide-screen projectors--your PowerBulletin community always stuns.</p></article></section><section class="bg second"></section><section class="stick"><article><h4>Real-Time Flow</h4><p>Ultrafast PowerBulletin is built on a real-time engine that powers\neverything from user chat &amp; posts to administration, such as creating products.</p></article></section><section class="bg third"></section><section class="stick"><article><h4>Products &amp; e-Commerce Capabilities</h4><p>Sell your business products &amp; services around PowerBulletin communities.\nOffering e-commerce is so easy to use, it\'s easy to love.</p></article></section><section class="bg fourth"></section><section class="stick"><article><h4>Live Support</h4><p>Knowledge is PowerBulletin!  With<a href="mailto:support@powerbulletin.com">direct access to our team</a>of friendly developers &amp; designers\nthere\'s almost no limit to what you can build.</p></article></section><section class="last"><article><div id="register_bottom"></div></article></section><section id="faq" class="faq"><article><h3>FAQ</h3><menu><li><h4>Can I change the look of PowerBulletin?</h4><p>Absolutely!  We provide a solid default theme to get started quickly.\nAnything is possible with your stylish eye:<a href="http://www.w3schools.com/cssref/" target="_blank">CSS</a>&amp;<a href="http://learnboost.github.io/stylus/" target="_blank">Stylus</a>are supported.</p></li></menu><menu><li><h4>Contact</h4><p>We\'re here for YOU:<a href="mailto:support@powerbulletin.com">support@powerbulletin.com</a></p></li></menu></article></section><footer><div class="onclick-scroll-top">Top</div></footer>');
}
return buf.join("");
}
jade.templates["SalesApp"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<header><ul><li><a data-scroll-to="#features" class="onclick-scroll-to">Features</a></li><li><a data-scroll-to="#faq" class="onclick-scroll-to">FAQ</a></li><li class="auth"><a class="onclick-login">Login</a><a style="display:none;" class="onclick-logout">Logout</a></li></ul></header><div id="wrapper" class="SalesApp-content"></div><div id="auth"></div>');
}
return buf.join("");
}
jade.templates["SalesLoader"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<!DOCTYPE html><html><head><title>PowerBulletin</title>');
// iterate stylesheets
;(function(){
  if ('number' == typeof stylesheets.length) {
    for (var $index = 0, $$l = stylesheets.length; $index < $$l; $index++) {
      var stylesheet = stylesheets[$index];

buf.push('<link');
buf.push(attrs({ terse: true, 'rel':('stylesheet'), 'type':('text/css'), 'href':(stylesheet) }, {"rel":true,"type":true,"href":true}));
buf.push('>');
    }
  } else {
    for (var $index in stylesheets) {
      var stylesheet = stylesheets[$index];

buf.push('<link');
buf.push(attrs({ terse: true, 'rel':('stylesheet'), 'type':('text/css'), 'href':(stylesheet) }, {"rel":true,"type":true,"href":true}));
buf.push('>');
   }
  }
}).call(this);

buf.push('<script');
buf.push(attrs({ terse: true, 'type':('text/javascript'), 'src':("" + (cacheUrl) + "/local/head-0.99.load.min.js") }, {"type":true,"src":true}));
buf.push('></script><script type="text/javascript">\n window.headjs = head.js\n window.env = \'' + ((interp = env) == null ? '' : interp) + '\'\n window.cacheUrl = \'' + ((interp = cacheUrl) == null ? '' : interp) + '\';\n window.siteName = \'PowerBulletin\';\n window.authDomain = \'' + ((interp = authDomain) == null ? '' : interp) + '\';\n head.js.apply(head, ' + ((interp = JSON.stringify(scripts)) == null ? '' : interp) + ');\n</script></head><body></body></html>');
}
return buf.join("");
}
jade.templates["SiteRegister"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<h3>Start by creating a name now<i>!</i></h3><div class="tooltip SiteRegister-errors"></div><form class="site-register"><fieldset><input');
buf.push(attrs({ 'type':('text'), 'name':('subdomain'), 'value':(typeof subdomain != 'undefined' ? subdomain : ''), 'autocomplete':("off"), "class": ('SiteRegister-subdomain') }, {"type":true,"name":true,"value":true,"autocomplete":true}));
buf.push('/><span class="hostname">');
var __val__ = hostname
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><span class="SiteRegister-available"><div class="success">&#x2713;</div><div class="error">&#x2718;</div></span><div class="SiteRegister-create"></div></fieldset></form>');
}
return buf.join("");
}
},{"fs":24}],22:[function(require,module,exports){
(function(global){/*!
 * Lo-Dash 1.0.0-rc.3 <http://lodash.com>
 * (c) 2012 John-David Dalton <http://allyoucanleet.com/>
 * Based on Underscore.js 1.4.3 <http://underscorejs.org>
 * (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.
 * Available under MIT license <http://lodash.com/license>
 */
;(function(window, undefined) {

  /** Detect free variable `exports` */
  var freeExports = typeof exports == 'object' && exports;

  /** Detect free variable `global` and use it as `window` */
  var freeGlobal = typeof global == 'object' && global;
  if (freeGlobal.global === freeGlobal) {
    window = freeGlobal;
  }

  /** Used for array and object method references */
  var arrayRef = [],
      // avoid a Closure Compiler bug by creatively creating an object
      objectRef = new function(){};

  /** Used to generate unique IDs */
  var idCounter = 0;

  /** Used internally to indicate various things */
  var indicatorObject = objectRef;

  /** Used by `cachedContains` as the default size when optimizations are enabled for large arrays */
  var largeArraySize = 30;

  /** Used to restore the original `_` reference in `noConflict` */
  var oldDash = window._;

  /** Used to detect template delimiter values that require a with-statement */
  var reComplexDelimiter = /[-?+=!~*%&^<>|{(\/]|\[\D|\b(?:delete|in|instanceof|new|typeof|void)\b/;

  /** Used to match HTML entities */
  var reEscapedHtml = /&(?:amp|lt|gt|quot|#x27);/g;

  /** Used to match empty string literals in compiled template source */
  var reEmptyStringLeading = /\b__p \+= '';/g,
      reEmptyStringMiddle = /\b(__p \+=) '' \+/g,
      reEmptyStringTrailing = /(__e\(.*?\)|\b__t\)) \+\n'';/g;

  /** Used to match regexp flags from their coerced string values */
  var reFlags = /\w*$/;

  /** Used to insert the data object variable into compiled template source */
  var reInsertVariable = /(?:__e|__t = )\(\s*(?![\d\s"']|this\.)/g;

  /** Used to detect if a method is native */
  var reNative = RegExp('^' +
    (objectRef.valueOf + '')
      .replace(/[.*+?^=!:${}()|[\]\/\\]/g, '\\$&')
      .replace(/valueOf|for [^\]]+/g, '.+?') + '$'
  );

  /**
   * Used to match ES6 template delimiters
   * http://people.mozilla.org/~jorendorff/es6-draft.html#sec-7.8.6
   */
  var reEsTemplate = /\$\{((?:(?=\\?)\\?[\s\S])*?)}/g;

  /** Used to match "interpolate" template delimiters */
  var reInterpolate = /<%=([\s\S]+?)%>/g;

  /** Used to ensure capturing order of template delimiters */
  var reNoMatch = /($^)/;

  /** Used to match HTML characters */
  var reUnescapedHtml = /[&<>"']/g;

  /** Used to match unescaped characters in compiled string literals */
  var reUnescapedString = /['\n\r\t\u2028\u2029\\]/g;

  /** Used to fix the JScript [[DontEnum]] bug */
  var shadowed = [
    'constructor', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable',
    'toLocaleString', 'toString', 'valueOf'
  ];

  /** Used to make template sourceURLs easier to identify */
  var templateCounter = 0;

  /** Native method shortcuts */
  var ceil = Math.ceil,
      concat = arrayRef.concat,
      floor = Math.floor,
      getPrototypeOf = reNative.test(getPrototypeOf = Object.getPrototypeOf) && getPrototypeOf,
      hasOwnProperty = objectRef.hasOwnProperty,
      push = arrayRef.push,
      propertyIsEnumerable = objectRef.propertyIsEnumerable,
      toString = objectRef.toString;

  /* Native method shortcuts for methods with the same name as other `lodash` methods */
  var nativeBind = reNative.test(nativeBind = slice.bind) && nativeBind,
      nativeIsArray = reNative.test(nativeIsArray = Array.isArray) && nativeIsArray,
      nativeIsFinite = window.isFinite,
      nativeIsNaN = window.isNaN,
      nativeKeys = reNative.test(nativeKeys = Object.keys) && nativeKeys,
      nativeMax = Math.max,
      nativeMin = Math.min,
      nativeRandom = Math.random;

  /** `Object#toString` result shortcuts */
  var argsClass = '[object Arguments]',
      arrayClass = '[object Array]',
      boolClass = '[object Boolean]',
      dateClass = '[object Date]',
      funcClass = '[object Function]',
      numberClass = '[object Number]',
      objectClass = '[object Object]',
      regexpClass = '[object RegExp]',
      stringClass = '[object String]';

  /** Detect various environments */
  var isIeOpera = !!window.attachEvent,
      isV8 = nativeBind && !/\n|true/.test(nativeBind + isIeOpera);

  /* Detect if `Function#bind` exists and is inferred to be fast (all but V8) */
  var isBindFast = nativeBind && !isV8;

  /* Detect if `Object.keys` exists and is inferred to be fast (IE, Opera, V8) */
  var isKeysFast = nativeKeys && (isIeOpera || isV8);

  /**
   * Detect the JScript [[DontEnum]] bug:
   *
   * In IE < 9 an objects own properties, shadowing non-enumerable ones, are
   * made non-enumerable as well.
   */
  var hasDontEnumBug;

  /** Detect if own properties are iterated after inherited properties (IE < 9) */
  var iteratesOwnLast;

  /**
   * Detect if `Array#shift` and `Array#splice` augment array-like objects
   * incorrectly:
   *
   * Firefox < 10, IE compatibility mode, and IE < 9 have buggy Array `shift()`
   * and `splice()` functions that fail to remove the last element, `value[0]`,
   * of array-like objects even though the `length` property is set to `0`.
   * The `shift()` method is buggy in IE 8 compatibility mode, while `splice()`
   * is buggy regardless of mode in IE < 9 and buggy in compatibility mode in IE 9.
   */
  var hasObjectSpliceBug = (hasObjectSpliceBug = { '0': 1, 'length': 1 },
    arrayRef.splice.call(hasObjectSpliceBug, 0, 1), hasObjectSpliceBug[0]);

  /** Detect if an `arguments` object's indexes are non-enumerable (IE < 9) */
  var nonEnumArgs = true;

  (function() {
    var props = [];
    function ctor() { this.x = 1; }
    ctor.prototype = { 'valueOf': 1, 'y': 1 };
    for (var prop in new ctor) { props.push(prop); }
    for (prop in arguments) { nonEnumArgs = !prop; }

    hasDontEnumBug = !/valueOf/.test(props);
    iteratesOwnLast = props[0] != 'x';
  }(1));

  /** Detect if `arguments` objects are `Object` objects (all but Opera < 10.5) */
  var argsAreObjects = arguments.constructor == Object;

  /** Detect if `arguments` objects [[Class]] is unresolvable (Firefox < 4, IE < 9) */
  var noArgsClass = !isArguments(arguments);

  /**
   * Detect lack of support for accessing string characters by index:
   *
   * IE < 8 can't access characters by index and IE 8 can only access
   * characters by index on string literals.
   */
  var noCharByIndex = ('x'[0] + Object('x')[0]) != 'xx';

  /**
   * Detect if a node's [[Class]] is unresolvable (IE < 9)
   * and that the JS engine won't error when attempting to coerce an object to
   * a string without a `toString` property value of `typeof` "function".
   */
  try {
    var noNodeClass = ({ 'toString': 0 } + '', toString.call(document) == objectClass);
  } catch(e) { }

  /**
   * Detect if sourceURL syntax is usable without erroring:
   *
   * The JS engine embedded in Adobe products will throw a syntax error when
   * it encounters a single line comment beginning with the `@` symbol.
   *
   * The JS engine in Narwhal will generate the function `function anonymous(){//}`
   * and throw a syntax error.
   *
   * Avoid comments beginning `@` symbols in IE because they are part of its
   * non-standard conditional compilation support.
   * http://msdn.microsoft.com/en-us/library/121hztk3(v=vs.94).aspx
   */
  try {
    var useSourceURL = (Function('//@')(), !isIeOpera);
  } catch(e) { }

  /** Used to identify object classifications that `_.clone` supports */
  var cloneableClasses = {};
  cloneableClasses[funcClass] = false;
  cloneableClasses[argsClass] = cloneableClasses[arrayClass] =
  cloneableClasses[boolClass] = cloneableClasses[dateClass] =
  cloneableClasses[numberClass] = cloneableClasses[objectClass] =
  cloneableClasses[regexpClass] = cloneableClasses[stringClass] = true;

  /** Used to lookup a built-in constructor by [[Class]] */
  var ctorByClass = {};
  ctorByClass[arrayClass] = Array;
  ctorByClass[boolClass] = Boolean;
  ctorByClass[dateClass] = Date;
  ctorByClass[objectClass] = Object;
  ctorByClass[numberClass] = Number;
  ctorByClass[regexpClass] = RegExp;
  ctorByClass[stringClass] = String;

  /** Used to determine if values are of the language type Object */
  var objectTypes = {
    'boolean': false,
    'function': true,
    'object': true,
    'number': false,
    'string': false,
    'undefined': false
  };

  /** Used to escape characters for inclusion in compiled string literals */
  var stringEscapes = {
    '\\': '\\',
    "'": "'",
    '\n': 'n',
    '\r': 'r',
    '\t': 't',
    '\u2028': 'u2028',
    '\u2029': 'u2029'
  };

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a `lodash` object, that wraps the given `value`, to enable
   * method chaining.
   *
   * The chainable wrapper functions are:
   * `after`, `assign`, `bind`, `bindAll`, `bindKey`, `chain`, `compact`, `compose`,
   * `concat`, `countBy`, `debounce`, `defaults`, `defer`, `delay`, `difference`,
   * `filter`, `flatten`, `forEach`, `forIn`, `forOwn`, `functions`, `groupBy`,
   * `initial`, `intersection`, `invert`, `invoke`, `keys`, `map`, `max`, `memoize`,
   * `merge`, `min`, `object`, `omit`, `once`, `pairs`, `partial`, `pick`, `pluck`,
   * `push`, `range`, `reject`, `rest`, `reverse`, `shuffle`, `slice`, `sort`,
   * `sortBy`, `splice`, `tap`, `throttle`, `times`, `toArray`, `union`, `uniq`,
   * `unshift`, `values`, `where`, `without`, `wrap`, and `zip`
   *
   * The non-chainable wrapper functions are:
   * `clone`, `cloneDeep`, `contains`, `escape`, `every`, `find`, `has`, `identity`,
   * `indexOf`, `isArguments`, `isArray`, `isBoolean`, `isDate`, `isElement`, `isEmpty`,
   * `isEqual`, `isFinite`, `isFunction`, `isNaN`, `isNull`, `isNumber`, `isObject`,
   * `isPlainObject`, `isRegExp`, `isString`, `isUndefined`, `join`, `lastIndexOf`,
   * `mixin`, `noConflict`, `pop`, `random`, `reduce`, `reduceRight`, `result`,
   * `shift`, `size`, `some`, `sortedIndex`, `template`, `unescape`, and `uniqueId`
   *
   * The wrapper functions `first` and `last` return wrapped values when `n` is
   * passed, otherwise they return unwrapped values.
   *
   * @name _
   * @constructor
   * @category Chaining
   * @param {Mixed} value The value to wrap in a `lodash` instance.
   * @returns {Object} Returns a `lodash` instance.
   */
  function lodash(value) {
    // exit early if already wrapped, even if wrapped by a different `lodash` constructor
    if (value && typeof value == 'object' && value.__wrapped__) {
      return value;
    }
    // allow invoking `lodash` without the `new` operator
    if (!(this instanceof lodash)) {
      return new lodash(value);
    }
    this.__wrapped__ = value;
  }

  /**
   * By default, the template delimiters used by Lo-Dash are similar to those in
   * embedded Ruby (ERB). Change the following template settings to use alternative
   * delimiters.
   *
   * @static
   * @memberOf _
   * @type Object
   */
  lodash.templateSettings = {

    /**
     * Used to detect `data` property values to be HTML-escaped.
     *
     * @static
     * @memberOf _.templateSettings
     * @type RegExp
     */
    'escape': /<%-([\s\S]+?)%>/g,

    /**
     * Used to detect code to be evaluated.
     *
     * @static
     * @memberOf _.templateSettings
     * @type RegExp
     */
    'evaluate': /<%([\s\S]+?)%>/g,

    /**
     * Used to detect `data` property values to inject.
     *
     * @static
     * @memberOf _.templateSettings
     * @type RegExp
     */
    'interpolate': reInterpolate,

    /**
     * Used to reference the data object in the template text.
     *
     * @static
     * @memberOf _.templateSettings
     * @type String
     */
    'variable': ''
  };

  /*--------------------------------------------------------------------------*/

  /**
   * The template used to create iterator functions.
   *
   * @private
   * @param {Obect} data The data object used to populate the text.
   * @returns {String} Returns the interpolated text.
   */
  var iteratorTemplate = template(
    // conditional strict mode
    "<% if (obj.useStrict) { %>'use strict';\n<% } %>" +

    // the `iteratee` may be reassigned by the `top` snippet
    'var index, iteratee = <%= firstArg %>, ' +
    // assign the `result` variable an initial value
    'result = <%= firstArg %>;\n' +
    // exit early if the first argument is falsey
    'if (!<%= firstArg %>) return result;\n' +
    // add code before the iteration branches
    '<%= top %>;\n' +

    // array-like iteration:
    '<% if (arrayLoop) { %>' +
    'var length = iteratee.length; index = -1;\n' +
    "if (typeof length == 'number') {" +

    // add support for accessing string characters by index if needed
    '  <% if (noCharByIndex) { %>\n' +
    '  if (isString(iteratee)) {\n' +
    "    iteratee = iteratee.split('')\n" +
    '  }' +
    '  <% } %>\n' +

    // iterate over the array-like value
    '  while (++index < length) {\n' +
    '    <%= arrayLoop %>\n' +
    '  }\n' +
    '}\n' +
    'else {' +

    // object iteration:
    // add support for iterating over `arguments` objects if needed
    '  <%  } else if (nonEnumArgs) { %>\n' +
    '  var length = iteratee.length; index = -1;\n' +
    '  if (length && isArguments(iteratee)) {\n' +
    '    while (++index < length) {\n' +
    "      index += '';\n" +
    '      <%= objectLoop %>\n' +
    '    }\n' +
    '  } else {' +
    '  <% } %>' +

    // Firefox < 3.6, Opera > 9.50 - Opera < 11.60, and Safari < 5.1
    // (if the prototype or a property on the prototype has been set)
    // incorrectly sets a function's `prototype` property [[Enumerable]]
    // value to `true`. Because of this Lo-Dash standardizes on skipping
    // the the `prototype` property of functions regardless of its
    // [[Enumerable]] value.
    '  <% if (!hasDontEnumBug) { %>\n' +
    "  var skipProto = typeof iteratee == 'function' && \n" +
    "    propertyIsEnumerable.call(iteratee, 'prototype');\n" +
    '  <% } %>' +

    // iterate own properties using `Object.keys` if it's fast
    '  <% if (isKeysFast && useHas) { %>\n' +
    '  var ownIndex = -1,\n' +
    '      ownProps = objectTypes[typeof iteratee] ? nativeKeys(iteratee) : [],\n' +
    '      length = ownProps.length;\n\n' +
    '  while (++ownIndex < length) {\n' +
    '    index = ownProps[ownIndex];\n' +
    "    <% if (!hasDontEnumBug) { %>if (!(skipProto && index == 'prototype')) {\n  <% } %>" +
    '    <%= objectLoop %>\n' +
    '    <% if (!hasDontEnumBug) { %>}\n<% } %>' +
    '  }' +

    // else using a for-in loop
    '  <% } else { %>\n' +
    '  for (index in iteratee) {<%' +
    '    if (!hasDontEnumBug || useHas) { %>\n    if (<%' +
    "      if (!hasDontEnumBug) { %>!(skipProto && index == 'prototype')<% }" +
    '      if (!hasDontEnumBug && useHas) { %> && <% }' +
    '      if (useHas) { %>hasOwnProperty.call(iteratee, index)<% }' +
    '    %>) {' +
    '    <% } %>\n' +
    '    <%= objectLoop %>;' +
    '    <% if (!hasDontEnumBug || useHas) { %>\n    }<% } %>\n' +
    '  }' +
    '  <% } %>' +

    // Because IE < 9 can't set the `[[Enumerable]]` attribute of an
    // existing property and the `constructor` property of a prototype
    // defaults to non-enumerable, Lo-Dash skips the `constructor`
    // property when it infers it's iterating over a `prototype` object.
    '  <% if (hasDontEnumBug) { %>\n\n' +
    '  var ctor = iteratee.constructor;\n' +
    '    <% for (var k = 0; k < 7; k++) { %>\n' +
    "  index = '<%= shadowed[k] %>';\n" +
    '  if (<%' +
    "      if (shadowed[k] == 'constructor') {" +
    '        %>!(ctor && ctor.prototype === iteratee) && <%' +
    '      } %>hasOwnProperty.call(iteratee, index)) {\n' +
    '    <%= objectLoop %>\n' +
    '  }' +
    '    <% } %>' +
    '  <% } %>' +
    '  <% if (arrayLoop || nonEnumArgs) { %>\n}<% } %>\n' +

    // add code to the bottom of the iteration function
    '<%= bottom %>;\n' +
    // finally, return the `result`
    'return result'
  );

  /** Reusable iterator options for `assign` and `defaults` */
  var assignIteratorOptions = {
    'args': 'object, source, guard',
    'top':
      "for (var argsIndex = 1, argsLength = typeof guard == 'number' ? 2 : arguments.length; argsIndex < argsLength; argsIndex++) {\n" +
      '  if ((iteratee = arguments[argsIndex])) {',
    'objectLoop': 'result[index] = iteratee[index]',
    'bottom': '  }\n}'
  };

  /**
   * Reusable iterator options shared by `each`, `forIn`, and `forOwn`.
   */
  var eachIteratorOptions = {
    'args': 'collection, callback, thisArg',
    'top': "callback = callback && typeof thisArg == 'undefined' ? callback : createCallback(callback, thisArg)",
    'arrayLoop': 'if (callback(iteratee[index], index, collection) === false) return result',
    'objectLoop': 'if (callback(iteratee[index], index, collection) === false) return result'
  };

  /** Reusable iterator options for `forIn` and `forOwn` */
  var forOwnIteratorOptions = {
    'arrayLoop': null
  };

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a function optimized to search large arrays for a given `value`,
   * starting at `fromIndex`, using strict equality for comparisons, i.e. `===`.
   *
   * @private
   * @param {Array} array The array to search.
   * @param {Mixed} value The value to search for.
   * @param {Number} [fromIndex=0] The index to search from.
   * @param {Number} [largeSize=30] The length at which an array is considered large.
   * @returns {Boolean} Returns `true` if `value` is found, else `false`.
   */
  function cachedContains(array, fromIndex, largeSize) {
    fromIndex || (fromIndex = 0);

    var length = array.length,
        isLarge = (length - fromIndex) >= (largeSize || largeArraySize);

    if (isLarge) {
      var cache = {},
          index = fromIndex - 1;

      while (++index < length) {
        // manually coerce `value` to a string because `hasOwnProperty`, in some
        // older versions of Firefox, coerces objects incorrectly
        var key = array[index] + '';
        (hasOwnProperty.call(cache, key) ? cache[key] : (cache[key] = [])).push(array[index]);
      }
    }
    return function(value) {
      if (isLarge) {
        var key = value + '';
        return hasOwnProperty.call(cache, key) && indexOf(cache[key], value) > -1;
      }
      return indexOf(array, value, fromIndex) > -1;
    }
  }

  /**
   * Used by `_.max` and `_.min` as the default `callback` when a given
   * `collection` is a string value.
   *
   * @private
   * @param {String} value The character to inspect.
   * @returns {Number} Returns the code unit of given character.
   */
  function charAtCallback(value) {
    return value.charCodeAt(0);
  }

  /**
   * Used by `sortBy` to compare transformed `collection` values, stable sorting
   * them in ascending order.
   *
   * @private
   * @param {Object} a The object to compare to `b`.
   * @param {Object} b The object to compare to `a`.
   * @returns {Number} Returns the sort order indicator of `1` or `-1`.
   */
  function compareAscending(a, b) {
    var ai = a.index,
        bi = b.index;

    a = a.criteria;
    b = b.criteria;

    // ensure a stable sort in V8 and other engines
    // http://code.google.com/p/v8/issues/detail?id=90
    if (a !== b) {
      if (a > b || typeof a == 'undefined') {
        return 1;
      }
      if (a < b || typeof b == 'undefined') {
        return -1;
      }
    }
    return ai < bi ? -1 : 1;
  }

  /**
   * Creates a function that, when called, invokes `func` with the `this`
   * binding of `thisArg` and prepends any `partailArgs` to the arguments passed
   * to the bound function.
   *
   * @private
   * @param {Function|String} func The function to bind or the method name.
   * @param {Mixed} [thisArg] The `this` binding of `func`.
   * @param {Array} partialArgs An array of arguments to be partially applied.
   * @returns {Function} Returns the new bound function.
   */
  function createBound(func, thisArg, partialArgs) {
    var isFunc = isFunction(func),
        isPartial = !partialArgs,
        key = thisArg;

    // juggle arguments
    if (isPartial) {
      partialArgs = thisArg;
    }
    if (!isFunc) {
      thisArg = func;
    }

    function bound() {
      // `Function#bind` spec
      // http://es5.github.com/#x15.3.4.5
      var args = arguments,
          thisBinding = isPartial ? this : thisArg;

      if (!isFunc) {
        func = thisArg[key];
      }
      if (partialArgs.length) {
        args = args.length
          ? partialArgs.concat(slice(args))
          : partialArgs;
      }
      if (this instanceof bound) {
        // ensure `new bound` is an instance of `bound` and `func`
        noop.prototype = func.prototype;
        thisBinding = new noop;
        noop.prototype = null;

        // mimic the constructor's `return` behavior
        // http://es5.github.com/#x13.2.2
        var result = func.apply(thisBinding, args);
        return isObject(result) ? result : thisBinding;
      }
      return func.apply(thisBinding, args);
    }
    return bound;
  }

  /**
   * Produces an iteration callback bound to an optional `thisArg`. If `func` is
   * a property name, the callback will return the property value for a given element.
   *
   * @private
   * @param {Function|String} [func=identity|property] The function called per
   * iteration or property name to query.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @param {Object} [accumulating] Used to indicate that the callback should
   *  accept an `accumulator` argument.
   * @returns {Function} Returns a callback function.
   */
  function createCallback(func, thisArg, accumulating) {
    if (!func) {
      return identity;
    }
    if (typeof func != 'function') {
      return function(object) {
        return object[func];
      };
    }
    if (typeof thisArg != 'undefined') {
      if (accumulating) {
        return function(accumulator, value, index, object) {
          return func.call(thisArg, accumulator, value, index, object);
        };
      }
      return function(value, index, object) {
        return func.call(thisArg, value, index, object);
      };
    }
    return func;
  }

  /**
   * Creates compiled iteration functions.
   *
   * @private
   * @param {Object} [options1, options2, ...] The compile options object(s).
   *  useHas - A boolean to specify using `hasOwnProperty` checks in the object loop.
   *  args - A string of comma separated arguments the iteration function will accept.
   *  top - A string of code to execute before the iteration branches.
   *  arrayLoop - A string of code to execute in the array loop.
   *  objectLoop - A string of code to execute in the object loop.
   *  bottom - A string of code to execute after the iteration branches.
   *
   * @returns {Function} Returns the compiled function.
   */
  function createIterator() {
    var data = {
      'arrayLoop': '',
      'bottom': '',
      'hasDontEnumBug': hasDontEnumBug,
      'isKeysFast': isKeysFast,
      'objectLoop': '',
      'nonEnumArgs': nonEnumArgs,
      'noCharByIndex': noCharByIndex,
      'shadowed': shadowed,
      'top': '',
      'useHas': true
    };

    // merge options into a template data object
    for (var object, index = 0; object = arguments[index]; index++) {
      for (var key in object) {
        data[key] = object[key];
      }
    }
    var args = data.args;
    data.firstArg = /^[^,]+/.exec(args)[0];

    // create the function factory
    var factory = Function(
        'createCallback, hasOwnProperty, isArguments, isString, objectTypes, ' +
        'nativeKeys, propertyIsEnumerable',
      'return function(' + args + ') {\n' + iteratorTemplate(data) + '\n}'
    );
    // return the compiled function
    return factory(
      createCallback, hasOwnProperty, isArguments, isString, objectTypes,
      nativeKeys, propertyIsEnumerable
    );
  }

  /**
   * A function compiled to iterate `arguments` objects, arrays, objects, and
   * strings consistenly across environments, executing the `callback` for each
   * element in the `collection`. The `callback` is bound to `thisArg` and invoked
   * with three arguments; (value, index|key, collection). Callbacks may exit
   * iteration early by explicitly returning `false`.
   *
   * @private
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array|Object|String} Returns `collection`.
   */
  var each = createIterator(eachIteratorOptions);

  /**
   * Used by `template` to escape characters for inclusion in compiled
   * string literals.
   *
   * @private
   * @param {String} match The matched character to escape.
   * @returns {String} Returns the escaped character.
   */
  function escapeStringChar(match) {
    return '\\' + stringEscapes[match];
  }

  /**
   * Used by `escape` to convert characters to HTML entities.
   *
   * @private
   * @param {String} match The matched character to escape.
   * @returns {String} Returns the escaped character.
   */
  function escapeHtmlChar(match) {
    return htmlEscapes[match];
  }

  /**
   * Checks if `value` is a DOM node in IE < 9.
   *
   * @private
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a DOM node, else `false`.
   */
  function isNode(value) {
    // IE < 9 presents DOM nodes as `Object` objects except they have `toString`
    // methods that are `typeof` "string" and still can coerce nodes to strings
    return typeof value.toString != 'function' && typeof (value + '') == 'string';
  }

  /**
   * A no-operation function.
   *
   * @private
   */
  function noop() {
    // no operation performed
  }

  /**
   * Slices the `collection` from the `start` index up to, but not including,
   * the `end` index.
   *
   * Note: This function is used, instead of `Array#slice`, to support node lists
   * in IE < 9 and to ensure dense arrays are returned.
   *
   * @private
   * @param {Array|Object|String} collection The collection to slice.
   * @param {Number} start The start index.
   * @param {Number} end The end index.
   * @returns {Array} Returns the new array.
   */
  function slice(array, start, end) {
    start || (start = 0);
    if (typeof end == 'undefined') {
      end = array ? array.length : 0;
    }
    var index = -1,
        length = end - start || 0,
        result = Array(length < 0 ? 0 : length);

    while (++index < length) {
      result[index] = array[start + index];
    }
    return result;
  }

  /**
   * Used by `unescape` to convert HTML entities to characters.
   *
   * @private
   * @param {String} match The matched character to unescape.
   * @returns {String} Returns the unescaped character.
   */
  function unescapeHtmlChar(match) {
    return htmlUnescapes[match];
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Assigns own enumerable properties of source object(s) to the `destination`
   * object. Subsequent sources will overwrite propery assignments of previous
   * sources.
   *
   * @static
   * @memberOf _
   * @alias extend
   * @category Objects
   * @param {Object} object The destination object.
   * @param {Object} [source1, source2, ...] The source objects.
   * @returns {Object} Returns the destination object.
   * @example
   *
   * _.assign({ 'name': 'moe' }, { 'age': 40 });
   * // => { 'name': 'moe', 'age': 40 }
   */
  var assign = createIterator(assignIteratorOptions);

  /**
   * Checks if `value` is an `arguments` object.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is an `arguments` object, else `false`.
   * @example
   *
   * (function() { return _.isArguments(arguments); })(1, 2, 3);
   * // => true
   *
   * _.isArguments([1, 2, 3]);
   * // => false
   */
  function isArguments(value) {
    return toString.call(value) == argsClass;
  }
  // fallback for browsers that can't detect `arguments` objects by [[Class]]
  if (noArgsClass) {
    isArguments = function(value) {
      return value ? hasOwnProperty.call(value, 'callee') : false;
    };
  }

  /**
   * Iterates over `object`'s own and inherited enumerable properties, executing
   * the `callback` for each property. The `callback` is bound to `thisArg` and
   * invoked with three arguments; (value, key, object). Callbacks may exit iteration
   * early by explicitly returning `false`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns `object`.
   * @example
   *
   * function Dog(name) {
   *   this.name = name;
   * }
   *
   * Dog.prototype.bark = function() {
   *   alert('Woof, woof!');
   * };
   *
   * _.forIn(new Dog('Dagny'), function(value, key) {
   *   alert(key);
   * });
   * // => alerts 'name' and 'bark' (order is not guaranteed)
   */
  var forIn = createIterator(eachIteratorOptions, forOwnIteratorOptions, {
    'useHas': false
  });

  /**
   * Iterates over an object's own enumerable properties, executing the `callback`
   * for each property. The `callback` is bound to `thisArg` and invoked with three
   * arguments; (value, key, object). Callbacks may exit iteration early by explicitly
   * returning `false`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns `object`.
   * @example
   *
   * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {
   *   alert(key);
   * });
   * // => alerts '0', '1', and 'length' (order is not guaranteed)
   */
  var forOwn = createIterator(eachIteratorOptions, forOwnIteratorOptions);

  /**
   * A fallback implementation of `isPlainObject` that checks if a given `value`
   * is an object created by the `Object` constructor, assuming objects created
   * by the `Object` constructor have no inherited enumerable properties and that
   * there are no `Object.prototype` extensions.
   *
   * @private
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if `value` is a plain object, else `false`.
   */
  function shimIsPlainObject(value) {
    // avoid non-objects and false positives for `arguments` objects
    var result = false;
    if (!(value && typeof value == 'object') || isArguments(value)) {
      return result;
    }
    // check that the constructor is `Object` (i.e. `Object instanceof Object`)
    var ctor = value.constructor;
    if ((!isFunction(ctor) && (!noNodeClass || !isNode(value))) || ctor instanceof ctor) {
      // IE < 9 iterates inherited properties before own properties. If the first
      // iterated property is an object's own property then there are no inherited
      // enumerable properties.
      if (iteratesOwnLast) {
        forIn(value, function(value, key, object) {
          result = !hasOwnProperty.call(object, key);
          return false;
        });
        return result === false;
      }
      // In most environments an object's own properties are iterated before
      // its inherited properties. If the last iterated property is an object's
      // own property then there are no inherited enumerable properties.
      forIn(value, function(value, key) {
        result = key;
      });
      return result === false || hasOwnProperty.call(value, result);
    }
    return result;
  }

  /**
   * A fallback implementation of `Object.keys` that produces an array of the
   * given object's own enumerable property names.
   *
   * @private
   * @param {Object} object The object to inspect.
   * @returns {Array} Returns a new array of property names.
   */
  function shimKeys(object) {
    var result = [];
    forOwn(object, function(value, key) {
      result.push(key);
    });
    return result;
  }

  /**
   * Used to convert characters to HTML entities:
   *
   * Though the `>` character is escaped for symmetry, characters like `>` and `/`
   * don't require escaping in HTML and have no special meaning unless they're part
   * of a tag or an unquoted attribute value.
   * http://mathiasbynens.be/notes/ambiguous-ampersands (under "semi-related fun fact")
   */
  var htmlEscapes = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#x27;'
  };

  /** Used to convert HTML entities to characters */
  var htmlUnescapes = invert(htmlEscapes);

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a clone of `value`. If `deep` is `true`, nested objects will also
   * be cloned, otherwise they will be assigned by reference.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to clone.
   * @param {Boolean} deep A flag to indicate a deep clone.
   * @param- {Object} [guard] Internally used to allow this method to work with
   *  others like `_.map` without using their callback `index` argument for `deep`.
   * @param- {Array} [stackA=[]] Internally used to track traversed source objects.
   * @param- {Array} [stackB=[]] Internally used to associate clones with their
   *  source counterparts.
   * @returns {Mixed} Returns the cloned `value`.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe', 'age': 40 },
   *   { 'name': 'larry', 'age': 50 },
   *   { 'name': 'curly', 'age': 60 }
   * ];
   *
   * var shallow = _.clone(stooges);
   * shallow[0] === stooges[0];
   * // => true
   *
   * var deep = _.clone(stooges, true);
   * deep[0] === stooges[0];
   * // => false
   */
  function clone(value, deep, guard, stackA, stackB) {
    if (value == null) {
      return value;
    }
    if (guard) {
      deep = false;
    }
    // inspect [[Class]]
    var isObj = isObject(value);
    if (isObj) {
      var className = toString.call(value);
      if (!cloneableClasses[className] || (noNodeClass && isNode(value))) {
        return value;
      }
      var isArr = isArray(value);
    }
    // shallow clone
    if (!isObj || !deep) {
      return isObj
        ? (isArr ? slice(value) : assign({}, value))
        : value;
    }
    var ctor = ctorByClass[className];
    switch (className) {
      case boolClass:
      case dateClass:
        return new ctor(+value);

      case numberClass:
      case stringClass:
        return new ctor(value);

      case regexpClass:
        return ctor(value.source, reFlags.exec(value));
    }
    // check for circular references and return corresponding clone
    stackA || (stackA = []);
    stackB || (stackB = []);

    var length = stackA.length;
    while (length--) {
      if (stackA[length] == value) {
        return stackB[length];
      }
    }
    // init cloned object
    var result = isArr ? ctor(value.length) : {};

    // add the source value to the stack of traversed objects
    // and associate it with its clone
    stackA.push(value);
    stackB.push(result);

    // recursively populate clone (susceptible to call stack limits)
    (isArr ? forEach : forOwn)(value, function(objValue, key) {
      result[key] = clone(objValue, deep, null, stackA, stackB);
    });

    // add array properties assigned by `RegExp#exec`
    if (isArr) {
      if (hasOwnProperty.call(value, 'index')) {
        result.index = value.index;
      }
      if (hasOwnProperty.call(value, 'input')) {
        result.input = value.input;
      }
    }
    return result;
  }

  /**
   * Creates a deep clone of `value`. Functions and DOM nodes are **not** cloned.
   * The enumerable properties of `arguments` objects and objects created by
   * constructors other than `Object` are cloned to plain `Object` objects.
   *
   * Note: This function is loosely based on the structured clone algorithm.
   * See http://www.w3.org/TR/html5/common-dom-interfaces.html#internal-structured-cloning-algorithm.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to deep clone.
   * @returns {Mixed} Returns the deep cloned `value`.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe', 'age': 40 },
   *   { 'name': 'larry', 'age': 50 },
   *   { 'name': 'curly', 'age': 60 }
   * ];
   *
   * var deep = _.cloneDeep(stooges);
   * deep[0] === stooges[0];
   * // => false
   */
  function cloneDeep(value) {
    return clone(value, true);
  }

  /**
   * Assigns own enumerable properties of source object(s) to the `destination`
   * object for all `destination` properties that resolve to `null`/`undefined`.
   * Once a property is set, additional defaults of the same property will be
   * ignored.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The destination object.
   * @param {Object} [default1, default2, ...] The default objects.
   * @returns {Object} Returns the destination object.
   * @example
   *
   * var iceCream = { 'flavor': 'chocolate' };
   * _.defaults(iceCream, { 'flavor': 'vanilla', 'sprinkles': 'rainbow' });
   * // => { 'flavor': 'chocolate', 'sprinkles': 'rainbow' }
   */
  var defaults = createIterator(assignIteratorOptions, {
    'objectLoop': 'if (result[index] == null) ' + assignIteratorOptions.objectLoop
  });

  /**
   * Creates a sorted array of all enumerable properties, own and inherited,
   * of `object` that have function values.
   *
   * @static
   * @memberOf _
   * @alias methods
   * @category Objects
   * @param {Object} object The object to inspect.
   * @returns {Array} Returns a new array of property names that have function values.
   * @example
   *
   * _.functions(_);
   * // => ['all', 'any', 'bind', 'bindAll', 'clone', 'compact', 'compose', ...]
   */
  function functions(object) {
    var result = [];
    forIn(object, function(value, key) {
      if (isFunction(value)) {
        result.push(key);
      }
    });
    return result.sort();
  }

  /**
   * Checks if the specified object `property` exists and is a direct property,
   * instead of an inherited property.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to check.
   * @param {String} property The property to check for.
   * @returns {Boolean} Returns `true` if key is a direct property, else `false`.
   * @example
   *
   * _.has({ 'a': 1, 'b': 2, 'c': 3 }, 'b');
   * // => true
   */
  function has(object, property) {
    return object ? hasOwnProperty.call(object, property) : false;
  }

  /**
   * Creates an object composed of the inverted keys and values of the given `object`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to invert.
   * @returns {Object} Returns the created inverted object.
   * @example
   *
   *  _.invert({ 'first': 'Moe', 'second': 'Larry', 'third': 'Curly' });
   * // => { 'Moe': 'first', 'Larry': 'second', 'Curly': 'third' } (order is not guaranteed)
   */
  function invert(object) {
    var result = {};
    forOwn(object, function(value, key) {
      result[value] = key;
    });
    return result;
  }

  /**
   * Checks if `value` is an array.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is an array, else `false`.
   * @example
   *
   * (function() { return _.isArray(arguments); })();
   * // => false
   *
   * _.isArray([1, 2, 3]);
   * // => true
   */
  var isArray = nativeIsArray || function(value) {
    // `instanceof` may cause a memory leak in IE 7 if `value` is a host object
    // http://ajaxian.com/archives/working-aroung-the-instanceof-memory-leak
    return (argsAreObjects && value instanceof Array) || toString.call(value) == arrayClass;
  };

  /**
   * Checks if `value` is a boolean (`true` or `false`) value.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a boolean value, else `false`.
   * @example
   *
   * _.isBoolean(null);
   * // => false
   */
  function isBoolean(value) {
    return value === true || value === false || toString.call(value) == boolClass;
  }

  /**
   * Checks if `value` is a date.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a date, else `false`.
   * @example
   *
   * _.isDate(new Date);
   * // => true
   */
  function isDate(value) {
    return value instanceof Date || toString.call(value) == dateClass;
  }

  /**
   * Checks if `value` is a DOM element.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a DOM element, else `false`.
   * @example
   *
   * _.isElement(document.body);
   * // => true
   */
  function isElement(value) {
    return value ? value.nodeType === 1 : false;
  }

  /**
   * Checks if `value` is empty. Arrays, strings, or `arguments` objects with a
   * length of `0` and objects with no own enumerable properties are considered
   * "empty".
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Array|Object|String} value The value to inspect.
   * @returns {Boolean} Returns `true` if the `value` is empty, else `false`.
   * @example
   *
   * _.isEmpty([1, 2, 3]);
   * // => false
   *
   * _.isEmpty({});
   * // => true
   *
   * _.isEmpty('');
   * // => true
   */
  function isEmpty(value) {
    var result = true;
    if (!value) {
      return result;
    }
    var className = toString.call(value),
        length = value.length;

    if ((className == arrayClass || className == stringClass ||
        className == argsClass || (noArgsClass && isArguments(value))) ||
        (className == objectClass && typeof length == 'number' && isFunction(value.splice))) {
      return !length;
    }
    forOwn(value, function() {
      return (result = false);
    });
    return result;
  }

  /**
   * Performs a deep comparison between two values to determine if they are
   * equivalent to each other.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} a The value to compare.
   * @param {Mixed} b The other value to compare.
   * @param- {Object} [stackA=[]] Internally used track traversed `a` objects.
   * @param- {Object} [stackB=[]] Internally used track traversed `b` objects.
   * @returns {Boolean} Returns `true` if the values are equvalent, else `false`.
   * @example
   *
   * var moe = { 'name': 'moe', 'luckyNumbers': [13, 27, 34] };
   * var clone = { 'name': 'moe', 'luckyNumbers': [13, 27, 34] };
   *
   * moe == clone;
   * // => false
   *
   * _.isEqual(moe, clone);
   * // => true
   */
  function isEqual(a, b, stackA, stackB) {
    // exit early for identical values
    if (a === b) {
      // treat `+0` vs. `-0` as not equal
      return a !== 0 || (1 / a == 1 / b);
    }
    // a strict comparison is necessary because `null == undefined`
    if (a == null || b == null) {
      return a === b;
    }
    // compare [[Class]] names
    var className = toString.call(a),
        otherName = toString.call(b);

    if (className == argsClass) {
      className = objectClass;
    }
    if (otherName == argsClass) {
      otherName = objectClass;
    }
    if (className != otherName) {
      return false;
    }
    switch (className) {
      case boolClass:
      case dateClass:
        // coerce dates and booleans to numbers, dates to milliseconds and booleans
        // to `1` or `0`, treating invalid dates coerced to `NaN` as not equal
        return +a == +b;

      case numberClass:
        // treat `NaN` vs. `NaN` as equal
        return a != +a
          ? b != +b
          // but treat `+0` vs. `-0` as not equal
          : (a == 0 ? (1 / a == 1 / b) : a == +b);

      case regexpClass:
      case stringClass:
        // coerce regexes to strings (http://es5.github.com/#x15.10.6.4)
        // treat string primitives and their corresponding object instances as equal
        return a == b + '';
    }
    var isArr = className == arrayClass;
    if (!isArr) {
      // unwrap any `lodash` wrapped values
      if (a.__wrapped__ || b.__wrapped__) {
        return isEqual(a.__wrapped__ || a, b.__wrapped__ || b);
      }
      // exit for functions and DOM nodes
      if (className != objectClass || (noNodeClass && (isNode(a) || isNode(b)))) {
        return false;
      }
      // in older versions of Opera, `arguments` objects have `Array` constructors
      var ctorA = !argsAreObjects && isArguments(a) ? Object : a.constructor,
          ctorB = !argsAreObjects && isArguments(b) ? Object : b.constructor;

      // non `Object` object instances with different constructors are not equal
      if (ctorA != ctorB && !(
            isFunction(ctorA) && ctorA instanceof ctorA &&
            isFunction(ctorB) && ctorB instanceof ctorB
          )) {
        return false;
      }
    }
    // assume cyclic structures are equal
    // the algorithm for detecting cyclic structures is adapted from ES 5.1
    // section 15.12.3, abstract operation `JO` (http://es5.github.com/#x15.12.3)
    stackA || (stackA = []);
    stackB || (stackB = []);

    var length = stackA.length;
    while (length--) {
      if (stackA[length] == a) {
        return stackB[length] == b;
      }
    }
    var index = -1,
        result = true,
        size = 0;

    // add `a` and `b` to the stack of traversed objects
    stackA.push(a);
    stackB.push(b);

    // recursively compare objects and arrays (susceptible to call stack limits)
    if (isArr) {
      // compare lengths to determine if a deep comparison is necessary
      size = a.length;
      result = size == b.length;

      if (result) {
        // deep compare the contents, ignoring non-numeric properties
        while (size--) {
          if (!(result = isEqual(a[size], b[size], stackA, stackB))) {
            break;
          }
        }
      }
      return result;
    }
    // deep compare objects using `forIn`, instead of `forOwn`, to avoid `Object.keys`
    // which, in this case, is more costly
    forIn(a, function(value, key, a) {
      if (hasOwnProperty.call(a, key)) {
        // count the number of properties.
        size++;
        // deep compare each property value.
        return (result = hasOwnProperty.call(b, key) && isEqual(value, b[key], stackA, stackB));
      }
    });

    if (result) {
      // ensure both objects have the same number of properties
      forIn(b, function(value, key, b) {
        if (hasOwnProperty.call(b, key)) {
          // `size` will be `-1` if `b` has more properties than `a`
          return (result = --size > -1);
        }
      });
    }
    return result;
  }

  /**
   * Checks if `value` is, or can be coerced to, a finite number.
   *
   * Note: This is not the same as native `isFinite`, which will return true for
   * booleans and empty strings. See http://es5.github.com/#x15.1.2.5.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a finite number, else `false`.
   * @example
   *
   * _.isFinite(-101);
   * // => true
   *
   * _.isFinite('10');
   * // => true
   *
   * _.isFinite(true);
   * // => false
   *
   * _.isFinite('');
   * // => false
   *
   * _.isFinite(Infinity);
   * // => false
   */
  function isFinite(value) {
    return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value));
  }

  /**
   * Checks if `value` is a function.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a function, else `false`.
   * @example
   *
   * _.isFunction(_);
   * // => true
   */
  function isFunction(value) {
    return typeof value == 'function';
  }
  // fallback for older versions of Chrome and Safari
  if (isFunction(/x/)) {
    isFunction = function(value) {
      return value instanceof Function || toString.call(value) == funcClass;
    };
  }

  /**
   * Checks if `value` is the language type of Object.
   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is an object, else `false`.
   * @example
   *
   * _.isObject({});
   * // => true
   *
   * _.isObject([1, 2, 3]);
   * // => true
   *
   * _.isObject(1);
   * // => false
   */
  function isObject(value) {
    // check if the value is the ECMAScript language type of Object
    // http://es5.github.com/#x8
    // and avoid a V8 bug
    // http://code.google.com/p/v8/issues/detail?id=2291
    return value ? objectTypes[typeof value] : false;
  }

  /**
   * Checks if `value` is `NaN`.
   *
   * Note: This is not the same as native `isNaN`, which will return `true` for
   * `undefined` and other values. See http://es5.github.com/#x15.1.2.4.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is `NaN`, else `false`.
   * @example
   *
   * _.isNaN(NaN);
   * // => true
   *
   * _.isNaN(new Number(NaN));
   * // => true
   *
   * isNaN(undefined);
   * // => true
   *
   * _.isNaN(undefined);
   * // => false
   */
  function isNaN(value) {
    // `NaN` as a primitive is the only value that is not equal to itself
    // (perform the [[Class]] check first to avoid errors with some host objects in IE)
    return isNumber(value) && value != +value
  }

  /**
   * Checks if `value` is `null`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is `null`, else `false`.
   * @example
   *
   * _.isNull(null);
   * // => true
   *
   * _.isNull(undefined);
   * // => false
   */
  function isNull(value) {
    return value === null;
  }

  /**
   * Checks if `value` is a number.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a number, else `false`.
   * @example
   *
   * _.isNumber(8.4 * 5);
   * // => true
   */
  function isNumber(value) {
    return typeof value == 'number' || toString.call(value) == numberClass;
  }

  /**
   * Checks if a given `value` is an object created by the `Object` constructor.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if `value` is a plain object, else `false`.
   * @example
   *
   * function Stooge(name, age) {
   *   this.name = name;
   *   this.age = age;
   * }
   *
   * _.isPlainObject(new Stooge('moe', 40));
   * // => false
   *
   * _.isPlainObject([1, 2, 3]);
   * // => false
   *
   * _.isPlainObject({ 'name': 'moe', 'age': 40 });
   * // => true
   */
  var isPlainObject = !getPrototypeOf ? shimIsPlainObject : function(value) {
    if (!(value && typeof value == 'object')) {
      return false;
    }
    var valueOf = value.valueOf,
        objProto = typeof valueOf == 'function' && (objProto = getPrototypeOf(valueOf)) && getPrototypeOf(objProto);

    return objProto
      ? value == objProto || (getPrototypeOf(value) == objProto && !isArguments(value))
      : shimIsPlainObject(value);
  };

  /**
   * Checks if `value` is a regular expression.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a regular expression, else `false`.
   * @example
   *
   * _.isRegExp(/moe/);
   * // => true
   */
  function isRegExp(value) {
    return value instanceof RegExp || toString.call(value) == regexpClass;
  }

  /**
   * Checks if `value` is a string.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is a string, else `false`.
   * @example
   *
   * _.isString('moe');
   * // => true
   */
  function isString(value) {
    return typeof value == 'string' || toString.call(value) == stringClass;
  }

  /**
   * Checks if `value` is `undefined`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Mixed} value The value to check.
   * @returns {Boolean} Returns `true` if the `value` is `undefined`, else `false`.
   * @example
   *
   * _.isUndefined(void 0);
   * // => true
   */
  function isUndefined(value) {
    return typeof value == 'undefined';
  }

  /**
   * Creates an array composed of the own enumerable property names of `object`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to inspect.
   * @returns {Array} Returns a new array of property names.
   * @example
   *
   * _.keys({ 'one': 1, 'two': 2, 'three': 3 });
   * // => ['one', 'two', 'three'] (order is not guaranteed)
   */
  var keys = !nativeKeys ? shimKeys : function(object) {
    // avoid iterating over the `prototype` property
    return typeof object == 'function' && propertyIsEnumerable.call(object, 'prototype')
      ? shimKeys(object)
      : (isObject(object) ? nativeKeys(object) : []);
  };

  /**
   * Merges enumerable properties of the source object(s) into the `destination`
   * object. Subsequent sources will overwrite propery assignments of previous
   * sources.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The destination object.
   * @param {Object} [source1, source2, ...] The source objects.
   * @param- {Object} [indicator] Internally used to indicate that the `stack`
   *  argument is an array of traversed objects instead of another source object.
   * @param- {Array} [stackA=[]] Internally used to track traversed source objects.
   * @param- {Array} [stackB=[]] Internally used to associate values with their
   *  source counterparts.
   * @returns {Object} Returns the destination object.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe' },
   *   { 'name': 'larry' }
   * ];
   *
   * var ages = [
   *   { 'age': 40 },
   *   { 'age': 50 }
   * ];
   *
   * _.merge(stooges, ages);
   * // => [{ 'name': 'moe', 'age': 40 }, { 'name': 'larry', 'age': 50 }]
   */
  function merge(object, source, indicator) {
    var args = arguments,
        index = 0,
        length = 2,
        stackA = args[3],
        stackB = args[4];

    if (indicator !== indicatorObject) {
      stackA = [];
      stackB = [];

      // work with `_.reduce` by only using its callback `accumulator` and `value` arguments
      if (typeof indicator != 'number') {
        length = args.length;
      }
    }
    while (++index < length) {
      forOwn(args[index], function(source, key) {
        var found, isArr, value;
        if (source && ((isArr = isArray(source)) || isPlainObject(source))) {
          // avoid merging previously merged cyclic sources
          var stackLength = stackA.length;
          while (stackLength--) {
            found = stackA[stackLength] == source;
            if (found) {
              break;
            }
          }
          if (found) {
            object[key] = stackB[stackLength];
          }
          else {
            // add `source` and associated `value` to the stack of traversed objects
            stackA.push(source);
            stackB.push(value = (value = object[key], isArr)
              ? (isArray(value) ? value : [])
              : (isPlainObject(value) ? value : {})
            );
            // recursively merge objects and arrays (susceptible to call stack limits)
            object[key] = merge(value, source, indicatorObject, stackA, stackB);
          }
        } else if (source != null) {
          object[key] = source;
        }
      });
    }
    return object;
  }

  /**
   * Creates a shallow clone of `object` excluding the specified properties.
   * Property names may be specified as individual arguments or as arrays of
   * property names. If `callback` is passed, it will be executed for each property
   * in the `object`, omitting the properties `callback` returns truthy for. The
   * `callback` is bound to `thisArg` and invoked with three arguments; (value, key, object).
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The source object.
   * @param {Function|String} callback|[prop1, prop2, ...] The properties to omit
   *  or the function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns an object without the omitted properties.
   * @example
   *
   * _.omit({ 'name': 'moe', 'age': 40, 'userid': 'moe1' }, 'userid');
   * // => { 'name': 'moe', 'age': 40 }
   *
   * _.omit({ 'name': 'moe', '_hint': 'knucklehead', '_seed': '96c4eb' }, function(value, key) {
   *   return key.charAt(0) == '_';
   * });
   * // => { 'name': 'moe' }
   */
  function omit(object, callback, thisArg) {
    var isFunc = typeof callback == 'function',
        result = {};

    if (isFunc) {
      callback = createCallback(callback, thisArg);
    } else {
      var props = concat.apply(arrayRef, arguments);
    }
    forIn(object, function(value, key, object) {
      if (isFunc
            ? !callback(value, key, object)
            : indexOf(props, key, 1) < 0
          ) {
        result[key] = value;
      }
    });
    return result;
  }

  /**
   * Creates a two dimensional array of the given object's key-value pairs,
   * i.e. `[[key1, value1], [key2, value2]]`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to inspect.
   * @returns {Array} Returns new array of key-value pairs.
   * @example
   *
   * _.pairs({ 'moe': 30, 'larry': 40, 'curly': 50 });
   * // => [['moe', 30], ['larry', 40], ['curly', 50]] (order is not guaranteed)
   */
  function pairs(object) {
    var result = [];
    forOwn(object, function(value, key) {
      result.push([key, value]);
    });
    return result;
  }

  /**
   * Creates a shallow clone of `object` composed of the specified properties.
   * Property names may be specified as individual arguments or as arrays of
   * property names. If `callback` is passed, it will be executed for each property
   * in the `object`, picking the properties `callback` returns truthy for. The
   * `callback` is bound to `thisArg` and invoked with three arguments; (value, key, object).
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The source object.
   * @param {Function|String} callback|[prop1, prop2, ...] The properties to pick
   *  or the function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns an object composed of the picked properties.
   * @example
   *
   * _.pick({ 'name': 'moe', 'age': 40, 'userid': 'moe1' }, 'name', 'age');
   * // => { 'name': 'moe', 'age': 40 }
   *
   * _.pick({ 'name': 'moe', '_hint': 'knucklehead', '_seed': '96c4eb' }, function(value, key) {
   *   return key.charAt(0) != '_';
   * });
   * // => { 'name': 'moe' }
   */
  function pick(object, callback, thisArg) {
    var result = {};
    if (typeof callback != 'function') {
      var index = 0,
          props = concat.apply(arrayRef, arguments),
          length = props.length;

      while (++index < length) {
        var key = props[index];
        if (key in object) {
          result[key] = object[key];
        }
      }
    } else {
      callback = createCallback(callback, thisArg);
      forIn(object, function(value, key, object) {
        if (callback(value, key, object)) {
          result[key] = value;
        }
      });
    }
    return result;
  }

  /**
   * Creates an array composed of the own enumerable property values of `object`.
   *
   * @static
   * @memberOf _
   * @category Objects
   * @param {Object} object The object to inspect.
   * @returns {Array} Returns a new array of property values.
   * @example
   *
   * _.values({ 'one': 1, 'two': 2, 'three': 3 });
   * // => [1, 2, 3]
   */
  function values(object) {
    var result = [];
    forOwn(object, function(value) {
      result.push(value);
    });
    return result;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Checks if a given `target` element is present in a `collection` using strict
   * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used
   * as the offset from the end of the collection.
   *
   * @static
   * @memberOf _
   * @alias include
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Mixed} target The value to check for.
   * @param {Number} [fromIndex=0] The index to search from.
   * @returns {Boolean} Returns `true` if the `target` element is found, else `false`.
   * @example
   *
   * _.contains([1, 2, 3], 1);
   * // => true
   *
   * _.contains([1, 2, 3], 1, 2);
   * // => false
   *
   * _.contains({ 'name': 'moe', 'age': 40 }, 'moe');
   * // => true
   *
   * _.contains('curly', 'ur');
   * // => true
   */
  function contains(collection, target, fromIndex) {
    var index = -1,
        length = collection ? collection.length : 0,
        result = false;

    fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex) || 0;
    if (typeof length == 'number') {
      result = (isString(collection)
        ? collection.indexOf(target, fromIndex)
        : indexOf(collection, target, fromIndex)
      ) > -1;
    } else {
      each(collection, function(value) {
        if (++index >= fromIndex) {
          return !(result = value === target);
        }
      });
    }
    return result;
  }

  /**
   * Creates an object composed of keys returned from running each element of
   * `collection` through a `callback`. The corresponding value of each key is
   * the number of times the key was returned by `callback`. The `callback` is
   * bound to `thisArg` and invoked with three arguments; (value, index|key, collection).
   * The `callback` argument may also be the name of a property to count by (e.g. 'length').
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function|String} callback|property The function called per iteration
   *  or property name to count by.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns the composed aggregate object.
   * @example
   *
   * _.countBy([4.3, 6.1, 6.4], function(num) { return Math.floor(num); });
   * // => { '4': 1, '6': 2 }
   *
   * _.countBy([4.3, 6.1, 6.4], function(num) { return this.floor(num); }, Math);
   * // => { '4': 1, '6': 2 }
   *
   * _.countBy(['one', 'two', 'three'], 'length');
   * // => { '3': 2, '5': 1 }
   */
  function countBy(collection, callback, thisArg) {
    var result = {};
    callback = createCallback(callback, thisArg);

    forEach(collection, function(value, key, collection) {
      key = callback(value, key, collection);
      (hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1);
    });
    return result;
  }

  /**
   * Checks if the `callback` returns a truthy value for **all** elements of a
   * `collection`. The `callback` is bound to `thisArg` and invoked with three
   * arguments; (value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias all
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Boolean} Returns `true` if all elements pass the callback check,
   *  else `false`.
   * @example
   *
   * _.every([true, 1, null, 'yes'], Boolean);
   * // => false
   */
  function every(collection, callback, thisArg) {
    var result = true;
    callback = createCallback(callback, thisArg);

    if (isArray(collection)) {
      var index = -1,
          length = collection.length;

      while (++index < length) {
        if (!(result = !!callback(collection[index], index, collection))) {
          break;
        }
      }
    } else {
      each(collection, function(value, index, collection) {
        return (result = !!callback(value, index, collection));
      });
    }
    return result;
  }

  /**
   * Examines each element in a `collection`, returning an array of all elements
   * the `callback` returns truthy for. The `callback` is bound to `thisArg` and
   * invoked with three arguments; (value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias select
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a new array of elements that passed the callback check.
   * @example
   *
   * var evens = _.filter([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });
   * // => [2, 4, 6]
   */
  function filter(collection, callback, thisArg) {
    var result = [];
    callback = createCallback(callback, thisArg);

    if (isArray(collection)) {
      var index = -1,
          length = collection.length;

      while (++index < length) {
        var value = collection[index];
        if (callback(value, index, collection)) {
          result.push(value);
        }
      }
    } else {
      each(collection, function(value, index, collection) {
        if (callback(value, index, collection)) {
          result.push(value);
        }
      });
    }
    return result;
  }

  /**
   * Examines each element in a `collection`, returning the first one the `callback`
   * returns truthy for. The function returns as soon as it finds an acceptable
   * element, and does not iterate over the entire `collection`. The `callback` is
   * bound to `thisArg` and invoked with three arguments; (value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias detect
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Mixed} Returns the element that passed the callback check,
   *  else `undefined`.
   * @example
   *
   * var even = _.find([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });
   * // => 2
   */
  function find(collection, callback, thisArg) {
    var result;
    callback = createCallback(callback, thisArg);

    forEach(collection, function(value, index, collection) {
      if (callback(value, index, collection)) {
        result = value;
        return false;
      }
    });
    return result;
  }

  /**
   * Iterates over a `collection`, executing the `callback` for each element in
   * the `collection`. The `callback` is bound to `thisArg` and invoked with three
   * arguments; (value, index|key, collection). Callbacks may exit iteration early
   * by explicitly returning `false`.
   *
   * @static
   * @memberOf _
   * @alias each
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array|Object|String} Returns `collection`.
   * @example
   *
   * _([1, 2, 3]).forEach(alert).join(',');
   * // => alerts each number and returns '1,2,3'
   *
   * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, alert);
   * // => alerts each number value (order is not guaranteed)
   */
  function forEach(collection, callback, thisArg) {
    if (callback && typeof thisArg == 'undefined' && isArray(collection)) {
      var index = -1,
          length = collection.length;

      while (++index < length) {
        if (callback(collection[index], index, collection) === false) {
          break;
        }
      }
    } else {
      each(collection, callback, thisArg);
    }
    return collection;
  }

  /**
   * Creates an object composed of keys returned from running each element of
   * `collection` through a `callback`. The corresponding value of each key is an
   * array of elements passed to `callback` that returned the key. The `callback`
   * is bound to `thisArg` and invoked with three arguments; (value, index|key, collection).
   * The `callback` argument may also be the name of a property to group by (e.g. 'length').
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function|String} callback|property The function called per iteration
   *  or property name to group by.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Object} Returns the composed aggregate object.
   * @example
   *
   * _.groupBy([4.2, 6.1, 6.4], function(num) { return Math.floor(num); });
   * // => { '4': [4.2], '6': [6.1, 6.4] }
   *
   * _.groupBy([4.2, 6.1, 6.4], function(num) { return this.floor(num); }, Math);
   * // => { '4': [4.2], '6': [6.1, 6.4] }
   *
   * _.groupBy(['one', 'two', 'three'], 'length');
   * // => { '3': ['one', 'two'], '5': ['three'] }
   */
  function groupBy(collection, callback, thisArg) {
    var result = {};
    callback = createCallback(callback, thisArg);

    forEach(collection, function(value, key, collection) {
      key = callback(value, key, collection);
      (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value);
    });
    return result;
  }

  /**
   * Invokes the method named by `methodName` on each element in the `collection`,
   * returning an array of the results of each invoked method. Additional arguments
   * will be passed to each invoked method. If `methodName` is a function it will
   * be invoked for, and `this` bound to, each element in the `collection`.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function|String} methodName The name of the method to invoke or
   *  the function invoked per iteration.
   * @param {Mixed} [arg1, arg2, ...] Arguments to invoke the method with.
   * @returns {Array} Returns a new array of the results of each invoked method.
   * @example
   *
   * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');
   * // => [[1, 5, 7], [1, 2, 3]]
   *
   * _.invoke([123, 456], String.prototype.split, '');
   * // => [['1', '2', '3'], ['4', '5', '6']]
   */
  function invoke(collection, methodName) {
    var args = slice(arguments, 2),
        isFunc = typeof methodName == 'function',
        result = [];

    forEach(collection, function(value) {
      result.push((isFunc ? methodName : value[methodName]).apply(value, args));
    });
    return result;
  }

  /**
   * Creates an array of values by running each element in the `collection`
   * through a `callback`. The `callback` is bound to `thisArg` and invoked with
   * three arguments; (value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias collect
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a new array of the results of each `callback` execution.
   * @example
   *
   * _.map([1, 2, 3], function(num) { return num * 3; });
   * // => [3, 6, 9]
   *
   * _.map({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { return num * 3; });
   * // => [3, 6, 9] (order is not guaranteed)
   */
  function map(collection, callback, thisArg) {
    var index = -1,
        length = collection ? collection.length : 0,
        result = Array(typeof length == 'number' ? length : 0);

    callback = createCallback(callback, thisArg);
    if (isArray(collection)) {
      while (++index < length) {
        result[index] = callback(collection[index], index, collection);
      }
    } else {
      each(collection, function(value, key, collection) {
        result[++index] = callback(value, key, collection);
      });
    }
    return result;
  }

  /**
   * Retrieves the maximum value of an `array`. If `callback` is passed,
   * it will be executed for each value in the `array` to generate the
   * criterion by which the value is ranked. The `callback` is bound to
   * `thisArg` and invoked with three arguments; (value, index, collection).
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Mixed} Returns the maximum value.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe', 'age': 40 },
   *   { 'name': 'larry', 'age': 50 },
   *   { 'name': 'curly', 'age': 60 }
   * ];
   *
   * _.max(stooges, function(stooge) { return stooge.age; });
   * // => { 'name': 'curly', 'age': 60 };
   */
  function max(collection, callback, thisArg) {
    var computed = -Infinity,
        index = -1,
        length = collection ? collection.length : 0,
        result = computed;

    if (callback || !isArray(collection)) {
      callback = !callback && isString(collection)
        ? charAtCallback
        : createCallback(callback, thisArg);

      each(collection, function(value, index, collection) {
        var current = callback(value, index, collection);
        if (current > computed) {
          computed = current;
          result = value;
        }
      });
    } else {
      while (++index < length) {
        if (collection[index] > result) {
          result = collection[index];
        }
      }
    }
    return result;
  }

  /**
   * Retrieves the minimum value of an `array`. If `callback` is passed,
   * it will be executed for each value in the `array` to generate the
   * criterion by which the value is ranked. The `callback` is bound to `thisArg`
   * and invoked with three arguments; (value, index, collection).
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Mixed} Returns the minimum value.
   * @example
   *
   * _.min([10, 5, 100, 2, 1000]);
   * // => 2
   */
  function min(collection, callback, thisArg) {
    var computed = Infinity,
        index = -1,
        length = collection ? collection.length : 0,
        result = computed;

    if (callback || !isArray(collection)) {
      callback = !callback && isString(collection)
        ? charAtCallback
        : createCallback(callback, thisArg);

      each(collection, function(value, index, collection) {
        var current = callback(value, index, collection);
        if (current < computed) {
          computed = current;
          result = value;
        }
      });
    } else {
      while (++index < length) {
        if (collection[index] < result) {
          result = collection[index];
        }
      }
    }
    return result;
  }

  /**
   * Retrieves the value of a specified property from all elements in
   * the `collection`.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {String} property The property to pluck.
   * @returns {Array} Returns a new array of property values.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe', 'age': 40 },
   *   { 'name': 'larry', 'age': 50 },
   *   { 'name': 'curly', 'age': 60 }
   * ];
   *
   * _.pluck(stooges, 'name');
   * // => ['moe', 'larry', 'curly']
   */
  function pluck(collection, property) {
    return map(collection, property + '');
  }

  /**
   * Boils down a `collection` to a single value. The initial state of the
   * reduction is `accumulator` and each successive step of it should be returned
   * by the `callback`. The `callback` is bound to `thisArg` and invoked with 4
   * arguments; for arrays they are (accumulator, value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias foldl, inject
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [accumulator] Initial value of the accumulator.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Mixed} Returns the accumulated value.
   * @example
   *
   * var sum = _.reduce([1, 2, 3], function(memo, num) { return memo + num; });
   * // => 6
   */
  function reduce(collection, callback, accumulator, thisArg) {
    var noaccum = arguments.length < 3;
    callback = createCallback(callback, thisArg, indicatorObject);

    if (isArray(collection)) {
      var index = -1,
          length = collection.length;

      if (noaccum) {
        accumulator = collection[++index];
      }
      while (++index < length) {
        accumulator = callback(accumulator, collection[index], index, collection);
      }
    } else {
      each(collection, function(value, index, collection) {
        accumulator = noaccum
          ? (noaccum = false, value)
          : callback(accumulator, value, index, collection)
      });
    }
    return accumulator;
  }

  /**
   * The right-associative version of `_.reduce`.
   *
   * @static
   * @memberOf _
   * @alias foldr
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [accumulator] Initial value of the accumulator.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Mixed} Returns the accumulated value.
   * @example
   *
   * var list = [[0, 1], [2, 3], [4, 5]];
   * var flat = _.reduceRight(list, function(a, b) { return a.concat(b); }, []);
   * // => [4, 5, 2, 3, 0, 1]
   */
  function reduceRight(collection, callback, accumulator, thisArg) {
    var iteratee = collection,
        length = collection ? collection.length : 0,
        noaccum = arguments.length < 3;

    if (typeof length != 'number') {
      var props = keys(collection);
      length = props.length;
    } else if (noCharByIndex && isString(collection)) {
      iteratee = collection.split('');
    }
    callback = createCallback(callback, thisArg, indicatorObject);
    forEach(collection, function(value, index, collection) {
      index = props ? props[--length] : --length;
      accumulator = noaccum
        ? (noaccum = false, iteratee[index])
        : callback(accumulator, iteratee[index], index, collection);
    });
    return accumulator;
  }

  /**
   * The opposite of `_.filter`, this method returns the values of a
   * `collection` that `callback` does **not** return truthy for.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a new array of elements that did **not** pass the
   *  callback check.
   * @example
   *
   * var odds = _.reject([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });
   * // => [1, 3, 5]
   */
  function reject(collection, callback, thisArg) {
    callback = createCallback(callback, thisArg);
    return filter(collection, function(value, index, collection) {
      return !callback(value, index, collection);
    });
  }

  /**
   * Creates an array of shuffled `array` values, using a version of the
   * Fisher-Yates shuffle. See http://en.wikipedia.org/wiki/Fisher-Yates_shuffle.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to shuffle.
   * @returns {Array} Returns a new shuffled collection.
   * @example
   *
   * _.shuffle([1, 2, 3, 4, 5, 6]);
   * // => [4, 1, 6, 3, 5, 2]
   */
  function shuffle(collection) {
    var index = -1,
        result = Array(collection ? collection.length : 0);

    forEach(collection, function(value) {
      var rand = floor(nativeRandom() * (++index + 1));
      result[index] = result[rand];
      result[rand] = value;
    });
    return result;
  }

  /**
   * Gets the size of the `collection` by returning `collection.length` for arrays
   * and array-like objects or the number of own enumerable properties for objects.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to inspect.
   * @returns {Number} Returns `collection.length` or number of own enumerable properties.
   * @example
   *
   * _.size([1, 2]);
   * // => 2
   *
   * _.size({ 'one': 1, 'two': 2, 'three': 3 });
   * // => 3
   *
   * _.size('curly');
   * // => 5
   */
  function size(collection) {
    var length = collection ? collection.length : 0;
    return typeof length == 'number' ? length : keys(collection).length;
  }

  /**
   * Checks if the `callback` returns a truthy value for **any** element of a
   * `collection`. The function returns as soon as it finds passing value, and
   * does not iterate over the entire `collection`. The `callback` is bound to
   * `thisArg` and invoked with three arguments; (value, index|key, collection).
   *
   * @static
   * @memberOf _
   * @alias any
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Boolean} Returns `true` if any element passes the callback check,
   *  else `false`.
   * @example
   *
   * _.some([null, 0, 'yes', false], Boolean);
   * // => true
   */
  function some(collection, callback, thisArg) {
    var result;
    callback = createCallback(callback, thisArg);

    if (isArray(collection)) {
      var index = -1,
          length = collection.length;

      while (++index < length) {
        if ((result = callback(collection[index], index, collection))) {
          break;
        }
      }
    } else {
      each(collection, function(value, index, collection) {
        return !(result = callback(value, index, collection));
      });
    }
    return !!result;
  }

  /**
   * Creates an array, stable sorted in ascending order by the results of
   * running each element of `collection` through a `callback`. The `callback`
   * is bound to `thisArg` and invoked with three arguments; (value, index|key, collection).
   * The `callback` argument may also be the name of a property to sort by (e.g. 'length').
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Function|String} callback|property The function called per iteration
   *  or property name to sort by.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a new array of sorted elements.
   * @example
   *
   * _.sortBy([1, 2, 3], function(num) { return Math.sin(num); });
   * // => [3, 1, 2]
   *
   * _.sortBy([1, 2, 3], function(num) { return this.sin(num); }, Math);
   * // => [3, 1, 2]
   *
   * _.sortBy(['larry', 'brendan', 'moe'], 'length');
   * // => ['moe', 'larry', 'brendan']
   */
  function sortBy(collection, callback, thisArg) {
    var result = [];
    callback = createCallback(callback, thisArg);

    forEach(collection, function(value, index, collection) {
      result.push({
        'criteria': callback(value, index, collection),
        'index': index,
        'value': value
      });
    });

    var length = result.length;
    result.sort(compareAscending);
    while (length--) {
      result[length] = result[length].value;
    }
    return result;
  }

  /**
   * Converts the `collection` to an array.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to convert.
   * @returns {Array} Returns the new converted array.
   * @example
   *
   * (function() { return _.toArray(arguments).slice(1); })(1, 2, 3, 4);
   * // => [2, 3, 4]
   */
  function toArray(collection) {
    var length = collection ? collection.length : 0;
    if (typeof length == 'number') {
      return noCharByIndex && isString(collection)
        ? collection.split('')
        : slice(collection);
    }
    return values(collection);
  }

  /**
   * Examines each element in a `collection`, returning an array of all elements
   * that contain the given `properties`.
   *
   * @static
   * @memberOf _
   * @category Collections
   * @param {Array|Object|String} collection The collection to iterate over.
   * @param {Object} properties The object of property values to filter by.
   * @returns {Array} Returns a new array of elements that contain the given `properties`.
   * @example
   *
   * var stooges = [
   *   { 'name': 'moe', 'age': 40 },
   *   { 'name': 'larry', 'age': 50 },
   *   { 'name': 'curly', 'age': 60 }
   * ];
   *
   * _.where(stooges, { 'age': 40 });
   * // => [{ 'name': 'moe', 'age': 40 }]
   */
  function where(collection, properties) {
    var props = keys(properties);
    return filter(collection, function(object) {
      var length = props.length;
      while (length--) {
        var result = object[props[length]] === properties[props[length]];
        if (!result) {
          break;
        }
      }
      return !!result;
    });
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Creates an array with all falsey values of `array` removed. The values
   * `false`, `null`, `0`, `""`, `undefined` and `NaN` are all falsey.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to compact.
   * @returns {Array} Returns a new filtered array.
   * @example
   *
   * _.compact([0, 1, false, 2, '', 3]);
   * // => [1, 2, 3]
   */
  function compact(array) {
    var index = -1,
        length = array ? array.length : 0,
        result = [];

    while (++index < length) {
      var value = array[index];
      if (value) {
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Creates an array of `array` elements not present in the other arrays
   * using strict equality for comparisons, i.e. `===`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to process.
   * @param {Array} [array1, array2, ...] Arrays to check.
   * @returns {Array} Returns a new array of `array` elements not present in the
   *  other arrays.
   * @example
   *
   * _.difference([1, 2, 3, 4, 5], [5, 2, 10]);
   * // => [1, 3, 4]
   */
  function difference(array) {
    var index = -1,
        length = array ? array.length : 0,
        flattened = concat.apply(arrayRef, arguments),
        contains = cachedContains(flattened, length),
        result = [];

    while (++index < length) {
      var value = array[index];
      if (!contains(value)) {
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Gets the first element of the `array`. Pass `n` to return the first `n`
   * elements of the `array`.
   *
   * @static
   * @memberOf _
   * @alias head, take
   * @category Arrays
   * @param {Array} array The array to query.
   * @param {Number} [n] The number of elements to return.
   * @param- {Object} [guard] Internally used to allow this method to work with
   *  others like `_.map` without using their callback `index` argument for `n`.
   * @returns {Mixed} Returns the first element, or an array of the first `n`
   *  elements, of `array`.
   * @example
   *
   * _.first([5, 4, 3, 2, 1]);
   * // => 5
   */
  function first(array, n, guard) {
    if (array) {
      var length = array.length;
      return (n == null || guard)
        ? array[0]
        : slice(array, 0, nativeMin(nativeMax(0, n), length));
    }
  }

  /**
   * Flattens a nested array (the nesting can be to any depth). If `shallow` is
   * truthy, `array` will only be flattened a single level.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to compact.
   * @param {Boolean} shallow A flag to indicate only flattening a single level.
   * @returns {Array} Returns a new flattened array.
   * @example
   *
   * _.flatten([1, [2], [3, [[4]]]]);
   * // => [1, 2, 3, 4];
   *
   * _.flatten([1, [2], [3, [[4]]]], true);
   * // => [1, 2, 3, [[4]]];
   */
  function flatten(array, shallow) {
    var index = -1,
        length = array ? array.length : 0,
        result = [];

    while (++index < length) {
      var value = array[index];

      // recursively flatten arrays (susceptible to call stack limits)
      if (isArray(value)) {
        push.apply(result, shallow ? value : flatten(value));
      } else {
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Gets the index at which the first occurrence of `value` is found using
   * strict equality for comparisons, i.e. `===`. If the `array` is already
   * sorted, passing `true` for `fromIndex` will run a faster binary search.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to search.
   * @param {Mixed} value The value to search for.
   * @param {Boolean|Number} [fromIndex=0] The index to search from or `true` to
   *  perform a binary search on a sorted `array`.
   * @returns {Number} Returns the index of the matched value or `-1`.
   * @example
   *
   * _.indexOf([1, 2, 3, 1, 2, 3], 2);
   * // => 1
   *
   * _.indexOf([1, 2, 3, 1, 2, 3], 2, 3);
   * // => 4
   *
   * _.indexOf([1, 1, 2, 2, 3, 3], 2, true);
   * // => 2
   */
  function indexOf(array, value, fromIndex) {
    var index = -1,
        length = array ? array.length : 0;

    if (typeof fromIndex == 'number') {
      index = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex || 0) - 1;
    } else if (fromIndex) {
      index = sortedIndex(array, value);
      return array[index] === value ? index : -1;
    }
    while (++index < length) {
      if (array[index] === value) {
        return index;
      }
    }
    return -1;
  }

  /**
   * Gets all but the last element of `array`. Pass `n` to exclude the last `n`
   * elements from the result.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to query.
   * @param {Number} [n=1] The number of elements to exclude.
   * @param- {Object} [guard] Internally used to allow this method to work with
   *  others like `_.map` without using their callback `index` argument for `n`.
   * @returns {Array} Returns all but the last element, or `n` elements, of `array`.
   * @example
   *
   * _.initial([3, 2, 1]);
   * // => [3, 2]
   */
  function initial(array, n, guard) {
    if (!array) {
      return [];
    }
    var length = array.length;
    n = n == null || guard ? 1 : n || 0;
    return slice(array, 0, nativeMin(nativeMax(0, length - n), length));
  }

  /**
   * Computes the intersection of all the passed-in arrays using strict equality
   * for comparisons, i.e. `===`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} [array1, array2, ...] Arrays to process.
   * @returns {Array} Returns a new array of unique elements that are present
   *  in **all** of the arrays.
   * @example
   *
   * _.intersection([1, 2, 3], [101, 2, 1, 10], [2, 1]);
   * // => [1, 2]
   */
  function intersection(array) {
    var args = arguments,
        argsLength = args.length,
        cache = { '0': {} },
        index = -1,
        length = array ? array.length : 0,
        isLarge = length >= 100,
        result = [],
        seen = result;

    outer:
    while (++index < length) {
      var value = array[index];
      if (isLarge) {
        var key = value + '';
        var inited = hasOwnProperty.call(cache[0], key)
          ? !(seen = cache[0][key])
          : (seen = cache[0][key] = []);
      }
      if (inited || indexOf(seen, value) < 0) {
        if (isLarge) {
          seen.push(value);
        }
        var argsIndex = argsLength;
        while (--argsIndex) {
          if (!(cache[argsIndex] || (cache[argsIndex] = cachedContains(args[argsIndex], 0, 100)))(value)) {
            continue outer;
          }
        }
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Gets the last element of the `array`. Pass `n` to return the last `n`
   * elements of the `array`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to query.
   * @param {Number} [n] The number of elements to return.
   * @param- {Object} [guard] Internally used to allow this method to work with
   *  others like `_.map` without using their callback `index` argument for `n`.
   * @returns {Mixed} Returns the last element, or an array of the last `n`
   *  elements, of `array`.
   * @example
   *
   * _.last([3, 2, 1]);
   * // => 1
   */
  function last(array, n, guard) {
    if (array) {
      var length = array.length;
      return (n == null || guard) ? array[length - 1] : slice(array, nativeMax(0, length - n));
    }
  }

  /**
   * Gets the index at which the last occurrence of `value` is found using strict
   * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used
   * as the offset from the end of the collection.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to search.
   * @param {Mixed} value The value to search for.
   * @param {Number} [fromIndex=array.length-1] The index to search from.
   * @returns {Number} Returns the index of the matched value or `-1`.
   * @example
   *
   * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2);
   * // => 4
   *
   * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2, 3);
   * // => 1
   */
  function lastIndexOf(array, value, fromIndex) {
    var index = array ? array.length : 0;
    if (typeof fromIndex == 'number') {
      index = (fromIndex < 0 ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1;
    }
    while (index--) {
      if (array[index] === value) {
        return index;
      }
    }
    return -1;
  }

  /**
   * Creates an object composed from arrays of `keys` and `values`. Pass either
   * a single two dimensional array, i.e. `[[key1, value1], [key2, value2]]`, or
   * two arrays, one of `keys` and one of corresponding `values`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} keys The array of keys.
   * @param {Array} [values=[]] The array of values.
   * @returns {Object} Returns an object composed of the given keys and
   *  corresponding values.
   * @example
   *
   * _.object(['moe', 'larry', 'curly'], [30, 40, 50]);
   * // => { 'moe': 30, 'larry': 40, 'curly': 50 }
   */
  function object(keys, values) {
    var index = -1,
        length = keys ? keys.length : 0,
        result = {};

    while (++index < length) {
      var key = keys[index];
      if (values) {
        result[key] = values[index];
      } else {
        result[key[0]] = key[1];
      }
    }
    return result;
  }

  /**
   * Creates an array of numbers (positive and/or negative) progressing from
   * `start` up to but not including `stop`. This method is a port of Python's
   * `range()` function. See http://docs.python.org/library/functions.html#range.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Number} [start=0] The start of the range.
   * @param {Number} end The end of the range.
   * @param {Number} [step=1] The value to increment or descrement by.
   * @returns {Array} Returns a new range array.
   * @example
   *
   * _.range(10);
   * // => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
   *
   * _.range(1, 11);
   * // => [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
   *
   * _.range(0, 30, 5);
   * // => [0, 5, 10, 15, 20, 25]
   *
   * _.range(0, -10, -1);
   * // => [0, -1, -2, -3, -4, -5, -6, -7, -8, -9]
   *
   * _.range(0);
   * // => []
   */
  function range(start, end, step) {
    start = +start || 0;
    step = +step || 1;

    if (end == null) {
      end = start;
      start = 0;
    }
    // use `Array(length)` so V8 will avoid the slower "dictionary" mode
    // http://youtu.be/XAqIpGU8ZZk#t=17m25s
    var index = -1,
        length = nativeMax(0, ceil((end - start) / step)),
        result = Array(length);

    while (++index < length) {
      result[index] = start;
      start += step;
    }
    return result;
  }

  /**
   * The opposite of `_.initial`, this method gets all but the first value of
   * `array`. Pass `n` to exclude the first `n` values from the result.
   *
   * @static
   * @memberOf _
   * @alias drop, tail
   * @category Arrays
   * @param {Array} array The array to query.
   * @param {Number} [n=1] The number of elements to exclude.
   * @param- {Object} [guard] Internally used to allow this method to work with
   *  others like `_.map` without using their callback `index` argument for `n`.
   * @returns {Array} Returns all but the first element, or `n` elements, of `array`.
   * @example
   *
   * _.rest([3, 2, 1]);
   * // => [2, 1]
   */
  function rest(array, n, guard) {
    return slice(array, (n == null || guard) ? 1 : nativeMax(0, n));
  }

  /**
   * Uses a binary search to determine the smallest index at which the `value`
   * should be inserted into `array` in order to maintain the sort order of the
   * sorted `array`. If `callback` is passed, it will be executed for `value` and
   * each element in `array` to compute their sort ranking. The `callback` is
   * bound to `thisArg` and invoked with one argument; (value). The `callback`
   * argument may also be the name of a property to order by.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to iterate over.
   * @param {Mixed} value The value to evaluate.
   * @param {Function|String} [callback=identity|property] The function called
   *  per iteration or property name to order by.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Number} Returns the index at which the value should be inserted
   *  into `array`.
   * @example
   *
   * _.sortedIndex([20, 30, 50], 40);
   * // => 2
   *
   * _.sortedIndex([{ 'x': 20 }, { 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');
   * // => 2
   *
   * var dict = {
   *   'wordToNumber': { 'twenty': 20, 'thirty': 30, 'fourty': 40, 'fifty': 50 }
   * };
   *
   * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {
   *   return dict.wordToNumber[word];
   * });
   * // => 2
   *
   * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {
   *   return this.wordToNumber[word];
   * }, dict);
   * // => 2
   */
  function sortedIndex(array, value, callback, thisArg) {
    var low = 0,
        high = array ? array.length : low;

    // explicitly reference `identity` for better inlining in Firefox
    callback = callback ? createCallback(callback, thisArg) : identity;
    value = callback(value);

    while (low < high) {
      var mid = (low + high) >>> 1;
      callback(array[mid]) < value
        ? low = mid + 1
        : high = mid;
    }
    return low;
  }

  /**
   * Computes the union of the passed-in arrays using strict equality for
   * comparisons, i.e. `===`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} [array1, array2, ...] Arrays to process.
   * @returns {Array} Returns a new array of unique values, in order, that are
   *  present in one or more of the arrays.
   * @example
   *
   * _.union([1, 2, 3], [101, 2, 1, 10], [2, 1]);
   * // => [1, 2, 3, 101, 10]
   */
  function union() {
    return uniq(concat.apply(arrayRef, arguments));
  }

  /**
   * Creates a duplicate-value-free version of the `array` using strict equality
   * for comparisons, i.e. `===`. If the `array` is already sorted, passing `true`
   * for `isSorted` will run a faster algorithm. If `callback` is passed, each
   * element of `array` is passed through a callback` before uniqueness is computed.
   * The `callback` is bound to `thisArg` and invoked with three arguments; (value, index, array).
   *
   * @static
   * @memberOf _
   * @alias unique
   * @category Arrays
   * @param {Array} array The array to process.
   * @param {Boolean} [isSorted=false] A flag to indicate that the `array` is already sorted.
   * @param {Function} [callback=identity] The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a duplicate-value-free array.
   * @example
   *
   * _.uniq([1, 2, 1, 3, 1]);
   * // => [1, 2, 3]
   *
   * _.uniq([1, 1, 2, 2, 3], true);
   * // => [1, 2, 3]
   *
   * _.uniq([1, 2, 1.5, 3, 2.5], function(num) { return Math.floor(num); });
   * // => [1, 2, 3]
   *
   * _.uniq([1, 2, 1.5, 3, 2.5], function(num) { return this.floor(num); }, Math);
   * // => [1, 2, 3]
   */
  function uniq(array, isSorted, callback, thisArg) {
    var index = -1,
        length = array ? array.length : 0,
        result = [],
        seen = result;

    // juggle arguments
    if (typeof isSorted == 'function') {
      thisArg = callback;
      callback = isSorted;
      isSorted = false;
    }
    // init value cache for large arrays
    var isLarge = !isSorted && length >= 75;
    if (isLarge) {
      var cache = {};
    }
    if (callback) {
      seen = [];
      callback = createCallback(callback, thisArg);
    }
    while (++index < length) {
      var value = array[index],
          computed = callback ? callback(value, index, array) : value;

      if (isLarge) {
        var key = computed + '';
        var inited = hasOwnProperty.call(cache, key)
          ? !(seen = cache[key])
          : (seen = cache[key] = []);
      }
      if (isSorted
            ? !index || seen[seen.length - 1] !== computed
            : inited || indexOf(seen, computed) < 0
          ) {
        if (callback || isLarge) {
          seen.push(computed);
        }
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Creates an array with all occurrences of the passed values removed using
   * strict equality for comparisons, i.e. `===`.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} array The array to filter.
   * @param {Mixed} [value1, value2, ...] Values to remove.
   * @returns {Array} Returns a new filtered array.
   * @example
   *
   * _.without([1, 2, 1, 0, 3, 1, 4], 0, 1);
   * // => [2, 3, 4]
   */
  function without(array) {
    var index = -1,
        length = array ? array.length : 0,
        contains = cachedContains(arguments, 1, 20),
        result = [];

    while (++index < length) {
      var value = array[index];
      if (!contains(value)) {
        result.push(value);
      }
    }
    return result;
  }

  /**
   * Groups the elements of each array at their corresponding indexes. Useful for
   * separate data sources that are coordinated through matching array indexes.
   * For a matrix of nested arrays, `_.zip.apply(...)` can transpose the matrix
   * in a similar fashion.
   *
   * @static
   * @memberOf _
   * @category Arrays
   * @param {Array} [array1, array2, ...] Arrays to process.
   * @returns {Array} Returns a new array of grouped elements.
   * @example
   *
   * _.zip(['moe', 'larry', 'curly'], [30, 40, 50], [true, false, false]);
   * // => [['moe', 30, true], ['larry', 40, false], ['curly', 50, false]]
   */
  function zip(array) {
    var index = -1,
        length = array ? max(pluck(arguments, 'length')) : 0,
        result = Array(length);

    while (++index < length) {
      result[index] = pluck(arguments, index);
    }
    return result;
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Creates a function that is restricted to executing `func` only after it is
   * called `n` times. The `func` is executed with the `this` binding of the
   * created function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Number} n The number of times the function must be called before
   * it is executed.
   * @param {Function} func The function to restrict.
   * @returns {Function} Returns the new restricted function.
   * @example
   *
   * var renderNotes = _.after(notes.length, render);
   * _.forEach(notes, function(note) {
   *   note.asyncSave({ 'success': renderNotes });
   * });
   * // `renderNotes` is run once, after all notes have saved
   */
  function after(n, func) {
    if (n < 1) {
      return func();
    }
    return function() {
      if (--n < 1) {
        return func.apply(this, arguments);
      }
    };
  }

  /**
   * Creates a function that, when called, invokes `func` with the `this`
   * binding of `thisArg` and prepends any additional `bind` arguments to those
   * passed to the bound function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to bind.
   * @param {Mixed} [thisArg] The `this` binding of `func`.
   * @param {Mixed} [arg1, arg2, ...] Arguments to be partially applied.
   * @returns {Function} Returns the new bound function.
   * @example
   *
   * var func = function(greeting) {
   *   return greeting + ' ' + this.name;
   * };
   *
   * func = _.bind(func, { 'name': 'moe' }, 'hi');
   * func();
   * // => 'hi moe'
   */
  function bind(func, thisArg) {
    // use `Function#bind` if it exists and is fast
    // (in V8 `Function#bind` is slower except when partially applied)
    return isBindFast || (nativeBind && arguments.length > 2)
      ? nativeBind.call.apply(nativeBind, arguments)
      : createBound(func, thisArg, slice(arguments, 2));
  }

  /**
   * Binds methods on `object` to `object`, overwriting the existing method.
   * If no method names are provided, all the function properties of `object`
   * will be bound.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Object} object The object to bind and assign the bound methods to.
   * @param {String} [methodName1, methodName2, ...] Method names on the object to bind.
   * @returns {Object} Returns `object`.
   * @example
   *
   * var buttonView = {
   *  'label': 'lodash',
   *  'onClick': function() { alert('clicked: ' + this.label); }
   * };
   *
   * _.bindAll(buttonView);
   * jQuery('#lodash_button').on('click', buttonView.onClick);
   * // => When the button is clicked, `this.label` will have the correct value
   */
  function bindAll(object) {
    var funcs = arguments,
        index = funcs.length > 1 ? 0 : (funcs = functions(object), -1),
        length = funcs.length;

    while (++index < length) {
      var key = funcs[index];
      object[key] = bind(object[key], object);
    }
    return object;
  }

  /**
   * Creates a function that, when called, invokes the method at `object[key]`
   * and prepends any additional `bindKey` arguments to those passed to the bound
   * function. This method differs from `_.bind` by allowing bound functions to
   * reference methods that will be redefined or don't yet exist.
   * See http://michaux.ca/articles/lazy-function-definition-pattern.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Object} object The object the method belongs to.
   * @param {String} key The key of the method.
   * @param {Mixed} [arg1, arg2, ...] Arguments to be partially applied.
   * @returns {Function} Returns the new bound function.
   * @example
   *
   * var object = {
   *   'name': 'moe',
   *   'greet': function(greeting) {
   *     return greeting + ' ' + this.name;
   *   }
   * };
   *
   * var func = _.bindKey(object, 'greet', 'hi');
   * func();
   * // => 'hi moe'
   *
   * object.greet = function(greeting) {
   *   return greeting + ', ' + this.name + '!';
   * };
   *
   * func();
   * // => 'hi, moe!'
   */
  function bindKey(object, key) {
    return createBound(object, key, slice(arguments, 2));
  }

  /**
   * Creates a function that is the composition of the passed functions,
   * where each function consumes the return value of the function that follows.
   * In math terms, composing the functions `f()`, `g()`, and `h()` produces `f(g(h()))`.
   * Each function is executed with the `this` binding of the composed function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} [func1, func2, ...] Functions to compose.
   * @returns {Function} Returns the new composed function.
   * @example
   *
   * var greet = function(name) { return 'hi: ' + name; };
   * var exclaim = function(statement) { return statement + '!'; };
   * var welcome = _.compose(exclaim, greet);
   * welcome('moe');
   * // => 'hi: moe!'
   */
  function compose() {
    var funcs = arguments;
    return function() {
      var args = arguments,
          length = funcs.length;

      while (length--) {
        args = [funcs[length].apply(this, args)];
      }
      return args[0];
    };
  }

  /**
   * Creates a function that will delay the execution of `func` until after
   * `wait` milliseconds have elapsed since the last time it was invoked. Pass
   * `true` for `immediate` to cause debounce to invoke `func` on the leading,
   * instead of the trailing, edge of the `wait` timeout. Subsequent calls to
   * the debounced function will return the result of the last `func` call.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to debounce.
   * @param {Number} wait The number of milliseconds to delay.
   * @param {Boolean} immediate A flag to indicate execution is on the leading
   *  edge of the timeout.
   * @returns {Function} Returns the new debounced function.
   * @example
   *
   * var lazyLayout = _.debounce(calculateLayout, 300);
   * jQuery(window).on('resize', lazyLayout);
   */
  function debounce(func, wait, immediate) {
    var args,
        result,
        thisArg,
        timeoutId;

    function delayed() {
      timeoutId = null;
      if (!immediate) {
        result = func.apply(thisArg, args);
      }
    }
    return function() {
      var isImmediate = immediate && !timeoutId;
      args = arguments;
      thisArg = this;

      clearTimeout(timeoutId);
      timeoutId = setTimeout(delayed, wait);

      if (isImmediate) {
        result = func.apply(thisArg, args);
      }
      return result;
    };
  }

  /**
   * Executes the `func` function after `wait` milliseconds. Additional arguments
   * will be passed to `func` when it is invoked.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to delay.
   * @param {Number} wait The number of milliseconds to delay execution.
   * @param {Mixed} [arg1, arg2, ...] Arguments to invoke the function with.
   * @returns {Number} Returns the `setTimeout` timeout id.
   * @example
   *
   * var log = _.bind(console.log, console);
   * _.delay(log, 1000, 'logged later');
   * // => 'logged later' (Appears after one second.)
   */
  function delay(func, wait) {
    var args = slice(arguments, 2);
    return setTimeout(function() { func.apply(undefined, args); }, wait);
  }

  /**
   * Defers executing the `func` function until the current call stack has cleared.
   * Additional arguments will be passed to `func` when it is invoked.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to defer.
   * @param {Mixed} [arg1, arg2, ...] Arguments to invoke the function with.
   * @returns {Number} Returns the `setTimeout` timeout id.
   * @example
   *
   * _.defer(function() { alert('deferred'); });
   * // returns from the function before `alert` is called
   */
  function defer(func) {
    var args = slice(arguments, 1);
    return setTimeout(function() { func.apply(undefined, args); }, 1);
  }

  /**
   * Creates a function that memoizes the result of `func`. If `resolver` is
   * passed, it will be used to determine the cache key for storing the result
   * based on the arguments passed to the memoized function. By default, the first
   * argument passed to the memoized function is used as the cache key. The `func`
   * is executed with the `this` binding of the memoized function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to have its output memoized.
   * @param {Function} [resolver] A function used to resolve the cache key.
   * @returns {Function} Returns the new memoizing function.
   * @example
   *
   * var fibonacci = _.memoize(function(n) {
   *   return n < 2 ? n : fibonacci(n - 1) + fibonacci(n - 2);
   * });
   */
  function memoize(func, resolver) {
    var cache = {};
    return function() {
      var key = resolver ? resolver.apply(this, arguments) : arguments[0];
      return hasOwnProperty.call(cache, key)
        ? cache[key]
        : (cache[key] = func.apply(this, arguments));
    };
  }

  /**
   * Creates a function that is restricted to execute `func` once. Repeat calls to
   * the function will return the value of the first call. The `func` is executed
   * with the `this` binding of the created function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to restrict.
   * @returns {Function} Returns the new restricted function.
   * @example
   *
   * var initialize = _.once(createApplication);
   * initialize();
   * initialize();
   * // Application is only created once.
   */
  function once(func) {
    var result,
        ran = false;

    return function() {
      if (ran) {
        return result;
      }
      ran = true;
      result = func.apply(this, arguments);

      // clear the `func` variable so the function may be garbage collected
      func = null;
      return result;
    };
  }

  /**
   * Creates a function that, when called, invokes `func` with any additional
   * `partial` arguments prepended to those passed to the new function. This
   * method is similar to `bind`, except it does **not** alter the `this` binding.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to partially apply arguments to.
   * @param {Mixed} [arg1, arg2, ...] Arguments to be partially applied.
   * @returns {Function} Returns the new partially applied function.
   * @example
   *
   * var greet = function(greeting, name) { return greeting + ': ' + name; };
   * var hi = _.partial(greet, 'hi');
   * hi('moe');
   * // => 'hi: moe'
   */
  function partial(func) {
    return createBound(func, slice(arguments, 1));
  }

  /**
   * Creates a function that, when executed, will only call the `func`
   * function at most once per every `wait` milliseconds. If the throttled
   * function is invoked more than once during the `wait` timeout, `func` will
   * also be called on the trailing edge of the timeout. Subsequent calls to the
   * throttled function will return the result of the last `func` call.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Function} func The function to throttle.
   * @param {Number} wait The number of milliseconds to throttle executions to.
   * @returns {Function} Returns the new throttled function.
   * @example
   *
   * var throttled = _.throttle(updatePosition, 100);
   * jQuery(window).on('scroll', throttled);
   */
  function throttle(func, wait) {
    var args,
        result,
        thisArg,
        timeoutId,
        lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
          remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      }
      else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  }

  /**
   * Creates a function that passes `value` to the `wrapper` function as its
   * first argument. Additional arguments passed to the function are appended
   * to those passed to the `wrapper` function. The `wrapper` is executed with
   * the `this` binding of the created function.
   *
   * @static
   * @memberOf _
   * @category Functions
   * @param {Mixed} value The value to wrap.
   * @param {Function} wrapper The wrapper function.
   * @returns {Function} Returns the new function.
   * @example
   *
   * var hello = function(name) { return 'hello ' + name; };
   * hello = _.wrap(hello, function(func) {
   *   return 'before, ' + func('moe') + ', after';
   * });
   * hello();
   * // => 'before, hello moe, after'
   */
  function wrap(value, wrapper) {
    return function() {
      var args = [value];
      push.apply(args, arguments);
      return wrapper.apply(this, args);
    };
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Converts the characters `&`, `<`, `>`, `"`, and `'` in `string` to their
   * corresponding HTML entities.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {String} string The string to escape.
   * @returns {String} Returns the escaped string.
   * @example
   *
   * _.escape('Moe, Larry & Curly');
   * // => 'Moe, Larry &amp; Curly'
   */
  function escape(string) {
    return string == null ? '' : (string + '').replace(reUnescapedHtml, escapeHtmlChar);
  }

  /**
   * This function returns the first argument passed to it.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Mixed} value Any value.
   * @returns {Mixed} Returns `value`.
   * @example
   *
   * var moe = { 'name': 'moe' };
   * moe === _.identity(moe);
   * // => true
   */
  function identity(value) {
    return value;
  }

  /**
   * Adds functions properties of `object` to the `lodash` function and chainable
   * wrapper.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Object} object The object of function properties to add to `lodash`.
   * @example
   *
   * _.mixin({
   *   'capitalize': function(string) {
   *     return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();
   *   }
   * });
   *
   * _.capitalize('larry');
   * // => 'Larry'
   *
   * _('curly').capitalize();
   * // => 'Curly'
   */
  function mixin(object) {
    forEach(functions(object), function(methodName) {
      var func = lodash[methodName] = object[methodName];

      lodash.prototype[methodName] = function() {
        var args = [this.__wrapped__];
        push.apply(args, arguments);

        var result = func.apply(lodash, args);
        return new lodash(result);
      };
    });
  }

  /**
   * Reverts the '_' variable to its previous value and returns a reference to
   * the `lodash` function.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @returns {Function} Returns the `lodash` function.
   * @example
   *
   * var lodash = _.noConflict();
   */
  function noConflict() {
    window._ = oldDash;
    return this;
  }

  /**
   * Produces a random number between `min` and `max` (inclusive). If only one
   * argument is passed, a number between `0` and the given number will be returned.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Number} [min=0] The minimum possible value.
   * @param {Number} [max=1] The maximum possible value.
   * @returns {Number} Returns a random number.
   * @example
   *
   * _.random(0, 5);
   * // => a number between 1 and 5
   *
   * _.random(5);
   * // => also a number between 1 and 5
   */
  function random(min, max) {
    if (min == null && max == null) {
      max = 1;
    }
    min = +min || 0;
    if (max == null) {
      max = min;
      min = 0;
    }
    return min + floor(nativeRandom() * ((+max || 0) - min + 1));
  }

  /**
   * Resolves the value of `property` on `object`. If `property` is a function
   * it will be invoked and its result returned, else the property value is
   * returned. If `object` is falsey, then `null` is returned.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Object} object The object to inspect.
   * @param {String} property The property to get the value of.
   * @returns {Mixed} Returns the resolved value.
   * @example
   *
   * var object = {
   *   'cheese': 'crumpets',
   *   'stuff': function() {
   *     return 'nonsense';
   *   }
   * };
   *
   * _.result(object, 'cheese');
   * // => 'crumpets'
   *
   * _.result(object, 'stuff');
   * // => 'nonsense'
   */
  function result(object, property) {
    // based on Backbone's private `getValue` function
    // https://github.com/documentcloud/backbone/blob/0.9.2/backbone.js#L1419-1424
    var value = object ? object[property] : null;
    return isFunction(value) ? object[property]() : value;
  }

  /**
   * A micro-templating method that handles arbitrary delimiters, preserves
   * whitespace, and correctly escapes quotes within interpolated code.
   *
   * Note: In the development build `_.template` utilizes sourceURLs for easier
   * debugging. See http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl
   *
   * Note: Lo-Dash may be used in Chrome extensions by either creating a `lodash csp`
   * build and avoiding `_.template` use, or loading Lo-Dash in a sandboxed page.
   * See http://developer.chrome.com/trunk/extensions/sandboxingEval.html
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {String} text The template text.
   * @param {Obect} data The data object used to populate the text.
   * @param {Object} options The options object.
   *  escape - The "escape" delimiter regexp.
   *  evaluate - The "evaluate" delimiter regexp.
   *  interpolate - The "interpolate" delimiter regexp.
   *  sourceURL - The sourceURL of the template's compiled source.
   *  variable - The data object variable name.
   *
   * @returns {Function|String} Returns a compiled function when no `data` object
   *  is given, else it returns the interpolated text.
   * @example
   *
   * // using a compiled template
   * var compiled = _.template('hello <%= name %>');
   * compiled({ 'name': 'moe' });
   * // => 'hello moe'
   *
   * var list = '<% _.forEach(people, function(name) { %><li><%= name %></li><% }); %>';
   * _.template(list, { 'people': ['moe', 'larry', 'curly'] });
   * // => '<li>moe</li><li>larry</li><li>curly</li>'
   *
   * // using the "escape" delimiter to escape HTML in data property values
   * _.template('<b><%- value %></b>', { 'value': '<script>' });
   * // => '<b>&lt;script&gt;</b>'
   *
   * // using the ES6 delimiter as an alternative to the default "interpolate" delimiter
   * _.template('hello ${ name }', { 'name': 'curly' });
   * // => 'hello curly'
   *
   * // using the internal `print` function in "evaluate" delimiters
   * _.template('<% print("hello " + epithet); %>!', { 'epithet': 'stooge' });
   * // => 'hello stooge!'
   *
   * // using custom template delimiters
   * _.templateSettings = {
   *   'interpolate': /{{([\s\S]+?)}}/g
   * };
   *
   * _.template('hello {{ name }}!', { 'name': 'mustache' });
   * // => 'hello mustache!'
   *
   * // using the `sourceURL` option to specify a custom sourceURL for the template
   * var compiled = _.template('hello <%= name %>', null, { 'sourceURL': '/basic/greeting.jst' });
   * compiled(data);
   * // => find the source of "greeting.jst" under the Sources tab or Resources panel of the web inspector
   *
   * // using the `variable` option to ensure a with-statement isn't used in the compiled template
   * var compiled = _.template('hello <%= data.name %>!', null, { 'variable': 'data' });
   * compiled.source;
   * // => function(data) {
   *   var __t, __p = '', __e = _.escape;
   *   __p += 'hello ' + ((__t = ( data.name )) == null ? '' : __t) + '!';
   *   return __p;
   * }
   *
   * // using the `source` property to inline compiled templates for meaningful
   * // line numbers in error messages and a stack trace
   * fs.writeFileSync(path.join(cwd, 'jst.js'), '\
   *   var JST = {\
   *     "main": ' + _.template(mainText).source + '\
   *   };\
   * ');
   */
  function template(text, data, options) {
    // based on John Resig's `tmpl` implementation
    // http://ejohn.org/blog/javascript-micro-templating/
    // and Laura Doktorova's doT.js
    // https://github.com/olado/doT
    text || (text = '');
    options || (options = {});

    var isEvaluating,
        result,
        settings = lodash.templateSettings,
        index = 0,
        interpolate = options.interpolate || settings.interpolate || reNoMatch,
        source = "__p += '",
        variable = options.variable || settings.variable,
        hasVariable = variable;

    // compile regexp to match each delimiter
    var reDelimiters = RegExp(
      (options.escape || settings.escape || reNoMatch).source + '|' +
      interpolate.source + '|' +
      (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +
      (options.evaluate || settings.evaluate || reNoMatch).source + '|$'
    , 'g');

    text.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {
      interpolateValue || (interpolateValue = esTemplateValue);

      // escape characters that cannot be included in string literals
      source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar);

      // replace delimiters with snippets
      if (escapeValue) {
        source += "' +\n__e(" + escapeValue + ") +\n'";
      }
      if (evaluateValue) {
        source += "';\n" + evaluateValue + ";\n__p += '";
      }
      if (interpolateValue) {
        source += "' +\n((__t = (" + interpolateValue + ")) == null ? '' : __t) +\n'";
      }
      isEvaluating || (isEvaluating = evaluateValue || reComplexDelimiter.test(escapeValue || interpolateValue));
      index = offset + match.length;

      // the JS engine embedded in Adobe products requires returning the `match`
      // string in order to produce the correct `offset` value
      return match;
    });

    source += "';\n";

    // if `variable` is not specified and the template contains "evaluate"
    // delimiters, wrap a with-statement around the generated code to add the
    // data object to the top of the scope chain
    if (!hasVariable) {
      variable = 'obj';
      if (isEvaluating) {
        source = 'with (' + variable + ') {\n' + source + '\n}\n';
      }
      else {
        // avoid a with-statement by prepending data object references to property names
        var reDoubleVariable = RegExp('(\\(\\s*)' + variable + '\\.' + variable + '\\b', 'g');
        source = source
          .replace(reInsertVariable, '$&' + variable + '.')
          .replace(reDoubleVariable, '$1__d');
      }
    }

    // cleanup code by stripping empty strings
    source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)
      .replace(reEmptyStringMiddle, '$1')
      .replace(reEmptyStringTrailing, '$1;');

    // frame code as the function body
    source = 'function(' + variable + ') {\n' +
      (hasVariable ? '' : variable + ' || (' + variable + ' = {});\n') +
      "var __t, __p = '', __e = _.escape" +
      (isEvaluating
        ? ', __j = Array.prototype.join;\n' +
          "function print() { __p += __j.call(arguments, '') }\n"
        : (hasVariable ? '' : ', __d = ' + variable + '.' + variable + ' || ' + variable) + ';\n'
      ) +
      source +
      'return __p\n}';

    // use a sourceURL for easier debugging
    // http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl
    var sourceURL = useSourceURL
      ? '\n//@ sourceURL=' + (options.sourceURL || '/lodash/template/source[' + (templateCounter++) + ']')
      : '';

    try {
      result = Function('_', 'return ' + source + sourceURL)(lodash);
    } catch(e) {
      e.source = source;
      throw e;
    }

    if (data) {
      return result(data);
    }
    // provide the compiled function's source via its `toString` method, in
    // supported environments, or the `source` property as a convenience for
    // inlining compiled templates during the build process
    result.source = source;
    return result;
  }

  /**
   * Executes the `callback` function `n` times, returning an array of the results
   * of each `callback` execution. The `callback` is bound to `thisArg` and invoked
   * with one argument; (index).
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {Number} n The number of times to execute the callback.
   * @param {Function} callback The function called per iteration.
   * @param {Mixed} [thisArg] The `this` binding of `callback`.
   * @returns {Array} Returns a new array of the results of each `callback` execution.
   * @example
   *
   * var diceRolls = _.times(3, _.partial(_.random, 1, 6));
   * // => [3, 6, 4]
   *
   * _.times(3, function(n) { mage.castSpell(n); });
   * // => calls `mage.castSpell(n)` three times, passing `n` of `0`, `1`, and `2` respectively
   *
   * _.times(3, function(n) { this.cast(n); }, mage);
   * // => also calls `mage.castSpell(n)` three times
   */
  function times(n, callback, thisArg) {
    n = +n || 0;
    var index = -1,
        result = Array(n);

    while (++index < n) {
      result[index] = callback.call(thisArg, index);
    }
    return result;
  }

  /**
   * The opposite of `_.escape`, this method converts the HTML entities
   * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#x27;` in `string` to their
   * corresponding characters.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {String} string The string to unescape.
   * @returns {String} Returns the unescaped string.
   * @example
   *
   * _.unescape('Moe, Larry &amp; Curly');
   * // => 'Moe, Larry & Curly'
   */
  function unescape(string) {
    return string == null ? '' : (string + '').replace(reEscapedHtml, unescapeHtmlChar);
  }

  /**
   * Generates a unique ID. If `prefix` is passed, the ID will be appended to it.
   *
   * @static
   * @memberOf _
   * @category Utilities
   * @param {String} [prefix] The value to prefix the ID with.
   * @returns {String} Returns the unique ID.
   * @example
   *
   * _.uniqueId('contact_');
   * // => 'contact_104'
   *
   * _.uniqueId();
   * // => '105'
   */
  function uniqueId(prefix) {
    return (prefix == null ? '' : prefix + '') + (++idCounter);
  }

  /*--------------------------------------------------------------------------*/

  /**
   * Invokes `interceptor` with the `value` as the first argument, and then
   * returns `value`. The purpose of this method is to "tap into" a method chain,
   * in order to perform operations on intermediate results within the chain.
   *
   * @static
   * @memberOf _
   * @category Chaining
   * @param {Mixed} value The value to pass to `interceptor`.
   * @param {Function} interceptor The function to invoke.
   * @returns {Mixed} Returns `value`.
   * @example
   *
   * _.chain([1, 2, 3, 200])
   *  .filter(function(num) { return num % 2 == 0; })
   *  .tap(alert)
   *  .map(function(num) { return num * num; })
   *  .value();
   * // => // [2, 200] (alerted)
   * // => [4, 40000]
   */
  function tap(value, interceptor) {
    interceptor(value);
    return value;
  }

  /**
   * Produces the `toString` result of the wrapped value.
   *
   * @name toString
   * @memberOf _
   * @category Chaining
   * @returns {String} Returns the string result.
   * @example
   *
   * _([1, 2, 3]).toString();
   * // => '1,2,3'
   */
  function wrapperToString() {
    return this.__wrapped__ + '';
  }

  /**
   * Extracts the wrapped value.
   *
   * @name valueOf
   * @memberOf _
   * @alias value
   * @category Chaining
   * @returns {Mixed} Returns the wrapped value.
   * @example
   *
   * _([1, 2, 3]).valueOf();
   * // => [1, 2, 3]
   */
  function wrapperValueOf() {
    return this.__wrapped__;
  }

  /*--------------------------------------------------------------------------*/

  // add functions that return wrapped values when chaining
  lodash.after = after;
  lodash.assign = assign;
  lodash.bind = bind;
  lodash.bindAll = bindAll;
  lodash.bindKey = bindKey;
  lodash.compact = compact;
  lodash.compose = compose;
  lodash.countBy = countBy;
  lodash.debounce = debounce;
  lodash.defaults = defaults;
  lodash.defer = defer;
  lodash.delay = delay;
  lodash.difference = difference;
  lodash.filter = filter;
  lodash.flatten = flatten;
  lodash.forEach = forEach;
  lodash.forIn = forIn;
  lodash.forOwn = forOwn;
  lodash.functions = functions;
  lodash.groupBy = groupBy;
  lodash.initial = initial;
  lodash.intersection = intersection;
  lodash.invert = invert;
  lodash.invoke = invoke;
  lodash.keys = keys;
  lodash.map = map;
  lodash.max = max;
  lodash.memoize = memoize;
  lodash.merge = merge;
  lodash.min = min;
  lodash.object = object;
  lodash.omit = omit;
  lodash.once = once;
  lodash.pairs = pairs;
  lodash.partial = partial;
  lodash.pick = pick;
  lodash.pluck = pluck;
  lodash.range = range;
  lodash.reject = reject;
  lodash.rest = rest;
  lodash.shuffle = shuffle;
  lodash.sortBy = sortBy;
  lodash.tap = tap;
  lodash.throttle = throttle;
  lodash.times = times;
  lodash.toArray = toArray;
  lodash.union = union;
  lodash.uniq = uniq;
  lodash.values = values;
  lodash.where = where;
  lodash.without = without;
  lodash.wrap = wrap;
  lodash.zip = zip;

  // add aliases
  lodash.collect = map;
  lodash.drop = rest;
  lodash.each = forEach;
  lodash.extend = assign;
  lodash.methods = functions;
  lodash.select = filter;
  lodash.tail = rest;
  lodash.unique = uniq;

  // add functions to `lodash.prototype`
  mixin(lodash);

  /*--------------------------------------------------------------------------*/

  // add functions that return unwrapped values when chaining
  lodash.clone = clone;
  lodash.cloneDeep = cloneDeep;
  lodash.contains = contains;
  lodash.escape = escape;
  lodash.every = every;
  lodash.find = find;
  lodash.has = has;
  lodash.identity = identity;
  lodash.indexOf = indexOf;
  lodash.isArguments = isArguments;
  lodash.isArray = isArray;
  lodash.isBoolean = isBoolean;
  lodash.isDate = isDate;
  lodash.isElement = isElement;
  lodash.isEmpty = isEmpty;
  lodash.isEqual = isEqual;
  lodash.isFinite = isFinite;
  lodash.isFunction = isFunction;
  lodash.isNaN = isNaN;
  lodash.isNull = isNull;
  lodash.isNumber = isNumber;
  lodash.isObject = isObject;
  lodash.isPlainObject = isPlainObject;
  lodash.isRegExp = isRegExp;
  lodash.isString = isString;
  lodash.isUndefined = isUndefined;
  lodash.lastIndexOf = lastIndexOf;
  lodash.mixin = mixin;
  lodash.noConflict = noConflict;
  lodash.random = random;
  lodash.reduce = reduce;
  lodash.reduceRight = reduceRight;
  lodash.result = result;
  lodash.size = size;
  lodash.some = some;
  lodash.sortedIndex = sortedIndex;
  lodash.template = template;
  lodash.unescape = unescape;
  lodash.uniqueId = uniqueId;

  // add aliases
  lodash.all = every;
  lodash.any = some;
  lodash.detect = find;
  lodash.foldl = reduce;
  lodash.foldr = reduceRight;
  lodash.include = contains;
  lodash.inject = reduce;

  forOwn(lodash, function(func, methodName) {
    if (!lodash.prototype[methodName]) {
      lodash.prototype[methodName] = function() {
        var args = [this.__wrapped__];
        push.apply(args, arguments);
        return func.apply(lodash, args);
      };
    }
  });

  /*--------------------------------------------------------------------------*/

  // add functions capable of returning wrapped and unwrapped values when chaining
  lodash.first = first;
  lodash.last = last;

  // add aliases
  lodash.take = first;
  lodash.head = first;

  forOwn(lodash, function(func, methodName) {
    if (!lodash.prototype[methodName]) {
      lodash.prototype[methodName]= function(n, guard) {
        var result = func(this.__wrapped__, n, guard);
        return (n == null || guard) ? result : new lodash(result);
      };
    }
  });

  /*--------------------------------------------------------------------------*/

  /**
   * The semantic version number.
   *
   * @static
   * @memberOf _
   * @type String
   */
  lodash.VERSION = '1.0.0-rc.3';

  // add "Chaining" functions to the wrapper
  lodash.prototype.toString = wrapperToString;
  lodash.prototype.value = wrapperValueOf;
  lodash.prototype.valueOf = wrapperValueOf;

  // add `Array` functions that return unwrapped values
  each(['join', 'pop', 'shift'], function(methodName) {
    var func = arrayRef[methodName];
    lodash.prototype[methodName] = function() {
      return func.apply(this.__wrapped__, arguments);
    };
  });

  // add `Array` functions that return the wrapped value
  each(['push', 'reverse', 'sort', 'unshift'], function(methodName) {
    var func = arrayRef[methodName];
    lodash.prototype[methodName] = function() {
      func.apply(this.__wrapped__, arguments);
      return this;
    };
  });

  // add `Array` functions that return new wrapped values
  each(['concat', 'slice', 'splice'], function(methodName) {
    var func = arrayRef[methodName];
    lodash.prototype[methodName] = function() {
      var result = func.apply(this.__wrapped__, arguments);
      return new lodash(result);
    };
  });

  // avoid array-like object bugs with `Array#shift` and `Array#splice`
  // in Firefox < 10 and IE < 9
  if (hasObjectSpliceBug) {
    each(['pop', 'shift', 'splice'], function(methodName) {
      var func = arrayRef[methodName],
          isSplice = methodName == 'splice';

      lodash.prototype[methodName] = function() {
        var value = this.__wrapped__,
            result = func.apply(value, arguments);

        if (value.length === 0) {
          delete value[0];
        }
        return isSplice ? new lodash(result) : result;
      };
    });
  }

  // add pseudo private property to be used and removed during the build process
  lodash._each = each;
  lodash._iteratorTemplate = iteratorTemplate;

  /*--------------------------------------------------------------------------*/

  // expose Lo-Dash
  // some AMD build optimizers, like r.js, check for specific condition patterns like the following:
  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {
    // Expose Lo-Dash to the global object even when an AMD loader is present in
    // case Lo-Dash was injected by a third-party script and not intended to be
    // loaded as a module. The global assignment can be reverted in the Lo-Dash
    // module via its `noConflict()` method.
    window._ = lodash;

    // define as an anonymous module so, through path mapping, it can be
    // referenced as the "underscore" module
    define(function() {
      return lodash;
    });
  }
  // check for `exports` after `define` in case a build optimizer adds an `exports` object
  else if (freeExports) {
    // in Node.js or RingoJS v0.8.0+
    if (typeof module == 'object' && module && module.exports == freeExports) {
      (module.exports = lodash)._ = lodash;
    }
    // in Narwhal or RingoJS v0.7.0-
    else {
      freeExports._ = lodash;
    }
  }
  else {
    // in a browser or Rhino
    window._ = lodash;
  }
}(this));

})(window)
},{}],19:[function(require,module,exports){

module.exports = jade = (function(exports){
/*!
 * Jade - runtime
 * Copyright(c) 2010 TJ Holowaychuk <tj@vision-media.ca>
 * MIT Licensed
 */

/**
 * Lame Array.isArray() polyfill for now.
 */

if (!Array.isArray) {
  Array.isArray = function(arr){
    return '[object Array]' == Object.prototype.toString.call(arr);
  };
}

/**
 * Lame Object.keys() polyfill for now.
 */

if (!Object.keys) {
  Object.keys = function(obj){
    var arr = [];
    for (var key in obj) {
      if (obj.hasOwnProperty(key)) {
        arr.push(key);
      }
    }
    return arr;
  }
}

/**
 * Merge two attribute objects giving precedence
 * to values in object `b`. Classes are special-cased
 * allowing for arrays and merging/joining appropriately
 * resulting in a string.
 *
 * @param {Object} a
 * @param {Object} b
 * @return {Object} a
 * @api private
 */

exports.merge = function merge(a, b) {
  var ac = a['class'];
  var bc = b['class'];

  if (ac || bc) {
    ac = ac || [];
    bc = bc || [];
    if (!Array.isArray(ac)) ac = [ac];
    if (!Array.isArray(bc)) bc = [bc];
    ac = ac.filter(nulls);
    bc = bc.filter(nulls);
    a['class'] = ac.concat(bc).join(' ');
  }

  for (var key in b) {
    if (key != 'class') {
      a[key] = b[key];
    }
  }

  return a;
};

/**
 * Filter null `val`s.
 *
 * @param {Mixed} val
 * @return {Mixed}
 * @api private
 */

function nulls(val) {
  return val != null;
}

/**
 * Render the given attributes object.
 *
 * @param {Object} obj
 * @param {Object} escaped
 * @return {String}
 * @api private
 */

exports.attrs = function attrs(obj, escaped){
  var buf = []
    , terse = obj.terse;

  delete obj.terse;
  var keys = Object.keys(obj)
    , len = keys.length;

  if (len) {
    buf.push('');
    for (var i = 0; i < len; ++i) {
      var key = keys[i]
        , val = obj[key];

      if ('boolean' == typeof val || null == val) {
        if (val) {
          terse
            ? buf.push(key)
            : buf.push(key + '="' + key + '"');
        }
      } else if (0 == key.indexOf('data') && 'string' != typeof val) {
        buf.push(key + "='" + JSON.stringify(val) + "'");
      } else if ('class' == key && Array.isArray(val)) {
        buf.push(key + '="' + exports.escape(val.join(' ')) + '"');
      } else if (escaped && escaped[key]) {
        buf.push(key + '="' + exports.escape(val) + '"');
      } else {
        buf.push(key + '="' + val + '"');
      }
    }
  }

  return buf.join(' ');
};

/**
 * Escape the given string of `html`.
 *
 * @param {String} html
 * @return {String}
 * @api private
 */

exports.escape = function escape(html){
  return String(html)
    .replace(/&(?!(\w+|\#\d+);)/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;');
};

/**
 * Re-throw the given `err` in context to the
 * the jade in `filename` at the given `lineno`.
 *
 * @param {Error} err
 * @param {String} filename
 * @param {String} lineno
 * @api private
 */

exports.rethrow = function rethrow(err, filename, lineno){
  if (!filename) throw err;

  var context = 3
    , str = require('fs').readFileSync(filename, 'utf8')
    , lines = str.split('\n')
    , start = Math.max(lineno - context, 0)
    , end = Math.min(lines.length, lineno + context);

  // Error context
  var context = lines.slice(start, end).map(function(line, i){
    var curr = i + start + 1;
    return (curr == lineno ? '  > ' : '    ')
      + curr
      + '| '
      + line;
  }).join('\n');

  // Alter exception message
  err.path = filename;
  err.message = (filename || 'Jade') + ':' + lineno
    + '\n' + context + '\n\n' + err.message;
  throw err;
};

  return exports;

})({});

jade.templates = {};
jade.render = function(node, template, data) {
  var tmp = jade.templates[template](data);
  node.innerHTML = tmp;
};

jade.templates["layout"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
 var invite = (inviteOnly) ? "window.inviteOnly='true';" : ''
buf.push('<!DOCTYPE html><!--\n░█▀█░█▀█░█░█░█▀▀░█▀▄░█▀▄░█░█░█░░░█░░░█▀▀░▀█▀░▀█▀░█▀█\n░█▀▀░█░█░█▄█░█▀▀░█▀▄░█▀▄░█░█░█░░░█░░░█▀▀░░█░░░█░░█░█\n░▀░░░▀▀▀░▀░▀░▀▀▀░▀░▀░▀▀░░▀▀▀░▀▀▀░▀▀▀░▀▀▀░░▀░░▀▀▀░▀░▀, jsb.mae.kh ~--><html><head>');
if ( typeof(title) !== 'undefined')
{
buf.push('<title>');
var __val__ = title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</title>');
}
if ( typeof(meta_description) !== 'undefined')
{
buf.push('<meta');
buf.push(attrs({ 'name':('description'), 'content':(meta_description) }, {"name":true,"content":true}));
buf.push('/>');
}
if ( typeof(meta_keywords) !== 'undefined')
{
buf.push('<meta');
buf.push(attrs({ 'name':('keywords'), 'content':(meta_keywords.join(', ')) }, {"name":true,"content":true}));
buf.push('/>');
}
if ( typeof(meta_zipcode) !== 'undefined')
{
buf.push('<meta');
buf.push(attrs({ 'name':('zipcode'), 'content':(meta_zipcode) }, {"name":true,"content":true}));
buf.push('/>');
}
buf.push('<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9,chrome=1"/><meta name="robots" content="index, follow"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="viewport" content="user-scalable=0, initial-scale=1, maximum-scale=1, width=device-width"/><link');
buf.push(attrs({ 'href':("" + (cacheUrl) + "/images/favicon.ico"), 'rel':('shortcut icon'), 'type':('image/x-icon') }, {"href":true,"rel":true,"type":true}));
buf.push('/><link');
buf.push(attrs({ 'href':("" + (cache2Url) + "/images/apple-touch-icon.png"), 'rel':('apple-touch-icon') }, {"href":true,"rel":true}));
buf.push('/><link');
buf.push(attrs({ 'href':("" + (cache3Url) + "/images/apple-touch-icon-72x72.png"), 'sizes':("72x72"), 'rel':('apple-touch-icon') }, {"href":true,"sizes":true,"rel":true}));
buf.push('/><link');
buf.push(attrs({ 'href':("" + (cache4Url) + "/images/apple-touch-icon-114x114.png"), 'sizes':("114x114"), 'rel':('apple-touch-icon') }, {"href":true,"sizes":true,"rel":true}));
buf.push('/><link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400" rel="stylesheet" type="text/css"/>');
if ( cssUrls)
{
// iterate cssUrls
;(function(){
  if ('number' == typeof cssUrls.length) {
    for (var $index = 0, $$l = cssUrls.length; $index < $$l; $index++) {
      var obj = cssUrls[$index];

buf.push('<link');
buf.push(attrs({ 'rel':('stylesheet'), 'type':('text/css'), 'href':(obj.url) }, {"rel":true,"type":true,"href":true}));
buf.push('/>');
    }
  } else {
    for (var $index in cssUrls) {
      var obj = cssUrls[$index];

buf.push('<link');
buf.push(attrs({ 'rel':('stylesheet'), 'type':('text/css'), 'href':(obj.url) }, {"rel":true,"type":true,"href":true}));
buf.push('/>');
   }
  }
}).call(this);

}
buf.push('<link');
buf.push(attrs({ 'href':("" + (cache5Url) + "/sites/" + (currentDomain) + ".css"), 'rel':('stylesheet'), 'type':('text/css') }, {"href":true,"rel":true,"type":true}));
buf.push('/>');
if ( style)
{
buf.push('<link');
buf.push(attrs({ 'href':("/sites/" + (siteId) + ".css"), 'rel':('stylesheet'), 'type':('text/css') }, {"href":true,"rel":true,"type":true}));
buf.push('/>');
}
if ( cvars.env != 'production')
{
buf.push('<script');
buf.push(attrs({ 'type':('text/javascript'), 'src':("" + (cache5Url) + "/local/head-0.99.load.min.js") }, {"type":true,"src":true}));
buf.push('></script>');
}
else
{
buf.push('<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/headjs/0.99/head.load.min.js"></script>');
}
if ( jsUrls)
{
buf.push('<script type="text/javascript">window.siteName="' + ((interp = siteName) == null ? '' : interp) + '";window.siteId=' + ((interp = siteId) == null ? '' : interp) + ';' + ((interp = invite) == null ? '' : interp) + 'window.initialMutant=' + ((interp = JSON.stringify(initialMutant)) == null ? '' : interp) + ';window.cacheUrl=' + ((interp = JSON.stringify(cvars.cacheUrl)) == null ? '' : interp) + ';window.authDomain="' + ((interp = cvars.authDomain) == null ? '' : interp) + '";window.headjs=head.js;head.js.apply(head,' + ((interp = JSON.stringify(cvars.baseJsUrls.concat(jsUrls))) == null ? '' : interp) + ');</script>');
}
buf.push('</head><body><header class="header toggler"><h1 class="logo"><a href="/" class="mutant">Power<strong>Bulletin</strong></a></h1><div class="container"><div class="search"><input id="query" type="text" placeholder="Search" autocomplete="off" class="query"/><div title="Close!" class="onclick-close toggler">x</div></div><div id="warning" class="tooltip"></div><div class="menu-container"><menu id="menu" class="menu">');
// iterate menu
;(function(){
  if ('number' == typeof menu.length) {
    for (var i = 0, $$l = menu.length; i < $$l; i++) {
      var f = menu[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'data-surf':(f.id), 'data-scroll-to':("#forum_" + (f.id) + ""), 'href':("/" + (f.slug) + ""), "class": ('title') + ' ' + ("forum-" + (f.id) + "") }, {"class":true,"data-surf":true,"data-scroll-to":true,"href":true}));
buf.push('>');
var __val__ = f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a>');
if ( f.forums.length)
{
buf.push('<div class="submenu"><menu>');
// iterate f.forums
;(function(){
  if ('number' == typeof f.forums.length) {
    for (var i = 0, $$l = f.forums.length; i < $$l; i++) {
      var sf = f.forums[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'href':(sf.uri), "class": ('mutant') + ' ' + ("forum-" + (sf.id) + "") }, {"class":true,"href":true}));
buf.push('>');
var __val__ = sf.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></li>');
    }
  } else {
    for (var i in f.forums) {
      var sf = f.forums[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'href':(sf.uri), "class": ('mutant') + ' ' + ("forum-" + (sf.id) + "") }, {"class":true,"href":true}));
buf.push('>');
var __val__ = sf.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></li>');
   }
  }
}).call(this);

buf.push('</menu></div>');
}
buf.push('</li>');
    }
  } else {
    for (var i in menu) {
      var f = menu[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'data-surf':(f.id), 'data-scroll-to':("#forum_" + (f.id) + ""), 'href':("/" + (f.slug) + ""), "class": ('title') + ' ' + ("forum-" + (f.id) + "") }, {"class":true,"data-surf":true,"data-scroll-to":true,"href":true}));
buf.push('>');
var __val__ = f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a>');
if ( f.forums.length)
{
buf.push('<div class="submenu"><menu>');
// iterate f.forums
;(function(){
  if ('number' == typeof f.forums.length) {
    for (var i = 0, $$l = f.forums.length; i < $$l; i++) {
      var sf = f.forums[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'href':(sf.uri), "class": ('mutant') + ' ' + ("forum-" + (sf.id) + "") }, {"class":true,"href":true}));
buf.push('>');
var __val__ = sf.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></li>');
    }
  } else {
    for (var i in f.forums) {
      var sf = f.forums[i];

buf.push('<li class="row"><a');
buf.push(attrs({ 'href':(sf.uri), "class": ('mutant') + ' ' + ("forum-" + (sf.id) + "") }, {"class":true,"href":true}));
buf.push('>');
var __val__ = sf.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></li>');
   }
  }
}).call(this);

buf.push('</menu></div>');
}
buf.push('</li>');
   }
  }
}).call(this);

buf.push('</menu></div><menu class="tools"><a class="profile photo mutant"><img id="profile"/></a><li class="onclick-login"><a href="/auth/login">Login</a></li><li class="admin-only"><a href="/admin" class="mutant">Admin</a></li><li><a href="/users" class="mutant onclick-profile">Profile</a></li><li class="onclick-logout"><a href="/auth/logout">Logout</a></li></menu></div></header><section id="left_content" class="left-content"><div id="handle" title="Toggle" class="handle"></div><div id="left_container"></div><div id="paginator" title="Go to this Page">');
if ( typeof page == 'number')
{
if ( page != 1)
{
if ( page != 2)
{
buf.push('<a');
buf.push(attrs({ 'title':('Previous Page'), 'href':("" + (furl.threadUri) + "/page/" + (page - 1) + ""), "class": ('page') + ' ' + ('previous') }, {"title":true,"href":true}));
buf.push('> </a>');
}
else
{
buf.push('<a');
buf.push(attrs({ 'title':('Previous Page'), 'href':("" + (furl.threadUri) + ""), "class": ('page') + ' ' + ('previous') }, {"title":true,"href":true}));
buf.push('> </a>');
}
}
else
{
buf.push('<a');
buf.push(attrs({ 'title':('Previous Page'), 'href':("" + (furl.threadUri) + ""), 'style':("display:none;"), "class": ('page') + ' ' + ('previous') }, {"title":true,"href":true,"style":true}));
buf.push('> </a>');
}
buf.push('<div title="Drag to Page through" class="current"><div class="tooltip right"></div></div>');
if ( page != pagesCount)
{
buf.push('<a');
buf.push(attrs({ 'title':('Next Page'), 'href':("" + (furl.threadUri) + "/page/" + (page + 1) + ""), "class": ('page') + ' ' + ('next') }, {"title":true,"href":true}));
buf.push('> </a>');
}
else
{
buf.push('<a');
buf.push(attrs({ 'title':('Next Page'), 'href':("" + (furl.threadUri) + "/page/" + (pagesCount) + ""), 'style':("display:none;"), "class": ('page') + ' ' + ('next') }, {"title":true,"href":true,"style":true}));
buf.push('> </a>');
}
}
else
{
buf.push('<a title="Previous Page" href="/" style="display:none;" class="page previous"> </a><div title="Drag to Page through" class="current"><div class="tooltip right"></div></div><a title="Next Page" href="/" style="display:none;" class="page next"> </a>');
}
buf.push('</div></section><section id="main_content" class="main-content container"></section><section class="extra"></section><section id="auth" style="display:none;"></section>');
if ( cvars.env != 'production')
{
buf.push('<div id="mocha"></div>');
}
buf.push('<footer class="onclick-footer-toggle"><div class="post-reply onclick-footer-toggle"></div><div class="onclick-scroll-top">Top</div><div id="pb_paginator"></div><h6 class="onclick-footer-toggle"><small>&copy; ' + escape((interp = siteName) == null ? '' : interp) + ' &nbsp;</small><b>');
var __val__ = new Date().getFullYear()
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</b></h6><div class="post-container"><form action="/resources/posts" method="post" class="post post-new"><div id="post_new"></div><div class="tooltip"></div></form></div></footer><div id="chat_drawer"></div><link');
buf.push(attrs({ 'href':("" + (cache5Url) + "/local/jquery-ui.min.css"), 'rel':('stylesheet'), 'type':('text/css') }, {"href":true,"rel":true,"type":true}));
buf.push('/>');
var __val__ = analytics
buf.push(null == __val__ ? "" : __val__);
buf.push('</body></html>');
}
return buf.join("");
}
jade.templates["homepage"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var media_post_mixin = function(f, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<img');
buf.push(attrs({ 'src':(f.media_url) }, {"src":true}));
buf.push('/>');
};
var html_post_mixin = function(f, t, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<p class="body">');
var __val__ = f.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
};
var posts_mixin = function(f, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
// iterate f.posts
;(function(){
  if ('number' == typeof f.posts.length) {
    for (var i = 0, $$l = f.posts.length; i < $$l; i++) {
      var p = f.posts[i];

buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), "class": ('post') + ' ' + ("col" + (Math.ceil(Math.random()*2)) + "") }, {"class":true,"id":true}));
buf.push('><a');
buf.push(attrs({ 'href':(p.uri), "class": ('mutant') }, {"href":true}));
buf.push('><h5 class="title">');
var __val__ = p.title
buf.push(null == __val__ ? "" : __val__);
buf.push('<span class="date">' + escape((interp = p.date) == null ? '' : interp) + '</span></h5></a>');
if ( p.media_url)
{
media_post_mixin(p, i);
}
else
{
html_post_mixin(p, i);
}
_post_profile_mixin(p, i);
buf.push('</div>');
    }
  } else {
    for (var i in f.posts) {
      var p = f.posts[i];

buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), "class": ('post') + ' ' + ("col" + (Math.ceil(Math.random()*2)) + "") }, {"class":true,"id":true}));
buf.push('><a');
buf.push(attrs({ 'href':(p.uri), "class": ('mutant') }, {"href":true}));
buf.push('><h5 class="title">');
var __val__ = p.title
buf.push(null == __val__ ? "" : __val__);
buf.push('<span class="date">' + escape((interp = p.date) == null ? '' : interp) + '</span></h5></a>');
if ( p.media_url)
{
media_post_mixin(p, i);
}
else
{
html_post_mixin(p, i);
}
_post_profile_mixin(p, i);
buf.push('</div>');
   }
  }
}).call(this);

};
if ( forums)
{
buf.push('<div');
buf.push(attrs({ "class": ('homepage') + ' ' + (activeForumId!='homepage'?'resizable forum':'') }, {"class":true}));
buf.push('>');
// iterate forums
;(function(){
  if ('number' == typeof forums.length) {
    for (var i = 0, $$l = forums.length; i < $$l; i++) {
      var f = forums[i];

buf.push('<div');
buf.push(attrs({ 'id':("forum_" + (f.id) + ""), "class": ('forum') + ' ' + (f.classes || '') }, {"class":true,"id":true}));
buf.push('><h2 class="title"><a');
buf.push(attrs({ 'href':(f.uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h2><a');
buf.push(attrs({ 'name':("forum_" + (f.id) + "") }, {"name":true}));
buf.push('></a><div class="container">');
posts_mixin(f, i);
buf.push('</div></div>');
    }
  } else {
    for (var i in forums) {
      var f = forums[i];

buf.push('<div');
buf.push(attrs({ 'id':("forum_" + (f.id) + ""), "class": ('forum') + ' ' + (f.classes || '') }, {"class":true,"id":true}));
buf.push('><h2 class="title"><a');
buf.push(attrs({ 'href':(f.uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h2><a');
buf.push(attrs({ 'name':("forum_" + (f.id) + "") }, {"name":true}));
buf.push('></a><div class="container">');
posts_mixin(f, i);
buf.push('</div></div>');
   }
  }
}).call(this);

buf.push('</div>');
}
else
{
buf.push('<p>Create a forum first<i>!</i></p>');
}
}
return buf.join("");
}
jade.templates["order-control"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="orderer"><div class="indicator"><!-- TODO -- , [\'nearest\', \'Nearby\']]-->');
var orders = ([['popular', 'Popular'], ['recent', 'Most Recent'], ['active', 'Most Active']]);
buf.push('</div><ul id="order">');
// iterate orders
;(function(){
  if ('number' == typeof orders.length) {
    for (var $index = 0, $$l = orders.length; $index < $$l; $index++) {
      var o = orders[$index];

if ( o[0] == active)
{
buf.push('<li');
buf.push(attrs({ 'data-value':(o[0]), "class": ('active') }, {"data-value":true}));
buf.push('>');
var __val__ = o[1]
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
}
else
{
buf.push('<li');
buf.push(attrs({ 'data-value':(o[0]) }, {"data-value":true}));
buf.push('>');
var __val__ = o[1]
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
}
    }
  } else {
    for (var $index in orders) {
      var o = orders[$index];

if ( o[0] == active)
{
buf.push('<li');
buf.push(attrs({ 'data-value':(o[0]), "class": ('active') }, {"data-value":true}));
buf.push('>');
var __val__ = o[1]
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
}
else
{
buf.push('<li');
buf.push(attrs({ 'data-value':(o[0]) }, {"data-value":true}));
buf.push('>');
var __val__ = o[1]
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</li>');
}
   }
  }
}).call(this);

buf.push('</ul><div class="onclick-scroll-top"></div></div>');
}
return buf.join("");
}
jade.templates["thread"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
_thread_mixin(thread);
}
return buf.join("");
}
jade.templates["nav"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
var subforum_mixin = function(f, sf, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<li class="subforum"><a');
buf.push(attrs({ 'href':(sf.uri), "class": ('mutant') + ' ' + ('title') + ' ' + ('stylish') }, {"href":true}));
buf.push('>');
var __val__ = sf.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></li>');
};
var forum_mixin = function(f, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<h3 class="title">Forums</h3>');
if ( f.forums)
{
buf.push('<ul');
buf.push(attrs({ "class": ('forum') + ' ' + ("" + (f.classes || '') + " forum-" + (activeForumId) + "") }, {"class":true}));
buf.push('>');
// iterate f.forums
;(function(){
  if ('number' == typeof f.forums.length) {
    for (var ii = 0, $$l = f.forums.length; ii < $$l; ii++) {
      var sf = f.forums[ii];

subforum_mixin(f, sf, ii);
    }
  } else {
    for (var ii in f.forums) {
      var sf = f.forums[ii];

subforum_mixin(f, sf, ii);
   }
  }
}).call(this);

buf.push('</ul>');
}
};
buf.push('<div class="create"><a');
buf.push(attrs({ 'data-edit':('true'), 'href':("" + (forum.uri) + "/new"), "class": ('mutant') + ' ' + ('no-surf') + ' ' + ('require-login') + ' ' + ('button') }, {"data-edit":true,"href":true}));
buf.push('>Create Thread</a></div><div id="thread-paginator"></div><div class="scrollable">');
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
buf.push('<ul class="threads">');
// iterate topThreads
;(function(){
  if ('number' == typeof topThreads.length) {
    for (var ii = 0, $$l = topThreads.length; ii < $$l; ii++) {
      var t = topThreads[ii];

_thread_mixin(t);
    }
  } else {
    for (var ii in topThreads) {
      var t = topThreads[ii];

_thread_mixin(t);
   }
  }
}).call(this);

buf.push('</ul></div>');
}
return buf.join("");
}
jade.templates["posts"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var _post_mixin = function(p, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), 'data-user-id':(p.user_id), 'data-post-id':(p.id), 'data-thread-id':(p.thread_id), 'data-forum-id':(p.forum_id), "class": ('post') + ' ' + (p.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true,"data-thread-id":true,"data-forum-id":true}));
buf.push('>');
if ( p.thread_uri)
{
buf.push('<h4 class="title"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h4>');
}
else
{
buf.push('<h4 class="title">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4>');
}
_post_profile_mixin(p);
buf.push('<div class="container"><span class="username">');
var __val__ = p.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><div');
buf.push(attrs({ 'data-time':(p.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = p.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="post-content">');
if ( p.html)
{
buf.push('<p class="body">');
var __val__ = p.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
}
buf.push('</div></div>');
_post_actions_mixin(p);
buf.push('<div class="reply"></div></div><div class="children">');
if ( p.posts && p.posts.length)
{
// iterate p.posts
;(function(){
  if ('number' == typeof p.posts.length) {
    for (var ii = 0, $$l = p.posts.length; ii < $$l; ii++) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
    }
  } else {
    for (var ii in p.posts) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
   }
  }
}).call(this);

}
else if ( p.morePosts)
{
buf.push('<a href="#" class="load-more">More Posts</a>');
}
buf.push('</div>');
};
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _breadcrumb_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
var path = ('');
var parts = (p.uri.split('/'));
var parts = (parts.splice(1, parts.length-2));
// iterate parts
;(function(){
  if ('number' == typeof parts.length) {
    for (var $index = 0, $$l = parts.length; $index < $$l; $index++) {
      var part = parts[$index];

if ( part != 't')
{
buf.push('<a');
buf.push(attrs({ 'href':("/" + (path) + "" + (part) + ""), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = part.replace('-', ' ')
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a><span>/</span>');
}
 path = path + part + '/'
    }
  } else {
    for (var $index in parts) {
      var part = parts[$index];

if ( part != 't')
{
buf.push('<a');
buf.push(attrs({ 'href':("/" + (path) + "" + (part) + ""), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = part.replace('-', ' ')
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a><span>/</span>');
}
 path = path + part + '/'
   }
  }
}).call(this);

buf.push('<em>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em>');
};
if ( typeof(post) !== 'undefined')
{
 if (!post.user_photo) post.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<div class="forum resizable">');
if ( page == 1)
{
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (post.id) + ""), 'data-user-id':(post.user_id), 'data-post-id':(post.id), "class": ('post') + ' ' + ('head') + ' ' + (post.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true}));
buf.push('><h3 class="title">');
var __val__ = post.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h3><a');
buf.push(attrs({ 'href':("/user/" + (post.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (post.user_photo) + "") }, {"src":true}));
buf.push('/></div><span>');
var __val__ = post.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span></a><div');
buf.push(attrs({ 'data-time':(post.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = post.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="edit-container"></div>');
if ( post.html)
{
buf.push('<div class="body">');
var __val__ = post.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</div>');
}
buf.push('<div class="reply"></div><div class="actions"><a class="stylish onclick-footer-toggle">Reply</a><a');
buf.push(attrs({ 'data-edit':(post.id), 'href':("" + (post.uri.replace(/\/\d+$/, '')) + "/edit/" + (post.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(post.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div></div>');
}
buf.push('<div class="children">');
if ( post.posts.length)
{
buf.push('<div');
buf.push(attrs({ 'data-page':(page) }, {"data-page":true}));
buf.push('>');
// iterate post.posts
;(function(){
  if ('number' == typeof post.posts.length) {
    for (var $index = 0, $$l = post.posts.length; $index < $$l; $index++) {
      var sp = post.posts[$index];

if ( sp.parent_id !== null)
{
_post_mixin(sp, 0);
}
    }
  } else {
    for (var $index in post.posts) {
      var sp = post.posts[$index];

if ( sp.parent_id !== null)
{
_post_mixin(sp, 0);
}
   }
  }
}).call(this);

buf.push('</div>');
}
else if ( post.morePosts)
{
buf.push('<a href="#">Load more posts ...</a>');
}
buf.push('</div><p class="onclick-footer-toggle">Post Reply</p></div>');
}
else
{
buf.push('<div class="forum resizable"></div>');
}
if ( typeof(post) !== 'undefined')
{
buf.push('<div id="breadcrumb" class="breadcrumb">');
_breadcrumb_mixin(post);
buf.push('</div>');
}
}
return buf.join("");
}
jade.templates["post-edit"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_edit_mixin = function(u, p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
var html_id = (p.id ? "_#{p.id}" : '');
buf.push('<div');
buf.push(attrs({ 'id':(p.is_comment ? html_id : 'post_edit'), "class": ('post-edit') + ' ' + ('onclick-submit') + ' ' + (p.is_comment ? 'comment' : '') }, {"class":true,"id":true}));
buf.push('><form');
buf.push(attrs({ 'action':("/resources/posts"), 'method':("" + (p.method || 'put') + "") }, {"action":true,"method":true}));
buf.push('><div class="tooltip"></div><div');
buf.push(attrs({ 'data-user-id':(u.id), "class": ('summary') }, {"data-user-id":true}));
buf.push('><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (u.photo || 'images/profile.jpg') + ""), "class": ('profile') + ' ' + ('photo') }, {"src":true}));
buf.push('/></div>');
if ( !p.is_comment)
{
buf.push('<input');
buf.push(attrs({ 'name':('title'), 'type':('text'), 'placeholder':('Title'), 'value':(p.title), "class": ('title') }, {"name":true,"type":true,"placeholder":true,"value":true}));
buf.push('/>');
}
buf.push('<textarea');
buf.push(attrs({ 'id':("editor" + (p.is_comment ? html_id : '') + ""), 'name':('body'), 'placeholder':('Comment ...'), "class": ('body') + ' ' + ('onshiftenter-submit') }, {"id":true,"name":true,"placeholder":true}));
buf.push('>');
var __val__ = p.body
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</textarea><input');
buf.push(attrs({ 'type':('hidden'), 'name':('id'), 'value':(p.id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('forum_id'), 'value':(p.forum_id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('parent_id'), 'value':(p.parent_id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('csrf'), 'value':(p.csrf) }, {"type":true,"name":true,"value":true}));
buf.push('/><button type="submit" name="submit" value="Save">Save</button><div class="close cancel">X</div></form><div class="preview"></div></div>');
};
if ( typeof(post) !== 'undefined')
{
_post_edit_mixin(user, post);
}
}
return buf.join("");
}
jade.templates["post-new"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="forum resizable"></div>');
}
return buf.join("");
}
jade.templates["profile"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="container"><h2>');
var __val__ = profile.name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h2><div');
buf.push(attrs({ 'data-user-id':("" + (profile.id) + ""), 'data-user-name':("" + (profile.name) + ""), "class": ('profile') }, {"data-user-id":true,"data-user-name":true}));
buf.push('><form');
buf.push(attrs({ 'action':("/resources/users/" + (profile.id) + "/avatar"), 'enctype':("multipart/form-data"), 'method':("post") }, {"action":true,"enctype":true,"method":true}));
buf.push('><div class="avatar">');
if ( profile.photo)
{
if ( profile.photo.match(/^https?:/))
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (profile.photo) + "") }, {"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (profile.photo) + "") }, {"src":true}));
buf.push('/>');
}
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/profile.jpg") }, {"src":true}));
buf.push('/>');
}
buf.push('</div><input type="file" name="avatar" style="display:none;"/></form></div><ul><li class="since"><span>Joined </span>');
var __val__ = profile.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</li><li class="count"><b>');
var __val__ = profile.human_post_count 
buf.push(null == __val__ ? "" : __val__);
buf.push('</b><span> ' + escape((interp = profile.post_count == 1 ? "post" : "posts") == null ? '' : interp) + '</span></li><li class="chat"><button title="Chat" class="onclick-chat">Private Message</button></li></ul></div>');
}
return buf.join("");
}
jade.templates["posts-by-user"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var _post_mixin = function(p, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), 'data-user-id':(p.user_id), 'data-post-id':(p.id), 'data-thread-id':(p.thread_id), 'data-forum-id':(p.forum_id), "class": ('post') + ' ' + (p.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true,"data-thread-id":true,"data-forum-id":true}));
buf.push('>');
if ( p.thread_uri)
{
buf.push('<h4 class="title"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h4>');
}
else
{
buf.push('<h4 class="title">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4>');
}
_post_profile_mixin(p);
buf.push('<div class="container"><span class="username">');
var __val__ = p.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><div');
buf.push(attrs({ 'data-time':(p.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = p.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="post-content">');
if ( p.html)
{
buf.push('<p class="body">');
var __val__ = p.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
}
buf.push('</div></div>');
_post_actions_mixin(p);
buf.push('<div class="reply"></div></div><div class="children">');
if ( p.posts && p.posts.length)
{
// iterate p.posts
;(function(){
  if ('number' == typeof p.posts.length) {
    for (var ii = 0, $$l = p.posts.length; ii < $$l; ii++) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
    }
  } else {
    for (var ii in p.posts) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
   }
  }
}).call(this);

}
else if ( p.morePosts)
{
buf.push('<a href="#" class="load-more">More Posts</a>');
}
buf.push('</div>');
};
buf.push('<div class="resizable forum">');
if ( postsByUser.length)
{
var last_thread_id = (-1);
// iterate postsByUser
;(function(){
  if ('number' == typeof postsByUser.length) {
    for (var i = 0, $$l = postsByUser.length; i < $$l; i++) {
      var p = postsByUser[i];

if ( last_thread_id != p.thread_id)
{
buf.push('<h3 class="heading"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') + ' ' + ('title') + ' ' + ('stylish') }, {"href":true}));
buf.push('> <b>' + escape((interp = p.thread_title) == null ? '' : interp) + ' </b></a><a');
buf.push(attrs({ 'href':("/user/" + (p.thread_username) + ""), "class": ('mutant') + ' ' + ('by') }, {"href":true}));
buf.push('>by <b>' + escape((interp = p.thread_username) == null ? '' : interp) + ' </b></a><a');
buf.push(attrs({ 'href':(p.forum_uri), "class": ('mutant') + ' ' + ('forum-link') }, {"href":true}));
buf.push('>in <b>' + escape((interp = p.forum_title) == null ? '' : interp) + '</b></a></h3>');
}
_post_mixin(p, i);
var last_thread_id = (p.thread_id);
    }
  } else {
    for (var i in postsByUser) {
      var p = postsByUser[i];

if ( last_thread_id != p.thread_id)
{
buf.push('<h3 class="heading"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') + ' ' + ('title') + ' ' + ('stylish') }, {"href":true}));
buf.push('> <b>' + escape((interp = p.thread_title) == null ? '' : interp) + ' </b></a><a');
buf.push(attrs({ 'href':("/user/" + (p.thread_username) + ""), "class": ('mutant') + ' ' + ('by') }, {"href":true}));
buf.push('>by <b>' + escape((interp = p.thread_username) == null ? '' : interp) + ' </b></a><a');
buf.push(attrs({ 'href':(p.forum_uri), "class": ('mutant') + ' ' + ('forum-link') }, {"href":true}));
buf.push('>in <b>' + escape((interp = p.forum_title) == null ? '' : interp) + '</b></a></h3>');
}
_post_mixin(p, i);
var last_thread_id = (p.thread_id);
   }
  }
}).call(this);

}
else
{
buf.push('<h3>Check back for my first post<i>!</i></h3>');
}
buf.push('</div>');
}
return buf.join("");
}
jade.templates["post"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var _post_mixin = function(p, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), 'data-user-id':(p.user_id), 'data-post-id':(p.id), 'data-thread-id':(p.thread_id), 'data-forum-id':(p.forum_id), "class": ('post') + ' ' + (p.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true,"data-thread-id":true,"data-forum-id":true}));
buf.push('>');
if ( p.thread_uri)
{
buf.push('<h4 class="title"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h4>');
}
else
{
buf.push('<h4 class="title">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4>');
}
_post_profile_mixin(p);
buf.push('<div class="container"><span class="username">');
var __val__ = p.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><div');
buf.push(attrs({ 'data-time':(p.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = p.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="post-content">');
if ( p.html)
{
buf.push('<p class="body">');
var __val__ = p.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
}
buf.push('</div></div>');
_post_actions_mixin(p);
buf.push('<div class="reply"></div></div><div class="children">');
if ( p.posts && p.posts.length)
{
// iterate p.posts
;(function(){
  if ('number' == typeof p.posts.length) {
    for (var ii = 0, $$l = p.posts.length; ii < $$l; ii++) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
    }
  } else {
    for (var ii in p.posts) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
   }
  }
}).call(this);

}
else if ( p.morePosts)
{
buf.push('<a href="#" class="load-more">More Posts</a>');
}
buf.push('</div>');
};
_post_mixin(post, 0);
}
return buf.join("");
}
jade.templates["admin-domains"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="domains"><form');
buf.push(attrs({ 'action':("/resources/sites/" + (siteId) + ""), 'method':("put"), "class": ('onclick-submit') }, {"action":true,"method":true}));
buf.push('><div class="domain"><label for="domain">Select a Domain</label><select id="domain" name="domain">');
// iterate site.domains
;(function(){
  if ('number' == typeof site.domains.length) {
    for (var $index = 0, $$l = site.domains.length; $index < $$l; $index++) {
      var d = site.domains[$index];

buf.push('<option');
buf.push(attrs({ 'value':(d.id) }, {"value":true}));
buf.push('>');
var __val__ = d.name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</option>');
    }
  } else {
    for (var $index in site.domains) {
      var d = site.domains[$index];

buf.push('<option');
buf.push(attrs({ 'value':(d.id) }, {"value":true}));
buf.push('>');
var __val__ = d.name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</option>');
   }
  }
}).call(this);

buf.push('</select></div><br/><fieldset><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/facebook_32.png") }, {"src":true}));
buf.push('/><legend>Facebook</legend><label for="facebook_client_id">ID</label><input');
buf.push(attrs({ 'id':("facebook_client_id"), 'type':('text'), 'name':('facebookClientId'), 'placeholder':('Facebook API ID ...'), 'value':(site.config.facebookClientId), "class": ('first') }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/><label for="facebook_client_secret">Secret</label><input');
buf.push(attrs({ 'id':("facebook_client_secret"), 'type':('text'), 'name':('facebookClientSecret'), 'placeholder':('Facebook secret ...'), 'value':(site.config.facebookClientId) }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/></fieldset><fieldset><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/twitter_32.png") }, {"src":true}));
buf.push('/><legend>Twitter</legend><label for="twitter_key">Key</label><input');
buf.push(attrs({ 'id':("twitter_key"), 'type':('text'), 'name':('twitterConsumerKey'), 'placeholder':('Twitter API key ...'), 'value':(site.config.twitterConsumerKey), "class": ('first') }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/><label for="twitter_secret">Secret</label><input');
buf.push(attrs({ 'id':("twitter_secret"), 'type':('text'), 'name':('twitterConsumerSecret'), 'placeholder':('Twitter API secret ...'), 'value':(site.config.twitterConsumerSecret) }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/></fieldset><fieldset><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/images/google_32.png") }, {"src":true}));
buf.push('/><legend>Google+</legend><label for="google_key">Key</label><input');
buf.push(attrs({ 'id':("google_key"), 'type':('text'), 'name':('googleConsumerKey'), 'placeholder':('Google+ API key ...'), 'value':(site.config.googleConsumerKey), "class": ('first') }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/><label for="google_secret">Secret</label><input');
buf.push(attrs({ 'id':("google_secret"), 'type':('text'), 'name':('googleConsumerSecret'), 'placeholder':('Google+ API secret ...'), 'value':(site.config.googleConsumerSecret) }, {"id":true,"type":true,"name":true,"placeholder":true,"value":true}));
buf.push('/></fieldset><button type="submit" value="Save">Save</button><div class="tooltip"></div><input type="hidden" name="action" value="domains"/></form></div>');
}
return buf.join("");
}
jade.templates["admin-general"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var analytics = (unescape(site.config.analytics));
buf.push('<form');
buf.push(attrs({ 'action':("/resources/sites/" + (siteId) + ""), 'method':("put"), "class": ('onclick-submit') + ' ' + ('no-focus') }, {"action":true,"method":true}));
buf.push('><fieldset><label for="name">Title</label><input');
buf.push(attrs({ 'id':('name'), 'name':('name'), 'type':('text'), 'value':(site.name), "class": ('name') }, {"id":true,"class":true,"name":true,"type":true,"value":true}));
buf.push('/><div class="break"></div><label for="posts_per_page">Posts per Page</label><input');
buf.push(attrs({ 'id':('posts_per_page'), 'name':('postsPerPage'), 'type':('text'), 'value':(site.config.postsPerPage), 'maxlength':(4), "class": ('posts-per-page') }, {"id":true,"class":true,"name":true,"type":true,"value":true,"maxlength":true}));
buf.push('/><div class="break"></div><label>Privacy</label><div class="box"><input');
buf.push(attrs({ 'id':('private'), 'type':('checkbox'), 'value':('checked'), 'name':('private'), 'checked':(site.config.private) }, {"type":true,"value":true,"name":true,"checked":true}));
buf.push('/><label for="private" class="switch-control"><div class="switch"></div></label><span class="label checked">On</span><div class="note">Hide content from search engines &amp; the public</div></div><div class="break"></div><label>Invite Only</label><div class="box"><input');
buf.push(attrs({ 'id':('invite_only'), 'type':('checkbox'), 'value':('checked'), 'name':('inviteOnly'), 'checked':(site.config.inviteOnly) }, {"type":true,"value":true,"name":true,"checked":true}));
buf.push('/><label for="invite_only" class="switch-control"><div class="switch"></div></label><span class="label checked">On</span><div class="note">Disallow the public from registering - <a href="/admin/invites" class="mutant">Invites</a></div></div><div class="break double"></div><label for="keywords">Keywords</label><textarea id="keywords" name="metaKeywords">');
var __val__ = site.config.metaKeywords
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</textarea><div class="note">Separate meta keywords with commas</div><div class="break"></div><label for="style">Style</label><textarea id="style" name="style">');
var __val__ = site.config.style
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</textarea><div class="note">Paste<a href="http://www.w3schools.com/cssref/" target="_blank">CSS</a>or <a href="http://learnboost.github.io/stylus/" target="_blank">Stylus</a>code in above</div><div class="break"></div><label for="analytics">Analytics</label><textarea id="analytics" name="analytics">');
var __val__ = analytics
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</textarea><div class="note">Paste Javascript code above, excluding &lt;script&gt; tags</div></fieldset><div class="tooltip"></div><button type="submit" value="Save">Save</button><input type="hidden" name="action" value="general"/></form>');
}
return buf.join("");
}
jade.templates["admin-invites"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<form action="/resources/users" method="post" class="onclick-submit"><fieldset><label for="emails">Emails</label><input id="emails" name="emails" type="text" class="emails clear"/><div class="note">Separated by commas</div><div class="break"></div><label for="message">Message</label><textarea id="message" name="message"></textarea></fieldset><button type="submit" value="Send">Send</button><div data-msg="Invites sent!" class="tooltip"></div><input type="hidden" name="action" value="invites"/></form>');
}
return buf.join("");
}
jade.templates["admin-nav"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div class="container"><menu><li class="general"><a href="/admin" class="mutant">General</a></li><li class="menu"><a href="/admin/menu" class="mutant">Menu</a></li><li class="invites"><a href="/admin/invites" class="mutant">Invites</a></li><li class="domains"><a href="/admin/domains" class="mutant">Domains</a></li><li class="feature upgrade"><a href="/admin/upgrade" class="mutant">PRO</a></li></menu></div>');
}
return buf.join("");
}
jade.templates["search"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var _post_mixin = function(p, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), 'data-user-id':(p.user_id), 'data-post-id':(p.id), 'data-thread-id':(p.thread_id), 'data-forum-id':(p.forum_id), "class": ('post') + ' ' + (p.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true,"data-thread-id":true,"data-forum-id":true}));
buf.push('>');
if ( p.thread_uri)
{
buf.push('<h4 class="title"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h4>');
}
else
{
buf.push('<h4 class="title">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4>');
}
_post_profile_mixin(p);
buf.push('<div class="container"><span class="username">');
var __val__ = p.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><div');
buf.push(attrs({ 'data-time':(p.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = p.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="post-content">');
if ( p.html)
{
buf.push('<p class="body">');
var __val__ = p.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
}
buf.push('</div></div>');
_post_actions_mixin(p);
buf.push('<div class="reply"></div></div><div class="children">');
if ( p.posts && p.posts.length)
{
// iterate p.posts
;(function(){
  if ('number' == typeof p.posts.length) {
    for (var ii = 0, $$l = p.posts.length; ii < $$l; ii++) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
    }
  } else {
    for (var ii in p.posts) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
   }
  }
}).call(this);

}
else if ( p.morePosts)
{
buf.push('<a href="#" class="load-more">More Posts</a>');
}
buf.push('</div>');
};
buf.push('<div id="breadcrumb" class="breadcrumb"><div id="new_hits"></div></div>');
var suffix = (elres.total == 1 ? '' : 's');
buf.push('<div class="search resizable"><em id="hit_count"><b>' + escape((interp = elres.total) == null ? '' : interp) + ' hit' + escape((interp = suffix) == null ? '' : interp) + '</b></em><span id="new_hit_count"><a href="#" onclick="showNewHits()">- <span class="count">0 </span>new!</a></span><div id="new_posts"></div>');
if ( elres.hits.length)
{
// iterate elres.hits
;(function(){
  if ('number' == typeof elres.hits.length) {
    for (var $index = 0, $$l = elres.hits.length; $index < $$l; $index++) {
      var hit = elres.hits[$index];

buf.push('<!-- always use thread title-->');
 hit._source.title = hit._source.thread_title
if ( env != 'production')
{
buf.push('<!-- show score in dev mode-->');
 hit._source.title = hit._source.title + ' (score: ' + hit._score + ' )'
}
if ( hit._source.id == hit._source.thread_id)
{
buf.push('<div class="thread-hit">');
_post_mixin(hit._source, 0);
buf.push('</div>');
}
else
{
buf.push('<div class="comment-hit">');
_post_mixin(hit._source, 0);
buf.push('</div>');
}
    }
  } else {
    for (var $index in elres.hits) {
      var hit = elres.hits[$index];

buf.push('<!-- always use thread title-->');
 hit._source.title = hit._source.thread_title
if ( env != 'production')
{
buf.push('<!-- show score in dev mode-->');
 hit._source.title = hit._source.title + ' (score: ' + hit._score + ' )'
}
if ( hit._source.id == hit._source.thread_id)
{
buf.push('<div class="thread-hit">');
_post_mixin(hit._source, 0);
buf.push('</div>');
}
else
{
buf.push('<div class="comment-hit">');
_post_mixin(hit._source, 0);
buf.push('</div>');
}
   }
  }
}).call(this);

}
else
{
buf.push('<h4>Try a more general search<i>!</i></h4>');
}
buf.push('</div>');
}
return buf.join("");
}
jade.templates["search-filters"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var forumOptions_mixin = function(forums, prefix){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
// iterate forums
;(function(){
  if ('number' == typeof forums.length) {
    for (var $index = 0, $$l = forums.length; $index < $$l; $index++) {
      var f = forums[$index];

buf.push('<option');
buf.push(attrs({ 'value':(f.id) }, {"value":true}));
buf.push('>');
var __val__ = prefix + f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</option>');
forumOptions_mixin(f.forums, '-');
    }
  } else {
    for (var $index in forums) {
      var f = forums[$index];

buf.push('<option');
buf.push(attrs({ 'value':(f.id) }, {"value":true}));
buf.push('>');
var __val__ = prefix + f.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</option>');
forumOptions_mixin(f.forums, '-');
   }
  }
}).call(this);

};
buf.push('<div id="search_filters"><div><label><h4>Filter by Forum</h4><select name="forum_id"><option value="">- All -</option>');
forumOptions_mixin(menu, '');
buf.push('</select></label></div><div><label><h4>Within a Timeframe</h4><select name="within"><option value="">- Any Time -</option><option value="day">Within Last Day</option><option value="week">Within Last Week</option><option value="month">Within Last Month</option></select></label></div></div>');
}
return buf.join("");
}
jade.templates["search-facets"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
buf.push('<div id="search_facets"><div style="height:30px"></div>');
if ( facets.forum.length > 1)
{
buf.push('<div class="facet"><div class="facet-title">Hits by Forum</div>');
// iterate facets.forum
;(function(){
  if ('number' == typeof facets.forum.length) {
    for (var $index = 0, $$l = facets.forum.length; $index < $$l; $index++) {
      var forum = facets.forum[$index];

buf.push('<a');
buf.push(attrs({ 'href':(forum.uri), "class": ('mutant') + ' ' + ('facet-hit') }, {"href":true}));
buf.push('><em>');
var __val__ = forum.hitCount
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em><span>');
var __val__ = forum.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span></a>');
    }
  } else {
    for (var $index in facets.forum) {
      var forum = facets.forum[$index];

buf.push('<a');
buf.push(attrs({ 'href':(forum.uri), "class": ('mutant') + ' ' + ('facet-hit') }, {"href":true}));
buf.push('><em>');
var __val__ = forum.hitCount
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em><span>');
var __val__ = forum.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span></a>');
   }
  }
}).call(this);

buf.push('</div>');
}
buf.push('</div>');
}
return buf.join("");
}
jade.templates["__threads"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
buf.push('<ul class="threads">');
// iterate topThreads
;(function(){
  if ('number' == typeof topThreads.length) {
    for (var ii = 0, $$l = topThreads.length; ii < $$l; ii++) {
      var t = topThreads[ii];

_thread_mixin(t);
    }
  } else {
    for (var ii in topThreads) {
      var t = topThreads[ii];

_thread_mixin(t);
   }
  }
}).call(this);

buf.push('</ul>');
}
return buf.join("");
}
jade.templates["_breadcrumb"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _breadcrumb_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
var path = ('');
var parts = (p.uri.split('/'));
var parts = (parts.splice(1, parts.length-2));
// iterate parts
;(function(){
  if ('number' == typeof parts.length) {
    for (var $index = 0, $$l = parts.length; $index < $$l; $index++) {
      var part = parts[$index];

if ( part != 't')
{
buf.push('<a');
buf.push(attrs({ 'href':("/" + (path) + "" + (part) + ""), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = part.replace('-', ' ')
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a><span>/</span>');
}
 path = path + part + '/'
    }
  } else {
    for (var $index in parts) {
      var part = parts[$index];

if ( part != 't')
{
buf.push('<a');
buf.push(attrs({ 'href':("/" + (path) + "" + (part) + ""), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = part.replace('-', ' ')
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a><span>/</span>');
}
 path = path + part + '/'
   }
  }
}).call(this);

buf.push('<em>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em>');
};
}
return buf.join("");
}
jade.templates["_post-actions"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
}
return buf.join("");
}
jade.templates["_post-edit"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_edit_mixin = function(u, p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
var html_id = (p.id ? "_#{p.id}" : '');
buf.push('<div');
buf.push(attrs({ 'id':(p.is_comment ? html_id : 'post_edit'), "class": ('post-edit') + ' ' + ('onclick-submit') + ' ' + (p.is_comment ? 'comment' : '') }, {"class":true,"id":true}));
buf.push('><form');
buf.push(attrs({ 'action':("/resources/posts"), 'method':("" + (p.method || 'put') + "") }, {"action":true,"method":true}));
buf.push('><div class="tooltip"></div><div');
buf.push(attrs({ 'data-user-id':(u.id), "class": ('summary') }, {"data-user-id":true}));
buf.push('><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (u.photo || 'images/profile.jpg') + ""), "class": ('profile') + ' ' + ('photo') }, {"src":true}));
buf.push('/></div>');
if ( !p.is_comment)
{
buf.push('<input');
buf.push(attrs({ 'name':('title'), 'type':('text'), 'placeholder':('Title'), 'value':(p.title), "class": ('title') }, {"name":true,"type":true,"placeholder":true,"value":true}));
buf.push('/>');
}
buf.push('<textarea');
buf.push(attrs({ 'id':("editor" + (p.is_comment ? html_id : '') + ""), 'name':('body'), 'placeholder':('Comment ...'), "class": ('body') + ' ' + ('onshiftenter-submit') }, {"id":true,"name":true,"placeholder":true}));
buf.push('>');
var __val__ = p.body
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</textarea><input');
buf.push(attrs({ 'type':('hidden'), 'name':('id'), 'value':(p.id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('forum_id'), 'value':(p.forum_id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('parent_id'), 'value':(p.parent_id) }, {"type":true,"name":true,"value":true}));
buf.push('/><input');
buf.push(attrs({ 'type':('hidden'), 'name':('csrf'), 'value':(p.csrf) }, {"type":true,"name":true,"value":true}));
buf.push('/><button type="submit" name="submit" value="Save">Save</button><div class="close cancel">X</div></form><div class="preview"></div></div>');
};
}
return buf.join("");
}
jade.templates["_post-profile"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
}
return buf.join("");
}
jade.templates["_post"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _post_actions_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div class="actions"><a class="stylish onclick-append-reply-ui">Comment</a><a');
buf.push(attrs({ 'data-edit':(p.id), 'href':("" + (p.uri.replace(/\/\d+$/, '')) + "/edit/" + (p.id) + ""), "class": ('stylish') + ' ' + ('edit') + ' ' + ('mutant') + ' ' + ('no-surf') }, {"data-edit":true,"href":true}));
buf.push('>Edit</a><a');
buf.push(attrs({ 'href':(p.uri), "class": ('stylish') + ' ' + ('permalink') + ' ' + ('mutant') }, {"href":true}));
buf.push('>Permalink</a><a class="stylish censor onclick-censor-post">Censor</a></div>');
};
var _post_profile_mixin = function(p){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!p.user_photo) p.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<a');
buf.push(attrs({ 'href':("/user/" + (p.user_name) + ""), "class": ('user') + ' ' + ('mutant') }, {"href":true}));
buf.push('><div class="profile photo">');
if ( p.user_photo && p.user_photo.match(/^http/))
{
buf.push('<img');
buf.push(attrs({ 'title':(p.user_name), 'src':("" + (p.user_photo) + "") }, {"title":true,"src":true}));
buf.push('/>');
}
else
{
buf.push('<img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "/" + (p.user_photo) + "") }, {"src":true}));
buf.push('/>');
}
buf.push('</div></a>');
};
var _post_mixin = function(p, i){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
buf.push('<div');
buf.push(attrs({ 'id':("post_" + (p.id) + ""), 'data-user-id':(p.user_id), 'data-post-id':(p.id), 'data-thread-id':(p.thread_id), 'data-forum-id':(p.forum_id), "class": ('post') + ' ' + (p.reason ? 'censored' : '') }, {"class":true,"id":true,"data-user-id":true,"data-post-id":true,"data-thread-id":true,"data-forum-id":true}));
buf.push('>');
if ( p.thread_uri)
{
buf.push('<h4 class="title"><a');
buf.push(attrs({ 'href':(p.thread_uri), "class": ('mutant') }, {"href":true}));
buf.push('>');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</a></h4>');
}
else
{
buf.push('<h4 class="title">');
var __val__ = p.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4>');
}
_post_profile_mixin(p);
buf.push('<div class="container"><span class="username">');
var __val__ = p.user_name
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</span><div');
buf.push(attrs({ 'data-time':(p.created_iso), "class": ('date') }, {"data-time":true}));
buf.push('>');
var __val__ = p.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</div><div class="post-content">');
if ( p.html)
{
buf.push('<p class="body">');
var __val__ = p.html
buf.push(null == __val__ ? "" : __val__);
buf.push('</p>');
}
buf.push('</div></div>');
_post_actions_mixin(p);
buf.push('<div class="reply"></div></div><div class="children">');
if ( p.posts && p.posts.length)
{
// iterate p.posts
;(function(){
  if ('number' == typeof p.posts.length) {
    for (var ii = 0, $$l = p.posts.length; ii < $$l; ii++) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
    }
  } else {
    for (var ii in p.posts) {
      var pp = p.posts[ii];

_post_mixin(pp, ii);
   }
  }
}).call(this);

}
else if ( p.morePosts)
{
buf.push('<a href="#" class="load-more">More Posts</a>');
}
buf.push('</div>');
};
}
return buf.join("");
}
jade.templates["_thread"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
}
return buf.join("");
}
jade.templates["__threads"] = function(locals, attrs, escape, rethrow, merge) {
attrs = attrs || jade.attrs; escape = escape || jade.escape; rethrow = rethrow || jade.rethrow; merge = merge || jade.merge;
var buf = [];
with (locals || {}) {
var interp;
var _thread_mixin = function(t){
var block = this.block, attributes = this.attributes || {}, escaped = this.escaped || {};
 if (!t.user_photo) t.user_photo = cacheUrl + 'images/profile.jpg'
buf.push('<li');
buf.push(attrs({ 'data-id':(t.id), 'data-user-id':(t.user_id), "class": ('thread') }, {"data-id":true,"data-user-id":true}));
buf.push('><a');
buf.push(attrs({ 'data-surf':(t.forum_id), 'href':(t.uri), "class": ('mutant') }, {"data-surf":true,"href":true}));
buf.push('><h4 class="title">');
var __val__ = t.title
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</h4><div class="break"></div><div class="profile photo"><img');
buf.push(attrs({ 'src':("" + (cacheUrl) + "" + (t.user_photo) + "") }, {"src":true}));
buf.push('/></div><div class="container"><span class="username">by<em>');
var __val__ = t.user_name // XXX weird things happened when I tried to turn this into an anchor
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('</em></span><span');
buf.push(attrs({ 'data-time':(t.created_iso), "class": ('created') }, {"data-time":true}));
buf.push('>');
var __val__ = t.created_human
buf.push(null == __val__ ? "" : __val__);
buf.push('</span><div class="clear"></div><span class="post-count">');
var __val__ = t.post_count
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>posts</i></span><span class="views">');
var __val__ = t.views
buf.push(escape(null == __val__ ? "" : __val__));
buf.push('<i>views</i></span></div></a></li>');
};
buf.push('<ul class="threads">');
// iterate topThreads
;(function(){
  if ('number' == typeof topThreads.length) {
    for (var ii = 0, $$l = topThreads.length; ii < $$l; ii++) {
      var t = topThreads[ii];

_thread_mixin(t);
    }
  } else {
    for (var ii in topThreads) {
      var t = topThreads[ii];

_thread_mixin(t);
   }
  }
}).call(this);

buf.push('</ul>');
}
return buf.join("");
}
},{"fs":24}],24:[function(require,module,exports){
// nothing to see here... no file methods for the browser

},{}],14:[function(require,module,exports){
var fsm, typeOfPart, machine, parse, forumUri, out$ = typeof exports != 'undefined' && exports || this, slice$ = [].slice;
fsm = require('./fsm.ls');
/*
states =
  * \initial
  * \forum
  * \new-thread
  * \-thread-marker
  * \thread
  * \thread-page
  * \-page-marker
  * \thread-permalink
  * \-permalink-page-marker
  * \thread-permalink-page
  * \-edit-marker
  * \edit
  * \error

inputs =
  * \string
  * \number
  * \new
  * \edit
  * \t
  * \page
*/
out$.typeOfPart = typeOfPart = function(i){
  switch (i) {
  case 'page':
    return 'page';
  case 't':
    return 't';
  case 'edit':
    return 'edit';
  case 'new':
    return 'new';
  default:
    if (i.match(/[\.]/)) {
      return 'fbdn';
    }
    if (i.match(/^\d+$/)) {
      return 'number';
    } else {
      return 'string';
    }
  }
};
out$.machine = machine = {
  initial: {
    string: 'forum',
    number: 'forum',
    'new': 'forum',
    edit: 'forum',
    t: 'forum',
    page: 'forum',
    fbdn: 'error'
  },
  forum: {
    string: 'forum',
    number: 'forum',
    'new': 'new-thread',
    edit: 'forum',
    t: '-thread-marker',
    page: 'forum',
    fbdn: 'error'
  },
  'new-thread': {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  '-thread-marker': {
    string: 'thread',
    number: 'thread',
    'new': 'thread',
    edit: 'thread',
    t: 'thread',
    page: 'thread',
    fbdn: 'error'
  },
  thread: {
    string: 'thread-permalink',
    number: 'thread-permalink',
    'new': 'error',
    edit: '-edit-marker',
    t: 'error',
    page: '-page-marker',
    fbdn: 'error'
  },
  'thread-permalink': {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: '-edit-marker',
    t: 'error',
    page: '-permalink-page-marker',
    fbdn: 'error'
  },
  '-edit-marker': {
    string: 'error',
    number: 'edit',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  edit: {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  '-permalink-page-marker': {
    string: 'error',
    number: 'thread-permalink-page',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  'thread-permalink-page': {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  '-page-marker': {
    string: 'error',
    number: 'thread-page',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  'thread-page': {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  },
  error: {
    string: 'error',
    number: 'error',
    'new': 'error',
    edit: 'error',
    t: 'error',
    page: 'error',
    fbdn: 'error'
  }
};
out$.parse = parse = function(path){
  var parts, inputs, type, meta, uriParts, page, n, edit, id;
  parts = reject(function(it){
    return it === '';
  })(
  path.split('/'));
  inputs = map(typeOfPart, parts);
  type = fsm.newState(machine, 'initial', inputs);
  meta = (function(){
    var ref$, ref1$;
    switch (type) {
    case 'initial':
      return {
        incomplete: true
      };
    case 'forum':
      return {
        forumUri: "/" + parts.join('/')
      };
    case 'new-thread':
      return {
        forumUri: "/" + slice$.call(parts, 0, parts.length - 1).join('/')
      };
    case 'thread':
      return {
        forumUri: forumUri(path),
        threadUri: "/" + parts.join('/')
      };
    case 'thread-page':
      ref$ = splitAt(parts.length - 2, parts), uriParts = ref$[0], ref1$ = ref$[1], page = ref1$[0], n = ref1$[1];
      return {
        forumUri: forumUri(path),
        threadUri: "/" + uriParts.join('/'),
        page: parseInt(n)
      };
    case 'thread-permalink':
      return {
        forumUri: forumUri(path),
        threadUri: "/" + parts.join('/'),
        slug: parts[parts.length - 1]
      };
    case 'thread-permalink-page':
      ref$ = splitAt(parts.length - 2, parts), uriParts = ref$[0], ref1$ = ref$[1], page = ref1$[0], n = ref1$[1];
      return {
        forumUri: forumUri(path),
        threadUri: "/" + uriParts.join('/'),
        page: parseInt(n)
      };
    case 'edit':
      ref$ = splitAt(parts.length - 2, parts), uriParts = ref$[0], ref1$ = ref$[1], edit = ref1$[0], id = ref1$[1];
      return {
        forumUri: forumUri(path),
        threadUri: "/" + uriParts.join('/'),
        id: parseInt(id)
      };
    default:
      return {
        incomplete: true
      };
    }
  }());
  return import$({
    type: type,
    parts: parts,
    path: "/" + parts.join('/')
  }, meta);
};
out$.forumUri = forumUri = function(path){
  var parts, inputs, t, forumStates;
  parts = reject(function(it){
    return it === '';
  })(
  path.split('/'));
  inputs = map(typeOfPart, parts);
  t = function(state, input){
    return fsm.newState(machine, state, [input]);
  };
  forumStates = takeWhile(function(it){
    return it === 'initial' || it === 'forum';
  })(
  scan(t, 'initial', inputs));
  return '/' + join('/')(
  take(forumStates.length - 1)(
  parts));
};
/*
Try these in the REPL.

furl.parse '/otherground-forum'
furl.parse '/otherground-forum/supportground'
furl.parse '/otherground-forum/new'                                                 # we can identify the new thread marker
furl.parse '/otherground-forum/supportground/t/new'                                 # threads can be called "new"
furl.parse '/otherground-forum/supportground/t/edit'                                # threads can be called "edit"
furl.parse '/otherground-forum/supportground/t/edit/edit'                           # ...but we can still identify the edit marker
furl.parse '/otherground-forum/supportground/t/edit/edit/1234'                      # and know this is an edit url
furl.parse '/otherground-forum/supportground/t/new-thing'                  
furl.parse '/otherground-forum/supportground/t/new-thing/page/5'                    # pretty page urls are not a problem
furl.parse '/otherground-forum/supportground/t/this-is-a-test/edit/2108'
*/
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"./fsm.ls":25}],21:[function(require,module,exports){
if (typeof define !== 'function') { var define = require('amdefine')(module, require); }
define(function(require){ return require('./src/Component'); });

},{"./src/Component":26,"amdefine":27}],27:[function(require,module,exports){
(function(process,__filename){/** vim: et:ts=4:sw=4:sts=4
 * @license amdefine 0.0.5 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/amdefine for details
 */

/*jslint node: true */
/*global module, process */
'use strict';

var path = require('path');

/**
 * Creates a define for node.
 * @param {Object} module the "module" object that is defined by Node for the
 * current module.
 * @param {Function} [require]. Node's require function for the current module.
 * It only needs to be passed in Node versions before 0.5, when module.require
 * did not exist.
 * @returns {Function} a define function that is usable for the current node
 * module.
 */
function amdefine(module, require) {
    var defineCache = {},
        loaderCache = {},
        alreadyCalled = false,
        makeRequire, stringRequire;

    /**
     * Trims the . and .. from an array of path segments.
     * It will keep a leading path segment if a .. will become
     * the first path segment, to help with module name lookups,
     * which act like paths, but can be remapped. But the end result,
     * all paths that use this function should look normalized.
     * NOTE: this method MODIFIES the input array.
     * @param {Array} ary the array of path segments.
     */
    function trimDots(ary) {
        var i, part;
        for (i = 0; ary[i]; i+= 1) {
            part = ary[i];
            if (part === '.') {
                ary.splice(i, 1);
                i -= 1;
            } else if (part === '..') {
                if (i === 1 && (ary[2] === '..' || ary[0] === '..')) {
                    //End of the line. Keep at least one non-dot
                    //path segment at the front so it can be mapped
                    //correctly to disk. Otherwise, there is likely
                    //no path mapping for a path starting with '..'.
                    //This can still fail, but catches the most reasonable
                    //uses of ..
                    break;
                } else if (i > 0) {
                    ary.splice(i - 1, 2);
                    i -= 2;
                }
            }
        }
    }

    function normalize(name, baseName) {
        var baseParts;

        //Adjust any relative paths.
        if (name && name.charAt(0) === '.') {
            //If have a base name, try to normalize against it,
            //otherwise, assume it is a top-level require that will
            //be relative to baseUrl in the end.
            if (baseName) {
                baseParts = baseName.split('/');
                baseParts = baseParts.slice(0, baseParts.length - 1);
                baseParts = baseParts.concat(name.split('/'));
                trimDots(baseParts);
                name = baseParts.join('/');
            }
        }

        return name;
    }

    /**
     * Create the normalize() function passed to a loader plugin's
     * normalize method.
     */
    function makeNormalize(relName) {
        return function (name) {
            return normalize(name, relName);
        };
    }

    function makeLoad(id) {
        function load(value) {
            loaderCache[id] = value;
        }

        load.fromText = function (id, text) {
            //This one is difficult because the text can/probably uses
            //define, and any relative paths and requires should be relative
            //to that id was it would be found on disk. But this would require
            //bootstrapping a module/require fairly deeply from node core.
            //Not sure how best to go about that yet.
            throw new Error('amdefine does not implement load.fromText');
        };

        return load;
    }

    makeRequire = function (systemRequire, exports, module, relId) {
        function amdRequire(deps, callback) {
            if (typeof deps === 'string') {
                //Synchronous, single module require('')
                return stringRequire(systemRequire, exports, module, deps, relId);
            } else {
                //Array of dependencies with a callback.

                //Convert the dependencies to modules.
                deps = deps.map(function (depName) {
                    return stringRequire(systemRequire, exports, module, depName, relId);
                });

                //Wait for next tick to call back the require call.
                process.nextTick(function () {
                    callback.apply(null, deps);
                });
            }
        }

        amdRequire.toUrl = function (filePath) {
            if (filePath.indexOf('.') === 0) {
                return normalize(filePath, path.dirname(module.filename));
            } else {
                return filePath;
            }
        };

        return amdRequire;
    };

    //Favor explicit value, passed in if the module wants to support Node 0.4.
    require = require || function req() {
        return module.require.apply(module, arguments);
    };

    function runFactory(id, deps, factory) {
        var r, e, m, result;

        if (id) {
            e = loaderCache[id] = {};
            m = {
                id: id,
                uri: __filename,
                exports: e
            };
            r = makeRequire(require, e, m, id);
        } else {
            //Only support one define call per file
            if (alreadyCalled) {
                throw new Error('amdefine with no module ID cannot be called more than once per file.');
            }
            alreadyCalled = true;

            //Use the real variables from node
            //Use module.exports for exports, since
            //the exports in here is amdefine exports.
            e = module.exports;
            m = module;
            r = makeRequire(require, e, m, module.id);
        }

        //If there are dependencies, they are strings, so need
        //to convert them to dependency values.
        if (deps) {
            deps = deps.map(function (depName) {
                return r(depName);
            });
        }

        //Call the factory with the right dependencies.
        if (typeof factory === 'function') {
            result = factory.apply(module.exports, deps);
        } else {
            result = factory;
        }

        if (result !== undefined) {
            m.exports = result;
            if (id) {
                loaderCache[id] = m.exports;
            }
        }
    }

    stringRequire = function (systemRequire, exports, module, id, relId) {
        //Split the ID by a ! so that
        var index = id.indexOf('!'),
            originalId = id,
            prefix, plugin;

        if (index === -1) {
            id = normalize(id, relId);

            //Straight module lookup. If it is one of the special dependencies,
            //deal with it, otherwise, delegate to node.
            if (id === 'require') {
                return makeRequire(systemRequire, exports, module, relId);
            } else if (id === 'exports') {
                return exports;
            } else if (id === 'module') {
                return module;
            } else if (loaderCache.hasOwnProperty(id)) {
                return loaderCache[id];
            } else if (defineCache[id]) {
                runFactory.apply(null, defineCache[id]);
                return loaderCache[id];
            } else {
                if(systemRequire) {
                    return systemRequire(originalId);
                } else {
                    throw new Error('No module with ID: ' + id);
                }
            }
        } else {
            //There is a plugin in play.
            prefix = id.substring(0, index);
            id = id.substring(index + 1, id.length);

            plugin = stringRequire(systemRequire, exports, module, prefix, relId);

            if (plugin.normalize) {
                id = plugin.normalize(id, makeNormalize(relId));
            } else {
                //Normalize the ID normally.
                id = normalize(id, relId);
            }

            if (loaderCache[id]) {
                return loaderCache[id];
            } else {
                plugin.load(id, makeRequire(systemRequire, exports, module, relId), makeLoad(id), {});

                return loaderCache[id];
            }
        }
    };

    //Create a define function specific to the module asking for amdefine.
    function define(id, deps, factory) {
        if (Array.isArray(id)) {
            factory = deps;
            deps = id;
            id = undefined;
        } else if (typeof id !== 'string') {
            factory = id;
            id = deps = undefined;
        }

        if (deps && !Array.isArray(deps)) {
            factory = deps;
            deps = undefined;
        }

        if (!deps) {
            deps = ['require', 'exports', 'module'];
        }

        //Set up properties for this module. If an ID, then use
        //internal cache. If no ID, then use the external variables
        //for this node module.
        if (id) {
            //Put the module in deep freeze until there is a
            //require call for it.
            defineCache[id] = [id, deps, factory];
        } else {
            runFactory(id, deps, factory);
        }
    }

    //define.require, which has access to all the values in the
    //cache. Useful for AMD modules that all have IDs in the file,
    //but need to finally export a value to node based on one of those
    //IDs.
    define.require = function (id) {
        if (loaderCache[id]) {
            return loaderCache[id];
        }

        if (defineCache[id]) {
            runFactory.apply(null, defineCache[id]);
            return loaderCache[id];
        }
    };

    define.amd = {};

    return define;
}

module.exports = amdefine;

})(require("__browserify_process"),"/../node_modules/yacomponent/node_modules/amdefine/amdefine.js")
},{"path":28,"__browserify_process":13}],15:[function(require,module,exports){
var Component, ch, templates, AdminMenu;
Component = require('yacomponent');
ch = require('../app/client-helpers.ls');
templates = require('../build/component-jade.js').templates;
module.exports = AdminMenu = (function(superclass){
  var prefix, opts, prototype = extend$((import$(AdminMenu, superclass).displayName = 'AdminMenu', AdminMenu), superclass).prototype, constructor = AdminMenu;
  prefix = 'list_';
  opts = {
    handle: 'div',
    items: 'li',
    maxLevels: 2,
    tolerance: 'pointer',
    toleranceElement: '> div',
    placeholder: 'placeholder'
  };
  prototype.template = templates.AdminMenu;
  prototype.current = null;
  prototype.show = function(){
    var this$ = this;
    return setTimeout(function(){
      return this$.$.find('.col2').show(300);
    }, 300);
  };
  prototype.clone = function(item){
    var e, x$, ref$;
    console.log('clone:', item);
    e = this.$.find('.default').clone().removeClass('default').attr('id', item.id);
    x$ = e.find('input');
    x$.data('menu', (ref$ = item.data) != null ? ref$.menu : void 8);
    x$.data('title', (ref$ = item.data) != null ? ref$.title : void 8);
    x$.val((ref$ = item.data) != null ? ref$.title : void 8);
    return e;
  };
  prototype.currentStore = function(){
    var e, form, x$;
    if (!(e = this.current)) {
      return;
    }
    console.log('here');
    form = this.$.find('form');
    if (form) {
      form.find('input[name="menu"]' != null
        ? 'input[name="menu"]'
        : remove());
      x$ = e;
      x$.data('form', form.serialize());
      x$.data('title', this.current.val());
      console.log('store-menu:', e.data('menu'));
      console.log('store-title:', e.data('title'));
    }
  };
  prototype.currentRestore = function(){
    var e, form, reset, ref$, title;
    if (!(e = this.current)) {
      return;
    }
    if (form = this.$.find('form')) {
      reset = function(){
        return form.get(0).reset();
      };
      ref$ = this.current.data, form = ref$.form, title = ref$.title;
      e.val(title);
      if (menu) {
        form.deserialize(form);
        this.current.val(title);
        console.log('restored:', form);
      } else {
        reset();
      }
    }
  };
  prototype.onAttach = function(){
    var site, s, i$, ref$, len$, item, this$ = this;
    site = this.state.site();
    if (site.config.menu) {
      s = this.$.find('.sortable');
      for (i$ = 0, len$ = (ref$ = JSON.parse(site.config.menu)).length; i$ < len$; ++i$) {
        item = ref$[i$];
        console.log('parsed:', item);
        if (item.id) {
          item.id = prefix + "" + item.id;
          s.append(this.clone(item));
        }
      }
      s.nestedSortable(opts);
      setTimeout(function(){
        return s.find('input:first').focus();
      }, 200);
      this.show();
    }
    this.$.on('click', '.onclick-add', function(ev){
      var s, max, id, e, x$;
      this$.show();
      s = this$.$.find('.sortable');
      max = parseInt(maximum(map(function(it){
        return it.id.replace(prefix, '');
      })(
      s.find('li'))));
      id = !max
        ? 1
        : max + 1;
      e = this$.clone({
        id: prefix + "" + id
      });
      console.log('created:', e);
      x$ = this$.$.find('.sortable');
      x$.append(e);
      x$.nestedSortable(opts);
      x$.find('input').focus();
      this$.currentRestore;
      return false;
    });
    this.$.on('click', 'button[type="submit"]', function(ev){
      var menu, form;
      this$.currentStore();
      menu = this$.$.find('.sortable').data('mjsNestedSortable').toHierarchy();
      if (!menu.length) {
        menu = [menu];
      }
      console.log('saving-nested-sortable:', menu);
      form = this$.$.find('form');
      form.append(constructor.$('<input>').attr('type', 'hidden').attr('name', 'menu').val(JSON.stringify(menu)));
      return submitForm(ev, function(data){
        var f, t, ref$;
        f = $(this);
        t = $(form.find('.tooltip'));
        return showTooltip(t, !data.success ? data != null ? (ref$ = data.errors) != null ? ref$.join('<br>') : void 8 : void 8 : 'Saved!');
      });
    });
    this.$.on('blur', '.row', function(ev){
      return this$.currentStore();
    });
    this.$.on('change', 'form', function(ev){
      return this$.currentStore();
    });
    this.$.on('click', '.row', function(ev){
      this$.current = $(ev.target);
      return this$.currentRestore;
    });
    this.$.find('.sortable').nestedSortable(opts);
  };
  prototype.onDetach = function(){
    return this.$.off();
  };
  function AdminMenu(){
    this.onAttach = bind$(this, 'onAttach', prototype);
    this.currentRestore = bind$(this, 'currentRestore', prototype);
    this.currentStore = bind$(this, 'currentStore', prototype);
    this.clone = bind$(this, 'clone', prototype);
    this.show = bind$(this, 'show', prototype);
    AdminMenu.superclass.apply(this, arguments);
  }
  return AdminMenu;
}(Component));
function bind$(obj, key, target){
  return function(){ return (target || obj)[key].apply(obj, arguments) };
}
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../app/client-helpers.ls":4,"../build/component-jade.js":20,"yacomponent":21}],18:[function(require,module,exports){
var Component, sh, templates, PhotoCropper;
Component = require('yacomponent');
sh = require('../app/shared-helpers.ls');
templates = require('../build/component-jade.js').templates;
module.exports = PhotoCropper = (function(superclass){
  var prototype = extend$((import$(PhotoCropper, superclass).displayName = 'PhotoCropper', PhotoCropper), superclass).prototype, constructor = PhotoCropper;
  PhotoCropper.pc = null;
  PhotoCropper.start = function(arg$, cb){
    var ref$, title, ref1$, mode, photo, aspectRatio, endpointUrl;
    ref$ = arg$ != null
      ? arg$
      : {}, title = (ref1$ = ref$.title) != null ? ref1$ : "Profile Photo", mode = (ref1$ = ref$.mode) != null ? ref1$ : 'upload', photo = (ref1$ = ref$.photo) != null ? ref1$ : null, aspectRatio = (ref1$ = ref$.aspectRatio) != null
      ? ref1$
      : 1 / 1, endpointUrl = (ref1$ = ref$.endpointUrl) != null ? ref1$ : null;
    cb == null && (cb = function(){});
    if (!photo) {
      photo = user.photo;
    }
    if (!endpointUrl) {
      endpointUrl = "/resources/users/" + user.id + "/avatar";
    }
    return lazyLoadFancybox(function(){
      PhotoCropper.pc = new PhotoCropper({
        aspectRatio: aspectRatio,
        endpointUrl: endpointUrl,
        locals: {
          title: title,
          photo: photo,
          endpointUrl: endpointUrl
        }
      });
      if (mode === 'crop') {
        PhotoCropper.pc.cropMode();
      }
      return $.fancybox.open(PhotoCropper.pc.$, {
        afterLoad: cb
      });
    });
  };
  function PhotoCropper(arg$){
    var title, aspectRatio;
    title = arg$.title, aspectRatio = arg$.aspectRatio, this.endpointUrl = arg$.endpointUrl;
    this.crop = bind$(this, 'crop', prototype);
    this.aspectRatio = parseFloat(aspectRatio);
    PhotoCropper.superclass.apply(this, arguments);
  }
  prototype.template = templates.PhotoCropper;
  prototype.jcrop = null;
  prototype.init = function(){
    if (this.aspectRatio) {
      return 1;
    } else {
      return 1;
    }
  };
  prototype.onAttach = function(){
    var this$ = this;
    this.$.find('.upload input[type=file]').html5Uploader({
      name: 'avatar',
      postUrl: this.endpointUrl,
      onSuccess: function(xhr, file, rJson){
        var r;
        r = JSON.parse(rJson);
        this$.$.find('img').attr('src', cacheUrl + "" + r.url);
        return this$.cropMode();
      }
    });
    return this.$.find('.crop .button').click(this.crop);
  };
  prototype.upload = function(){
    var data, jqxhr, this$ = this;
    data = this.$.find('form').serialize();
    jqxhr = constructor.$.post(this.endpointUrl, data);
    jqxhr.done(function(r){
      return this$.cropMode(r);
    });
    return jqxhr.fail(function(r){
      return console.warn('upload failed', r);
    });
  };
  prototype.uploadMode = function(){
    this.$.find('.crop').hide();
    return this.$.find('.upload').show();
  };
  prototype.cropMode = function(){
    var this$ = this;
    this.$.find('.upload').hide();
    this.$.find('.crop').show();
    return lazyLoadJcrop(function(){
      var options, fb, saveJcrop;
      if (this$.jcrop) {
        this$.jcrop.destroy();
      }
      options = {
        aspectRatio: this$.aspectRatio
      };
      import$(options, this$.boxDimensions());
      fb = constructor.$.fancybox;
      saveJcrop = function(j){
        return this$.jcrop = j;
      };
      return this$.$.find('.crop img').Jcrop(options, function(){
        saveJcrop(this);
        return fb.update();
      });
    });
  };
  prototype.boxDimensions = function(){
    var fancyboxSideMargin, resize;
    fancyboxSideMargin = 35;
    resize = 0.95;
    return {
      boxWidth: parseInt(constructor.$(window).width() - fancyboxSideMargin * 2),
      boxHeight: parseInt(constructor.$(window).height() * resize)
    };
  };
  prototype.crop = function(ev){
    var data, jqxhr, this$ = this;
    data = this.jcrop.tellSelect();
    if (data.height === 0 || data.width === 0) {
      return;
    }
    jqxhr = constructor.$.ajax({
      type: 'PUT',
      data: data,
      url: this.endpointUrl
    });
    jqxhr.done(function(r){
      return constructor.$.fancybox.close();
    });
    return jqxhr.fail(function(r){
      return console.warn('upload failed', r);
    });
  };
  return PhotoCropper;
}(Component));
function bind$(obj, key, target){
  return function(){ return (target || obj)[key].apply(obj, arguments) };
}
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../app/shared-helpers.ls":3,"../build/component-jade.js":20,"yacomponent":21}],16:[function(require,module,exports){
var Component, templates, Paginator;
Component = require('yacomponent');
templates = require('../build/component-jade.js').templates;
function calcPages(activePage, step, qty, pageDistance, pageQty, pnumToHref){
  var beg, end, pages, res$, i$, ref$, len$, num, firstNum, lastNum;
  activePage = parseInt(activePage);
  step = parseInt(step);
  qty = parseInt(qty);
  pageDistance = parseInt(pageDistance);
  pageQty = parseInt(pageQty);
  activePage = parseInt(activePage);
  beg = Math.max(activePage - pageDistance, 1);
  end = Math.min(activePage + pageDistance, pageQty);
  if (activePage <= pageDistance) {
    end = Math.min(end + (pageDistance - activePage) + 1, pageQty);
  } else if (activePage >= pageQty - pageDistance) {
    beg = Math.max(beg - (pageDistance - (pageQty - activePage)), 1);
  }
  res$ = [];
  for (i$ = 0, len$ = (ref$ = (fn$())).length; i$ < len$; ++i$) {
    num = ref$[i$];
    res$.push({
      num: num,
      title: num,
      href: pnumToHref(num),
      active: activePage === num
    });
  }
  pages = res$;
  firstNum = 1;
  if (pages.length && pages[0].title !== firstNum) {
    pages.unshift({
      num: firstNum,
      title: 'First',
      href: pnumToHref(firstNum)
    });
  }
  lastNum = pages.length - 1;
  if (pages.length && pages[lastNum].title !== pageQty) {
    pages.push({
      num: pageQty,
      title: 'Last',
      href: pnumToHref(pageQty)
    });
  }
  return pages;
  function fn$(){
    var i$, to$, results$ = [];
    for (i$ = beg, to$ = end; i$ <= to$; ++i$) {
      results$.push(i$);
    }
    return results$;
  }
}
module.exports = Paginator = (function(superclass){
  var defaultLocals, prototype = extend$((import$(Paginator, superclass).displayName = 'Paginator', Paginator), superclass).prototype, constructor = Paginator;
  defaultLocals = {
    activePage: 1,
    step: 8,
    qty: 0,
    pageDistance: 4
  };
  function Paginator(arg$){
    var ref$, pnumToHref;
    ref$ = arg$ != null
      ? arg$
      : {}, pnumToHref = ref$.pnumToHref, this.onPage = ref$.onPage;
    if (!pnumToHref) {
      if (this.onPage) {
        pnumToHref = function(){
          return '#';
        };
      } else {
        pnumToHref = function(it){
          return "?page=" + it;
        };
      }
    }
    this.pnumToHref = constructor.$R.state(pnumToHref);
    Paginator.superclass.apply(this, arguments);
  }
  prototype.init = function(){
    var k, ref$, v, this$ = this;
    for (k in ref$ = defaultLocals) {
      v = ref$[k];
      if (this.local(k) === void 8) {
        this.local(k, v);
      }
    }
    this.state.pageQty = constructor.$R(function(qty, step){
      return Math.ceil(qty / step);
    }).bindTo(this.state.qty, this.state.step);
    return function(){
      var bindings, ref$;
      bindings = [this$.state.activePage, this$.state.step, this$.state.qty, this$.state.pageDistance, this$.state.pageQty, this$.pnumToHref];
      return this$.state.pages = (ref$ = constructor.$R(calcPages)).bindTo.apply(ref$, bindings);
    }();
  };
  prototype.template = templates.Paginator;
  prototype.onAttach = function(){
    var c, handler;
    this.$.show();
    if (this.onPage) {
      c = this;
      handler = function(){
        var pg;
        pg = parseInt(constructor.$(this).data('page'));
        c.local('activePage', pg);
        c.reload();
        c.onPage(pg, c);
        return false;
      };
      return this.$.on('click', 'a', handler);
    }
  };
  prototype.onDetach = function(){
    return this.$.off();
  };
  return Paginator;
}(Component));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../build/component-jade.js":20,"yacomponent":21}],17:[function(require,module,exports){
var Component, templates, AdminUpgrade;
Component = require('yacomponent');
templates = require('../build/component-jade.js').templates;
module.exports = AdminUpgrade = (function(superclass){
  var prototype = extend$((import$(AdminUpgrade, superclass).displayName = 'AdminUpgrade', AdminUpgrade), superclass).prototype, constructor = AdminUpgrade;
  prototype.template = templates.AdminUpgrade;
  function AdminUpgrade(){
    AdminUpgrade.superclass.apply(this, arguments);
  }
  return AdminUpgrade;
}(Component));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"../build/component-jade.js":20,"yacomponent":21}],23:[function(require,module,exports){
var lodash, Component, ParallaxButton, SiteRegister, sh, templates, debounce, Sales, slice$ = [].slice;
lodash = require('lodash');
Component = require('yacomponent');
ParallaxButton = require('./ParallaxButton.ls');
SiteRegister = require('./SiteRegister.ls');
sh = require('../app/shared-helpers.ls');
templates = require('../build/component-jade.js').templates;
debounce = partialize$.apply(lodash, [lodash.debounce, [void 8, 250], [0]]);
module.exports = Sales = (function(superclass){
  var prototype = extend$((import$(Sales, superclass).displayName = 'Sales', Sales), superclass).prototype, constructor = Sales;
  prototype.template = templates.Sales;
  prototype.init = function(){
    this.local('subdomain', '');
    return this.children = {
      registerTop: new SiteRegister({
        locals: {
          subdomain: this.state.subdomain
        }
      }, '#register_top', this),
      registerBottom: new SiteRegister({
        locals: {
          subdomain: this.state.subdomain
        }
      }, '#register_bottom', this)
    };
  };
  prototype.onAttach = function(){
    var this$ = this;
    return constructor.$R(function(subdomain){
      var i$, ref$, len$, c, results$ = [];
      for (i$ = 0, len$ = (ref$ = [this$.children.registerTop, this$.children.registerBottom]).length; i$ < len$; ++i$) {
        c = ref$[i$];
        results$.push(c.updateSubdomain(subdomain));
      }
      return results$;
    }).bindTo(this.state.subdomain);
  };
  function Sales(){
    Sales.superclass.apply(this, arguments);
  }
  return Sales;
}(Component));
function partialize$(f, args, where){
  var context = this;
  return function(){
    var params = slice$.call(arguments), i,
        len = params.length, wlen = where.length,
        ta = args ? args.concat() : [], tw = where ? where.concat() : [];
    for(i = 0; i < len; ++i) { ta[tw[0]] = params[i]; tw.shift(); }
    return len < wlen && len ?
      partialize$.apply(context, [f, ta, tw]) : f.apply(context, ta);
  };
}
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"./ParallaxButton.ls":29,"../app/shared-helpers.ls":3,"./SiteRegister.ls":30,"../build/component-jade.js":20,"yacomponent":21,"lodash":22}],28:[function(require,module,exports){
(function(process){function filter (xs, fn) {
    var res = [];
    for (var i = 0; i < xs.length; i++) {
        if (fn(xs[i], i, xs)) res.push(xs[i]);
    }
    return res;
}

// resolves . and .. elements in a path array with directory names there
// must be no slashes, empty elements, or device names (c:\) in the array
// (so also no leading and trailing slashes - it does not distinguish
// relative and absolute paths)
function normalizeArray(parts, allowAboveRoot) {
  // if the path tries to go above the root, `up` ends up > 0
  var up = 0;
  for (var i = parts.length; i >= 0; i--) {
    var last = parts[i];
    if (last == '.') {
      parts.splice(i, 1);
    } else if (last === '..') {
      parts.splice(i, 1);
      up++;
    } else if (up) {
      parts.splice(i, 1);
      up--;
    }
  }

  // if the path is allowed to go above the root, restore leading ..s
  if (allowAboveRoot) {
    for (; up--; up) {
      parts.unshift('..');
    }
  }

  return parts;
}

// Regex to split a filename into [*, dir, basename, ext]
// posix version
var splitPathRe = /^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;

// path.resolve([from ...], to)
// posix version
exports.resolve = function() {
var resolvedPath = '',
    resolvedAbsolute = false;

for (var i = arguments.length; i >= -1 && !resolvedAbsolute; i--) {
  var path = (i >= 0)
      ? arguments[i]
      : process.cwd();

  // Skip empty and invalid entries
  if (typeof path !== 'string' || !path) {
    continue;
  }

  resolvedPath = path + '/' + resolvedPath;
  resolvedAbsolute = path.charAt(0) === '/';
}

// At this point the path should be resolved to a full absolute path, but
// handle relative paths to be safe (might happen when process.cwd() fails)

// Normalize the path
resolvedPath = normalizeArray(filter(resolvedPath.split('/'), function(p) {
    return !!p;
  }), !resolvedAbsolute).join('/');

  return ((resolvedAbsolute ? '/' : '') + resolvedPath) || '.';
};

// path.normalize(path)
// posix version
exports.normalize = function(path) {
var isAbsolute = path.charAt(0) === '/',
    trailingSlash = path.slice(-1) === '/';

// Normalize the path
path = normalizeArray(filter(path.split('/'), function(p) {
    return !!p;
  }), !isAbsolute).join('/');

  if (!path && !isAbsolute) {
    path = '.';
  }
  if (path && trailingSlash) {
    path += '/';
  }
  
  return (isAbsolute ? '/' : '') + path;
};


// posix version
exports.join = function() {
  var paths = Array.prototype.slice.call(arguments, 0);
  return exports.normalize(filter(paths, function(p, index) {
    return p && typeof p === 'string';
  }).join('/'));
};


exports.dirname = function(path) {
  var dir = splitPathRe.exec(path)[1] || '';
  var isWindows = false;
  if (!dir) {
    // No dirname
    return '.';
  } else if (dir.length === 1 ||
      (isWindows && dir.length <= 3 && dir.charAt(1) === ':')) {
    // It is just a slash or a drive letter with a slash
    return dir;
  } else {
    // It is a full dirname, strip trailing slash
    return dir.substring(0, dir.length - 1);
  }
};


exports.basename = function(path, ext) {
  var f = splitPathRe.exec(path)[2] || '';
  // TODO: make this comparison case-insensitive on windows?
  if (ext && f.substr(-1 * ext.length) === ext) {
    f = f.substr(0, f.length - ext.length);
  }
  return f;
};


exports.extname = function(path) {
  return splitPathRe.exec(path)[3] || '';
};

exports.relative = function(from, to) {
  from = exports.resolve(from).substr(1);
  to = exports.resolve(to).substr(1);

  function trim(arr) {
    var start = 0;
    for (; start < arr.length; start++) {
      if (arr[start] !== '') break;
    }

    var end = arr.length - 1;
    for (; end >= 0; end--) {
      if (arr[end] !== '') break;
    }

    if (start > end) return [];
    return arr.slice(start, end - start + 1);
  }

  var fromParts = trim(from.split('/'));
  var toParts = trim(to.split('/'));

  var length = Math.min(fromParts.length, toParts.length);
  var samePartsLength = length;
  for (var i = 0; i < length; i++) {
    if (fromParts[i] !== toParts[i]) {
      samePartsLength = i;
      break;
    }
  }

  var outputParts = [];
  for (var i = samePartsLength; i < fromParts.length; i++) {
    outputParts.push('..');
  }

  outputParts = outputParts.concat(toParts.slice(samePartsLength));

  return outputParts.join('/');
};

})(require("__browserify_process"))
},{"__browserify_process":13}],25:[function(require,module,exports){
/*
export example =
  A:
    a: "B"
    b: "C"
  B:
    a: "A"
    b: "C"
  C:
    a: "C"
    b: "C"
*/
var newState, out$ = typeof exports != 'undefined' && exports || this;
out$.newState = newState = function(machine, state, inputs){
  var transition;
  transition = function(s, i){
    return machine[s][i];
  };
  return fold(transition, state, inputs);
};
},{}],26:[function(require,module,exports){
(function(){
  var define;
  define = (typeof window != 'undefined' && window !== null ? window.define : void 8) || require('amdefine')(module, require);
  define(function(require){
    var reactivejs, dollarish, Component;
    reactivejs = require('reactivejs');
    dollarish = typeof window != 'undefined' && window !== null
      ? window.$
      : require('cheerio');
    return Component = (function(){
      Component.displayName = 'Component';
      var prototype = Component.prototype, constructor = Component;
      Component.$ = dollarish;
      Component.$R = reactivejs;
      function Component(arg$, selector, parent){
        var ref$, locals, ref1$, autoRender, autoAttach, res$, k, v;
        ref$ = arg$ != null
          ? arg$
          : {}, locals = (ref1$ = ref$.locals) != null
          ? ref1$
          : {}, autoRender = (ref1$ = ref$.autoRender) != null ? ref1$ : true, autoAttach = (ref1$ = ref$.autoAttach) != null ? ref1$ : true;
        this.selector = selector;
        this.parent = parent;
        res$ = {};
        for (k in locals) {
          v = locals[k];
          res$[k] = v != null && v._isReactive
            ? v
            : constructor.$R.state(v === void 8 ? null : v);
        }
        this.state = res$;
        if (this.selector) {
          if (this.parent) {
            this.$ = this.parent.$.find(this.selector);
          } else {
            this.$ = constructor.$(this.selector);
          }
        } else {
          this.$top = constructor.$('<div><div/></div>');
          this.$ = this.$top.find('div');
        }
        if (this.init) {
          this.init();
        }
        if (!this.parent) {
          if (autoRender) {
            this.render();
          }
          if (autoAttach) {
            this.attach();
          }
        }
      }
      prototype.isClient = typeof window != 'undefined' && window !== null;
      prototype.template = function(){
        return '';
      };
      prototype.attach = function(){
        var i$, ref$, child;
        if (!this.isClient) {
          return this;
        }
        if (this.isAttached) {
          return this;
        }
        if (this.children) {
          for (i$ in ref$ = this.children) {
            child = ref$[i$];
            child.attach();
          }
        }
        if (this.onAttach) {
          this.onAttach();
        }
        this.isAttached = true;
        return this;
      };
      prototype.detach = function(){
        var i$, ref$, child;
        if (!this.isClient) {
          return this;
        }
        if (!this.isAttached) {
          return this;
        }
        if (this.children) {
          for (i$ in ref$ = this.children) {
            child = ref$[i$];
            child.detach();
          }
        }
        if (this.onDetach) {
          this.onDetach();
        }
        this.isAttached = false;
        return this;
      };
      prototype.render = function(){
        var locals, templateOut, $dom, i$, ref$, child;
        this.$.addClass(this.constructor.name);
        locals = this.locals();
        templateOut = this.template(locals);
        if (this.mutate || this.children) {
          $dom = constructor.$('<div class="render-wrapper">' + templateOut + '</div>');
          if (this.mutate) {
            this.mutate($dom);
          }
          this.$.html($dom.html());
          if (this.children) {
            for (i$ in ref$ = this.children) {
              child = ref$[i$];
              child.$ = this.$.find(child.selector);
              child.render();
            }
          }
        } else {
          this.$.html(templateOut);
        }
        return this;
      };
      prototype.reload = function(){
        return this.detach().render().attach();
      };
      prototype.locals = function(newLocals){
        var k, v, ref$, s, results$ = {};
        if (newLocals) {
          for (k in newLocals) {
            v = newLocals[k];
            this.local(k, v);
          }
        }
        for (k in ref$ = this.state) {
          s = ref$[k];
          results$[k] = s();
        }
        return results$;
      };
      prototype.local = function(k, v){
        var existingR;
        existingR = this.state[k];
        if (v === void 8) {
          if (existingR) {
            return existingR();
          }
        } else {
          if (existingR) {
            if (existingR.val === void 8) {
              throw new Error("'" + k + "' is not reactive state, you can only set reactive state");
            } else {
              return existingR(v === void 8 ? null : v);
            }
          } else {
            this.state[k] = constructor.$R.state(v === void 8 ? null : v);
            return v;
          }
        }
      };
      prototype.html = function(wrapped){
        wrapped == null && (wrapped = true);
        return ((wrapped && this.$top) || this.$).html();
      };
      return Component;
    }());
  });
}).call(this);

},{"cheerio":12,"amdefine":27,"reactivejs":8}],29:[function(require,module,exports){
var Component, $R, ParallaxButton;
Component = require('yacomponent');
$R = require('reactivejs');
module.exports = ParallaxButton = (function(superclass){
  var prototype = extend$((import$(ParallaxButton, superclass).displayName = 'ParallaxButton', ParallaxButton), superclass).prototype, constructor = ParallaxButton;
  prototype.template = function(arg$){
    var title;
    title = arg$.title;
    return "<button>" + title + "</button>";
  };
  function ParallaxButton(arg$){
    var ref$;
    this.onClick = (ref$ = arg$.onClick) != null
      ? ref$
      : function(){};
    ParallaxButton.superclass.apply(this, arguments);
  }
  prototype.onAttach = function(){
    var this$ = this;
    this.$.on('click', 'button', function(){
      this$.onClick();
      return false;
    });
    this.onLoadResize || (this.onLoadResize = function(){
      this$.renderLeftHalf();
      return this$.renderTopHalf();
    });
    this.onScroll || (this.onScroll = function(){
      return this$.renderTopHalf();
    });
    constructor.$(window).on('load resize', this.onLoadResize);
    constructor.$(window).on('scroll', this.onScroll);
  };
  prototype.onDetach = function(){
    this.$.off('click', 'button');
    constructor.$(window).off('load resize', this.onLoadResize);
    constructor.$(window).off('scroll', this.onScroll);
  };
  prototype.renderTopHalf = function(){
    var $button, offTop, scrTop, halfWindowHeight;
    $button = this.$.find('button');
    offTop = $button.offset().top;
    scrTop = constructor.$(window).scrollTop();
    halfWindowHeight = constructor.$(window).height() / 2;
    $button.toggleClass('top-half', offTop - scrTop < halfWindowHeight);
  };
  prototype.renderLeftHalf = function(){
    var $button, offLeft, halfWindowWidth;
    $button = this.$.find('button');
    offLeft = $button.offset().left;
    halfWindowWidth = constructor.$(window).width() / 2;
    $button.toggleClass('left-half', offLeft < halfWindowWidth);
  };
  prototype.enable = function(){
    this.$.find('button').attr('disabled', null);
    this.attach();
  };
  prototype.disable = function(){
    this.$.find('button').attr('disabled', true);
    this.detach();
  };
  return ParallaxButton;
}(Component));
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
},{"yacomponent":21,"reactivejs":8}],30:[function(require,module,exports){
(function(global){var lodash, Component, ParallaxButton, Auth, sh, ch, pureValidations, templates, debounce, SiteRegister, slice$ = [].slice;
lodash = require('lodash');
Component = require('yacomponent');
ParallaxButton = require('./ParallaxButton.ls');
Auth = require('./Auth.ls');
sh = require('../app/shared-helpers.ls');
ch = require('../app/client-helpers.ls');
pureValidations = require('../plv8_modules/pure-validations.js');
templates = require('../build/component-jade.js').templates;
debounce = partialize$.apply(lodash, [lodash.debounce, [void 8, 250], [0]]);
module.exports = SiteRegister = (function(superclass){
  var prototype = extend$((import$(SiteRegister, superclass).displayName = 'SiteRegister', SiteRegister), superclass).prototype, constructor = SiteRegister;
  prototype.template = templates.SiteRegister;
  prototype.init = function(){
    var this$ = this;
    this.local('hostname', global.env === 'production' ? '.powerbulletin.com' : '.pb.com');
    if (!this.local('subdomain')) {
      this.local('subdomain', '');
    }
    return function(){
      var onClick, locals;
      onClick = Auth.requireRegistration(function(){
        var subdomain;
        subdomain = this$.local('subdomain');
        return constructor.$.post('/ajax/can-has-site-plz', {
          domain: subdomain + this$.local('hostname')
        }, function(r){
          var errors;
          errors = r.errors;
          if (errors.length) {
            if (errors.length) {
              return ch.showTooltip(constructor.$('.SiteRegister-errors'), errors.join('<br>'));
            }
          } else {
            return window.location = "http://" + subdomain + this$.local('hostname') + "#once";
          }
        });
      });
      locals = {
        title: 'Create'
      };
      return this$.children = {
        buy: new ParallaxButton({
          onClick: onClick,
          locals: locals
        }, '.SiteRegister-create', this$)
      };
    }();
  };
  prototype.onAttach = function(){
    var component, $sa, $errors, lastVal, this$ = this;
    component = this;
    $sa = this.$.find('.SiteRegister-available');
    $errors = constructor.$('.SiteRegister-errors');
    this.checkSubdomainAvailability = constructor.$R(function(subdomain){
      var errors;
      errors = pureValidations.subdomain(subdomain);
      return constructor.$.get('/ajax/check-domain-availability', {
        domain: subdomain + this$.local('hostname')
      }, function(res){
        $sa.removeClass('success error');
        if (res.available) {
          component.children.buy.enable();
          $sa.addClass('success');
        } else {
          component.children.buy.disable();
          $sa.addClass('error');
          errors.push('Domain is unavailable, try again!');
        }
        if (errors.length) {
          return ch.showTooltip($errors, errors.join('<br>'));
        }
      });
    }).bindTo(this.state.subdomain);
    this.$.on('keydown', 'input.SiteRegister-subdomain', function(){
      return $('.hostname').css('opacity', 0);
    });
    return this.$.on('keyup', 'input.SiteRegister-subdomain', debounce(function(){
      var newInput;
      newInput = $(this).val();
      if (newInput.length) {
        $('.hostname').animate({
          opacity: 1,
          left: newInput.length * 27 + 32
        }, 150);
        if (newInput !== lastVal) {
          component.state.subdomain(newInput);
        }
        return lastVal = newInput;
      }
    }));
  };
  prototype.onDetach = function(){
    sh.rUnbind(this.checkSubdomainAvailability);
    delete this.checkSubdomainAvailability;
    return this.$.off('keyup', 'input.SiteRegister-subdomain');
  };
  prototype.updateSubdomain = function(s){
    return this.$.find('input.SiteRegister-subdomain').val(s);
  };
  function SiteRegister(){
    SiteRegister.superclass.apply(this, arguments);
  }
  return SiteRegister;
}(Component));
function partialize$(f, args, where){
  var context = this;
  return function(){
    var params = slice$.call(arguments), i,
        len = params.length, wlen = where.length,
        ta = args ? args.concat() : [], tw = where ? where.concat() : [];
    for(i = 0; i < len; ++i) { ta[tw[0]] = params[i]; tw.shift(); }
    return len < wlen && len ?
      partialize$.apply(context, [f, ta, tw]) : f.apply(context, ta);
  };
}
function extend$(sub, sup){
  function fun(){} fun.prototype = (sub.superclass = sup).prototype;
  (sub.prototype = new fun).constructor = sub;
  if (typeof sup.extended == 'function') sup.extended(sub);
  return sub;
}
function import$(obj, src){
  var own = {}.hasOwnProperty;
  for (var key in src) if (own.call(src, key)) obj[key] = src[key];
  return obj;
}
})(window)
},{"./ParallaxButton.ls":29,"./Auth.ls":7,"../app/shared-helpers.ls":3,"../app/client-helpers.ls":4,"../build/component-jade.js":20,"../plv8_modules/pure-validations.js":31,"yacomponent":21,"lodash":22}],31:[function(require,module,exports){
(function(){
  var post, censor, subdomain, out$ = typeof exports != 'undefined' && exports || this;
  out$.post = post = function(post){
    var errors;
    errors = [];
    if (!post.user_id) {
      errors.push('Must specify a user');
    }
    if (!post.forum_id) {
      errors.push('Forum cannot be blank');
    }
    if (!(post.title || post.parent_id)) {
      errors.push('Title your creation!');
    }
    if (!post.body) {
      errors.push('Write something!');
    }
    return errors;
  };
  out$.censor = censor = function(c){
    var errors;
    errors = [];
    if (!c.user_id) {
      errors.push('User cannot be blank');
    }
    if (!c.post_id) {
      errors.push('Post cannot be blank');
    }
    if (!c.reason) {
      errors.push('Reason cannot be blank');
    }
    return errors;
  };
  out$.subdomain = subdomain = function(subdomain){
    var allowedChars, errors;
    allowedChars = /^[a-z0-9\-]+$/i;
    errors = [];
    if (!subdomain.match(allowedChars)) {
      errors.push('Invalid Subdomain');
    }
    return errors;
  };
}).call(this);

},{}]},{},[9,2])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvdmFncmFudC9ub2RlX21vZHVsZXMvcHJlbHVkZS1scy9wcmVsdWRlLWJyb3dzZXItbWluLmpzIiwiL3ZhZ3JhbnQvYXBwL2xheW91dC5scyIsIi92YWdyYW50L2FwcC9wYi1zYWxlcy1lbnRyeS5scyIsIi92YWdyYW50L25vZGVfbW9kdWxlcy9yZWFjdGl2ZWpzL3NyYy9yZWFjdGl2ZS5qcyIsIi92YWdyYW50L2FwcC9jbGllbnQtaGVscGVycy5scyIsIi92YWdyYW50L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L19lbXB0eS5qcyIsIi92YWdyYW50L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9pbnNlcnQtbW9kdWxlLWdsb2JhbHMvbm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIi92YWdyYW50L2FwcC9wYi1tdXRhbnRzLmxzIiwiL3ZhZ3JhbnQvbGliL211dGFudC9tdXRhbnQubHMiLCIvdmFncmFudC9jb21wb25lbnQvQXV0aC5scyIsIi92YWdyYW50L2FwcC9zaGFyZWQtaGVscGVycy5scyIsIi92YWdyYW50L2NvbXBvbmVudC9CdXkubHMiLCIvdmFncmFudC9jb21wb25lbnQvU2FsZXNBcHAubHMiLCIvdmFncmFudC9idWlsZC9jb21wb25lbnQtamFkZS5qcyIsIi92YWdyYW50L25vZGVfbW9kdWxlcy9sb2Rhc2gvbG9kYXNoLmpzIiwiL3ZhZ3JhbnQvYnVpbGQvY2xpZW50LWphZGUuanMiLCIvdmFncmFudC9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1yZXNvbHZlL2J1aWx0aW4vZnMuanMiLCIvdmFncmFudC9hcHAvZm9ydW0tdXJscy5scyIsIi92YWdyYW50L25vZGVfbW9kdWxlcy95YWNvbXBvbmVudC9tYWluLmpzIiwiL3ZhZ3JhbnQvbm9kZV9tb2R1bGVzL3lhY29tcG9uZW50L25vZGVfbW9kdWxlcy9hbWRlZmluZS9hbWRlZmluZS5qcyIsIi92YWdyYW50L2NvbXBvbmVudC9BZG1pbk1lbnUubHMiLCIvdmFncmFudC9jb21wb25lbnQvUGhvdG9Dcm9wcGVyLmxzIiwiL3ZhZ3JhbnQvY29tcG9uZW50L1BhZ2luYXRvci5scyIsIi92YWdyYW50L2NvbXBvbmVudC9BZG1pblVwZ3JhZGUubHMiLCIvdmFncmFudC9jb21wb25lbnQvU2FsZXMubHMiLCIvdmFncmFudC9ub2RlX21vZHVsZXMvYnJvd3NlcmlmeS9ub2RlX21vZHVsZXMvYnJvd3Nlci1yZXNvbHZlL2J1aWx0aW4vcGF0aC5qcyIsIi92YWdyYW50L2FwcC9mc20ubHMiLCIvdmFncmFudC9ub2RlX21vZHVsZXMveWFjb21wb25lbnQvc3JjL0NvbXBvbmVudC5qcyIsIi92YWdyYW50L2NvbXBvbmVudC9QYXJhbGxheEJ1dHRvbi5scyIsIi92YWdyYW50L2NvbXBvbmVudC9TaXRlUmVnaXN0ZXIubHMiLCIvdmFncmFudC9wbHY4X21vZHVsZXMvcHVyZS12YWxpZGF0aW9ucy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDelZBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNudkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9QQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaldBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1ZkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdjJJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3psRUE7QUFDQTs7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN1FBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1U0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzPWZ1bmN0aW9uKG4scix0KXtmdW5jdGlvbiBlKHQsaSl7aWYoIXJbdF0pe2lmKCFuW3RdKXt2YXIgbz10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCFpJiZvKXJldHVybiBvKHQsITApO2lmKHUpcmV0dXJuIHUodCwhMCk7dGhyb3cgbmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIit0K1wiJ1wiKX12YXIgYT1yW3RdPXtleHBvcnRzOnt9fTtuW3RdWzBdLmNhbGwoYS5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciB1PW5bdF1bMV1bcl07cmV0dXJuIGUodT91OnIpfSxhLGEuZXhwb3J0cyl9cmV0dXJuIHJbdF0uZXhwb3J0c312YXIgdT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgaT0wO2k8dC5sZW5ndGg7aSsrKWUodFtpXSk7cmV0dXJuIGV9KHtcInByZWx1ZGUtbHNcIjpbZnVuY3Rpb24obixyLHQpe3IuZXhwb3J0cz1uKFwiYmNtYzFnXCIpfSx7fV0sYmNtYzFnOltmdW5jdGlvbihuLHIsdCl7dmFyIGUsdSxpLG8sYSxjLGYsbCxzLHA9e30udG9TdHJpbmc7ZT1uKFwiLi9GdW5jLmpzXCIpO3U9bihcIi4vTGlzdC5qc1wiKTtpPW4oXCIuL09iai5qc1wiKTtvPW4oXCIuL1N0ci5qc1wiKTthPW4oXCIuL051bS5qc1wiKTtjPWZ1bmN0aW9uKG4pe3JldHVybiBufTtmPWgoZnVuY3Rpb24obixyKXtyZXR1cm4gcC5jYWxsKHIpLnNsaWNlKDgsLTEpPT09bn0pO2w9aChmdW5jdGlvbihuLHIpe3ZhciB0LGU9W107Zm9yKHQ9MDt0PG47Kyt0KXtlLnB1c2gocil9cmV0dXJuIGV9KTtvLmVtcHR5PXUuZW1wdHk7by5zbGljZT11LnNsaWNlO28udGFrZT11LnRha2U7by5kcm9wPXUuZHJvcDtvLnNwbGl0QXQ9dS5zcGxpdEF0O28udGFrZVdoaWxlPXUudGFrZVdoaWxlO28uZHJvcFdoaWxlPXUuZHJvcFdoaWxlO28uc3Bhbj11LnNwYW47by5icmVha1N0cj11LmJyZWFrTGlzdDtzPXtGdW5jOmUsTGlzdDp1LE9iajppLFN0cjpvLE51bTphLGlkOmMsaXNUeXBlOmYscmVwbGljYXRlOmx9O3MuZWFjaD11LmVhY2g7cy5tYXA9dS5tYXA7cy5maWx0ZXI9dS5maWx0ZXI7cy5jb21wYWN0PXUuY29tcGFjdDtzLnJlamVjdD11LnJlamVjdDtzLnBhcnRpdGlvbj11LnBhcnRpdGlvbjtzLmZpbmQ9dS5maW5kO3MuaGVhZD11LmhlYWQ7cy5maXJzdD11LmZpcnN0O3MudGFpbD11LnRhaWw7cy5sYXN0PXUubGFzdDtzLmluaXRpYWw9dS5pbml0aWFsO3MuZW1wdHk9dS5lbXB0eTtzLnJldmVyc2U9dS5yZXZlcnNlO3MuZGlmZmVyZW5jZT11LmRpZmZlcmVuY2U7cy5pbnRlcnNlY3Rpb249dS5pbnRlcnNlY3Rpb247cy51bmlvbj11LnVuaW9uO3MuY291bnRCeT11LmNvdW50Qnk7cy5ncm91cEJ5PXUuZ3JvdXBCeTtzLmZvbGQ9dS5mb2xkO3MuZm9sZGw9dS5mb2xkbDtzLmZvbGQxPXUuZm9sZDE7cy5mb2xkbDE9dS5mb2xkbDE7cy5mb2xkcj11LmZvbGRyO3MuZm9sZHIxPXUuZm9sZHIxO3MudW5mb2xkcj11LnVuZm9sZHI7cy5hbmRMaXN0PXUuYW5kTGlzdDtzLm9yTGlzdD11Lm9yTGlzdDtzLmFueT11LmFueTtzLmFsbD11LmFsbDtzLnVuaXF1ZT11LnVuaXF1ZTtzLnNvcnQ9dS5zb3J0O3Muc29ydFdpdGg9dS5zb3J0V2l0aDtzLnNvcnRCeT11LnNvcnRCeTtzLnN1bT11LnN1bTtzLnByb2R1Y3Q9dS5wcm9kdWN0O3MubWVhbj11Lm1lYW47cy5hdmVyYWdlPXUuYXZlcmFnZTtzLmNvbmNhdD11LmNvbmNhdDtzLmNvbmNhdE1hcD11LmNvbmNhdE1hcDtzLmZsYXR0ZW49dS5mbGF0dGVuO3MubWF4aW11bT11Lm1heGltdW07cy5taW5pbXVtPXUubWluaW11bTtzLnNjYW49dS5zY2FuO3Muc2Nhbmw9dS5zY2FubDtzLnNjYW4xPXUuc2NhbjE7cy5zY2FubDE9dS5zY2FubDE7cy5zY2Fucj11LnNjYW5yO3Muc2NhbnIxPXUuc2NhbnIxO3Muc2xpY2U9dS5zbGljZTtzLnRha2U9dS50YWtlO3MuZHJvcD11LmRyb3A7cy5zcGxpdEF0PXUuc3BsaXRBdDtzLnRha2VXaGlsZT11LnRha2VXaGlsZTtzLmRyb3BXaGlsZT11LmRyb3BXaGlsZTtzLnNwYW49dS5zcGFuO3MuYnJlYWtMaXN0PXUuYnJlYWtMaXN0O3MuemlwPXUuemlwO3MuemlwV2l0aD11LnppcFdpdGg7cy56aXBBbGw9dS56aXBBbGw7cy56aXBBbGxXaXRoPXUuemlwQWxsV2l0aDtzLmFwcGx5PWUuYXBwbHk7cy5jdXJyeT1lLmN1cnJ5O3MuZmxpcD1lLmZsaXA7cy5maXg9ZS5maXg7cy5zcGxpdD1vLnNwbGl0O3Muam9pbj1vLmpvaW47cy5saW5lcz1vLmxpbmVzO3MudW5saW5lcz1vLnVubGluZXM7cy53b3Jkcz1vLndvcmRzO3MudW53b3Jkcz1vLnVud29yZHM7cy5jaGFycz1vLmNoYXJzO3MudW5jaGFycz1vLnVuY2hhcnM7cy52YWx1ZXM9aS52YWx1ZXM7cy5rZXlzPWkua2V5cztzLnBhaXJzVG9PYmo9aS5wYWlyc1RvT2JqO3Mub2JqVG9QYWlycz1pLm9ialRvUGFpcnM7cy5saXN0c1RvT2JqPWkubGlzdHNUb09iajtzLm9ialRvTGlzdHM9aS5vYmpUb0xpc3RzO3MubWF4PWEubWF4O3MubWluPWEubWluO3MubmVnYXRlPWEubmVnYXRlO3MuYWJzPWEuYWJzO3Muc2lnbnVtPWEuc2lnbnVtO3MucXVvdD1hLnF1b3Q7cy5yZW09YS5yZW07cy5kaXY9YS5kaXY7cy5tb2Q9YS5tb2Q7cy5yZWNpcD1hLnJlY2lwO3MucGk9YS5waTtzLnRhdT1hLnRhdTtzLmV4cD1hLmV4cDtzLnNxcnQ9YS5zcXJ0O3MubG49YS5sbjtzLnBvdz1hLnBvdztzLnNpbj1hLnNpbjtzLnRhbj1hLnRhbjtzLmNvcz1hLmNvcztzLmFjb3M9YS5hY29zO3MuYXNpbj1hLmFzaW47cy5hdGFuPWEuYXRhbjtzLmF0YW4yPWEuYXRhbjI7cy50cnVuY2F0ZT1hLnRydW5jYXRlO3Mucm91bmQ9YS5yb3VuZDtzLmNlaWxpbmc9YS5jZWlsaW5nO3MuZmxvb3I9YS5mbG9vcjtzLmlzSXROYU49YS5pc0l0TmFOO3MuZXZlbj1hLmV2ZW47cy5vZGQ9YS5vZGQ7cy5nY2Q9YS5nY2Q7cy5sY209YS5sY207cy5WRVJTSU9OPVwiMS4wLjBcIjtyLmV4cG9ydHM9cztmdW5jdGlvbiBoKG4scil7dmFyIHQsZT1mdW5jdGlvbih1KXtyZXR1cm4gbi5sZW5ndGg+MT9mdW5jdGlvbigpe3ZhciBpPXU/dS5jb25jYXQoKTpbXTt0PXI/dHx8dGhpczp0aGlzO3JldHVybiBpLnB1c2guYXBwbHkoaSxhcmd1bWVudHMpPG4ubGVuZ3RoJiZhcmd1bWVudHMubGVuZ3RoP2UuY2FsbCh0LGkpOm4uYXBwbHkodCxpKX06bn07cmV0dXJuIGUoKX19LHtcIi4vRnVuYy5qc1wiOjEsXCIuL09iai5qc1wiOjIsXCIuL051bS5qc1wiOjMsXCIuL0xpc3QuanNcIjo0LFwiLi9TdHIuanNcIjo1fV0sMTpbZnVuY3Rpb24obixyLHQpe3ZhciBlLHUsaSxvO2U9ZnVuY3Rpb24obil7cmV0dXJuIGEobil9O3U9YShmdW5jdGlvbihuLHIsdCl7cmV0dXJuIG4odCxyKX0pO2k9ZnVuY3Rpb24obil7cmV0dXJuIGZ1bmN0aW9uKHIsdCl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIG4ocihyKSkuYXBwbHkobnVsbCxhcmd1bWVudHMpfX0oZnVuY3Rpb24ocix0KXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gbihyKHIpKS5hcHBseShudWxsLGFyZ3VtZW50cyl9fSl9O289YShmdW5jdGlvbihuLHIpe3JldHVybiBuLmFwcGx5KG51bGwscil9KTtyLmV4cG9ydHM9e2N1cnJ5OmUsZmxpcDp1LGZpeDppLGFwcGx5Om99O2Z1bmN0aW9uIGEobixyKXt2YXIgdCxlPWZ1bmN0aW9uKHUpe3JldHVybiBuLmxlbmd0aD4xP2Z1bmN0aW9uKCl7dmFyIGk9dT91LmNvbmNhdCgpOltdO3Q9cj90fHx0aGlzOnRoaXM7cmV0dXJuIGkucHVzaC5hcHBseShpLGFyZ3VtZW50cyk8bi5sZW5ndGgmJmFyZ3VtZW50cy5sZW5ndGg/ZS5jYWxsKHQsaSk6bi5hcHBseSh0LGkpfTpufTtyZXR1cm4gZSgpfX0se31dLDI6W2Z1bmN0aW9uKG4scix0KXt2YXIgZSx1LGksbyxhLGMsZixsLHMscCxoLGcsdixtO2U9ZnVuY3Rpb24obil7dmFyIHIsdCxlPVtdO2ZvcihyIGluIG4pe3Q9bltyXTtlLnB1c2godCl9cmV0dXJuIGV9O3U9ZnVuY3Rpb24obil7dmFyIHIsdD1bXTtmb3IociBpbiBuKXt0LnB1c2gocil9cmV0dXJuIHR9O2k9ZnVuY3Rpb24obil7dmFyIHIsdCxlLHU9e307Zm9yKHI9MCx0PW4ubGVuZ3RoO3I8dDsrK3Ipe2U9bltyXTt1W2VbMF1dPWVbMV19cmV0dXJuIHV9O289ZnVuY3Rpb24obil7dmFyIHIsdCxlPVtdO2ZvcihyIGluIG4pe3Q9bltyXTtlLnB1c2goW3IsdF0pfXJldHVybiBlfTthPWQoZnVuY3Rpb24obixyKXt2YXIgdCxlLHUsaSxvPXt9O2Zvcih0PTAsZT1uLmxlbmd0aDt0PGU7Kyt0KXt1PXQ7aT1uW3RdO29baV09clt1XX1yZXR1cm4gb30pO2M9ZnVuY3Rpb24obil7dmFyIHIsdCxlLHU7cj1bXTt0PVtdO2ZvcihlIGluIG4pe3U9bltlXTtyLnB1c2goZSk7dC5wdXNoKHUpfXJldHVybltyLHRdfTtmPWZ1bmN0aW9uKG4pe3ZhciByO2ZvcihyIGluIG4pe3JldHVybiBmYWxzZX1yZXR1cm4gdHJ1ZX07bD1kKGZ1bmN0aW9uKG4scil7dmFyIHQsZTtmb3IodCBpbiByKXtlPXJbdF07bihlKX1yZXR1cm4gcn0pO3M9ZChmdW5jdGlvbihuLHIpe3ZhciB0LGUsdT17fTtmb3IodCBpbiByKXtlPXJbdF07dVt0XT1uKGUpfXJldHVybiB1fSk7cD1kKGZ1bmN0aW9uKG4pe3ZhciByLHQsZT17fTtmb3IociBpbiBuKXt0PW5bcl07aWYodCl7ZVtyXT10fX1yZXR1cm4gZX0pO2g9ZChmdW5jdGlvbihuLHIpe3ZhciB0LGUsdT17fTtmb3IodCBpbiByKXtlPXJbdF07aWYobihlKSl7dVt0XT1lfX1yZXR1cm4gdX0pO2c9ZChmdW5jdGlvbihuLHIpe3ZhciB0LGUsdT17fTtmb3IodCBpbiByKXtlPXJbdF07aWYoIW4oZSkpe3VbdF09ZX19cmV0dXJuIHV9KTt2PWQoZnVuY3Rpb24obixyKXt2YXIgdCxlLHUsaTt0PXt9O2U9e307Zm9yKHUgaW4gcil7aT1yW3VdOyhuKGkpP3Q6ZSlbdV09aX1yZXR1cm5bdCxlXX0pO209ZChmdW5jdGlvbihuLHIpe3ZhciB0LGU7Zm9yKHQgaW4gcil7ZT1yW3RdO2lmKG4oZSkpe3JldHVybiBlfX19KTtyLmV4cG9ydHM9e3ZhbHVlczplLGtleXM6dSxwYWlyc1RvT2JqOmksb2JqVG9QYWlyczpvLGxpc3RzVG9PYmo6YSxvYmpUb0xpc3RzOmMsZW1wdHk6ZixlYWNoOmwsbWFwOnMsZmlsdGVyOmgsY29tcGFjdDpwLHJlamVjdDpnLHBhcnRpdGlvbjp2LGZpbmQ6bX07ZnVuY3Rpb24gZChuLHIpe3ZhciB0LGU9ZnVuY3Rpb24odSl7cmV0dXJuIG4ubGVuZ3RoPjE/ZnVuY3Rpb24oKXt2YXIgaT11P3UuY29uY2F0KCk6W107dD1yP3R8fHRoaXM6dGhpcztyZXR1cm4gaS5wdXNoLmFwcGx5KGksYXJndW1lbnRzKTxuLmxlbmd0aCYmYXJndW1lbnRzLmxlbmd0aD9lLmNhbGwodCxpKTpuLmFwcGx5KHQsaSl9Om59O3JldHVybiBlKCl9fSx7fV0sMzpbZnVuY3Rpb24obixyLHQpe3ZhciBlLHUsaSxvLGEsYyxmLGwscyxwLGgsZyx2LG0sZCx5LGosYix4LE0sayxXLEwscSx3LFQseixBLE4sTyxCLFM7ZT1JKGZ1bmN0aW9uKG4scil7cmV0dXJuIG4+cj9uOnJ9KTt1PUkoZnVuY3Rpb24obixyKXtyZXR1cm4gbjxyP246cn0pO2k9ZnVuY3Rpb24obil7cmV0dXJuLW59O289TWF0aC5hYnM7YT1mdW5jdGlvbihuKXtpZihuPDApe3JldHVybi0xfWVsc2UgaWYobj4wKXtyZXR1cm4gMX1lbHNle3JldHVybiAwfX07Yz1JKGZ1bmN0aW9uKG4scil7cmV0dXJufn4obi9yKX0pO2Y9SShmdW5jdGlvbihuLHIpe3JldHVybiBuJXJ9KTtsPUkoZnVuY3Rpb24obixyKXtyZXR1cm4gTWF0aC5mbG9vcihuL3IpfSk7cz1JKGZ1bmN0aW9uKG4scil7dmFyIHQ7cmV0dXJuKG4lKHQ9cikrdCkldH0pO3A9ZnVuY3Rpb24obil7cmV0dXJuIDEvbn07aD1NYXRoLlBJO2c9aCoyO3Y9TWF0aC5leHA7bT1NYXRoLnNxcnQ7ZD1NYXRoLmxvZzt5PUkoZnVuY3Rpb24obixyKXtyZXR1cm4gTWF0aC5wb3cobixyKX0pO2o9TWF0aC5zaW47Yj1NYXRoLnRhbjt4PU1hdGguY29zO009TWF0aC5hc2luO2s9TWF0aC5hY29zO1c9TWF0aC5hdGFuO0w9SShmdW5jdGlvbihuLHIpe3JldHVybiBNYXRoLmF0YW4yKG4scil9KTtxPWZ1bmN0aW9uKG4pe3JldHVybn5+bn07dz1NYXRoLnJvdW5kO1Q9TWF0aC5jZWlsO3o9TWF0aC5mbG9vcjtBPWZ1bmN0aW9uKG4pe3JldHVybiBuIT09bn07Tj1mdW5jdGlvbihuKXtyZXR1cm4gbiUyPT09MH07Tz1mdW5jdGlvbihuKXtyZXR1cm4gbiUyIT09MH07Qj1JKGZ1bmN0aW9uKG4scil7dmFyIHQ7bj1NYXRoLmFicyhuKTtyPU1hdGguYWJzKHIpO3doaWxlKHIhPT0wKXt0PW4lcjtuPXI7cj10fXJldHVybiBufSk7Uz1JKGZ1bmN0aW9uKG4scil7cmV0dXJuIE1hdGguYWJzKE1hdGguZmxvb3Iobi9CKG4scikqcikpfSk7ci5leHBvcnRzPXttYXg6ZSxtaW46dSxuZWdhdGU6aSxhYnM6byxzaWdudW06YSxxdW90OmMscmVtOmYsZGl2OmwsbW9kOnMscmVjaXA6cCxwaTpoLHRhdTpnLGV4cDp2LHNxcnQ6bSxsbjpkLHBvdzp5LHNpbjpqLHRhbjpiLGNvczp4LGFjb3M6ayxhc2luOk0sYXRhbjpXLGF0YW4yOkwsdHJ1bmNhdGU6cSxyb3VuZDp3LGNlaWxpbmc6VCxmbG9vcjp6LGlzSXROYU46QSxldmVuOk4sb2RkOk8sZ2NkOkIsbGNtOlN9O2Z1bmN0aW9uIEkobixyKXt2YXIgdCxlPWZ1bmN0aW9uKHUpe3JldHVybiBuLmxlbmd0aD4xP2Z1bmN0aW9uKCl7dmFyIGk9dT91LmNvbmNhdCgpOltdO3Q9cj90fHx0aGlzOnRoaXM7cmV0dXJuIGkucHVzaC5hcHBseShpLGFyZ3VtZW50cyk8bi5sZW5ndGgmJmFyZ3VtZW50cy5sZW5ndGg/ZS5jYWxsKHQsaSk6bi5hcHBseSh0LGkpfTpufTtyZXR1cm4gZSgpfX0se31dLDQ6W2Z1bmN0aW9uKG4scix0KXt2YXIgZSx1LGksbyxhLGMsZixsLHMscCxoLGcsdixtLGQseSxqLGIseCxNLGssVyxMLHEsdyxULHosQSxOLE8sQixTLEksUCxGLEUsQyxSLFYsRCxHLEgsSixLLFEsVSxYLFksWiwkLF8sbnIscnIsdHIsZXIsdXIsaXIsb3IsYXIsY3IsZnIsbHI9W10uc2xpY2U7ZT1zcihmdW5jdGlvbihuLHIpe3ZhciB0LGUsdTtmb3IodD0wLGU9ci5sZW5ndGg7dDxlOysrdCl7dT1yW3RdO24odSl9cmV0dXJuIHJ9KTt1PXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1LGk9W107Zm9yKHQ9MCxlPXIubGVuZ3RoO3Q8ZTsrK3Qpe3U9clt0XTtpLnB1c2gobih1KSl9cmV0dXJuIGl9KTtpPXNyKGZ1bmN0aW9uKG4pe3ZhciByLHQsZSx1PVtdO2ZvcihyPTAsdD1uLmxlbmd0aDtyPHQ7KytyKXtlPW5bcl07aWYoZSl7dS5wdXNoKGUpfX1yZXR1cm4gdX0pO289c3IoZnVuY3Rpb24obixyKXt2YXIgdCxlLHUsaT1bXTtmb3IodD0wLGU9ci5sZW5ndGg7dDxlOysrdCl7dT1yW3RdO2lmKG4odSkpe2kucHVzaCh1KX19cmV0dXJuIGl9KTthPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1LGk9W107Zm9yKHQ9MCxlPXIubGVuZ3RoO3Q8ZTsrK3Qpe3U9clt0XTtpZighbih1KSl7aS5wdXNoKHUpfX1yZXR1cm4gaX0pO2M9c3IoZnVuY3Rpb24obixyKXt2YXIgdCxlLHUsaSxvO3Q9W107ZT1bXTtmb3IodT0wLGk9ci5sZW5ndGg7dTxpOysrdSl7bz1yW3VdOyhuKG8pP3Q6ZSkucHVzaChvKX1yZXR1cm5bdCxlXX0pO2Y9c3IoZnVuY3Rpb24obixyKXt2YXIgdCxlLHU7Zm9yKHQ9MCxlPXIubGVuZ3RoO3Q8ZTsrK3Qpe3U9clt0XTtpZihuKHUpKXtyZXR1cm4gdX19fSk7bD1zPWZ1bmN0aW9uKG4pe2lmKCFuLmxlbmd0aCl7cmV0dXJufXJldHVybiBuWzBdfTtwPWZ1bmN0aW9uKG4pe2lmKCFuLmxlbmd0aCl7cmV0dXJufXJldHVybiBuLnNsaWNlKDEpfTtoPWZ1bmN0aW9uKG4pe2lmKCFuLmxlbmd0aCl7cmV0dXJufXJldHVybiBuW24ubGVuZ3RoLTFdfTtnPWZ1bmN0aW9uKG4pe3ZhciByO3I9bi5sZW5ndGg7aWYoIXIpe3JldHVybn1yZXR1cm4gbi5zbGljZSgwLHItMSl9O3Y9ZnVuY3Rpb24obil7cmV0dXJuIW4ubGVuZ3RofTttPWZ1bmN0aW9uKG4pe3JldHVybiBuLmNvbmNhdCgpLnJldmVyc2UoKX07ZD1mdW5jdGlvbihuKXt2YXIgcix0LGUsdTtyPVtdO2Zvcih0PTAsZT1uLmxlbmd0aDt0PGU7Kyt0KXt1PW5bdF07aWYoIXByKHUscikpe3IucHVzaCh1KX19cmV0dXJuIHJ9O3k9aj1zcihmdW5jdGlvbihuLHIsdCl7dmFyIGUsdSxpO2ZvcihlPTAsdT10Lmxlbmd0aDtlPHU7KytlKXtpPXRbZV07cj1uKHIsaSl9cmV0dXJuIHJ9KTtiPXg9c3IoZnVuY3Rpb24obixyKXtyZXR1cm4geShuLHJbMF0sci5zbGljZSgxKSl9KTtNPXNyKGZ1bmN0aW9uKG4scix0KXtyZXR1cm4geShuLHIsdC5jb25jYXQoKS5yZXZlcnNlKCkpfSk7az1zcihmdW5jdGlvbihuLHIpe3ZhciB0O3Q9ci5jb25jYXQoKS5yZXZlcnNlKCk7cmV0dXJuIHkobix0WzBdLHQuc2xpY2UoMSkpfSk7Vz1zcihmdW5jdGlvbihuLHIpe3ZhciB0LGUsdTt0PVtdO2U9cjt3aGlsZSgodT1uKGUpKSE9bnVsbCl7dC5wdXNoKHVbMF0pO2U9dVsxXX1yZXR1cm4gdH0pO0w9ZnVuY3Rpb24obil7cmV0dXJuW10uY29uY2F0LmFwcGx5KFtdLG4pfTtxPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQ7cmV0dXJuW10uY29uY2F0LmFwcGx5KFtdLGZ1bmN0aW9uKCl7dmFyIGUsdSxpLG89W107Zm9yKGU9MCxpPSh1PXIpLmxlbmd0aDtlPGk7KytlKXt0PXVbZV07by5wdXNoKG4odCkpfXJldHVybiBvfSgpKX0pO3c9c3IoZnVuY3Rpb24obil7dmFyIHI7cmV0dXJuW10uY29uY2F0LmFwcGx5KFtdLGZ1bmN0aW9uKCl7dmFyIHQsZSx1LGk9W107Zm9yKHQ9MCx1PShlPW4pLmxlbmd0aDt0PHU7Kyt0KXtyPWVbdF07aWYoci5sZW5ndGghPW51bGwpe2kucHVzaCh3KHIpKX1lbHNle2kucHVzaChyKX19cmV0dXJuIGl9KCkpfSk7VD1mdW5jdGlvbihuKXt2YXIgcix0LGUsdSxpLG8sYSxjO3I9bHIuY2FsbChhcmd1bWVudHMsMSk7dD1bXTtuOmZvcihlPTAsdT1uLmxlbmd0aDtlPHU7KytlKXtpPW5bZV07Zm9yKG89MCxhPXIubGVuZ3RoO288YTsrK28pe2M9cltvXTtpZihwcihpLGMpKXtjb250aW51ZSBufX10LnB1c2goaSl9cmV0dXJuIHR9O3o9ZnVuY3Rpb24obil7dmFyIHIsdCxlLHUsaSxvLGEsYztyPWxyLmNhbGwoYXJndW1lbnRzLDEpO3Q9W107bjpmb3IoZT0wLHU9bi5sZW5ndGg7ZTx1OysrZSl7aT1uW2VdO2ZvcihvPTAsYT1yLmxlbmd0aDtvPGE7KytvKXtjPXJbb107aWYoIXByKGksYykpe2NvbnRpbnVlIG59fXQucHVzaChpKX1yZXR1cm4gdH07QT1mdW5jdGlvbigpe3ZhciBuLHIsdCxlLHUsaSxvLGE7bj1sci5jYWxsKGFyZ3VtZW50cyk7cj1bXTtmb3IodD0wLGU9bi5sZW5ndGg7dDxlOysrdCl7dT1uW3RdO2ZvcihpPTAsbz11Lmxlbmd0aDtpPG87KytpKXthPXVbaV07aWYoIXByKGEscikpe3IucHVzaChhKX19fXJldHVybiByfTtOPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1LGksbzt0PXt9O2ZvcihlPTAsdT1yLmxlbmd0aDtlPHU7KytlKXtpPXJbZV07bz1uKGkpO2lmKG8gaW4gdCl7dFtvXSs9MX1lbHNle3Rbb109MX19cmV0dXJuIHR9KTtPPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1LGksbzt0PXt9O2ZvcihlPTAsdT1yLmxlbmd0aDtlPHU7KytlKXtpPXJbZV07bz1uKGkpO2lmKG8gaW4gdCl7dFtvXS5wdXNoKGkpfWVsc2V7dFtvXT1baV19fXJldHVybiB0fSk7Qj1mdW5jdGlvbihuKXt2YXIgcix0LGU7Zm9yKHI9MCx0PW4ubGVuZ3RoO3I8dDsrK3Ipe2U9bltyXTtpZighZSl7cmV0dXJuIGZhbHNlfX1yZXR1cm4gdHJ1ZX07Uz1mdW5jdGlvbihuKXt2YXIgcix0LGU7Zm9yKHI9MCx0PW4ubGVuZ3RoO3I8dDsrK3Ipe2U9bltyXTtpZihlKXtyZXR1cm4gdHJ1ZX19cmV0dXJuIGZhbHNlfTtJPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1O2Zvcih0PTAsZT1yLmxlbmd0aDt0PGU7Kyt0KXt1PXJbdF07aWYobih1KSl7cmV0dXJuIHRydWV9fXJldHVybiBmYWxzZX0pO1A9c3IoZnVuY3Rpb24obixyKXt2YXIgdCxlLHU7Zm9yKHQ9MCxlPXIubGVuZ3RoO3Q8ZTsrK3Qpe3U9clt0XTtpZighbih1KSl7cmV0dXJuIGZhbHNlfX1yZXR1cm4gdHJ1ZX0pO0Y9ZnVuY3Rpb24obil7cmV0dXJuIG4uY29uY2F0KCkuc29ydChmdW5jdGlvbihuLHIpe2lmKG4+cil7cmV0dXJuIDF9ZWxzZSBpZihuPHIpe3JldHVybi0xfWVsc2V7cmV0dXJuIDB9fSl9O0U9c3IoZnVuY3Rpb24obixyKXtpZighci5sZW5ndGgpe3JldHVybltdfXJldHVybiByLmNvbmNhdCgpLnNvcnQobil9KTtDPXNyKGZ1bmN0aW9uKG4scil7aWYoIXIubGVuZ3RoKXtyZXR1cm5bXX1yZXR1cm4gci5jb25jYXQoKS5zb3J0KGZ1bmN0aW9uKHIsdCl7aWYobihyKT5uKHQpKXtyZXR1cm4gMX1lbHNlIGlmKG4ocik8bih0KSl7cmV0dXJuLTF9ZWxzZXtyZXR1cm4gMH19KX0pO1I9ZnVuY3Rpb24obil7dmFyIHIsdCxlLHU7cj0wO2Zvcih0PTAsZT1uLmxlbmd0aDt0PGU7Kyt0KXt1PW5bdF07cis9dX1yZXR1cm4gcn07Vj1mdW5jdGlvbihuKXt2YXIgcix0LGUsdTtyPTE7Zm9yKHQ9MCxlPW4ubGVuZ3RoO3Q8ZTsrK3Qpe3U9blt0XTtyKj11fXJldHVybiByfTtEPUc9ZnVuY3Rpb24obil7dmFyIHIsdCxlLHU7cj0wO3Q9bi5sZW5ndGg7Zm9yKGU9MDtlPHQ7KytlKXt1PWU7cis9blt1XX1yZXR1cm4gci90fTtIPWZ1bmN0aW9uKG4pe3ZhciByLHQsZSx1LGk7cj1uWzBdO2Zvcih0PTAsdT0oZT1uLnNsaWNlKDEpKS5sZW5ndGg7dDx1OysrdCl7aT1lW3RdO2lmKGk+cil7cj1pfX1yZXR1cm4gcn07Sj1mdW5jdGlvbihuKXt2YXIgcix0LGUsdSxpO3I9blswXTtmb3IodD0wLHU9KGU9bi5zbGljZSgxKSkubGVuZ3RoO3Q8dTsrK3Qpe2k9ZVt0XTtpZihpPHIpe3I9aX19cmV0dXJuIHJ9O0s9UT1zcihmdW5jdGlvbihuLHIsdCl7dmFyIGUsdTtlPXI7cmV0dXJuW3JdLmNvbmNhdChmdW5jdGlvbigpe3ZhciByLGksbyxhPVtdO2ZvcihyPTAsbz0oaT10KS5sZW5ndGg7cjxvOysrcil7dT1pW3JdO2EucHVzaChlPW4oZSx1KSl9cmV0dXJuIGF9KCkpfSk7VT1YPXNyKGZ1bmN0aW9uKG4scil7aWYoIXIubGVuZ3RoKXtyZXR1cm59cmV0dXJuIEsobixyWzBdLHIuc2xpY2UoMSkpfSk7WT1zcihmdW5jdGlvbihuLHIsdCl7dD10LmNvbmNhdCgpLnJldmVyc2UoKTtyZXR1cm4gSyhuLHIsdCkucmV2ZXJzZSgpfSk7Wj1zcihmdW5jdGlvbihuLHIpe2lmKCFyLmxlbmd0aCl7cmV0dXJufXI9ci5jb25jYXQoKS5yZXZlcnNlKCk7cmV0dXJuIEsobixyWzBdLHIuc2xpY2UoMSkpLnJldmVyc2UoKX0pOyQ9c3IoZnVuY3Rpb24obixyLHQpe3JldHVybiB0LnNsaWNlKG4scil9KTtfPXNyKGZ1bmN0aW9uKG4scil7aWYobjw9MCl7cmV0dXJuIHIuc2xpY2UoMCwwKX1lbHNlIGlmKCFyLmxlbmd0aCl7cmV0dXJuIHJ9ZWxzZXtyZXR1cm4gci5zbGljZSgwLG4pfX0pO25yPXNyKGZ1bmN0aW9uKG4scil7aWYobjw9MHx8IXIubGVuZ3RoKXtyZXR1cm4gcn1lbHNle3JldHVybiByLnNsaWNlKG4pfX0pO3JyPXNyKGZ1bmN0aW9uKG4scil7cmV0dXJuW18obixyKSxucihuLHIpXX0pO3RyPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1O3Q9ci5sZW5ndGg7aWYoIXQpe3JldHVybiByfWZvcihlPTA7ZTx0OysrZSl7dT1lO2lmKCFuKHJbdV0pKXticmVha319cmV0dXJuIHIuc2xpY2UoMCx1KX0pO2VyPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1O3Q9ci5sZW5ndGg7aWYoIXQpe3JldHVybiByfWZvcihlPTA7ZTx0OysrZSl7dT1lO2lmKCFuKHJbdV0pKXticmVha319cmV0dXJuIHIuc2xpY2UodSl9KTt1cj1zcihmdW5jdGlvbihuLHIpe3JldHVyblt0cihuLHIpLGVyKG4scildfSk7aXI9c3IoZnVuY3Rpb24obixyKXtyZXR1cm4gdXIoaHIoW2dyLG5dKSxyKX0pO29yPXNyKGZ1bmN0aW9uKG4scil7dmFyIHQsZSx1LGksbyxhO3Q9W107ZT1yLmxlbmd0aDtmb3IodT0wLGk9bi5sZW5ndGg7dTxpOysrdSl7bz11O2E9blt1XTtpZihvPT09ZSl7YnJlYWt9dC5wdXNoKFthLHJbb11dKX1yZXR1cm4gdH0pO2FyPXNyKGZ1bmN0aW9uKG4scix0KXt2YXIgZSx1LGksbyxhLGM7ZT1bXTt1PXQubGVuZ3RoO2ZvcihpPTAsbz1yLmxlbmd0aDtpPG87KytpKXthPWk7Yz1yW2ldO2lmKGE9PT11KXticmVha31lLnB1c2gobihjLHRbYV0pKX1yZXR1cm4gZX0pO2NyPWZ1bmN0aW9uKCl7dmFyIG4scix0LGUsdSxpLG8sYSxjLGY9W107bj1sci5jYWxsKGFyZ3VtZW50cyk7cj05ZTk7Zm9yKHQ9MCxlPW4ubGVuZ3RoO3Q8ZTsrK3Qpe3U9blt0XTtyPD0oaT11Lmxlbmd0aCl8fChyPWkpfWZvcih0PTA7dDxyOysrdCl7bz10O2E9W107Zm9yKGM9MCxlPW4ubGVuZ3RoO2M8ZTsrK2Mpe3U9bltjXTthLnB1c2godVtvXSl9Zi5wdXNoKGEpfXJldHVybiBmfTtmcj1mdW5jdGlvbihuKXt2YXIgcix0LGUsdSxpLG8sYSxjPVtdO3I9bHIuY2FsbChhcmd1bWVudHMsMSk7dD05ZTk7Zm9yKGU9MCx1PXIubGVuZ3RoO2U8dTsrK2Upe2k9cltlXTt0PD0obz1pLmxlbmd0aCl8fCh0PW8pfWZvcihlPTA7ZTx0OysrZSl7YT1lO2MucHVzaChuLmFwcGx5KG51bGwsZigpKSl9cmV0dXJuIGM7ZnVuY3Rpb24gZigpe3ZhciBuLHQsZSx1PVtdO2ZvcihuPTAsZT0odD1yKS5sZW5ndGg7bjxlOysrbil7aT10W25dO3UucHVzaChpW2FdKX1yZXR1cm4gdX19O3IuZXhwb3J0cz17ZWFjaDplLG1hcDp1LGZpbHRlcjpvLGNvbXBhY3Q6aSxyZWplY3Q6YSxwYXJ0aXRpb246YyxmaW5kOmYsaGVhZDpsLGZpcnN0OnMsdGFpbDpwLGxhc3Q6aCxpbml0aWFsOmcsZW1wdHk6dixyZXZlcnNlOm0sZGlmZmVyZW5jZTpULGludGVyc2VjdGlvbjp6LHVuaW9uOkEsY291bnRCeTpOLGdyb3VwQnk6Tyxmb2xkOnksZm9sZDE6Yixmb2xkbDpqLGZvbGRsMTp4LGZvbGRyOk0sZm9sZHIxOmssdW5mb2xkcjpXLGFuZExpc3Q6Qixvckxpc3Q6Uyxhbnk6SSxhbGw6UCx1bmlxdWU6ZCxzb3J0OkYsc29ydFdpdGg6RSxzb3J0Qnk6QyxzdW06Uixwcm9kdWN0OlYsbWVhbjpELGF2ZXJhZ2U6Ryxjb25jYXQ6TCxjb25jYXRNYXA6cSxmbGF0dGVuOncsbWF4aW11bTpILG1pbmltdW06SixzY2FuOkssc2NhbjE6VSxzY2FubDpRLHNjYW5sMTpYLHNjYW5yOlksc2NhbnIxOlosc2xpY2U6JCx0YWtlOl8sZHJvcDpucixzcGxpdEF0OnJyLHRha2VXaGlsZTp0cixkcm9wV2hpbGU6ZXIsc3Bhbjp1cixicmVha0xpc3Q6aXIsemlwOm9yLHppcFdpdGg6YXIsemlwQWxsOmNyLHppcEFsbFdpdGg6ZnJ9O2Z1bmN0aW9uIHNyKG4scil7dmFyIHQsZT1mdW5jdGlvbih1KXtyZXR1cm4gbi5sZW5ndGg+MT9mdW5jdGlvbigpe3ZhciBpPXU/dS5jb25jYXQoKTpbXTt0PXI/dHx8dGhpczp0aGlzO3JldHVybiBpLnB1c2guYXBwbHkoaSxhcmd1bWVudHMpPG4ubGVuZ3RoJiZhcmd1bWVudHMubGVuZ3RoP2UuY2FsbCh0LGkpOm4uYXBwbHkodCxpKX06bn07cmV0dXJuIGUoKX1mdW5jdGlvbiBwcihuLHIpe3ZhciB0PS0xLGU9ci5sZW5ndGg+Pj4wO3doaWxlKCsrdDxlKWlmKG49PT1yW3RdJiZ0IGluIHIpcmV0dXJuIHRydWU7cmV0dXJuIGZhbHNlfWZ1bmN0aW9uIGhyKG4pe3JldHVybiBmdW5jdGlvbigpe3ZhciByLHQ9YXJndW1lbnRzO2ZvcihyPW4ubGVuZ3RoO3I+MDstLXIpe3Q9W25bci0xXS5hcHBseSh0aGlzLHQpXX1yZXR1cm4gdFswXX19ZnVuY3Rpb24gZ3Iobil7cmV0dXJuIW59fSx7fV0sNTpbZnVuY3Rpb24obixyLHQpe3ZhciBlLHUsaSxvLGEsYyxmLGwscyxwO2U9aChmdW5jdGlvbihuLHIpe3JldHVybiByLnNwbGl0KG4pfSk7dT1oKGZ1bmN0aW9uKG4scil7cmV0dXJuIHIuam9pbihuKX0pO2k9ZnVuY3Rpb24obil7aWYoIW4ubGVuZ3RoKXtyZXR1cm5bXX1yZXR1cm4gbi5zcGxpdChcIlxcblwiKX07bz1mdW5jdGlvbihuKXtyZXR1cm4gbi5qb2luKFwiXFxuXCIpfTthPWZ1bmN0aW9uKG4pe2lmKCFuLmxlbmd0aCl7cmV0dXJuW119cmV0dXJuIG4uc3BsaXQoL1sgXSsvKX07Yz1mdW5jdGlvbihuKXtyZXR1cm4gbi5qb2luKFwiIFwiKX07Zj1mdW5jdGlvbihuKXtyZXR1cm4gbi5zcGxpdChcIlwiKX07bD1mdW5jdGlvbihuKXtyZXR1cm4gbi5qb2luKFwiXCIpfTtzPWZ1bmN0aW9uKG4pe3JldHVybiBuLnNwbGl0KFwiXCIpLnJldmVyc2UoKS5qb2luKFwiXCIpfTtwPWgoZnVuY3Rpb24obixyKXt2YXIgdCxlLHU7ZT1bXTtmb3IodT0wO3U8bjsrK3Upe2UucHVzaChyKX10PWU7cmV0dXJuIHQuam9pbihcIlwiKX0pO3IuZXhwb3J0cz17c3BsaXQ6ZSxqb2luOnUsbGluZXM6aSx1bmxpbmVzOm8sd29yZHM6YSx1bndvcmRzOmMsY2hhcnM6Zix1bmNoYXJzOmwscmV2ZXJzZTpzLHJlcGVhdDpwfTtmdW5jdGlvbiBoKG4scil7dmFyIHQsZT1mdW5jdGlvbih1KXtyZXR1cm4gbi5sZW5ndGg+MT9mdW5jdGlvbigpe3ZhciBpPXU/dS5jb25jYXQoKTpbXTt0PXI/dHx8dGhpczp0aGlzO3JldHVybiBpLnB1c2guYXBwbHkoaSxhcmd1bWVudHMpPG4ubGVuZ3RoJiZhcmd1bWVudHMubGVuZ3RoP2UuY2FsbCh0LGkpOm4uYXBwbHkodCxpKX06bn07cmV0dXJuIGUoKX19LHt9XX0se30sW10pO1xuIiwidmFyICRSLCBtdXRhbnQsIGNoLCAkdywgJGQsIGlzSWUsIGlzTW96LCBpc09wZXJhLCBpc1RvdWNoYWJsZSwgdGhyZXNob2xkLCBsYXN0UmVxSWQsIGhhc1Njcm9sbGVkLCB0aW1lVXBkYXRlciwgc2hvd1RpbWVvdXRJZCwgaGlkZVRpbWVvdXRJZDtcbndpbmRvdy5oZWxwZXJzID0gcmVxdWlyZSgnLi9zaGFyZWQtaGVscGVycy5scycpO1xud2luZG93Lm11dGFudHMgPSByZXF1aXJlKCcuL3BiLW11dGFudHMubHMnKTtcbiRSID0gcmVxdWlyZSgncmVhY3RpdmVqcycpO1xud2luZG93LnJVc2VyID0gJFIuc3RhdGUoKTtcbm11dGFudCA9IHJlcXVpcmUoJy4uL2xpYi9tdXRhbnQvbXV0YW50LmxzJyk7XG5jaCA9IHJlcXVpcmUoJy4vY2xpZW50LWhlbHBlcnMubHMnKTtcbndpbmRvdy5BdXRoID0gcmVxdWlyZSgnLi4vY29tcG9uZW50L0F1dGgubHMnKTtcbndpbmRvdy5jb3JzID0ge1xuICBhamF4UGFyYW1zOiB7XG4gICAgeGhyRmllbGRzOiB7XG4gICAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWVcbiAgICB9LFxuICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCl7fSxcbiAgICBlcnJvcjogZnVuY3Rpb24oKXt9XG4gIH0sXG4gIGdldDogZnVuY3Rpb24odXJsLCBkYXRhLCBjYil7XG4gICAgdmFyIHBhcmFtcztcbiAgICBwYXJhbXMgPSB7fTtcbiAgICBpbXBvcnQkKHBhcmFtcywgdGhpcy5hamF4UGFyYW1zKTtcbiAgICBwYXJhbXMudHlwZSA9ICdHRVQnO1xuICAgIHBhcmFtcy51cmwgPSB1cmw7XG4gICAgcGFyYW1zLmRhdGEgPSBkYXRhO1xuICAgIGlmIChjYikge1xuICAgICAgcGFyYW1zLnN1Y2Nlc3MgPSBjYjtcbiAgICB9XG4gICAgcmV0dXJuICQuYWpheChwYXJhbXMpO1xuICB9LFxuICBwb3N0OiBmdW5jdGlvbih1cmwsIGRhdGEsIGNiKXtcbiAgICB2YXIgcGFyYW1zO1xuICAgIHBhcmFtcyA9IHt9O1xuICAgIGltcG9ydCQocGFyYW1zLCB0aGlzLmFqYXhQYXJhbXMpO1xuICAgIHBhcmFtcy50eXBlID0gJ1BPU1QnO1xuICAgIHBhcmFtcy51cmwgPSB1cmw7XG4gICAgcGFyYW1zLmRhdGEgPSBkYXRhO1xuICAgIGlmIChjYikge1xuICAgICAgcGFyYW1zLnN1Y2Nlc3MgPSBjYjtcbiAgICB9XG4gICAgcmV0dXJuICQuYWpheChwYXJhbXMpO1xuICB9XG59O1xud2luZG93LmhpbnRzID0ge1xuICBsYXN0OiB7XG4gICAgcGF0aG5hbWU6IG51bGwsXG4gICAgbXV0YXRvcjogbnVsbFxuICB9LFxuICBjdXJyZW50OiB7XG4gICAgcGF0aG5hbWU6IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSxcbiAgICBtdXRhdG9yOiB3aW5kb3cubXV0YXRvclxuICB9XG59O1xuJHcgPSAkKHdpbmRvdyk7XG4kZCA9ICQoZG9jdW1lbnQpO1xuaXNJZSA9IGZhbHNlIHx8IGluJCgnbXNUcmFuc2Zvcm0nLCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUpO1xuaXNNb3ogPSBmYWxzZSB8fCBpbiQoJ01vekJveFNpemluZycsIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZSk7XG5pc09wZXJhID0gISEod2luZG93Lm9wZXJhICYmIHdpbmRvdy5vcGVyYS52ZXJzaW9uKTtcbmlzVG91Y2hhYmxlID0gZnVuY3Rpb24oKXtcbiAgdmFyIGU7XG4gIHRyeSB7XG4gICAgZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ1RvdWNoRXZlbnQnKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZSQpIHtcbiAgICBlID0gZSQ7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59KCk7XG50aHJlc2hvbGQgPSAxNTtcbiRkLm9uKCdjbGljaycsICdhLm11dGFudCcsIGNoLm11dGF0ZSk7XG53aW5kb3cubGFzdFN0YXRlY2hhbmdlV2FzVXNlciA9IHRydWU7XG5sYXN0UmVxSWQgPSAwO1xuSGlzdG9yeS5BZGFwdGVyLmJpbmQod2luZG93LCAnc3RhdGVjaGFuZ2UnLCBmdW5jdGlvbihlKXtcbiAgdmFyIHN0YXRlY2hhbmdlV2FzVXNlciwgdXJsLCBwYXJhbXMsIHJlZiQsIHJjLCBzdXJmUGFyYW1zLCByZXFJZCwganF4aHI7XG4gIHN0YXRlY2hhbmdlV2FzVXNlciA9IHdpbmRvdy5sYXN0U3RhdGVjaGFuZ2VXYXNVc2VyO1xuICB3aW5kb3cubGFzdFN0YXRlY2hhbmdlV2FzVXNlciA9IHRydWU7XG4gIHVybCA9IEhpc3RvcnkuZ2V0UGFnZVVybCgpLnJlcGxhY2UoL1xcLyQvLCAnJyk7XG4gIHBhcmFtcyA9IEhpc3RvcnkuZ2V0U3RhdGUoKS5kYXRhO1xuICBpbXBvcnQkKHdpbmRvdy5oaW50cy5sYXN0LCB3aW5kb3cuaGludHMuY3VycmVudCk7XG4gIHJlZiQgPSB3aW5kb3cuaGludHMuY3VycmVudDtcbiAgcmVmJC5wYXRobmFtZSA9IHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZTtcbiAgcmVmJC5tdXRhdG9yID0gbnVsbDtcbiAgaWYgKHdpbmRvdy5oaW50cy5sYXN0Lm11dGF0b3IgPT09ICdmb3J1bScgJiYgIXdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZS5tYXRjaCgvXlxcLyhhdXRofGFkbWlufHJlc291cmNlcykvKSkge1xuICAgIHJjID0gd2luZG93LnRhc2tzLnJlY29tbWVuZGF0aW9uKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSwgd2luZG93LmhpbnRzLmxhc3QucGF0aG5hbWUpO1xuICB9XG4gIGlmICghKHBhcmFtcyAhPSBudWxsICYmIHBhcmFtcy5ub1N1cmYpKSB7XG4gICAgc3Bpbih0cnVlKTtcbiAgICBzdXJmUGFyYW1zID0ge1xuICAgICAgX3N1cmY6IG11dGF0b3IsXG4gICAgICBfc3VyZkRhdGE6IHBhcmFtcyAhPSBudWxsID8gcGFyYW1zLnN1cmZEYXRhIDogdm9pZCA4XG4gICAgfTtcbiAgICBpZiAocmMgIT0gbnVsbCAmJiAoKHJlZiQgPSByYy5rZWVwKSAhPSBudWxsICYmIHJlZiQubGVuZ3RoKSkge1xuICAgICAgc3VyZlBhcmFtcy5fc3VyZlRhc2tzID0gcmMua2VlcC5zb3J0KCkubWFwKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIHRhc2tzLmNjKGl0KTtcbiAgICAgIH0pLmpvaW4oJywnKTtcbiAgICB9XG4gICAgcmVxSWQgPSArK2xhc3RSZXFJZDtcbiAgICBqcXhociA9ICQuZ2V0KHVybCwgc3VyZlBhcmFtcywgZnVuY3Rpb24ocil7XG4gICAgICB2YXIgcmVmJCwgb25VbmxvYWQ7XG4gICAgICBpZiAoIXIubXV0YW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICgocmVmJCA9IHIubG9jYWxzKSAhPSBudWxsICYmIHJlZiQudGl0bGUpIHtcbiAgICAgICAgJGQuYXR0cigndGl0bGUnLCByLmxvY2Fscy50aXRsZSk7XG4gICAgICB9XG4gICAgICBvblVubG9hZCA9IG11dGFudHNbd2luZG93Lm11dGF0b3JdLm9uVW5sb2FkIHx8IGZ1bmN0aW9uKHcsIG5leHRNdXRhbnQsIGNiKXtcbiAgICAgICAgcmV0dXJuIGNiKG51bGwpO1xuICAgICAgfTtcbiAgICAgIHJldHVybiBvblVubG9hZCh3aW5kb3csIHIubXV0YW50LCBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgbG9jYWxzO1xuICAgICAgICBpZiAocmVxSWQgPT09IGxhc3RSZXFJZCkge1xuICAgICAgICAgIGxvY2FscyA9IGltcG9ydCQoe1xuICAgICAgICAgICAgc3RhdGVjaGFuZ2VXYXNVc2VyOiBzdGF0ZWNoYW5nZVdhc1VzZXJcbiAgICAgICAgICB9LCByLmxvY2Fscyk7XG4gICAgICAgICAgcmV0dXJuIG11dGFudC5ydW4obXV0YW50c1tyLm11dGFudF0sIHtcbiAgICAgICAgICAgIGxvY2FsczogbG9jYWxzLFxuICAgICAgICAgICAgdXNlcjogd2luZG93LnVzZXJcbiAgICAgICAgICB9LCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgb25sb2FkUmVzaXphYmxlKCk7XG4gICAgICAgICAgICB3aW5kb3cuaGludHMuY3VycmVudC5tdXRhdG9yID0gd2luZG93Lm11dGF0b3I7XG4gICAgICAgICAgICByZXR1cm4gc3BpbihmYWxzZSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBqcXhoci5mYWlsKGZ1bmN0aW9uKHhociwgc3RhdHVzLCBlcnJvcil7XG4gICAgICBzaG93VG9vbHRpcCgkKCcjd2FybmluZycpLCBcIlBhZ2UgTm90IEZvdW5kXCIsIDgwMDApO1xuICAgICAgSGlzdG9yeS5iYWNrKCk7XG4gICAgICByZXR1cm4gd2luZG93LnNwaW4oZmFsc2UpO1xuICAgIH0pO1xuICB9XG59KTtcbndpbmRvdy5vbmxvYWRQZXJzb25hbGl6ZSA9IGZ1bmN0aW9uKCl7XG4gIHZhciByZWYkO1xuICBpZiAod2luZG93LnVzZXIpIHtcbiAgICAkKCcub25jbGljay1wcm9maWxlJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIHRoaXMuaHJlZiA9IFwiL3VzZXIvXCIgKyB3aW5kb3cudXNlci5uYW1lO1xuICAgIH0pO1xuICAgICQoJy5vbmNsaWNrLWxvZ2luJykuaGlkZSgpO1xuICAgICQoJy5vbmNsaWNrLWxvZ291dCcpLnNob3coKTtcbiAgICAkKCcub25jbGljay1wcm9maWxlJykuc2hvdygpO1xuICAgIGlmICgoKHR5cGVvZiB1c2VyICE9ICd1bmRlZmluZWQnICYmIHVzZXIgIT09IG51bGwpICYmICgocmVmJCA9IHVzZXIucmlnaHRzKSAhPSBudWxsICYmIHJlZiRbJ3N1cGVyJ10pKSB8fCAoKHR5cGVvZiB1c2VyICE9ICd1bmRlZmluZWQnICYmIHVzZXIgIT09IG51bGwpICYmICgocmVmJCA9IHVzZXIucmlnaHRzKSAhPSBudWxsICYmIHJlZiQuYWRtaW4pKSkge1xuICAgICAgcmV0dXJuICQoJy5hZG1pbi1vbmx5Jykuc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJCgnLmFkbWluLW9ubHknKS5oaWRlKCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgICQoJy5vbmNsaWNrLWxvZ2luJykuc2hvdygpO1xuICAgICQoJy5vbmNsaWNrLWxvZ291dCcpLmhpZGUoKTtcbiAgICAkKCcub25jbGljay1wcm9maWxlJykuaGlkZSgpO1xuICAgIHJldHVybiAkKCcuYWRtaW4tb25seScpLmhpZGUoKTtcbiAgfVxufTtcbndpbmRvdy5vbmxvYWRSZXNpemFibGUgPSBmdW5jdGlvbigpe1xuICB2YXIgbGVmdE9mZnNldCwgJGwsICRyO1xuICBsZWZ0T2Zmc2V0ID0gNTA7XG4gICRsID0gJCgnI2xlZnRfY29udGVudCcpO1xuICAkciA9ICQoJyNtYWluX2NvbnRlbnQgLnJlc2l6YWJsZScpO1xuICBpZiAoJHIubGVuZ3RoKSB7XG4gICAgJGwucmVzaXphYmxlKHtcbiAgICAgIG1pbldpZHRoOiAyMDAsXG4gICAgICBtYXhXaWR0aDogNDUwLFxuICAgICAgcmVzaXplOiBmdW5jdGlvbihlLCB1aSl7XG4gICAgICAgICRsLnRvZ2dsZUNsYXNzKCd3aWRlJywgJGwud2lkdGgoKSA+IDMwMCk7XG4gICAgICAgICRyLmNzcygncGFkZGluZy1sZWZ0JywgdWkuc2l6ZS53aWR0aCArIGxlZnRPZmZzZXQpO1xuICAgICAgICAkbC5maW5kKCcuc2Nyb2xsYWJsZScpLmdldE5pY2VTY3JvbGwoKS5yZXNpemUoKTtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5zYXZlVWkoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICAkbC5maW5kKCcuc2Nyb2xsYWJsZScpLm5pY2VTY3JvbGwoe1xuICAgICAgYm91bmNlc2Nyb2xsOiB0cnVlLFxuICAgICAgY3Vyc29yY29sb3I6ICcjYmJiJyxcbiAgICAgIGN1cnNvcndpZHRoOiA2LFxuICAgICAgaGlkZWN1cnNvcmRlbGF5OiAxMDAwLFxuICAgICAgbW91c2VzY3JvbGxzdGVwOiA2LFxuICAgICAgcmFpbG9mZnNldDogdHJ1ZSxcbiAgICAgIHJhaWxwYWRkaW5nOiB7XG4gICAgICAgIGJvdHRvbTogMTUwXG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuICRyLmNzcygncGFkZGluZy1sZWZ0JywgJGwud2lkdGgoKSArIGxlZnRPZmZzZXQpO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gJGwucmVzaXphYmxlKCdkZXN0cm95Jyk7XG4gICAgfSBjYXRjaCAoZSQpIHt9XG4gIH1cbn07XG53aW5kb3cuc2Nyb2xsVG9Ub3AgPSBmdW5jdGlvbihjYil7XG4gIHZhciAkZTtcbiAgY2IgPT0gbnVsbCAmJiAoY2IgPSBmdW5jdGlvbigpe30pO1xuICBpZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCgpID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gICRlID0gJCgnaHRtbCxib2R5Jyk7XG4gICRlLmFuaW1hdGUoe1xuICAgIHNjcm9sbFRvcDogMFxuICB9LCAyNTAsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuICRlLmFuaW1hdGUoe1xuICAgICAgc2Nyb2xsVG9wOiB0aHJlc2hvbGQgLyAyXG4gICAgfSwgNzAsIGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gJGUuYW5pbWF0ZSh7XG4gICAgICAgIHNjcm9sbFRvcDogMFxuICAgICAgfSwgNTUsIGZ1bmN0aW9uKCl7fSk7XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gY2IoKTtcbn07XG53aW5kb3cuYXdlc29tZVNjcm9sbFRvID0gZnVuY3Rpb24oZSwgZHVyYXRpb24sIGNiKXtcbiAgdmFyIG1zLCBvZmZzZXQsIGRzdFNjcm9sbCwgY3VyU2Nyb2xsO1xuICBjYiA9PSBudWxsICYmIChjYiA9IGZ1bmN0aW9uKCl7fSk7XG4gIGUgPSAkKGUpO1xuICBtcyA9IGR1cmF0aW9uIHx8IDI1MDtcbiAgb2Zmc2V0ID0gMTA7XG4gIGlmICghZS5sZW5ndGgpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGlzSWUgfHwgaXNPcGVyYSkge1xuICAgIGVbMF0uc2Nyb2xsSW50b1ZpZXcoKTtcbiAgICBjYigpO1xuICB9IGVsc2Uge1xuICAgIGRzdFNjcm9sbCA9IE1hdGgucm91bmQoZS5wb3NpdGlvbigpLnRvcCkgLSBvZmZzZXQ7XG4gICAgY3VyU2Nyb2xsID0gd2luZG93LnNjcm9sbFk7XG4gICAgaWYgKE1hdGguYWJzKGRzdFNjcm9sbCAtIGN1clNjcm9sbCkgPiB0aHJlc2hvbGQgKiAyKSB7XG4gICAgICAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgc2Nyb2xsVG9wOiBkc3RTY3JvbGxcbiAgICAgIH0sIG1zLCBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gJCgnaHRtbCxib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgICAgc2Nyb2xsVG9wOiBkc3RTY3JvbGwgKyB0aHJlc2hvbGQgLyAyXG4gICAgICAgIH0sIDcwLCBmdW5jdGlvbigpe1xuICAgICAgICAgIHJldHVybiAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICAgICAgICAgIHNjcm9sbFRvcDogZHN0U2Nyb2xsXG4gICAgICAgICAgfSwgNTAsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gY2IoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2IoKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGU7XG59O1xuaGFzU2Nyb2xsZWQgPSBmdW5jdGlvbigpe1xuICB2YXIgc3Q7XG4gIHN0ID0gJHcuc2Nyb2xsVG9wKCk7XG4gIHJldHVybiAkKCdib2R5JykudG9nZ2xlQ2xhc3MoJ3Njcm9sbGVkJywgc3QgPiB0aHJlc2hvbGQpO1xufTtcbnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgJHcub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGhhc1Njcm9sbGVkKCk7XG4gIH0pO1xuICByZXR1cm4gaGFzU2Nyb2xsZWQoKTtcbn0sIDYwMCk7XG4kKCdoZWFkZXIuaGVhZGVyJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZXYpe1xuICB2YXIgYjtcbiAgaWYgKCQoZXYudGFyZ2V0KS5oYXNDbGFzcygnaGVhZGVyJykpIHtcbiAgICBiID0gJCgnYm9keScpO1xuICAgIGlmICgkdy5zY3JvbGxUb3AoKSA+IHRocmVzaG9sZCkge1xuICAgICAgYi50b2dnbGVDbGFzcygnc2Nyb2xsZWQnKTtcbiAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiAkKCcjcXVlcnknKS5mb2N1cygpO1xuICAgICAgfSwgMSk7XG4gICAgfVxuICB9XG59KTtcbiRkLm9uKCdjbGljaycsICcub25jbGljay1zY3JvbGwtdG8nLCBmdW5jdGlvbigpe1xuICBhd2Vzb21lU2Nyb2xsVG8oJCh0aGlzKS5kYXRhKCdzY3JvbGwtdG8nKSk7XG4gIHJldHVybiBmYWxzZTtcbn0pO1xuJGQub24oJ21vdXNlZG93bicsICcub25jbGljay1zY3JvbGwtdG9wJywgZnVuY3Rpb24oKXtcbiAgJCh0aGlzKS5hdHRyKCd0aXRsZScsICdTY3JvbGwgdG8gVG9wIScpO1xuICB3aW5kb3cuc2Nyb2xsVG9Ub3AoKTtcbiAgcmV0dXJuIGZhbHNlO1xufSk7XG53aW5kb3cuc2hha2VEaWFsb2cgPSBmdW5jdGlvbigkZm9ybSwgdGltZSl7XG4gIHZhciAkZmFuY3lib3g7XG4gICRmYW5jeWJveCA9ICRmb3JtLnBhcmVudHMoJy5mYW5jeWJveC13cmFwOmZpcnN0JykucmVtb3ZlQ2xhc3MoJ3NoYWtlJyk7XG4gIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuICRmYW5jeWJveC5hZGRDbGFzcygnc2hha2UnKTtcbiAgfSwgMTAwKTtcbn07XG5BdXRoLmFmdGVyTG9naW4gPSBmdW5jdGlvbigpe1xuICByZXR1cm4gJC5nZXRKU09OKCcvYXV0aC91c2VyJywgZnVuY3Rpb24odXNlcil7XG4gICAgdmFyIHJlZiQ7XG4gICAgd2luZG93LnVzZXIgPSB1c2VyO1xuICAgIG9ubG9hZFBlcnNvbmFsaXplKCk7XG4gICAgaWYgKHVzZXIgJiYgKCh0eXBlb2YgbXV0YW50cyAhPSAndW5kZWZpbmVkJyAmJiBtdXRhbnRzICE9PSBudWxsKSAmJiAoKHJlZiQgPSBtdXRhbnRzW3dpbmRvdy5tdXRhdG9yXSkgIT0gbnVsbCAmJiByZWYkLm9uUGVyc29uYWxpemUpKSkge1xuICAgICAgc2V0UHJvZmlsZSh1c2VyLnBob3RvKTtcbiAgICAgIHJldHVybiB0eXBlb2YgbXV0YW50cyAhPSAndW5kZWZpbmVkJyAmJiBtdXRhbnRzICE9PSBudWxsID8gKHJlZiQgPSBtdXRhbnRzW3dpbmRvdy5tdXRhdG9yXSkgIT0gbnVsbCA/IHJlZiQub25QZXJzb25hbGl6ZSh3aW5kb3csIHVzZXIsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciByZWYkO1xuICAgICAgICBpZiAodHlwZW9mIHNvY2tldCAhPSAndW5kZWZpbmVkJyAmJiBzb2NrZXQgIT09IG51bGwpIHtcbiAgICAgICAgICBzb2NrZXQuZGlzY29ubmVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0eXBlb2Ygc29ja2V0ICE9ICd1bmRlZmluZWQnICYmIHNvY2tldCAhPT0gbnVsbCA/IChyZWYkID0gc29ja2V0LnNvY2tldCkgIT0gbnVsbCA/IHJlZiQuY29ubmVjdCgpIDogdm9pZCA4IDogdm9pZCA4O1xuICAgICAgfSkgOiB2b2lkIDggOiB2b2lkIDg7XG4gICAgfVxuICB9KTtcbn07XG53aW5kb3cubG9nb3V0ID0gZnVuY3Rpb24oKXtcbiAgd2luZG93LmxvY2F0aW9uID0gJy9hdXRoL2xvZ291dCc7XG4gIHJldHVybiBmYWxzZTtcbn07XG4kZC5vbignY2xpY2snLCAnLm9uY2xpY2stbG9nb3V0JywgZnVuY3Rpb24oKXtcbiAgd2luZG93LmxvZ291dCgpO1xuICByZXR1cm4gZmFsc2U7XG59KTtcbiRkLm9uKCdjbGljaycsICcucmVxdWlyZS1sb2dpbicsIEF1dGgucmVxdWlyZUxvZ2luKGZ1bmN0aW9uKCl7XG4gIHJldHVybiB0aGlzLmNsaWNrO1xufSkpO1xuJGQub24oJ2NsaWNrJywgJy5vbmNsaWNrLWxvZ2luJywgZnVuY3Rpb24oKXtcbiAgQXV0aC5zaG93TG9naW5EaWFsb2coKTtcbiAgcmV0dXJuIGZhbHNlO1xufSk7XG50aW1lVXBkYXRlciA9IGZ1bmN0aW9uKCl7XG4gIHZhciBub3c7XG4gIG5vdyA9IG5ldyBEYXRlO1xuICByZXR1cm4gJCgnW2RhdGEtdGltZV0nKS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgdmFyICRlbCwgZCwgZWxhcHNlZCwgaHIsIGxoO1xuICAgICRlbCA9ICQodGhpcyk7XG4gICAgZCA9IG5ldyBEYXRlKCRlbC5kYXRhKCd0aW1lJykpO1xuICAgIGVsYXBzZWQgPSAobm93IC0gZCkgLyAxMDAwO1xuICAgIGhyID0gd2luZG93LmhlbHBlcnMuZWxhcHNlZFRvSHVtYW5SZWFkYWJsZShlbGFwc2VkKTtcbiAgICBsaCA9ICRlbC5kYXRhKCdsYXN0LWh1bWFuJyk7XG4gICAgJGVsLmRhdGEoJ2xhc3QtaHVtYW4nLCBocik7XG4gICAgaWYgKCRlbC5oYXNDbGFzcygndGltZS10aXRsZScpKSB7XG4gICAgICByZXR1cm4gJGVsLmF0dHIoJ3RpdGxlJywgaHIucmVwbGFjZSgvPC4qP1xcLz8+L2csICcnKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAkZWwuaHRtbChocik7XG4gICAgfVxuICB9KTtcbn07XG5zZXRJbnRlcnZhbCh0aW1lVXBkYXRlciwgMzAwMDApO1xud2luZG93LnNwaW4gPSBmdW5jdGlvbihsb2FkaW5nKXtcbiAgdmFyIHRpbWVVbnRpbFNob3csIHRpbWVVbnRpbEhpZGUsICRiLCBzaG93LCBoaWRlO1xuICBsb2FkaW5nID09IG51bGwgJiYgKGxvYWRpbmcgPSB0cnVlKTtcbiAgdGltZVVudGlsU2hvdyA9IDUwMDtcbiAgdGltZVVudGlsSGlkZSA9IDY1MDA7XG4gIGNsZWFyVGltZW91dChzaG93VGltZW91dElkKTtcbiAgY2xlYXJUaW1lb3V0KGhpZGVUaW1lb3V0SWQpO1xuICAkYiB8fCAoJGIgPSAkKCdib2R5JykpO1xuICBzaG93ID0gZnVuY3Rpb24oKXtcbiAgICAkYi5hZGRDbGFzcygnd2FpdGluZycpO1xuICAgIHJldHVybiBoaWRlVGltZW91dElkID0gc2V0VGltZW91dChoaWRlLCB0aW1lVW50aWxIaWRlKTtcbiAgfTtcbiAgaGlkZSA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuICRiLnJlbW92ZUNsYXNzKCd3YWl0aW5nJyk7XG4gIH07XG4gIGlmIChsb2FkaW5nKSB7XG4gICAgcmV0dXJuIHNob3dUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KHNob3csIHRpbWVVbnRpbFNob3cpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBoaWRlKCk7XG4gIH1cbn07XG5vbmxvYWRSZXNpemFibGUoKTtcbiQuZ2V0SlNPTignL2F1dGgvdXNlcicsIGZ1bmN0aW9uKHVzZXIpe1xuICB2YXIgbTtcbiAgd2luZG93LnVzZXIgPSB1c2VyO1xuICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHdpbmRvdy5yVXNlcih3aW5kb3cudXNlcik7XG4gIH0sIDUwKTtcbiAgaWYgKHdpbmRvdy5sb2NhdGlvbi5oYXNoLm1hdGNoKC9eXFwjcmVjb3Zlcj0vKSkge1xuICAgIEF1dGguc2hvd1Jlc2V0UGFzc3dvcmREaWFsb2coKTtcbiAgfVxuICBpZiAobSA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoLm1hdGNoKC9eXFwjaW52YWxpZD0oLispLykpIHtcbiAgICBBdXRoLnNob3dJbmZvRGlhbG9nKFwiV2VsY29tZSBiYWNrIFwiICsgbVsxXSArIFwiIVwiKTtcbiAgfVxuICBzd2l0Y2ggKHdpbmRvdy5sb2NhdGlvbi5oYXNoKSB7XG4gIGNhc2UgJyNpbnZhbGlkJzpcbiAgICBBdXRoLnNob3dJbmZvRGlhbG9nKCdJbnZhbGlkIGludml0ZSBjb2RlIScpO1xuICAgIGJyZWFrO1xuICBjYXNlICcjdmFsaWRhdGUnOlxuICAgIEF1dGguYWZ0ZXJMb2dpbigpO1xuICAgIGJyZWFrO1xuICBjYXNlICcjb25jZSc6XG4gICAgQXV0aC5sb2dpbldpdGhUb2tlbigpO1xuICB9XG4gIG9ubG9hZFBlcnNvbmFsaXplKCk7XG4gIGlmICh3aW5kb3cuaW5pdGlhbE11dGFudCkge1xuICAgIHJldHVybiBtdXRhbnQucnVuKG11dGFudHNbd2luZG93LmluaXRpYWxNdXRhbnRdLCB7XG4gICAgICBpbml0aWFsOiB0cnVlLFxuICAgICAgdXNlcjogd2luZG93LnVzZXJcbiAgICB9LCBmdW5jdGlvbigpe30pO1xuICB9XG59KTtcbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59XG5mdW5jdGlvbiBpbiQoeCwgYXJyKXtcbiAgdmFyIGkgPSAtMSwgbCA9IGFyci5sZW5ndGggPj4+IDA7XG4gIHdoaWxlICgrK2kgPCBsKSBpZiAoeCA9PT0gYXJyW2ldICYmIGkgaW4gYXJyKSByZXR1cm4gdHJ1ZTtcbiAgcmV0dXJuIGZhbHNlO1xufSIsIihmdW5jdGlvbihnbG9iYWwpe3ZhciAkUiwgU2FsZXNBcHAsIEJ1eTtcbiRSID0gcmVxdWlyZSgncmVhY3RpdmVqcycpO1xuU2FsZXNBcHAgPSByZXF1aXJlKCcuLi9jb21wb25lbnQvU2FsZXNBcHAubHMnKTtcbkJ1eSA9IHJlcXVpcmUoJy4uL2NvbXBvbmVudC9CdXkubHMnKTtcbmltcG9ydCQoZ2xvYmFsLCByZXF1aXJlKCdwcmVsdWRlLWxzL3ByZWx1ZGUtYnJvd3Nlci1taW4nKSgncHJlbHVkZS1scycpKTtcbndpbmRvdy5jb21wb25lbnQgPSB7XG4gIHNhbGVzQXBwOiBuZXcgU2FsZXNBcHAoe1xuICAgIGF1dG9SZW5kZXI6IGZhbHNlXG4gIH0sICdib2R5JykuYXR0YWNoKClcbn07XG53aW5kb3cuZG9CdXkgPSBmdW5jdGlvbigpe1xuICB2YXIgcmVmJDtcbiAgKHJlZiQgPSB3aW5kb3cuY29tcG9uZW50KS5idXkgfHwgKHJlZiQuYnV5ID0gKG5ldyBCdXkpLmF0dGFjaCgpKTtcbiAgcmV0dXJuIGxhenlMb2FkRmFuY3lib3goZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gJC5mYW5jeWJveCh3aW5kb3cuY29tcG9uZW50LmJ1eS4kKTtcbiAgfSk7XG59O1xuJFIoZnVuY3Rpb24odXNlcil7XG4gIGlmICh1c2VyKSB7XG4gICAgcmV0dXJuIGNvbXBvbmVudC5zYWxlc0FwcC5sb2dpbih1c2VyKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gY29tcG9uZW50LnNhbGVzQXBwLmxvZ291dCgpO1xuICB9XG59KS5iaW5kVG8od2luZG93LnJVc2VyKTtcbiQod2luZG93KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKXtcbiAgdmFyIG9mZnNldCwgaW52ZXJzZTtcbiAgb2Zmc2V0ID0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuICBpbnZlcnNlID0gOCAvIE1hdGguYWJzKG9mZnNldCArIDAuMDEpO1xuICBpZiAoaW52ZXJzZSA8IDApIHtcbiAgICAwO1xuICB9IGVsc2Uge1xuICAgIGludmVyc2U7XG4gIH1cbiAgJCgnI2ltYWdpbmUnKS5jc3MoJ29wYWNpdHknLCBpbnZlcnNlKTtcbiAgJCgnLmxvZ28nKS5jc3MoJ3knLCAoMCAtIG9mZnNldCAqIDAuMSkgKyBcInB4XCIpO1xuICAkKCcjcmVnaXN0ZXJfdG9wJykuY3NzKHtcbiAgICBvcGFjaXR5OiBpbnZlcnNlLFxuICAgIHk6ICgwIC0gb2Zmc2V0ICogMi43KSArIFwicHhcIlxuICB9KTtcbiAgZWFjaChmdW5jdGlvbihpdCl7XG4gICAgcmV0dXJuICQoaXQpLmNzcygneScsICgwIC0gb2Zmc2V0ICogMC42OCkgKyBcInB4XCIpO1xuICB9KShcbiAgJCgnLmJnJykpO1xuICBlYWNoKGZ1bmN0aW9uKGl0KXtcbiAgICByZXR1cm4gJChpdCkuY3NzKCd5JywgKDAgLSBvZmZzZXQgKiAwLjgyKSArIFwicHhcIik7XG4gIH0pKFxuICAkKCcuc3RpY2s6b2RkJykpO1xuICByZXR1cm4gZWFjaChmdW5jdGlvbihpdCl7XG4gICAgcmV0dXJuICQoaXQpLmNzcygneScsICgwIC0gb2Zmc2V0ICogMC43NykgKyBcInB4XCIpO1xuICB9KShcbiAgJCgnLnN0aWNrOmV2ZW4nKSk7XG59KTtcbnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgJCgnI3JlZ2lzdGVyX3RvcCcpLnRyYW5zaXRpb24oe1xuICAgIHg6IDI1LFxuICAgIG9wYWNpdHk6IDFcbiAgfSwgMTAwMCwgJ2Vhc2VPdXRFeHBvJyk7XG4gICQoJy5TaXRlUmVnaXN0ZXItc3ViZG9tYWluOmZpcnN0JykuZm9jdXMoKTtcbiAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gJCgnLlNpdGVSZWdpc3RlciBoMycpLnRyYW5zaXRpb24oe1xuICAgICAgb3BhY2l0eTogMSxcbiAgICAgIHk6IDMwXG4gICAgfSwgNDAwKTtcbiAgfSwgMTAwKTtcbn0sIDMwMCk7XG5pZiAoJCh3aW5kb3cpLnNjcm9sbFRvcCAhPT0gMCkge1xuICAkKCdodG1sLGJvZHknKS5hbmltYXRlKHtcbiAgICBzY3JvbGxUb3A6IDBcbiAgfSwgNTAwLCAnZWFzZU91dEV4cG8nKTtcbn1cbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59XG59KSh3aW5kb3cpIiwiKGZ1bmN0aW9uKCkge1xuICB2YXIgZGVmYXVsdENvbnRleHQgPSB0aGlzO1xuICB2YXIgX19pZCA9IDA7XG5cbiAgZnVuY3Rpb24gJFIoZm5jLCBjb250ZXh0KSB7XG4gICAgICB2YXIgcmYgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGRpcnR5Tm9kZXMgPSB0b3BvKHJmKTtcbiAgICAgICAgdmFyIHYgPSBkaXJ0eU5vZGVzWzBdLnJ1bi5hcHBseShyZiwgYXJndW1lbnRzKTtcbiAgICAgICAgZGlydHlOb2Rlcy5zbGljZSgxKS5mb3JFYWNoKGZ1bmN0aW9uIChuKSB7IG4ucnVuKCkgfSApO1xuICAgICAgICByZXR1cm4gdjtcbiAgICAgIH07XG4gICAgICByZi5pZCA9IF9faWQrKztcbiAgICAgIHJmLmNvbnRleHQgPSBjb250ZXh0IHx8IGRlZmF1bHRDb250ZXh0O1xuICAgICAgcmYuZm5jID0gZm5jO1xuICAgICAgcmYuZGVwZW5kZW50cyA9IFtdO1xuICAgICAgcmYuZGVwZW5kZW5jaWVzID0gW107XG4gICAgICByZi5tZW1vID0gJFIuZW1wdHk7XG4gICAgICByZXR1cm4gJFIuZXh0ZW5kKHJmLCByZWFjdGl2ZUV4dGVuc2lvbnMsICRSLnBsdWdpbkV4dGVuc2lvbnMpO1xuICB9XG4gICRSLl8gPSB7fTtcbiAgJFIuZW1wdHkgPSB7fTtcbiAgJFIuc3RhdGUgPSBmdW5jdGlvbiAoaW5pdGlhbCkge1xuICAgIHZhciByRm5jID0gJFIoZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgdGhpcy52YWwgPSBhcmd1bWVudHNbMF07XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy52YWw7XG4gICAgfSlcbiAgICByRm5jLmNvbnRleHQgPSByRm5jO1xuICAgIHJGbmMudmFsID0gaW5pdGlhbDtcbiAgICByZXR1cm4gckZuYztcbiAgfVxuICAkUi5leHRlbmQgPSBmdW5jdGlvbihvKSB7XG4gICAgdmFyIGV4dGVuc2lvbnMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIGV4dGVuc2lvbnMuZm9yRWFjaChmdW5jdGlvbiAoZXh0ZW5zaW9uKSB7XG4gICAgICBpZiAoZXh0ZW5zaW9uKSB7XG4gICAgICAgIGZvciAodmFyIHByb3AgaW4gZXh0ZW5zaW9uKSB7IG9bcHJvcF0gPSBleHRlbnNpb25bcHJvcF0gfVxuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiBvO1xuICB9O1xuICAkUi5wbHVnaW5FeHRlbnNpb25zID0ge31cblxuICB2YXIgcmVhY3RpdmVFeHRlbnNpb25zID0ge1xuICAgIF9pc1JlYWN0aXZlOiB0cnVlLFxuICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmZuYy50b1N0cmluZygpIH0sXG4gICAgZ2V0OiBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXMubWVtbyA9PT0gJFIuZW1wdHkgPyB0aGlzLnJ1bigpIDogdGhpcy5tZW1vIH0sXG4gICAgcnVuOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciB1bmJvdW5kQXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XG4gICAgICByZXR1cm4gdGhpcy5tZW1vID0gdGhpcy5mbmMuYXBwbHkodGhpcy5jb250ZXh0LCB0aGlzLmFyZ3VtZW50TGlzdCh1bmJvdW5kQXJncykpO1xuICAgIH0sXG4gICAgYmluZFRvOiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBuZXdEZXBlbmRlbmNpZXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpLm1hcCh3cmFwKTtcbiAgICAgIHZhciBvbGREZXBlbmRlbmNpZXMgPSB0aGlzLmRlcGVuZGVuY2llcztcblxuICAgICAgb2xkRGVwZW5kZW5jaWVzLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcbiAgICAgICAgaWYgKGQgIT09ICRSLl8pIHsgZC5yZW1vdmVEZXBlbmRlbnQodGhpcykgfVxuICAgICAgfSwgdGhpcyk7XG5cbiAgICAgIG5ld0RlcGVuZGVuY2llcy5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XG4gICAgICAgIGlmIChkICE9PSAkUi5fKSB7IGQuYWRkRGVwZW5kZW50KHRoaXMpIH1cbiAgICAgIH0sIHRoaXMpO1xuXG4gICAgICB0aGlzLmRlcGVuZGVuY2llcyA9IG5ld0RlcGVuZGVuY2llcztcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH0sXG4gICAgcmVtb3ZlRGVwZW5kZW50OiBmdW5jdGlvbihyRm5jKSB7XG4gICAgICB0aGlzLmRlcGVuZGVudHMgPSB0aGlzLmRlcGVuZGVudHMuZmlsdGVyKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkICE9PSByRm5jIH0pO1xuICAgIH0sXG4gICAgYWRkRGVwZW5kZW50OiBmdW5jdGlvbihyRm5jKSB7XG4gICAgICBpZiAoIXRoaXMuZGVwZW5kZW50cy5zb21lKGZ1bmN0aW9uIChkKSB7IHJldHVybiBkID09PSByRm5jIH0pKSB7XG4gICAgICAgIHRoaXMuZGVwZW5kZW50cy5wdXNoKHJGbmMpO1xuICAgICAgfVxuICAgIH0sXG4gICAgYXJndW1lbnRMaXN0OiBmdW5jdGlvbih1bmJvdW5kQXJncykge1xuICAgICAgcmV0dXJuIHRoaXMuZGVwZW5kZW5jaWVzLm1hcChmdW5jdGlvbihkZXBlbmRlbmN5KSB7XG4gICAgICAgIGlmIChkZXBlbmRlbmN5ID09PSAkUi5fKSB7XG4gICAgICAgICAgcmV0dXJuIHVuYm91bmRBcmdzLnNoaWZ0KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoZGVwZW5kZW5jeS5faXNSZWFjdGl2ZSkge1xuICAgICAgICAgIHJldHVybiBkZXBlbmRlbmN5LmdldCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pLmNvbmNhdCh1bmJvdW5kQXJncyk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSAkUjtcbiAgfSBlbHNlIHtcbiAgICBkZWZhdWx0Q29udGV4dC4kUiA9ICRSO1xuICB9XG5cbiAgLy9Qcml2YXRlXG4gIGZ1bmN0aW9uIHRvcG8ocm9vdEZuYykge1xuICAgIHZhciBleHBsb3JlZCA9IHt9O1xuICAgIGZ1bmN0aW9uIHNlYXJjaChyRm5jKSB7XG4gICAgICBpZiAoZXhwbG9yZWRbckZuYy5pZF0pIHsgcmV0dXJuIFtdIH1cbiAgICAgIGV4cGxvcmVkW3JGbmMuaWRdID0gdHJ1ZTtcbiAgICAgIHJldHVybiByRm5jLmRlcGVuZGVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIGRlcCkgeyByZXR1cm4gYWNjLmNvbmNhdChzZWFyY2goZGVwKSl9LFtdKS5jb25jYXQockZuYyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHNlYXJjaChyb290Rm5jKS5yZXZlcnNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiB3cmFwKHYpIHtcbiAgICByZXR1cm4gdiAmJiAodi5faXNSZWFjdGl2ZSB8fCB2ID09ICRSLl8pID8gdiA6ICRSKGZ1bmN0aW9uICgpIHtyZXR1cm4gdn0pO1xuICB9XG59KSgpO1xuIiwidmFyIHBvc3RTdWNjZXNzLCBja1N1Ym1pdEZvcm0sIHN1Ym1pdEZvcm0sIHNldElubGluZUVkaXRvciwgZm9jdXMsIHJlbmRlciwgdG9nZ2xlUG9zdCwgZWRpdFBvc3QsIGxvYWRDc3NDYWNoZSwgbG9hZENzcywgbGF6eUxvYWQsIGxhenlMb2FkRGVzZXJpYWxpemUsIGxhenlMb2FkTmVzdGVkU29ydGFibGUsIGxhenlMb2FkSHRtbDVVcGxvYWRlciwgbGF6eUxvYWRKY3JvcCwgbGF6eUxvYWRFZGl0b3IsIGxhenlMb2FkRmFuY3lib3gsIGxhenlMb2FkU29ja2V0aW8sIGZhbmN5Ym94UGFyYW1zLCByZXNwb25kUmVzaXplLCBzZXRXaWRlLCBhbGlnbkJyZWFkY3J1bWIsIHJlbW92ZUVkaXRpbmdVcmwsIG11dGF0ZSwgdGltZXJzLCBzaG93VG9vbHRpcCwgc3dpdGNoQW5kRm9jdXMsIHNldE9ubGluZVVzZXIsIHNldFByb2ZpbGUsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXMsIHRoaXMkID0gdGhpcztcbm91dCQucG9zdFN1Y2Nlc3MgPSBwb3N0U3VjY2VzcyA9IGZ1bmN0aW9uKGV2LCBkYXRhKXtcbiAgdmFyIGYsIHAsIHQsIHJlZiQsIG1ldGE7XG4gIGYgPSAkKGV2LnRhcmdldCkuY2xvc2VzdCgnLnBvc3QtZWRpdCcpO1xuICBwID0gZi5jbG9zZXN0KCcuZWRpdGluZycpO1xuICB0ID0gJChmLmZpbmQoJy50b29sdGlwJykpO1xuICBpZiAoIWRhdGEuc3VjY2Vzcykge1xuICAgIHNob3dUb29sdGlwKHQsIGRhdGEgIT0gbnVsbCA/IChyZWYkID0gZGF0YS5lcnJvcnMpICE9IG51bGwgPyByZWYkLmpvaW4oJzxicj4nKSA6IHZvaWQgOCA6IHZvaWQgOCk7XG4gIH0gZWxzZSB7XG4gICAgcC5maW5kKCcudGl0bGUnKS5odG1sKChyZWYkID0gZGF0YVswXSkgIT0gbnVsbCA/IHJlZiQudGl0bGUgOiB2b2lkIDgpO1xuICAgIHAuZmluZCgnLmJvZHknKS5odG1sKChyZWYkID0gZGF0YVswXSkgIT0gbnVsbCA/IHJlZiQuYm9keSA6IHZvaWQgOCk7XG4gICAgZi5yZW1vdmVDbGFzcygnZmFkZWluJykuaGlkZSgzMDApO1xuICAgIG1ldGEgPSBmdXJsLnBhcnNlKHdpbmRvdy5sb2NhdGlvbi5wYXRobmFtZSk7XG4gICAgd2luZG93Lmxhc3RTdGF0ZWNoYW5nZVdhc1VzZXIgPSBmYWxzZTtcbiAgICBzd2l0Y2ggKG1ldGEudHlwZSkge1xuICAgIGNhc2UgJ25ldy10aHJlYWQnOlxuICAgICAgSGlzdG9yeS5yZXBsYWNlU3RhdGUoe30sICcnLCBkYXRhLnVyaSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdlZGl0JzpcbiAgICAgIHJlbW92ZUVkaXRpbmdVcmwobWV0YSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5vdXQkLmNrU3VibWl0Rm9ybSA9IGNrU3VibWl0Rm9ybSA9IGZ1bmN0aW9uKGUpe1xuICB2YXIgZWRpdG9yLCByZWYkLCBldiwgJHA7XG4gIGVkaXRvciA9IGUgIT0gbnVsbCA/IChyZWYkID0gZS5lbGVtZW50KSAhPSBudWxsID8gcmVmJC4kIDogdm9pZCA4IDogdm9pZCA4O1xuICBldiA9IHtcbiAgICB0YXJnZXQ6IGVkaXRvclxuICB9O1xuICBpZiAoIShlZGl0b3IgIT0gbnVsbCAmJiBlZGl0b3IuaWQpKSB7XG4gICAgJHAgPSAkKGVkaXRvcikuY2xvc2VzdCgnLnBvc3QnKTtcbiAgICByZXR1cm4gJC5hamF4KHtcbiAgICAgIHVybDogJy9yZXNvdXJjZXMvcG9zdHMvJyArICRwLmRhdGEoJ3Bvc3QtaWQnKSxcbiAgICAgIHR5cGU6ICdwdXQnLFxuICAgICAgZGF0YToge1xuICAgICAgICBpZDogJHAuZGF0YSgncG9zdC1pZCcpLFxuICAgICAgICBmb3J1bV9pZDogJHAuZGF0YSgnZm9ydW0taWQnKSxcbiAgICAgICAgcGFyZW50X2lkOiAkcC5kYXRhKCd0aHJlYWQtaWQnKSxcbiAgICAgICAgYm9keTogZS5nZXREYXRhKClcbiAgICAgIH0sXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICAgZS5maXJlKCdibHVyJyk7XG4gICAgICAgIHJldHVybiAkcC5maW5kKCdbY29udGVudEVkaXRhYmxlPXRydWVdJykuYmx1cigpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBzdWJtaXRGb3JtKGV2LCBmdW5jdGlvbihkYXRhKXtcbiAgICAgIHBvc3RTdWNjZXNzKGV2LCBkYXRhKTtcbiAgICAgICQoJ2Zvb3RlcicpLnJlbW92ZUNsYXNzKCdleHBhbmRlZCcpO1xuICAgICAgcmV0dXJuICQoJyNwb3N0X25ldyAuZmFkZWluJykucmVtb3ZlKCk7XG4gICAgfSk7XG4gIH1cbn07XG5vdXQkLnN1Ym1pdEZvcm0gPSBzdWJtaXRGb3JtID0gZnVuY3Rpb24oZXYsIGZuKXtcbiAgdmFyICRmLCAkcywgYm9keSwgZSwgcmVmJCwgaW5wdXQ7XG4gICRmID0gJChldi50YXJnZXQpLmNsb3Nlc3QoJ2Zvcm0nKTtcbiAgJHMgPSAkKCRmLmZpbmQoJ1t0eXBlPXN1Ym1pdF06Zmlyc3QnKSk7XG4gIGlmICgkcykge1xuICAgICRzLmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XG4gIH1cbiAgYm9keSA9ICRmLmZpbmQoJ3RleHRhcmVhLmJvZHknKTtcbiAgZSA9IHR5cGVvZiBDS0VESVRPUiAhPSAndW5kZWZpbmVkJyAmJiBDS0VESVRPUiAhPT0gbnVsbCA/IChyZWYkID0gQ0tFRElUT1IuaW5zdGFuY2VzKSAhPSBudWxsID8gcmVmJFtib2R5LmF0dHIoJ2lkJyldIDogdm9pZCA4IDogdm9pZCA4O1xuICBpZiAoZSkge1xuICAgIGlucHV0ID0gZS5nZXREYXRhKCk7XG4gICAgaWYgKGlucHV0ICE9IG51bGwgJiYgaW5wdXQubGVuZ3RoKSB7XG4gICAgICBib2R5LnZhbChpbnB1dCk7XG4gICAgICBlLnNldERhdGEoJycpO1xuICAgIH1cbiAgfVxuICAkLmFqYXgoe1xuICAgIHVybDogJGYuYXR0cignYWN0aW9uJyksXG4gICAgdHlwZTogJGYuYXR0cignbWV0aG9kJyksXG4gICAgZGF0YTogJGYuc2VyaWFsaXplKCksXG4gICAgZGF0YVR5cGU6ICdqc29uJyxcbiAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKXtcbiAgICAgICRzLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgICBpZiAoJCgnZm9vdGVyJykuaGFzQ2xhc3MoJ2V4cGFuZGVkJykpIHtcbiAgICAgICAgJCgnLm9uY2xpY2stZm9vdGVyLXRvZ2dsZTpmaXJzdCcpLmNsaWNrKCk7XG4gICAgICB9XG4gICAgICBpZiAoZm4pIHtcbiAgICAgICAgcmV0dXJuIGZuLmNhbGwoJGYsIGRhdGEpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZXJyb3I6IGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgJHMucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcbiAgICAgIHJldHVybiBzaG93VG9vbHRpcCgkKCRmLmZpbmQoJy50b29sdGlwJykpLCBkYXRhICE9IG51bGwgPyBkYXRhLm1zZyA6IHZvaWQgOCkgfHwgJ1RyeSBhZ2FpbiEnO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBmYWxzZTtcbn07XG5vdXQkLnNldElubGluZUVkaXRvciA9IHNldElubGluZUVkaXRvciA9IGZ1bmN0aW9uKHVzZXJJZCl7XG4gICQoXCIucG9zdFtkYXRhLXVzZXItaWQ9XCIgKyB1c2VySWQgKyBcIl0gLnBvc3QtY29udGVudFwiKS5hdHRyKCdjb250ZW50RWRpdGFibGUnLCB0cnVlKTtcbiAgcmV0dXJuIGxhenlMb2FkRWRpdG9yKGZ1bmN0aW9uKCl7XG4gICAgdmFyIGkkLCByZWYkLCBsZW4kLCBlO1xuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSBDS0VESVRPUi5pbnN0YW5jZXMpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICBlID0gcmVmJFtpJF07XG4gICAgICBlLmRlc3Ryb3kodHJ1ZSk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gQ0tFRElUT1IuaW5saW5lQWxsKCk7XG4gICAgfSBjYXRjaCAoZSQpIHt9XG4gIH0pO1xufTtcbmZvY3VzID0gZnVuY3Rpb24oJGUpe1xuICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgIHJldHVybiAkZS5maW5kKCdpbnB1dFt0eXBlPVwidGV4dFwiXScpLmZvY3VzKCk7XG4gIH0sIDEwKTtcbn07XG5yZW5kZXIgPSBmdW5jdGlvbihzZWwsIGxvY2FscywgY2Ipe1xuICB2YXIgJGU7XG4gIGNiID09IG51bGwgJiYgKGNiID0gZnVuY3Rpb24oKXt9KTtcbiAgJGUgPSAkKHNlbCk7XG4gIHJldHVybiByZW5kZXJBbmRBcHBlbmQod2luZG93LCBzZWwsICdwb3N0LWVkaXQnLCB7XG4gICAgdXNlcjogdXNlcixcbiAgICBwb3N0OiBsb2NhbHNcbiAgfSwgZnVuY3Rpb24oJGUpe1xuICAgIGNiKCk7XG4gICAgcmV0dXJuIGZvY3VzKCRlKTtcbiAgfSk7XG59O1xub3V0JC50b2dnbGVQb3N0ID0gdG9nZ2xlUG9zdCA9IGZ1bmN0aW9uKGV2KXtcbiAgdmFyIGRhdGEsIGU7XG4gIGlmICghJChldiAhPSBudWxsID8gZXYudGFyZ2V0IDogdm9pZCA4KS5oYXNDbGFzcygnb25jbGljay1mb290ZXItdG9nZ2xlJykpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKCF1c2VyKSB7XG4gICAgQXV0aC5zaG93TG9naW5EaWFsb2coKTtcbiAgICByZXR1cm47XG4gIH1cbiAgZGF0YSA9IHtcbiAgICBhY3Rpb246ICcvcmVzb3VyY2VzL3Bvc3RzJyxcbiAgICBtZXRob2Q6ICdwb3N0J1xuICB9O1xuICBlID0gJCgnZm9vdGVyJyk7XG4gIGlmIChlLmhhc0NsYXNzKCdleHBhbmRlZCcpKSB7XG4gICAgZS5yZW1vdmVDbGFzcygnZXhwYW5kZWQnKTtcbiAgICByZXR1cm4gJCgnI3Bvc3RfbmV3IC5mYWRlaW4nKS5yZW1vdmUoKTtcbiAgfSBlbHNlIHtcbiAgICBlLmFkZENsYXNzKCdleHBhbmRlZCcpO1xuICAgIHJldHVybiByZW5kZXIoJyNwb3N0X25ldycsIGRhdGEsIGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gbGF6eUxvYWRFZGl0b3IoZnVuY3Rpb24oKXtcbiAgICAgICAgaWYgKCFDS0VESVRPUi5pbnN0YW5jZXMucG9zdF9uZXcpIHtcbiAgICAgICAgICBDS0VESVRPUi5yZXBsYWNlKCQoJyNwb3N0X25ldyB0ZXh0YXJlYScpWzBdKTtcbiAgICAgICAgfVxuICAgICAgICBlLmZpbmQoJ2Zvcm0ucG9zdC1uZXcgaW5wdXRbbmFtZT1cImZvcnVtX2lkXCJdJykudmFsKHdpbmRvdy5hY3RpdmVGb3J1bUlkKTtcbiAgICAgICAgcmV0dXJuIGUuZmluZCgnZm9ybS5wb3N0LW5ldyBpbnB1dFtuYW1lPVwicGFyZW50X2lkXCJdJykudmFsKHdpbmRvdy5hY3RpdmVUaHJlYWRJZCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufTtcbm91dCQuZWRpdFBvc3QgPSBlZGl0UG9zdCA9IGZ1bmN0aW9uKGlkLCBkYXRhKXtcbiAgdmFyIHNlbCwgZTtcbiAgZGF0YSA9PSBudWxsICYmIChkYXRhID0ge30pO1xuICBpZiAoaWQgPT09IHRydWUpIHtcbiAgICBzY3JvbGxUb1RvcCgpO1xuICAgIGRhdGEuYWN0aW9uID0gJy9yZXNvdXJjZXMvcG9zdHMnO1xuICAgIGRhdGEubWV0aG9kID0gJ3Bvc3QnO1xuICAgIHJldHVybiByZW5kZXIoJy5mb3J1bScsIGRhdGEsIGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gbGF6eUxvYWRFZGl0b3IoZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIENLRURJVE9SLnJlcGxhY2UoJCgnI2VkaXRvcicpWzBdKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHNlbCA9IFwiI3Bvc3RfXCIgKyBpZDtcbiAgICBlID0gJChzZWwpO1xuICAgIGlmICghZS5maW5kKFwiI3Bvc3RfZWRpdF9cIiArIGlkICsgXCI6dmlzaWJsZVwiKS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiAkLmdldChcIi9yZXNvdXJjZXMvcG9zdHMvXCIgKyBpZCwgZnVuY3Rpb24ocCl7XG4gICAgICAgIHJlbmRlcihzZWwsIHApO1xuICAgICAgICByZXR1cm4gZS5hZGRDbGFzcygnZWRpdGluZycpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmb2N1cyhlKTtcbiAgICB9XG4gIH1cbn07XG5sb2FkQ3NzQ2FjaGUgPSB7fTtcbmxvYWRDc3MgPSBmdW5jdGlvbihocmVmKXtcbiAgaWYgKGxvYWRDc3NDYWNoZVtocmVmXSkge1xuICAgIHJldHVybjtcbiAgfVxuICAkKCdoZWFkJykuYXBwZW5kKCQoJzxsaW5rIHJlbD1cInN0eWxlc2hlZXRcIiB0eXBlPVwidGV4dC9jc3NcIj4nKS5hdHRyKCdocmVmJywgaHJlZikpO1xuICByZXR1cm4gbG9hZENzc0NhY2hlW2hyZWZdID0gdHJ1ZTtcbn07XG5vdXQkLmxhenlMb2FkID0gbGF6eUxvYWQgPSBmdW5jdGlvbih0ZXN0LCBzY3JpcHQsIGNzcywgY2Ipe1xuICB2YXIgYjtcbiAgYiA9ICQoJ2JvZHknKTtcbiAgYi5hZGRDbGFzcygnd2FpdGluZycpO1xuICBpZiAoIXRlc3QoKSkge1xuICAgIGlmIChjc3MpIHtcbiAgICAgIGxvYWRDc3MoY3NzKTtcbiAgICB9XG4gICAgcmV0dXJuIGhlYWRqcyhzY3JpcHQsIGZ1bmN0aW9uKCl7XG4gICAgICBiLnJlbW92ZUNsYXNzKCd3YWl0aW5nJyk7XG4gICAgICByZXR1cm4gY2IoKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBiLnJlbW92ZUNsYXNzKCd3YWl0aW5nJyk7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH1cbn07XG5vdXQkLmxhenlMb2FkRGVzZXJpYWxpemUgPSBsYXp5TG9hZERlc2VyaWFsaXplID0gZnVuY3Rpb24oY2Ipe1xuICByZXR1cm4gbGF6eUxvYWQoZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVmJDtcbiAgICByZXR1cm4gKHJlZiQgPSB3aW5kb3cuJCgpLmRlc2VyaWFsaXplKSAhPSBudWxsID8gcmVmJC5sZW5ndGggOiB2b2lkIDg7XG4gIH0sIGNhY2hlVXJsICsgXCIvbG9jYWwvanF1ZXJ5LmRlc2VyaWFsaXplLm1pbi5qc1wiLCBudWxsLCBjYik7XG59O1xub3V0JC5sYXp5TG9hZE5lc3RlZFNvcnRhYmxlID0gbGF6eUxvYWROZXN0ZWRTb3J0YWJsZSA9IGZ1bmN0aW9uKGNiKXtcbiAgcmV0dXJuIGxhenlMb2FkKGZ1bmN0aW9uKCl7XG4gICAgdmFyIHJlZiQ7XG4gICAgcmV0dXJuIChyZWYkID0gd2luZG93LiQoKS5uZXN0ZWRTb3J0YWJsZSkgIT0gbnVsbCA/IHJlZiQubGVuZ3RoIDogdm9pZCA4O1xuICB9LCBjYWNoZVVybCArIFwiL2xvY2FsL2pxdWVyeS5tanMubmVzdGVkU29ydGFibGUuanNcIiwgbnVsbCwgY2IpO1xufTtcbm91dCQubGF6eUxvYWRIdG1sNVVwbG9hZGVyID0gbGF6eUxvYWRIdG1sNVVwbG9hZGVyID0gZnVuY3Rpb24oY2Ipe1xuICByZXR1cm4gbGF6eUxvYWQoZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVmJDtcbiAgICByZXR1cm4gKHJlZiQgPSB3aW5kb3cuJCgpLmh0bWw1VXBsb2FkZXIpICE9IG51bGwgPyByZWYkLmxlbmd0aCA6IHZvaWQgODtcbiAgfSwgY2FjaGVVcmwgKyBcIi9sb2NhbC9qcXVlcnkuaHRtbDV1cGxvYWRlci5qc1wiLCBjYWNoZVVybCArIFwiL2xvY2FsL2VkaXRvci9za2lucy9tb29uby9lZGl0b3IuY3NzXCIsIGNiKTtcbn07XG5vdXQkLmxhenlMb2FkSmNyb3AgPSBsYXp5TG9hZEpjcm9wID0gZnVuY3Rpb24oY2Ipe1xuICByZXR1cm4gbGF6eUxvYWQoZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVmJDtcbiAgICByZXR1cm4gKHJlZiQgPSB3aW5kb3cuJCgpLkpjcm9wKSAhPSBudWxsID8gcmVmJC5sZW5ndGggOiB2b2lkIDg7XG4gIH0sIGNhY2hlVXJsICsgXCIvamNyb3AvanMvanF1ZXJ5Lkpjcm9wLm1pbi5qc1wiLCBjYWNoZVVybCArIFwiL2pjcm9wL2Nzcy9qcXVlcnkuSmNyb3AubWluLmNzc1wiLCBjYik7XG59O1xub3V0JC5sYXp5TG9hZEVkaXRvciA9IGxhenlMb2FkRWRpdG9yID0gZnVuY3Rpb24oY2Ipe1xuICByZXR1cm4gbGF6eUxvYWQoZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdHlwZW9mIENLRURJVE9SICE9ICd1bmRlZmluZWQnICYmIENLRURJVE9SICE9PSBudWxsID8gQ0tFRElUT1IudmVyc2lvbiA6IHZvaWQgODtcbiAgfSwgY2FjaGVVcmwgKyBcIi9sb2NhbC9lZGl0b3IvY2tlZGl0b3IuanNcIiwgbnVsbCwgY2IpO1xufTtcbm91dCQubGF6eUxvYWRGYW5jeWJveCA9IGxhenlMb2FkRmFuY3lib3ggPSBmdW5jdGlvbihjYil7XG4gIHJldHVybiBsYXp5TG9hZChmdW5jdGlvbigpe1xuICAgIHZhciByZWYkO1xuICAgIHJldHVybiAocmVmJCA9IHdpbmRvdy4kKCkuZmFuY3lib3gpICE9IG51bGwgPyByZWYkLmxlbmd0aCA6IHZvaWQgODtcbiAgfSwgY2FjaGVVcmwgKyBcIi9mYW5jeWJveC9qcXVlcnkuZmFuY3lib3gucGFjay5qc1wiLCBjYWNoZVVybCArIFwiL2ZhbmN5Ym94L2pxdWVyeS5mYW5jeWJveC5jc3NcIiwgY2IpO1xufTtcbm91dCQubGF6eUxvYWRTb2NrZXRpbyA9IGxhenlMb2FkU29ja2V0aW8gPSBmdW5jdGlvbihjYil7XG4gIHJldHVybiBsYXp5TG9hZChmdW5jdGlvbigpe1xuICAgIHJldHVybiB3aW5kb3cuaW87XG4gIH0sIFwiL3NvY2tldC5pby9zb2NrZXQuaW8uanNcIiwgbnVsbCwgY2IpO1xufTtcbm91dCQuZmFuY3lib3hQYXJhbXMgPSBmYW5jeWJveFBhcmFtcyA9IHtcbiAgY2xvc2VFZmZlY3Q6ICdlbGFzdGljJyxcbiAgY2xvc2VTcGVlZDogMjAwLFxuICBjbG9zZUVhc2luZzogJ2Vhc2VPdXRFeHBvJyxcbiAgb3BlbkVmZmVjdDogJ2ZhZGUnLFxuICBvcGVuU3BlZWQ6IDQ1MFxufTtcbm91dCQucmVzcG9uZFJlc2l6ZSA9IHJlc3BvbmRSZXNpemUgPSBmdW5jdGlvbigpe1xuICB2YXIgdztcbiAgdyA9ICQod2luZG93KTtcbiAgaWYgKHdpbmRvdy5tdXRhdG9yICE9PSAnYWRtaW4nKSB7XG4gICAgaWYgKHcud2lkdGgoKSA8PSA4MDApIHtcbiAgICAgIHJldHVybiAkKCdib2R5JykuYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuICAgIH1cbiAgfVxufTtcbm91dCQuc2V0V2lkZSA9IHNldFdpZGUgPSBmdW5jdGlvbigpe1xuICB2YXIgbDtcbiAgbCA9ICQoJyNsZWZ0X2NvbnRlbnQnKTtcbiAgcmV0dXJuIGwudG9nZ2xlQ2xhc3MoJ3dpZGUnLCBsLndpZHRoKCkgPiAzMDApO1xufTtcbm91dCQuYWxpZ25CcmVhZGNydW1iID0gYWxpZ25CcmVhZGNydW1iID0gZnVuY3Rpb24oKXtcbiAgdmFyIGIsIG0sIGwsIHBvcztcbiAgYiA9ICQoJyNicmVhZGNydW1iJyk7XG4gIG0gPSAkKCcjbWFpbl9jb250ZW50Jyk7XG4gIGwgPSAkKCcjbGVmdF9jb250ZW50Jyk7XG4gIHBvcyA9IChtLndpZHRoKCkgLSBiLndpZHRoKCkpIC8gMjtcbiAgcmV0dXJuIGIudHJhbnNpdGlvbih7XG4gICAgbGVmdDogcG9zIDwgbC53aWR0aCgpID8gbC53aWR0aCgpIDogcG9zXG4gIH0sIDMwMCwgJ2Vhc2VPdXRFeHBvJyk7XG59O1xub3V0JC5yZW1vdmVFZGl0aW5nVXJsID0gcmVtb3ZlRWRpdGluZ1VybCA9IGZ1bmN0aW9uKG1ldGEpe1xuICByZXR1cm4gSGlzdG9yeS5yZXBsYWNlU3RhdGUoe1xuICAgIG5vU3VyZjogdHJ1ZVxuICB9LCAnJywgbWV0YS50aHJlYWRVcmkpO1xufTtcbm91dCQubXV0YXRlID0gbXV0YXRlID0gZnVuY3Rpb24oKXtcbiAgdmFyICRlLCBocmVmLCBwYXJhbXM7XG4gICRlID0gJCh0aGlzKTtcbiAgaWYgKCRlLmhhc0NsYXNzKCdyZXF1aXJlLWxvZ2luJykgJiYgIXVzZXIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaHJlZiA9ICRlLmF0dHIoJ2hyZWYnKTtcbiAgaWYgKCFocmVmKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGlmIChocmVmICE9IG51bGwgJiYgaHJlZi5tYXRjaCgvIy8pKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgcGFyYW1zID0ge307XG4gIGlmICgkZS5oYXNDbGFzcygnbm8tc3VyZicpKSB7XG4gICAgcGFyYW1zLm5vU3VyZiA9IHRydWU7XG4gIH1cbiAgcGFyYW1zLnN1cmZEYXRhID0gJGUuZGF0YSgnc3VyZicpIHx8IHdpbmRvdy5zdXJmRGF0YSB8fCB2b2lkIDg7XG4gIHdpbmRvdy5sYXN0U3RhdGVjaGFuZ2VXYXNVc2VyID0gZmFsc2U7XG4gIEhpc3RvcnkucHVzaFN0YXRlKHBhcmFtcywgJycsIGhyZWYpO1xuICByZXR1cm4gZmFsc2U7XG59O1xudGltZXJzID0ge307XG5vdXQkLnNob3dUb29sdGlwID0gc2hvd1Rvb2x0aXAgPSBmdW5jdGlvbigkdG9vbHRpcCwgbXNnLCBkdXJhdGlvbil7XG4gIHZhciB0aW1lcjtcbiAgZHVyYXRpb24gPT0gbnVsbCAmJiAoZHVyYXRpb24gPSA0MDAwKTtcbiAgaWYgKCEobXNnICE9IG51bGwgJiYgbXNnLmxlbmd0aCkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgdGltZXIgPSB0aW1lcnNbbXNnXTtcbiAgaWYgKHRpbWVyKSB7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgfVxuICAkdG9vbHRpcC5odG1sKG1zZykuYWRkQ2xhc3MoJ2hvdmVyJyk7XG4gIHJldHVybiB0aW1lcnNbbXNnXSA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICB0aW1lcnNbbXNnXSA9IHZvaWQgODtcbiAgICByZXR1cm4gJHRvb2x0aXAucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7XG4gIH0sIGR1cmF0aW9uKTtcbn07XG5vdXQkLnN3aXRjaEFuZEZvY3VzID0gc3dpdGNoQW5kRm9jdXMgPSBmdW5jdGlvbihyZW1vdmUsIGFkZCwgZm9jdXNPbil7XG4gIHZhciAkZTtcbiAgJGUgPSAkKCcuZmFuY3lib3gtd3JhcCcpO1xuICAkZS5yZW1vdmVDbGFzcyhyZW1vdmUgKyBcIiBzaGFrZSBzbGlkZVwiKS5hZGRDbGFzcyhhZGQpO1xuICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICRlLmFkZENsYXNzKCdzbGlkZScpO1xuICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gJChmb2N1c09uKS5mb2N1cygpO1xuICAgIH0sIDI1MCk7XG4gIH0sIDUwKTtcbn07XG5vdXQkLnNldE9ubGluZVVzZXIgPSBzZXRPbmxpbmVVc2VyID0gZnVuY3Rpb24oaWQpe1xuICB2YXIgeCQ7XG4gIHgkID0gJChcIltkYXRhLXVzZXItaWQ9XCIgKyBpZCArIFwiXSAucHJvZmlsZS5waG90b1wiKTtcbiAgeCQuYWRkQ2xhc3MoJ29ubGluZScpO1xuICB4JC5hdHRyKCd0aXRsZScsICdPbmxpbmUhJyk7XG4gIHJldHVybiB4JDtcbn07XG5vdXQkLnNldFByb2ZpbGUgPSBzZXRQcm9maWxlID0gZnVuY3Rpb24oc3JjKXtcbiAgdmFyIHgkLCB5JDtcbiAgeCQgPSAkKCcucGhvdG8nKTtcbiAgeCQuYXR0cignaHJlZicsIFwiL3VzZXIvXCIgKyB1c2VyLm5hbWUpO1xuICB4JC5hZGRDbGFzcygnb25saW5lJyk7XG4gIHkkID0gJCgnI3Byb2ZpbGUnKTtcbiAgeSQub24oJ2xvYWQnLCBmdW5jdGlvbigpe1xuICAgIHJldHVybiAkKCcucHJvZmlsZScpLnNob3coKTtcbiAgfSk7XG4gIHkkLmF0dHIoJ3NyYycsIHdpbmRvdy5jYWNoZVVybCArIHNyYyk7XG4gIHJldHVybiB5JDtcbn07IixudWxsLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcblxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG5wcm9jZXNzLm5leHRUaWNrID0gKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2FuU2V0SW1tZWRpYXRlID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAmJiB3aW5kb3cuc2V0SW1tZWRpYXRlO1xuICAgIHZhciBjYW5Qb3N0ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCdcbiAgICAmJiB3aW5kb3cucG9zdE1lc3NhZ2UgJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXJcbiAgICA7XG5cbiAgICBpZiAoY2FuU2V0SW1tZWRpYXRlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZikgeyByZXR1cm4gd2luZG93LnNldEltbWVkaWF0ZShmKSB9O1xuICAgIH1cblxuICAgIGlmIChjYW5Qb3N0KSB7XG4gICAgICAgIHZhciBxdWV1ZSA9IFtdO1xuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChldikge1xuICAgICAgICAgICAgaWYgKGV2LnNvdXJjZSA9PT0gd2luZG93ICYmIGV2LmRhdGEgPT09ICdwcm9jZXNzLXRpY2snKSB7XG4gICAgICAgICAgICAgICAgZXYuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgaWYgKHF1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZuID0gcXVldWUuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiBuZXh0VGljayhmbikge1xuICAgICAgICAgICAgcXVldWUucHVzaChmbik7XG4gICAgICAgICAgICB3aW5kb3cucG9zdE1lc3NhZ2UoJ3Byb2Nlc3MtdGljaycsICcqJyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIGZ1bmN0aW9uIG5leHRUaWNrKGZuKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZm4sIDApO1xuICAgIH07XG59KSgpO1xuXG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59XG5cbi8vIFRPRE8oc2h0eWxtYW4pXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbiIsIihmdW5jdGlvbihwcm9jZXNzLGdsb2JhbCl7dmFyIEFkbWluVXBncmFkZSwgQWRtaW5NZW51LCBQYWdpbmF0b3IsIFBob3RvQ3JvcHBlciwgbGF5b3V0U3RhdGljLCBsYXlvdXRPblBlcnNvbmFsaXplLCBwYWdlckluaXQsIGhvbWVwYWdlLCBmb3J1bSwgc2FtZVByb2ZpbGUsIHByb2ZpbGUsIGFkbWluLCBqb2luU2VhcmNoLCByZXNldFBhZ2luYXRvciwgZW5kU2VhcmNoLCBta1NlYXJjaFBudW1Ub0hyZWYsIG1rUG9zdFBudW1Ub0hyZWYsIHNlYXJjaCwgcGFnZSwgcHJpdmF0ZVNpdGUsIHNsaWNlJCA9IFtdLnNsaWNlLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuZ2xvYmFsLmZ1cmwgPSByZXF1aXJlKCcuL2ZvcnVtLXVybHMubHMnKTtcbmltcG9ydCQoZ2xvYmFsLCByZXF1aXJlKCcuL3NoYXJlZC1oZWxwZXJzLmxzJykpO1xuQWRtaW5VcGdyYWRlID0gcmVxdWlyZSgnLi4vY29tcG9uZW50L0FkbWluVXBncmFkZS5scycpO1xuQWRtaW5NZW51ID0gcmVxdWlyZSgnLi4vY29tcG9uZW50L0FkbWluTWVudS5scycpO1xuUGFnaW5hdG9yID0gcmVxdWlyZSgnLi4vY29tcG9uZW50L1BhZ2luYXRvci5scycpO1xuUGhvdG9Dcm9wcGVyID0gcmVxdWlyZSgnLi4vY29tcG9uZW50L1Bob3RvQ3JvcHBlci5scycpO1xuZnVuY3Rpb24gYmVuY2goc3ViamVjdE5hbWUsIHN1YmplY3RCb2R5KXtcbiAgdmFyIGJlZiwgYWZ0O1xuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xuICAgIHN1YmplY3RCb2R5KCk7XG4gIH0gZWxzZSB7XG4gICAgYmVmID0gbmV3IERhdGU7XG4gICAgc3ViamVjdEJvZHkoKTtcbiAgICBhZnQgPSBuZXcgRGF0ZTtcbiAgICBwYXJ0aWFsaXplJC5hcHBseSh0aGlzLCBbc2V0VGltZW91dCwgW3ZvaWQgOCwgMV0sIFswXV0pKGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgZHVyO1xuICAgICAgZHVyID0gYWZ0IC0gYmVmO1xuICAgICAgcmV0dXJuIGNvbnNvbGUubG9nKFwiYmVuY2htYXJrZWQgJ1wiICsgc3ViamVjdE5hbWUgKyBcIic6IHRvb2sgXCIgKyBkdXIgKyBcIm1zXCIpO1xuICAgIH0pO1xuICB9XG59XG5mdW5jdGlvbiByZW5kZXJDb21wb25lbnQod2luLCB0YXJnZXQsIG5hbWUsIGtsYXNzLCBmaXJzdEtsYXNzQXJnKXtcbiAgdmFyIHdjLCBjLCBsb2NhbHM7XG4gIHdjID0gd2luLmNvbXBvbmVudCB8fCAod2luLmNvbXBvbmVudCA9IHt9KTtcbiAgaWYgKGMgPSB3Y1tuYW1lXSkge1xuICAgIGlmIChsb2NhbHMgPSBmaXJzdEtsYXNzQXJnICE9IG51bGwgPyBmaXJzdEtsYXNzQXJnLmxvY2FscyA6IHZvaWQgOCkge1xuICAgICAgYy5sb2NhbHMobG9jYWxzKTtcbiAgICB9XG4gICAgYy5yZWxvYWQoKTtcbiAgfSBlbHNlIHtcbiAgICBjID0gd2NbbmFtZV0gPSBuZXcga2xhc3MoZmlyc3RLbGFzc0FyZyk7XG4gIH1cbiAgd2luLiQodGFyZ2V0KS5odG1sKCcnKS5hcHBlbmQoYy4kKTtcbn1cbmZ1bmN0aW9uIHBhZ2luYXRvckNvbXBvbmVudCh3LCBsb2NhbHMsIHBudW1Ub0hyZWYpe1xuICB2YXIgd2M7XG4gIHdjID0gdy5jb21wb25lbnQgfHwgKHcuY29tcG9uZW50ID0ge30pO1xuICBpZiAod2MucGFnaW5hdG9yKSB7XG4gICAgd2MucGFnaW5hdG9yLmxvY2Fscyhsb2NhbHMpO1xuICAgIHdjLnBhZ2luYXRvci5wbnVtVG9IcmVmKHBudW1Ub0hyZWYpO1xuICAgIHdjLnBhZ2luYXRvci5yZWxvYWQoKTtcbiAgfSBlbHNlIHtcbiAgICB3Yy5wYWdpbmF0b3IgPSBuZXcgUGFnaW5hdG9yKHtcbiAgICAgIGxvY2FsczogbG9jYWxzLFxuICAgICAgcG51bVRvSHJlZjogcG51bVRvSHJlZlxuICAgIH0sIHcuJCgnI3BiX3BhZ2luYXRvcicpKTtcbiAgfVxufVxuZnVuY3Rpb24gcGFyc2VVcmwodXJsKXtcbiAgdmFyIGEsIHA7XG4gIGlmICh0eXBlb2YgZG9jdW1lbnQgIT0gJ3VuZGVmaW5lZCcgJiYgZG9jdW1lbnQgIT09IG51bGwpIHtcbiAgICBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIGEuaHJlZiA9IHVybDtcbiAgICByZXR1cm4ge1xuICAgICAgc2VhcmNoOiBhLnNlYXJjaCxcbiAgICAgIHBhdGhuYW1lOiBhLnBhdGhuYW1lXG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBwID0gcmVxdWlyZSgndXJsJykucGFyc2UodXJsKTtcbiAgICByZXR1cm4ge1xuICAgICAgc2VhcmNoOiBwLnNlYXJjaCxcbiAgICAgIHBhdGhuYW1lOiBwLnBhdGhuYW1lXG4gICAgfTtcbiAgfVxufVxuZnVuY3Rpb24gZGVmYXVsdFBudW1Ub0hyZWZGdW4odXJpKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKHBnKXtcbiAgICB2YXIgcGFyc2VkO1xuICAgIHBhcnNlZCA9IHBhcnNlVXJsKHVyaSk7XG4gICAgaWYgKHBnID4gMSkge1xuICAgICAgcmV0dXJuIHBhcnNlZC5wYXRobmFtZSArIChcIj9wYWdlPVwiICsgcGcpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcGFyc2VkLnBhdGhuYW1lO1xuICAgIH1cbiAgfTtcbn1cbmxheW91dFN0YXRpYyA9IGZ1bmN0aW9uKHcsIG5leHRNdXRhbnQsIGFjdGl2ZUZvcnVtSWQpe1xuICB2YXIgZm9ydW1DbGFzcywgZmlkLCBwO1xuICBhY3RpdmVGb3J1bUlkID09IG51bGwgJiYgKGFjdGl2ZUZvcnVtSWQgPSAtMSk7XG4gIGZvcnVtQ2xhc3MgPSB3LmFjdGl2ZUZvcnVtSWQgPyBcIiBmb3J1bS1cIiArIHcuYWN0aXZlRm9ydW1JZCA6ICcnO1xuICB3LiQoJ2h0bWwnKS5hdHRyKCdjbGFzcycsIG5leHRNdXRhbnQgKyBcIlwiICsgZm9ydW1DbGFzcyk7XG4gIHcubWFyc2hhbCgnbXV0YXRvcicsIG5leHRNdXRhbnQpO1xuICBmaWQgPSBhY3RpdmVGb3J1bUlkIHx8IHcuYWN0aXZlRm9ydW1JZDtcbiAgdy4kKCdoZWFkZXIgLm1lbnUnKS5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICB3LiQoXCJtZW51IC5yb3cgLmZvcnVtLVwiICsgZmlkKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gIHAgPSB3LiQoXCJtZW51IC5zdWJtZW51IC5mb3J1bS1cIiArIGZpZCk7XG4gIGlmIChwLmxlbmd0aCkge1xuICAgIHAucGFyZW50KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIHJldHVybiB3LiQobGFzdChwLnBhcmVudHMoJ2xpJykpKS5maW5kKCcudGl0bGUnKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gIH1cbn07XG5sYXlvdXRPblBlcnNvbmFsaXplID0gZnVuY3Rpb24odywgdSl7XG4gIGlmICh1KSB7XG4gICAgc2V0T25saW5lVXNlcih1LmlkKTtcbiAgICBzZXRQcm9maWxlKHUucGhvdG8pO1xuICAgIHN3aXRjaCAod2luZG93LmxvY2F0aW9uLmhhc2gpIHtcbiAgICBjYXNlICcjY2hvb3NlJzpcbiAgICAgIGlmIChpc0VtYWlsKHR5cGVvZiB1c2VyICE9ICd1bmRlZmluZWQnICYmIHVzZXIgIT09IG51bGwgPyB1c2VyLm5hbWUgOiB2b2lkIDgpKSB7XG4gICAgICAgIEF1dGguc2hvd0xvZ2luRGlhbG9nKCk7XG4gICAgICAgIHJldHVybiBzd2l0Y2hBbmRGb2N1cygnb24tbG9naW4nLCAnb24tY2hvb3NlJywgJyNhdXRoIGlucHV0W25hbWU9dXNlcm5hbWVdJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xucGFnZXJJbml0ID0gZnVuY3Rpb24odyl7XG4gIHZhciBwYWdlck9wdHM7XG4gIHBhZ2VyT3B0cyA9IHtcbiAgICBjdXJyZW50OiBwYXJzZUludCh3LnBhZ2UpLFxuICAgIGxhc3Q6IHBhcnNlSW50KHcucGFnZXNDb3VudCksXG4gICAgZm9ydW1JZDogcGFyc2VJbnQody5hY3RpdmVGb3J1bUlkKVxuICB9O1xuICBpZiAody5wYWdlcikge1xuICAgIGltcG9ydCQody5wYWdlciwgcGFnZXJPcHRzKTtcbiAgICB3LnBhZ2VyLmluaXQoKTtcbiAgfSBlbHNlIHtcbiAgICB3LnBhZ2VyID0gbmV3IHcuUGFnZXIoJyNwYWdpbmF0b3InLCBwYWdlck9wdHMpO1xuICB9XG4gIGlmICh3LnBhZ2UpIHtcbiAgICByZXR1cm4gdy5wYWdlci5zZXRQYWdlKHcucGFnZSwgZmFsc2UpO1xuICB9XG59O1xub3V0JC5ob21lcGFnZSA9IGhvbWVwYWdlID0ge1xuICAnc3RhdGljJzogZnVuY3Rpb24od2luZG93LCBuZXh0KXtcbiAgICB3aW5kb3cucmVuZGVyTXV0YW50KCdtYWluX2NvbnRlbnQnLCAnaG9tZXBhZ2UnKTtcbiAgICBsYXlvdXRTdGF0aWMuY2FsbCh0aGlzLCB3aW5kb3csICdob21lcGFnZScpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uUGVyc29uYWxpemU6IGZ1bmN0aW9uKHcsIHUsIG5leHQpe1xuICAgIGxheW91dE9uUGVyc29uYWxpemUodywgdSk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25Mb2FkOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHZhciBhY3RpdmUsIHJlZiQ7XG4gICAgdHJ5IHtcbiAgICAgIHdpbmRvdy4kKCcuZm9ydW0gLmNvbnRhaW5lcicpLm1hc29ucnkoe1xuICAgICAgICBpdGVtU2VsZWN0b3I6ICcucG9zdCcsXG4gICAgICAgIGlzQW5pbWF0ZWQ6IHRydWUsXG4gICAgICAgIGFuaW1hdGlvbk9wdGlvbnM6IHtcbiAgICAgICAgICBkdXJhdGlvbjogMjAwXG4gICAgICAgIH0sXG4gICAgICAgIGlzRml0V2lkdGg6IHRydWUsXG4gICAgICAgIGlzUmVzaXphYmxlOiB0cnVlXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlJCkge31cbiAgICBhY3RpdmUgPSAoKHJlZiQgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLm1hdGNoKC9vcmRlcj0oXFx3KykvKSkgIT0gbnVsbCA/IHJlZiRbMV0gOiB2b2lkIDgpIHx8ICdyZWNlbnQnO1xuICAgIHdpbmRvdy5qYWRlLnJlbmRlcigkKCcuZXh0cmE6Zmlyc3QnKVswXSwgJ29yZGVyLWNvbnRyb2wnLCB7XG4gICAgICBhY3RpdmU6IGFjdGl2ZVxuICAgIH0pO1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHZhciByZW9yZGVyO1xuICAgICAgJCgnLmZvcnVtJykud2F5cG9pbnQoe1xuICAgICAgICBvZmZzZXQ6ICcyNSUnLFxuICAgICAgICBoYW5kbGVyOiBmdW5jdGlvbihkaXJlY3Rpb24pe1xuICAgICAgICAgIHZhciBlLCBlaWQsIGlkLCBjdXI7XG4gICAgICAgICAgZSA9ICQodGhpcyk7XG4gICAgICAgICAgZWlkID0gZS5hdHRyKCdpZCcpO1xuICAgICAgICAgIGlkID0gZGlyZWN0aW9uID09PSAnZG93bidcbiAgICAgICAgICAgID8gZWlkXG4gICAgICAgICAgICA6ICQoXCIjXCIgKyBlaWQpLnByZXZBbGwoJy5mb3J1bTpmaXJzdCcpLmF0dHIoJ2lkJyk7XG4gICAgICAgICAgaWYgKCFpZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICAkKCdoZWFkZXIgLm1lbnUnKS5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgIGN1ciA9ICQoJ2hlYWRlciAubWVudScpLmZpbmQoXCIuXCIgKyBpZC5yZXBsYWNlKC9fLywgJy0nKSkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgICAgICQoJy5mb3J1bSAuc3R1Y2snKS5yZW1vdmVDbGFzcygnc3R1Y2snKTtcbiAgICAgICAgICByZXR1cm4gZmxpcEJhY2tncm91bmQod2luZG93LCBjdXIsIGRpcmVjdGlvbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmVvcmRlciA9IF9fLmRlYm91bmNlKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIEhpc3RvcnkucHVzaFN0YXRlKHt9LCAnJywgaXQpO1xuICAgICAgfSwgMTAwKTtcbiAgICAgIHdpbmRvdy5jdXJyZW50T3JkZXIgPSBmYWxzZTtcbiAgICAgIHJldHVybiAkKCcjb3JkZXIgbGknKS53YXlwb2ludCh7XG4gICAgICAgIGNvbnRleHQ6ICd1bCcsXG4gICAgICAgIG9mZnNldDogMzAsXG4gICAgICAgIGhhbmRsZXI6IGZ1bmN0aW9uKGRpcmVjdGlvbil7XG4gICAgICAgICAgdmFyIGUsIG9yZGVyLCBwYXRoO1xuICAgICAgICAgIGUgPSAkKHRoaXMpO1xuICAgICAgICAgIGlmIChkaXJlY3Rpb24gPT09ICd1cCcpIHtcbiAgICAgICAgICAgIGUgPSBlLnByZXYoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKCFlLmxlbmd0aCkge1xuICAgICAgICAgICAgZSA9ICQodGhpcyk7XG4gICAgICAgICAgfVxuICAgICAgICAgICQoJyNvcmRlciBsaS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgZS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICAgICAgb3JkZXIgPSBlLmRhdGEoJ3ZhbHVlJyk7XG4gICAgICAgICAgcGF0aCA9IFwiLz9vcmRlcj1cIiArIG9yZGVyO1xuICAgICAgICAgIGlmICh3aW5kb3cuY3VycmVudE9yZGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVvcmRlcihwYXRoKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5jdXJyZW50T3JkZXIgPSBvcmRlcjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0sIDEwMCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25VbmxvYWQ6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dE11dGFudCwgbmV4dCl7XG4gICAgdHJ5IHtcbiAgICAgIHdpbmRvdy4kKCcuZm9ydW0gLmNvbnRhaW5lcicpLm1hc29ucnkoJ2Rlc3Ryb3knKTtcbiAgICAgIHdpbmRvdy4kKCcuZm9ydW0gLmhlYWRlcicpLndheXBvaW50KCdkZXN0cm95Jyk7XG4gICAgICB3aW5kb3cuJCgnLmZvcnVtJykud2F5cG9pbnQoJ2Rlc3Ryb3knKTtcbiAgICAgIHdpbmRvdy4kKCcjb3JkZXIgbGknKS53YXlwb2ludCgnZGVzdHJveScpO1xuICAgICAgd2luZG93LiQoJy5iZycpLnJlbW92ZSgpO1xuICAgICAgd2luZG93LiQoJCgnLmV4dHJhOmZpcnN0JykpLmh0bWwoJycpO1xuICAgIH0gY2F0Y2ggKGUkKSB7fVxuICAgIHJldHVybiBuZXh0KCk7XG4gIH1cbn07XG5mdW5jdGlvbiByZW5kZXJUaHJlYWRQYWdpbmF0b3JDb21wb25lbnQod2luLCBxdHksIHN0ZXApe1xuICB2YXIgb25QYWdlLCBsb2NhbHM7XG4gIG9uUGFnZSA9IGZ1bmN0aW9uKHBhZ2Upe1xuICAgIHJldHVybiAkLmdldChcIi9yZXNvdXJjZXMvdGhyZWFkcy9cIiArIHdpbmRvdy5hY3RpdmVGb3J1bUlkLCB7XG4gICAgICBwYWdlOiBwYWdlXG4gICAgfSwgZnVuY3Rpb24odG9wVGhyZWFkcywgc3RhdHVzKXtcbiAgICAgIHZhciBjb250YWluZXI7XG4gICAgICBjb250YWluZXIgPSB3aW4uJCgnI2xlZnRfY29udGFpbmVyIC5zY3JvbGxhYmxlJyk7XG4gICAgICByZXR1cm4gY29udGFpbmVyLmh0bWwod2luLmphZGUudGVtcGxhdGVzLl9fdGhyZWFkcyh7XG4gICAgICAgIHRvcFRocmVhZHM6IHRvcFRocmVhZHNcbiAgICAgIH0pKTtcbiAgICB9KTtcbiAgfTtcbiAgbG9jYWxzID0ge1xuICAgIHF0eTogcXR5LFxuICAgIHN0ZXA6IHN0ZXAsXG4gICAgYWN0aXZlUGFnZTogMVxuICB9O1xuICByZW5kZXJDb21wb25lbnQod2luLCAnI3RocmVhZC1wYWdpbmF0b3InLCAndGhyZWFkUGFnaW5hdG9yJywgUGFnaW5hdG9yLCB7XG4gICAgbG9jYWxzOiBsb2NhbHMsXG4gICAgb25QYWdlOiBvblBhZ2VcbiAgfSk7XG59XG5vdXQkLmZvcnVtID0gZm9ydW0gPSB7XG4gICdzdGF0aWMnOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHZhciBwcmV2TXV0YW50LCB0aGlzJCA9IHRoaXM7XG4gICAgcHJldk11dGFudCA9IHdpbmRvdy5tdXRhdG9yO1xuICAgIHdpbmRvdy5yZW5kZXJNdXRhbnQoJ21haW5fY29udGVudCcsIGlzRWRpdGluZyh0aGlzLmZ1cmwucGF0aCkgPT09IHRydWVcbiAgICAgID8gJ3Bvc3QtbmV3J1xuICAgICAgOiBpc0ZvcnVtSG9tZXBhZ2UodGhpcy5mdXJsLnBhdGgpID8gJ2hvbWVwYWdlJyA6ICdwb3N0cycpO1xuICAgIGlmICh0aGlzLnRvcFRocmVhZHMpIHtcbiAgICAgIHdpbmRvdy5yZW5kZXJNdXRhbnQoJ2xlZnRfY29udGFpbmVyJywgJ25hdicpO1xuICAgICAgcmVuZGVyVGhyZWFkUGFnaW5hdG9yQ29tcG9uZW50KHdpbmRvdywgdGhpcy50UXR5LCB0aGlzLnRTdGVwKTtcbiAgICAgIHdpbmRvdy5tYXJzaGFsKCd0UXR5JywgdGhpcy50UXR5KTtcbiAgICAgIHdpbmRvdy5tYXJzaGFsKCd0U3RlcCcsIHRoaXMudFN0ZXApO1xuICAgIH1cbiAgICB3aW5kb3cubWFyc2hhbCgnYWN0aXZlRm9ydW1JZCcsIHRoaXMuYWN0aXZlRm9ydW1JZCk7XG4gICAgd2luZG93Lm1hcnNoYWwoJ2FjdGl2ZVRocmVhZElkJywgdGhpcy5hY3RpdmVUaHJlYWRJZCk7XG4gICAgd2luZG93Lm1hcnNoYWwoJ3BhZ2UnLCB0aGlzLnBhZ2UpO1xuICAgIHdpbmRvdy5tYXJzaGFsKCdwYWdlc0NvdW50JywgdGhpcy5wYWdlc0NvdW50KTtcbiAgICB3aW5kb3cubWFyc2hhbCgncHJldlBhZ2VzJywgdGhpcy5wcmV2UGFnZXMpO1xuICAgIChmdW5jdGlvbigpe1xuICAgICAgdmFyIHdjLCBsb2NhbHMsIHBudW1Ub0hyZWY7XG4gICAgICBpZiAoIXRoaXMkLnBvc3QpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgd2MgPSB3aW5kb3cuY29tcG9uZW50IHx8ICh3aW5kb3cuY29tcG9uZW50ID0ge30pO1xuICAgICAgbG9jYWxzID0ge1xuICAgICAgICBzdGVwOiB0aGlzJC5saW1pdCxcbiAgICAgICAgcXR5OiB0aGlzJC5xdHksXG4gICAgICAgIGFjdGl2ZVBhZ2U6IHRoaXMkLnBhZ2VcbiAgICAgIH07XG4gICAgICBwbnVtVG9IcmVmID0gbWtQb3N0UG51bVRvSHJlZih0aGlzJC5wb3N0LnVyaSk7XG4gICAgICByZXR1cm4gcGFnaW5hdG9yQ29tcG9uZW50KHdpbmRvdywgbG9jYWxzLCBwbnVtVG9IcmVmKTtcbiAgICB9KSgpO1xuICAgIGxheW91dFN0YXRpYy5jYWxsKHRoaXMsIHdpbmRvdywgJ2ZvcnVtJywgdGhpcy5hY3RpdmVGb3J1bUlkKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9LFxuICBvbkxvYWQ6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgdmFyIGN1ciwgJCwgJGwsIGlkLCBwb3N0SWQ7XG4gICAgY3VyID0gd2luZG93LiQoXCJoZWFkZXIgLm1lbnUgLmZvcnVtLVwiICsgd2luZG93LmFjdGl2ZUZvcnVtSWQpO1xuICAgIGZsaXBCYWNrZ3JvdW5kKHdpbmRvdywgY3VyKTtcbiAgICAkID0gd2luZG93LiQ7XG4gICAgYWxpZ25CcmVhZGNydW1iKCk7XG4gICAgJGwgPSAkKCcjbGVmdF9jb250YWluZXInKTtcbiAgICAkbC5maW5kKCcuYWN0aXZlJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICRsLmZpbmQoXCIudGhyZWFkW2RhdGEtaWQ9J1wiICsgd2luZG93LmFjdGl2ZVRocmVhZElkICsgXCInXVwiKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgaWQgPSBpc0VkaXRpbmcod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKTtcbiAgICBpZiAoaWQpIHtcbiAgICAgIGVkaXRQb3N0KGlkLCB7XG4gICAgICAgIGZvcnVtX2lkOiB3aW5kb3cuYWN0aXZlRm9ydW1JZFxuICAgICAgfSk7XG4gICAgfVxuICAgICQoJ2JvZHknKS5vbignY2xpY2snLCB0b2dnbGVQb3N0KTtcbiAgICBwb3N0SWQgPSAkKCcjbWFpbl9jb250ZW50IC5wb3N0OmZpcnN0JykuZGF0YSgncG9zdC1pZCcpO1xuICAgIGlmIChwb3N0SWQpIHtcbiAgICAgICQucG9zdChcIi9yZXNvdXJjZXMvcG9zdHMvXCIgKyBwb3N0SWQgKyBcIi9pbXByZXNzaW9uXCIpO1xuICAgIH1cbiAgICBwYWdlckluaXQod2luZG93KTtcbiAgICBpZiAodXNlcikge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gJCgnLm9uY2xpY2stYXBwZW5kLXJlcGx5LXVpOmZpcnN0JykuY2xpY2soKTtcbiAgICAgIH0sIDMwMCk7XG4gICAgfVxuICAgIHdpbmRvdy5zdXJmRGF0YSA9IHdpbmRvdy5hY3RpdmVGb3J1bUlkO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uSW5pdGlhbDogZnVuY3Rpb24od2luZG93LCBuZXh0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgdGhyZWFkcywgb2Zmc2V0LCBjdXIsIGRzdCwgcmVmJDtcbiAgICAgIHRocmVhZHMgPSAkKCcjbGVmdF9jb250YWluZXIgLnRocmVhZHMnKTtcbiAgICAgIG9mZnNldCA9IC0xMjU7XG4gICAgICBjdXIgPSB0aHJlYWRzLnNjcm9sbFRvcCgpO1xuICAgICAgZHN0ID0gTWF0aC5yb3VuZCgocmVmJCA9ICQoJyNsZWZ0X2NvbnRhaW5lciAudGhyZWFkcyA+IC5hY3RpdmUnKS5wb3NpdGlvbigpKSAhPSBudWxsID8gcmVmJC50b3AgOiB2b2lkIDgpO1xuICAgICAgaWYgKGRzdCkge1xuICAgICAgICByZXR1cm4gdGhyZWFkcy5hbmltYXRlKHtcbiAgICAgICAgICBzY3JvbGxUb3A6IGN1ciArIGRzdCArIG9mZnNldFxuICAgICAgICB9LCA1MDAsICdlYXNlT3V0RXhwbycpO1xuICAgICAgfVxuICAgIH0sIDUwMCk7XG4gICAgcmVuZGVyVGhyZWFkUGFnaW5hdG9yQ29tcG9uZW50KHdpbmRvdywgd2luZG93LnRRdHksIHdpbmRvdy50U3RlcCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25NdXRhdGU6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgdmFyIHJlZiQ7XG4gICAgc2Nyb2xsVG9Ub3AoKTtcbiAgICBzZXRXaWRlKCk7XG4gICAgaWYgKChyZWYkID0gd2luZG93LnNvY2tldCkgIT0gbnVsbCkge1xuICAgICAgcmVmJC5lbWl0KCdvbmxpbmUtbm93Jyk7XG4gICAgfVxuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uUGVyc29uYWxpemU6IGZ1bmN0aW9uKHcsIHUsIG5leHQpe1xuICAgIHZhciByZWYkO1xuICAgIGlmICh1KSB7XG4gICAgICBsYXlvdXRPblBlcnNvbmFsaXplKHcsIHUpO1xuICAgICAgJChcIi5wb3N0W2RhdGEtdXNlci1pZD1cIiArIHUuaWQgKyBcIl0gLmNlbnNvclwiKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJyk7XG4gICAgICBpZiAoKHJlZiQgPSB1LnJpZ2h0cykgIT0gbnVsbCAmJiByZWYkWydzdXBlciddKSB7XG4gICAgICAgICQoJy5jZW5zb3InKS5jc3MoJ2Rpc3BsYXknLCAnaW5saW5lJyk7XG4gICAgICB9XG4gICAgICBzZXRJbmxpbmVFZGl0b3IodS5pZCk7XG4gICAgfVxuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbih3aW4sIG5leHRNdXRhbnQsIG5leHQpe1xuICAgICQoJ2JvZHknKS5vZmYoJ2NsaWNrJyk7XG4gICAgdHJ5IHtcbiAgICAgIHdpbi4kKCcjbGVmdF9jb250YWluZXInKS5yZXNpemFibGUoJ2Rlc3Ryb3knKTtcbiAgICB9IGNhdGNoIChlJCkge31cbiAgICBpZiAobmV4dE11dGFudCAhPT0gJ2ZvcnVtJykge1xuICAgICAgcmVzZXRQYWdpbmF0b3Iod2luKTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfVxufTtcbnNhbWVQcm9maWxlID0gZnVuY3Rpb24oaGludHMpe1xuICB2YXIgcmVmJCwgbCwgYywgcDEsIHAyO1xuICByZWYkID0gW2hpbnRzLmxhc3QsIGhpbnRzLmN1cnJlbnRdLCBsID0gcmVmJFswXSwgYyA9IHJlZiRbMV07XG4gIGlmIChsLm11dGF0b3IgPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmVmJCA9IFtsLnBhdGhuYW1lLnNwbGl0KCcvJyksIGMucGF0aG5hbWUuc3BsaXQoJy8nKV0sIHAxID0gcmVmJFswXSwgcDIgPSByZWYkWzFdO1xuICBpZiAocDFbMV0gPT09ICd1c2VyJyAmJiBwMlsxXSA9PT0gJ3VzZXInKSB7XG4gICAgaWYgKHAxWzJdID09PSBwMlsyXSkge1xuICAgICAgcmV0dXJuIHAxWzJdO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2U7XG59O1xub3V0JC5wcm9maWxlID0gcHJvZmlsZSA9IHtcbiAgJ3N0YXRpYyc6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICBpZiAod2luZG93LmhpbnRzKSB7XG4gICAgICBpZiAoIXNhbWVQcm9maWxlKHdpbmRvdy5oaW50cykpIHtcbiAgICAgICAgd2luZG93LnJlbmRlck11dGFudCgnbGVmdF9jb250YWluZXInLCAncHJvZmlsZScpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cucmVuZGVyTXV0YW50KCdsZWZ0X2NvbnRhaW5lcicsICdwcm9maWxlJyk7XG4gICAgfVxuICAgIHdpbmRvdy5yZW5kZXJNdXRhbnQoJ21haW5fY29udGVudCcsICdwb3N0cy1ieS11c2VyJyk7XG4gICAgd2luZG93Lm1hcnNoYWwoJ3N0ZXAnLCB0aGlzLnN0ZXApO1xuICAgIHdpbmRvdy5tYXJzaGFsKCdxdHknLCB0aGlzLnF0eSk7XG4gICAgd2luZG93Lm1hcnNoYWwoJ3BhZ2UnLCB0aGlzLnBhZ2UpO1xuICAgIHdpbmRvdy5tYXJzaGFsKCdwYWdlc0NvdW50JywgdGhpcy5wYWdlc0NvdW50KTtcbiAgICAoZnVuY3Rpb24oKXtcbiAgICAgIHZhciBsb2NhbHMsIHBudW1Ub0hyZWY7XG4gICAgICBsb2NhbHMgPSB7XG4gICAgICAgIHN0ZXA6IHRoaXMkLmxpbWl0LFxuICAgICAgICBxdHk6IHRoaXMkLnF0eSxcbiAgICAgICAgYWN0aXZlUGFnZTogdGhpcyQucGFnZVxuICAgICAgfTtcbiAgICAgIHBudW1Ub0hyZWYgPSBta1Bvc3RQbnVtVG9IcmVmKFwiL3VzZXIvXCIgKyB0aGlzJC5wcm9maWxlLm5hbWUpO1xuICAgICAgd2luZG93Lm1hcnNoYWwoJ3VyaScsIHRoaXMkLnVyaSk7XG4gICAgICByZXR1cm4gcGFnaW5hdG9yQ29tcG9uZW50KHdpbmRvdywgbG9jYWxzLCBwbnVtVG9IcmVmKTtcbiAgICB9KSgpO1xuICAgIGxheW91dFN0YXRpYy5jYWxsKHRoaXMsIHdpbmRvdywgJ3Byb2ZpbGUnKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9LFxuICBvbkxvYWQ6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgcGFnZXJJbml0KHdpbmRvdyk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25NdXRhdGU6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgc2Nyb2xsVG9Ub3AoKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9LFxuICBvblBlcnNvbmFsaXplOiBmdW5jdGlvbih3LCB1LCBuZXh0KXtcbiAgICByZXR1cm4gbGF6eUxvYWRIdG1sNVVwbG9hZGVyKGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGhvdG9jcm9wcGVyU3RhcnQsIHBob3RvY3JvcHBlckVuYWJsZSwgcGhvdG9jcm9wcGVyRGlzYWJsZSwgcHJvZmlsZVVzZXJJZDtcbiAgICAgIHBob3RvY3JvcHBlclN0YXJ0ID0gZnVuY3Rpb24oZXYpe1xuICAgICAgICByZXR1cm4gUGhvdG9Dcm9wcGVyLnN0YXJ0KCk7XG4gICAgICB9O1xuICAgICAgcGhvdG9jcm9wcGVyRW5hYmxlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG9wdGlvbnM7XG4gICAgICAgIHdpbmRvdy4kKCcjbGVmdF9jb250ZW50JykuYWRkQ2xhc3MoJ2VkaXRhYmxlJyk7XG4gICAgICAgIHdpbmRvdy4kKCdib2R5Jykub24oJ2NsaWNrJywgJyNsZWZ0X2NvbnRlbnQuZWRpdGFibGUgLmF2YXRhcicsIHBob3RvY3JvcHBlclN0YXJ0KTtcbiAgICAgICAgb3B0aW9ucyA9IHtcbiAgICAgICAgICBuYW1lOiAnYXZhdGFyJyxcbiAgICAgICAgICBwb3N0VXJsOiBcIi9yZXNvdXJjZXMvdXNlcnMvXCIgKyB3aW5kb3cudXNlci5pZCArIFwiL2F2YXRhclwiLFxuICAgICAgICAgIG9uU3VjY2VzczogZnVuY3Rpb24ocil7XG4gICAgICAgICAgICByZXR1cm4gUGhvdG9Dcm9wcGVyLnN0YXJ0KHtcbiAgICAgICAgICAgICAgbW9kZTogJ2Nyb3AnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB3aW5kb3cuJCgnI2xlZnRfY29udGVudCAuYXZhdGFyJykuaHRtbDVVcGxvYWRlcihvcHRpb25zKTtcbiAgICAgIH07XG4gICAgICBwaG90b2Nyb3BwZXJEaXNhYmxlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgd2luZG93LiQoJyNsZWZ0X2NvbnRlbnQnKS5yZW1vdmVDbGFzcygnZWRpdGFibGUnKTtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy4kKCdib2R5Jykub2ZmKCdjbGljaycsICcjbGVmdF9jb250ZW50LmVkaXRhYmxlIC5hdmF0YXInLCBwaG90b2Nyb3BwZXJTdGFydCk7XG4gICAgICB9O1xuICAgICAgaWYgKHUpIHtcbiAgICAgICAgbGF5b3V0T25QZXJzb25hbGl6ZSh3LCB1KTtcbiAgICAgICAgcHJvZmlsZVVzZXJJZCA9IHdpbmRvdy4kKCcjbGVmdF9jb250ZW50IC5wcm9maWxlJykuZGF0YSgndXNlcklkJyk7XG4gICAgICAgIGlmIChwcm9maWxlVXNlcklkID09PSB1LmlkKSB7XG4gICAgICAgICAgcGhvdG9jcm9wcGVyRW5hYmxlKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcGhvdG9jcm9wcGVyRGlzYWJsZSgpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBwaG90b2Nyb3BwZXJEaXNhYmxlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV4dCgpO1xuICAgIH0pO1xuICB9LFxuICBvblVubG9hZDogZnVuY3Rpb24od2luZG93LCBuZXh0TXV0YW50LCBuZXh0KXtcbiAgICBpZiAobmV4dE11dGFudCAhPT0gJ2ZvcnVtJykge1xuICAgICAgcmVzZXRQYWdpbmF0b3Iod2luZG93KTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25Jbml0aWFsOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgKGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgbG9jYWxzLCBuYW1lLCBwbnVtVG9IcmVmO1xuICAgICAgbG9jYWxzID0ge1xuICAgICAgICBzdGVwOiB3aW5kb3cuc3RlcCxcbiAgICAgICAgcXR5OiB3aW5kb3cucXR5LFxuICAgICAgICBhY3RpdmVQYWdlOiB3aW5kb3cucGFnZVxuICAgICAgfTtcbiAgICAgIG5hbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKVsyXTtcbiAgICAgIHBudW1Ub0hyZWYgPSBta1Bvc3RQbnVtVG9IcmVmKFwiL3VzZXIvXCIgKyBuYW1lKTtcbiAgICAgIHJldHVybiBwYWdpbmF0b3JDb21wb25lbnQod2luZG93LCBsb2NhbHMsIHBudW1Ub0hyZWYpO1xuICAgIH0pKCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfVxufTtcbmZ1bmN0aW9uIHJlbmRlckFkbWluQ29tcG9uZW50cyhhY3Rpb24sIHNpdGUsIHdpbil7XG4gIHN3aXRjaCAoYWN0aW9uKSB7XG4gIGNhc2UgJ2RvbWFpbnMnOlxuICAgIHRyeSB7XG4gICAgICB3aW4ucmVuZGVyTXV0YW50KCdtYWluX2NvbnRlbnQnLCAnYWRtaW4tZG9tYWlucycpO1xuICAgIH0gY2F0Y2ggKGUkKSB7fVxuICAgIGJyZWFrO1xuICBjYXNlICdpbnZpdGVzJzpcbiAgICB0cnkge1xuICAgICAgd2luLnJlbmRlck11dGFudCgnbWFpbl9jb250ZW50JywgJ2FkbWluLWludml0ZXMnKTtcbiAgICB9IGNhdGNoIChlJCkge31cbiAgICBicmVhaztcbiAgY2FzZSAnbWVudSc6XG4gICAgcmVuZGVyQ29tcG9uZW50KHdpbiwgJyNtYWluX2NvbnRlbnQnLCAnYWRtaW4tbWVudScsIEFkbWluTWVudSwge1xuICAgICAgbG9jYWxzOiB7XG4gICAgICAgIHNpdGU6IHNpdGVcbiAgICAgIH1cbiAgICB9KTtcbiAgICBicmVhaztcbiAgY2FzZSAndXBncmFkZSc6XG4gICAgcmVuZGVyQ29tcG9uZW50KHdpbiwgJyNtYWluX2NvbnRlbnQnLCAnYWRtaW4tdXBncmFkZScsIEFkbWluVXBncmFkZSwge1xuICAgICAgbG9jYWxzOiB7XG4gICAgICAgIHN1YnNjcmlwdGlvbnM6IHNpdGUuc3Vic2NyaXB0aW9uc1xuICAgICAgfVxuICAgIH0pO1xuICAgIGJyZWFrO1xuICBkZWZhdWx0OlxuICAgIHRyeSB7XG4gICAgICB3aW4ucmVuZGVyTXV0YW50KCdtYWluX2NvbnRlbnQnLCAnYWRtaW4tZ2VuZXJhbCcpO1xuICAgIH0gY2F0Y2ggKGUkKSB7fVxuICB9XG59XG5vdXQkLmFkbWluID0gYWRtaW4gPSB7XG4gICdzdGF0aWMnOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHdpbmRvdy5yZW5kZXJNdXRhbnQoJ2xlZnRfY29udGFpbmVyJywgJ2FkbWluLW5hdicpO1xuICAgIHdpbmRvdy4kKCcjbGVmdF9jb250YWluZXIgbWVudSBsaScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcbiAgICB3aW5kb3cuJChcIiNsZWZ0X2NvbnRhaW5lciBtZW51IC5cIiArICh0aGlzLmFjdGlvbiB8fCAnZ2VuZXJhbCcpKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgcmVuZGVyQWRtaW5Db21wb25lbnRzKHRoaXMuYWN0aW9uLCB0aGlzLnNpdGUsIHdpbmRvdyk7XG4gICAgd2luZG93Lm1hcnNoYWwoJ2FjdGlvbicsIHRoaXMuYWN0aW9uKTtcbiAgICB3aW5kb3cubWFyc2hhbCgnc2l0ZScsIHRoaXMuc2l0ZSk7XG4gICAgbGF5b3V0U3RhdGljLmNhbGwodGhpcywgd2luZG93LCAnYWRtaW4nKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9LFxuICBvblBlcnNvbmFsaXplOiBmdW5jdGlvbih3LCB1LCBuZXh0KXtcbiAgICBsYXlvdXRPblBlcnNvbmFsaXplKHcsIHUpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uVW5sb2FkOiBmdW5jdGlvbih3aW5kb3csIG5leHRNdXRhbnQsIG5leHQpe1xuICAgIGlmICh3aW5kb3cuYWRtaW5FeHBhbmRlZCkge1xuICAgICAgJCgnYm9keScpLmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25Mb2FkOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHZhciAkYiwgdGhpcyQgPSB0aGlzO1xuICAgICRiID0gJCgnYm9keScpO1xuICAgIGlmICh3aW5kb3cuYWRtaW5FeHBhbmRlZCA9ICRiLmhhc0NsYXNzKCdjb2xsYXBzZWQnKSkge1xuICAgICAgJGIucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xuICAgIH1cbiAgICAkKCdmb3JtIGlucHV0OmZpcnN0JykuZm9jdXMoKS5zZWxlY3QoKTtcbiAgICAkKCcuZG9tYWluJykudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgd2luZG93LnBhZ2VzQ291bnQgPSAwO1xuICAgIHBhZ2VySW5pdCh3aW5kb3cpO1xuICAgIHJldHVybiBsYXp5TG9hZE5lc3RlZFNvcnRhYmxlKGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gbGF6eUxvYWREZXNlcmlhbGl6ZShmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0sXG4gIG9uSW5pdGlhbDogZnVuY3Rpb24od2luLCBuZXh0KXtcbiAgICByZW5kZXJBZG1pbkNvbXBvbmVudHMod2luLmFjdGlvbiwgd2luLnNpdGUsIHdpbik7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25NdXRhdGU6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgc2Nyb2xsVG9Ub3AoKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9XG59O1xuam9pblNlYXJjaCA9IGZ1bmN0aW9uKHNvY2spe1xuICByZXR1cm4gc29jay5lbWl0KCdzZWFyY2gnLCB3aW5kb3cuc2VhcmNob3B0cyk7XG59O1xucmVzZXRQYWdpbmF0b3IgPSBmdW5jdGlvbih3KXtcbiAgdmFyIHJlZiQsIHgkO1xuICAkKCcjcGJfcGFnaW5hdG9yJykuaGlkZSgpO1xuICBpZiAoKHJlZiQgPSB3LmNvbXBvbmVudCkgIT0gbnVsbCAmJiByZWYkLnBhZ2luYXRvcikge1xuICAgIHgkID0gdy5jb21wb25lbnQucGFnaW5hdG9yO1xuICAgIHgkLmxvY2FsKCdxdHknLCAwKTtcbiAgICB4JC5yZWxvYWQoKTtcbiAgICByZXR1cm4geCQ7XG4gIH1cbn07XG5lbmRTZWFyY2ggPSBmdW5jdGlvbih3KXtcbiAgcmVzZXRQYWdpbmF0b3Iodyk7XG4gIHJldHVybiBzb2NrZXQuZW1pdCgnc2VhcmNoLWVuZCcpO1xufTtcbm1rU2VhcmNoUG51bVRvSHJlZiA9IGZ1bmN0aW9uKHNlYXJjaG9wdHMpe1xuICByZXR1cm4gZnVuY3Rpb24ocG51bSl7XG4gICAgdmFyIHF1ZXJ5LCBydmFsLCByZWYkLCBrLCB2O1xuICAgIHF1ZXJ5ID0gcG51bSA9PT0gdm9pZCA4IHx8IHBhcnNlSW50KHBudW0pID09PSAxXG4gICAgICA/IChydmFsID0gaW1wb3J0JCh7fSwgc2VhcmNob3B0cyksIGRlbGV0ZSBydmFsLnBhZ2UsIHJ2YWwpXG4gICAgICA6IChyZWYkID0gaW1wb3J0JCh7fSwgc2VhcmNob3B0cyksIHJlZiQucGFnZSA9IHBudW0sIHJlZiQpO1xuICAgIGlmIChPYmplY3Qua2V5cyhxdWVyeSkubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gJy9zZWFyY2g/JyArIChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgcmVmJCwgcmVzdWx0cyQgPSBbXTtcbiAgICAgICAgZm9yIChrIGluIHJlZiQgPSBxdWVyeSkge1xuICAgICAgICAgIHYgPSByZWYkW2tdO1xuICAgICAgICAgIHJlc3VsdHMkLnB1c2goayArIFwiPVwiICsgdik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdHMkO1xuICAgICAgfSgpKS5qb2luKCcmJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnL3NlYXJjaCc7XG4gICAgfVxuICB9O1xufTtcbm1rUG9zdFBudW1Ub0hyZWYgPSBmdW5jdGlvbihwb3N0VXJpKXtcbiAgcmV0dXJuIGZ1bmN0aW9uKHBudW0pe1xuICAgIGlmIChwbnVtID4gMSkge1xuICAgICAgcmV0dXJuIHBvc3RVcmkgKyBcIi9wYWdlL1wiICsgcG51bTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHBvc3RVcmk7XG4gICAgfVxuICB9O1xufTtcbm91dCQuc2VhcmNoID0gc2VhcmNoID0ge1xuICAnc3RhdGljJzoge1xuICAgIHByZXBhcmU6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgICB2YXIgcGFyYW1zLCBhZnRlciwgcmVmJCwgcmVmMSQsICRxLCBxRWwsIHE7XG4gICAgICBwYXJhbXMgPSB0aGlzO1xuICAgICAgYWZ0ZXIgPSB3aW5kb3cuYWZ0ZXJQcmVwYXJlID0gW107XG4gICAgICB3aW5kb3cubWFyc2hhbCgncGFnZScsIHRoaXMucGFnZSk7XG4gICAgICB3aW5kb3cubWFyc2hhbCgncGFnZXNDb3VudCcsIHRoaXMucGFnZXNDb3VudCk7XG4gICAgICB3aW5kb3cubWFyc2hhbCgnc2VhcmNob3B0cycsIHRoaXMuc2VhcmNob3B0cyk7XG4gICAgICB3aW5kb3cubWFyc2hhbCgnbmV3SGl0cycsIDApO1xuICAgICAgaWYgKCgocmVmJCA9IHdpbmRvdy5oaW50cykgIT0gbnVsbCA/IChyZWYxJCA9IHJlZiQubGFzdCkgIT0gbnVsbCA/IHJlZjEkLm11dGF0b3IgOiB2b2lkIDggOiB2b2lkIDgpICE9PSAnc2VhcmNoJykge1xuICAgICAgICAoZnVuY3Rpb24oKXtcbiAgICAgICAgICB2YXIgZmlsdGVyc0h0bWwsICR0O1xuICAgICAgICAgIHdpbmRvdy5yZXBsYWNlSHRtbCh3aW5kb3cuJCgnI2xlZnRfY29udGFpbmVyJyksICc8ZGl2IGlkPVwic2VhcmNoX2ZpbHRlcnNcIj48L2Rpdj48ZGl2IGlkPVwic2VhcmNoX2ZhY2V0c1wiPjwvZGl2PicpO1xuICAgICAgICAgIGZpbHRlcnNIdG1sID0gd2luZG93LnJlbmRlcignc2VhcmNoLWZpbHRlcnMnKTtcbiAgICAgICAgICAkdCA9IHdpbmRvdy4kKCcjc2VhcmNoX2ZpbHRlcnMnKTtcbiAgICAgICAgICByZXR1cm4gYWZ0ZXIucHVzaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIGJlbmNoKCdzZWFyY2gtZmlsdGVycycsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIHJldHVybiB3aW5kb3cucmVwbGFjZUh0bWwoJHQsIGZpbHRlcnNIdG1sKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KSgpO1xuICAgICAgfVxuICAgICAgKGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBodG1sLCAkdDtcbiAgICAgICAgaHRtbCA9IHdpbmRvdy5yZW5kZXIoJ3NlYXJjaC1mYWNldHMnKTtcbiAgICAgICAgJHQgPSB3aW5kb3cuJCgnI3NlYXJjaF9mYWNldHMnKTtcbiAgICAgICAgcmV0dXJuIGFmdGVyLnB1c2goZnVuY3Rpb24oKXtcbiAgICAgICAgICByZXR1cm4gYmVuY2goJ3NlYXJjaC1mYWNldHMnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXBsYWNlSHRtbCgkdCwgaHRtbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSkoKTtcbiAgICAgIChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgaHRtbCwgJHQ7XG4gICAgICAgIGh0bWwgPSB3aW5kb3cucmVuZGVyKCdzZWFyY2gnKTtcbiAgICAgICAgJHQgPSB3aW5kb3cuJCgnI21haW5fY29udGVudCcpO1xuICAgICAgICByZXR1cm4gYWZ0ZXIucHVzaChmdW5jdGlvbigpe1xuICAgICAgICAgIHJldHVybiBiZW5jaCgnc2VhcmNoLWNvbnRlbnQnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5yZXBsYWNlSHRtbCgkdCwgaHRtbCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSkoKTtcbiAgICAgICRxID0gd2luZG93LiQoJyNxdWVyeScpO1xuICAgICAgcUVsID0gJHFbMF07XG4gICAgICBxID0gdGhpcy5zZWFyY2hvcHRzLnE7XG4gICAgICBpZiAodHlwZW9mIEhpc3RvcnkgIT0gJ3VuZGVmaW5lZCcgJiYgSGlzdG9yeSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAodGhpcy5zdGF0ZWNoYW5nZVdhc1VzZXIpIHtcbiAgICAgICAgICBhZnRlci5wdXNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gYmVuY2goJ3F1ZXJ5LXN0cmluZy11cGRhdGUnLCBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICByZXR1cm4gcUVsLnZhbHVlID0gcTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZnRlci5wdXNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgcmV0dXJuIGJlbmNoKCdxdWVyeS1zdHJpbmctdXBkYXRlJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiAkcS52YWwocSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBIaXN0b3J5ICE9ICd1bmRlZmluZWQnICYmIEhpc3RvcnkgIT09IG51bGwpIHtcbiAgICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHFFbCkge1xuICAgICAgICAgICRxLmJsdXIoKTtcbiAgICAgICAgICBhZnRlci5wdXNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICByZXR1cm4gYmVuY2goJ3JlLWZvY3VzJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgcmV0dXJuIHBhcnRpYWxpemUkLmFwcGx5KHRoaXMsIFtzZXRUaW1lb3V0LCBbdm9pZCA4LCAxXSwgWzBdXSkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHEuZm9jdXMoKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9LFxuICAgIGRyYXc6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgICB2YXIgYWZ0ZXIsIGkkLCBsZW4kLCBmLCB0aGlzJCA9IHRoaXM7XG4gICAgICBhZnRlciA9IHdpbmRvdy5hZnRlclByZXBhcmU7XG4gICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IGFmdGVyLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGYgPSBhZnRlcltpJF07XG4gICAgICAgIGYoKTtcbiAgICAgIH1cbiAgICAgIGJlbmNoKCdmaWx0ZXItc3RhdGUnLCBmdW5jdGlvbigpe1xuICAgICAgICB3aW5kb3cuJCgnI3NlYXJjaF9maWx0ZXJzIFtuYW1lPWZvcnVtX2lkXScpLnZhbCh0aGlzJC5zZWFyY2hvcHRzLmZvcnVtX2lkKTtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy4kKCcjc2VhcmNoX2ZpbHRlcnMgW25hbWU9d2l0aGluXScpLnZhbCh0aGlzJC5zZWFyY2hvcHRzLndpdGhpbik7XG4gICAgICB9KTtcbiAgICAgIChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgd2MsIGxvY2FscywgcG51bVRvSHJlZjtcbiAgICAgICAgd2MgPSB3aW5kb3cuY29tcG9uZW50IHx8ICh3aW5kb3cuY29tcG9uZW50ID0ge30pO1xuICAgICAgICBsb2NhbHMgPSB7XG4gICAgICAgICAgc3RlcDogMTAsXG4gICAgICAgICAgcXR5OiB0aGlzJC5lbHJlcy50b3RhbCxcbiAgICAgICAgICBhY3RpdmVQYWdlOiB0aGlzJC5wYWdlXG4gICAgICAgIH07XG4gICAgICAgIHBudW1Ub0hyZWYgPSBta1NlYXJjaFBudW1Ub0hyZWYodGhpcyQuc2VhcmNob3B0cyk7XG4gICAgICAgIHJldHVybiBwYWdpbmF0b3JDb21wb25lbnQod2luZG93LCBsb2NhbHMsIHBudW1Ub0hyZWYpO1xuICAgICAgfSkoKTtcbiAgICAgIGJlbmNoKCdsYXlvdXQtc3RhdGljJywgZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGxheW91dFN0YXRpYy5jYWxsKHRoaXMkLCB3aW5kb3csICdzZWFyY2gnKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9XG4gIH0sXG4gIG9uSW5pdGlhbDogZnVuY3Rpb24odywgbmV4dCl7XG4gICAgJFIoam9pblNlYXJjaCkuYmluZFRvKHcuclNvY2tldCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25NdXRhdGU6IGZ1bmN0aW9uKHcsIG5leHQpe1xuICAgIGpvaW5TZWFyY2gody5zb2NrZXQpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uTG9hZDogZnVuY3Rpb24odywgbmV4dCl7XG4gICAgd2luZG93LiRuZXdIaXRzID0gdy4kKCc8ZGl2Lz4nKTtcbiAgICBhbGlnbkJyZWFkY3J1bWIoKTtcbiAgICBwYWdlckluaXQodyk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25VbmxvYWQ6IGZ1bmN0aW9uKHcsIG5leHRNdXRhbnQsIG5leHQpe1xuICAgIGVuZFNlYXJjaCh3KTtcbiAgICBkZWxldGUgdy5zZWFyY2hvcHRzO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH1cbn07XG5vdXQkLnBhZ2UgPSBwYWdlID0ge1xuICAnc3RhdGljJzogZnVuY3Rpb24od2luZG93LCBuZXh0KXtcbiAgICB3aW5kb3cucmVwbGFjZUh0bWwod2luZG93LiQoJyNsZWZ0X2NvbnRhaW5lcicpLCAnJyk7XG4gICAgd2luZG93LnJlcGxhY2VIdG1sKHdpbmRvdy4kKCcjbWFpbl9jb250ZW50JyksIHRoaXMucGFnZS5jb25maWcubWFpbl9jb250ZW50KTtcbiAgICBsYXlvdXRTdGF0aWMuY2FsbCh0aGlzLCB3aW5kb3csICdwYWdlJyk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25Mb2FkOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHBhZ2VySW5pdCh3aW5kb3cpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0sXG4gIG9uTXV0YXRlOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHNjcm9sbFRvVG9wKCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfVxufTtcbm91dCQucHJpdmF0ZVNpdGUgPSBwcml2YXRlU2l0ZSA9IHtcbiAgJ3N0YXRpYyc6IGZ1bmN0aW9uKHdpbmRvdywgbmV4dCl7XG4gICAgd2luZG93LiQoJ2hlYWRlcicpLnJlbW92ZSgpO1xuICAgIHdpbmRvdy4kKCdmb290ZXInKS5yZW1vdmUoKTtcbiAgICB3aW5kb3cuJCgnI2xlZnRfY29udGVudCcpLnJlbW92ZSgpO1xuICAgIHdpbmRvdy4kKCcjbWFpbl9jb250ZW50JykucmVtb3ZlKCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSxcbiAgb25Mb2FkOiBmdW5jdGlvbih3aW5kb3csIG5leHQpe1xuICAgIHZhciByZWYkO1xuICAgIHJlZiQgPSB3aW5kb3cuZmFuY3lib3hQYXJhbXM7XG4gICAgcmVmJC5jbG9zZUJ0biA9IGZhbHNlO1xuICAgIHJlZiQuY2xvc2VDbGljayA9IGZhbHNlO1xuICAgIHJlZiQubW9kYWwgPSB0cnVlO1xuICAgIEF1dGguc2hvd0xvZ2luRGlhbG9nKCk7XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfVxufTtcbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59XG5mdW5jdGlvbiBwYXJ0aWFsaXplJChmLCBhcmdzLCB3aGVyZSl7XG4gIHZhciBjb250ZXh0ID0gdGhpcztcbiAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgdmFyIHBhcmFtcyA9IHNsaWNlJC5jYWxsKGFyZ3VtZW50cyksIGksXG4gICAgICAgIGxlbiA9IHBhcmFtcy5sZW5ndGgsIHdsZW4gPSB3aGVyZS5sZW5ndGgsXG4gICAgICAgIHRhID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXSwgdHcgPSB3aGVyZSA/IHdoZXJlLmNvbmNhdCgpIDogW107XG4gICAgZm9yKGkgPSAwOyBpIDwgbGVuOyArK2kpIHsgdGFbdHdbMF1dID0gcGFyYW1zW2ldOyB0dy5zaGlmdCgpOyB9XG4gICAgcmV0dXJuIGxlbiA8IHdsZW4gJiYgbGVuID9cbiAgICAgIHBhcnRpYWxpemUkLmFwcGx5KGNvbnRleHQsIFtmLCB0YSwgdHddKSA6IGYuYXBwbHkoY29udGV4dCwgdGEpO1xuICB9O1xufVxufSkocmVxdWlyZShcIl9fYnJvd3NlcmlmeV9wcm9jZXNzXCIpLHdpbmRvdykiLCJ2YXIgY2hlZXJpbywgdXNlSnNkb20sIGRvbVdpbmRvdywgaXNTdXJmYWJsZSwgc2xpY2UkID0gW10uc2xpY2U7XG5pZiAodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cgIT09IG51bGwpIHtcbiAgdHJ1ZTtcbn0gZWxzZSB7XG4gIGNoZWVyaW8gPSByZXF1aXJlKCdjaGVlcmlvJyk7XG4gIHVzZUpzZG9tID0gZmFsc2U7XG4gIGRvbVdpbmRvdyA9IGZ1bmN0aW9uKGh0bWwsIGNiKXtcbiAgICB2YXIgc2NyaXB0cywganNkb21fb3B0cywganNkb21fZG9uZSwgdGhpcyQgPSB0aGlzO1xuICAgIHNjcmlwdHMgPSBbJy4uLy4uL3B1YmxpYy9sb2NhbC9qcXVlcnktMS45LjEubWluLmpzJywgJy4uLy4uL25vZGVfbW9kdWxlcy9yZWFjdGl2ZWpzL3NyYy9yZWFjdGl2ZS5qcyddO1xuICAgIGpzZG9tX29wdHMgPSB7XG4gICAgICBodG1sOiBodG1sLFxuICAgICAgc2NyaXB0czogc2NyaXB0c1xuICAgIH07XG4gICAganNkb21fZG9uZSA9IGZ1bmN0aW9uKGVyciwgd2luZG93KXtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIGNiKGVycik7XG4gICAgICB9XG4gICAgICB3aW5kb3cuJCA9IHdpbmRvdy5qUXVlcnk7XG4gICAgICByZXR1cm4gY2IobnVsbCwgd2luZG93KTtcbiAgICB9O1xuICAgIHJldHVybiBqc2RvbS5lbnYoanNkb21fb3B0cywganNkb21fZG9uZSk7XG4gIH07XG59XG50aGlzLnJ1biA9IGZ1bmN0aW9uKHRlbXBsYXRlLCBvcHRzLCBjYil7XG4gIC8qXG4gIHJ1biByZXR1cm5zIHZvaWQgYmVjYXVzZSBpdCBtdXRhdGVzIHRoZSB3aW5kb3cgb2JqZWN0XG4gIFxuICBvbiB0aGUgc2VydmVyIHNpZGUgd2UgbmVlZCB0byBrbm93IHRoZSBiYXNlIGh0bWwgYmVmb3JlIHdlIGNhbiBtdXRhdGUgaXRcbiAgXG4gIG9uIHRoZSBjbGllbnQgc2lkZSB0aGUgY2FsbGJhY2sgcmV0dXJucyBub3RoaW5nIGJlY2F1c2UgdGhlIGRvbSBoYXMgYmVlbiBtdXRhdGVkIGFscmVhZHlcbiAgb24gdGhlIHNlcnZlciBzaWRlIHRoZSBjYWxsYmFjayB3aWxsIHJldHVybiBodG1sXG4gIFxuICB0ZW1wbGF0ZXMgYXJlIG9iamVjdHMgd2l0aCB1cCB0byBmb3VyIG1ldGhvZHM6XG4gIHN0YXRpYywgb25Mb2FkLCBvbkluaXRpYWwsIG9uTXV0YXRlXG4gIFxuICBzdGF0aWMgaXMgY2xpZW50IG9yIHNlcnZlcnNpZGUgYW5kIHRoaXMgcGhhc2UgaXMgcHVyZWx5IGZvciBodG1sIGRvbSB0cmVlIGNyZWF0aW9uL21hbmlwdWxhdGlvblxuICBcbiAgb25Mb2FkIGhhcHBlbnMgd2hlbiBhIG11dGFudCB0ZW1wbGF0ZSBpcyBydW4sIHJlZ2FyZGxlc3Mgb2Ygd2hldGhlciBpdCBpcyB0aGUgaW5pdGlhbCBwYWdlbG9hZCwgb3IgYSBtdXRhdGlvblxuICBcbiAgb25Jbml0aWFsIG9ubHkgaGFwcGVucyBvbiBhbiBpbml0aWFsIHBhZ2Vsb2FkIChub3Qgb24gbXV0YXRpb24pXG4gIFxuICBvbk11dGF0ZSBvbmx5IGhhcHBlbnMgb24gYSBtdXRhdGlvbiAobm90IG9uIGFuIGluaXRpYWwgcGFnZWxvYWQpXG4gICovXG4gIHZhciBpbml0aWFsX3J1biwgcGFyYW1zLCBodG1sLCB1c2VyLCByZWYkLCBwcmVwYXJlLCByYXdEcmF3LCByYWYsIGRyYXcsIG9uTG9hZCwgb25Jbml0aWFsLCBvbk11dGF0ZSwgb25QZXJzb25hbGl6ZSwgcmVuZGVyTXV0YW50LCByZW5kZXIsIHZhclN0YXRlbWVudHMsIG1hcnNoYWwsIHJ1blN0YXRpYywgJDtcbiAgY2IgPT0gbnVsbCAmJiAoY2IgPSBmdW5jdGlvbigpe30pO1xuICBpbml0aWFsX3J1biA9IG9wdHMuaW5pdGlhbDtcbiAgcGFyYW1zID0gb3B0cy5sb2NhbHMgfHwge307XG4gIGh0bWwgPSBvcHRzLmh0bWw7XG4gIHVzZXIgPSBvcHRzLnVzZXI7XG4gIGlmICgoKHJlZiQgPSB0ZW1wbGF0ZVsnc3RhdGljJ10pICE9IG51bGwgJiYgcmVmJC5wcmVwYXJlKSAmJiAoKHJlZiQgPSB0ZW1wbGF0ZVsnc3RhdGljJ10pICE9IG51bGwgJiYgcmVmJC5kcmF3KSkge1xuICAgIHByZXBhcmUgPSAoKHJlZiQgPSB0ZW1wbGF0ZVsnc3RhdGljJ10pICE9IG51bGwgPyByZWYkLnByZXBhcmUgOiB2b2lkIDgpIHx8IGZ1bmN0aW9uKHcsIGNiKXtcbiAgICAgIHJldHVybiBjYigpO1xuICAgIH07XG4gICAgcmF3RHJhdyA9ICgocmVmJCA9IHRlbXBsYXRlWydzdGF0aWMnXSkgIT0gbnVsbCA/IHJlZiQuZHJhdyA6IHZvaWQgOCkgfHwgZnVuY3Rpb24odywgY2Ipe1xuICAgICAgcmV0dXJuIGNiKCk7XG4gICAgfTtcbiAgfSBlbHNlIHtcbiAgICBwcmVwYXJlID0gZnVuY3Rpb24odywgY2Ipe1xuICAgICAgcmV0dXJuIGNiKCk7XG4gICAgfTtcbiAgICByYXdEcmF3ID0gdGVtcGxhdGVbJ3N0YXRpYyddIHx8IGZ1bmN0aW9uKHcsIGNiKXtcbiAgICAgIHJldHVybiBjYigpO1xuICAgIH07XG4gIH1cbiAgaWYgKHJhZiA9IHR5cGVvZiB3aW5kb3cgIT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93ICE9PSBudWxsID8gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSA6IHZvaWQgOCkge1xuICAgIGRyYXcgPSBmdW5jdGlvbih3LCBjYil7XG4gICAgICB2YXIgcGFyYW1zO1xuICAgICAgcGFyYW1zID0gdGhpcztcbiAgICAgIHJldHVybiByYWYoZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGJlZztcbiAgICAgICAgYmVnID0gbmV3IERhdGU7XG4gICAgICAgIHJldHVybiByYXdEcmF3LmNhbGwocGFyYW1zLCB3LCBmdW5jdGlvbigpe1xuICAgICAgICAgIHZhciBlbmQ7XG4gICAgICAgICAgZW5kID0gbmV3IERhdGU7XG4gICAgICAgICAgY2IoKTtcbiAgICAgICAgICByZXR1cm4gcGFydGlhbGl6ZSQuYXBwbHkodGhpcywgW3NldFRpbWVvdXQsIFt2b2lkIDgsIDFdLCBbMF1dKShmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIGR1ciwgaW5mbztcbiAgICAgICAgICAgIGR1ciA9IGVuZCAtIGJlZztcbiAgICAgICAgICAgIGlmICh0cnVlKSB7XG4gICAgICAgICAgICAgIGluZm8gPSBcInJlcXVlc3QtYW5pbWF0aW9uLWZyYW1lIHRvb2sgXCIgKyBkdXIgKyBcIm1zIGluIG11dGFudCBzdGF0aWMgZHJhdyBwaGFzZVwiO1xuICAgICAgICAgICAgICByZXR1cm4gY29uc29sZS53YXJuKGluZm8pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0gZWxzZSB7XG4gICAgZHJhdyA9IHJhd0RyYXc7XG4gIH1cbiAgb25Mb2FkID0gdGVtcGxhdGUub25Mb2FkIHx8IGZ1bmN0aW9uKHcsIGNiKXtcbiAgICByZXR1cm4gY2IoKTtcbiAgfTtcbiAgb25Jbml0aWFsID0gdGVtcGxhdGUub25Jbml0aWFsIHx8IGZ1bmN0aW9uKHcsIGNiKXtcbiAgICByZXR1cm4gY2IoKTtcbiAgfTtcbiAgb25NdXRhdGUgPSB0ZW1wbGF0ZS5vbk11dGF0ZSB8fCBmdW5jdGlvbih3LCBjYil7XG4gICAgcmV0dXJuIGNiKCk7XG4gIH07XG4gIG9uUGVyc29uYWxpemUgPSB0ZW1wbGF0ZS5vblBlcnNvbmFsaXplIHx8IGZ1bmN0aW9uKHcsIHUsIGNiKXtcbiAgICByZXR1cm4gY2IoKTtcbiAgfTtcbiAgcmVxdWlyZSgnLi4vLi4vYnVpbGQvY2xpZW50LWphZGUuanMnKTtcbiAgZnVuY3Rpb24gcmVwbGFjZUh0bWwoJGVsLCBodG1sKXtcbiAgICB2YXIgZWwsIG5ld0VsO1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdyAhPT0gbnVsbCkge1xuICAgICAgZWwgPSAkZWxbMF07XG4gICAgICBuZXdFbCA9IGVsLmNsb25lTm9kZShmYWxzZSk7XG4gICAgICBuZXdFbC5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgZWwucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3RWwsIGVsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJGVsLmh0bWwoaHRtbCk7XG4gICAgfVxuICB9XG4gIHJlbmRlck11dGFudCA9IGZ1bmN0aW9uKGlkLCB0bXBsKXtcbiAgICByZXR1cm4gcmVwbGFjZUh0bWwoJChcIiNcIiArIGlkKSwgamFkZS50ZW1wbGF0ZXNbdG1wbF0ocGFyYW1zKSk7XG4gIH07XG4gIHJlbmRlciA9IGZ1bmN0aW9uKHQpe1xuICAgIHJldHVybiBqYWRlLnRlbXBsYXRlc1t0XShwYXJhbXMpO1xuICB9O1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cgIT09IG51bGwpIHtcbiAgICB3aW5kb3cucmVuZGVyID0gcmVuZGVyO1xuICAgIHdpbmRvdy5yZXBsYWNlSHRtbCA9IHJlcGxhY2VIdG1sO1xuICAgIGlmIChpbml0aWFsX3J1bikge1xuICAgICAgcmV0dXJuIG9uTG9hZC5jYWxsKHBhcmFtcywgd2luZG93LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgcmV0dXJuIGNiKGVycik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG9uSW5pdGlhbC5jYWxsKHBhcmFtcywgd2luZG93LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIHJldHVybiBjYihlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIG9uUGVyc29uYWxpemUuY2FsbChwYXJhbXMsIHdpbmRvdywgdXNlciwgY2IpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gY2IoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHdpbmRvdy5yZW5kZXJNdXRhbnQgPSBmdW5jdGlvbih0YXJnZXQsIHRtcGwpe1xuICAgICAgICByZXR1cm4gamFkZS5yZW5kZXIod2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldCksIHRtcGwsIHBhcmFtcyk7XG4gICAgICB9O1xuICAgICAgd2luZG93Lm1hcnNoYWwgPSBmdW5jdGlvbihrZXksIHZhbCl7XG4gICAgICAgIHJldHVybiB3aW5kb3dba2V5XSA9IHZhbDtcbiAgICAgIH07XG4gICAgICByZXR1cm4gcHJlcGFyZS5jYWxsKHBhcmFtcywgd2luZG93LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICB2YXIgaGFzRHJhdywgcmVmJDtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBjYihlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGhhc0RyYXcgPSAhISgocmVmJCA9IHRlbXBsYXRlWydzdGF0aWMnXSkgIT0gbnVsbCAmJiByZWYkLmRyYXcpO1xuICAgICAgICByZXR1cm4gKGhhc0RyYXcgPyBkcmF3IDogcmF3RHJhdykuY2FsbChwYXJhbXMsIHdpbmRvdywgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICByZXR1cm4gY2IoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIG9uTG9hZC5jYWxsKHBhcmFtcywgd2luZG93LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgICByZXR1cm4gY2IoZXJyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvbk11dGF0ZS5jYWxsKHBhcmFtcywgd2luZG93LCBmdW5jdGlvbihlcnIpe1xuICAgICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb25QZXJzb25hbGl6ZS5jYWxsKHBhcmFtcywgd2luZG93LCB1c2VyLCBjYik7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNiKCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIGlmIChodG1sKSB7XG4gICAgdmFyU3RhdGVtZW50cyA9IFtdO1xuICAgIG1hcnNoYWwgPSBmdW5jdGlvbihrZXksIHZhbCl7XG4gICAgICBpZiAodmFsICE9PSB2b2lkIDgpIHtcbiAgICAgICAgcmV0dXJuIHZhclN0YXRlbWVudHMucHVzaChcIndpbmRvd1snXCIgKyBrZXkgKyBcIiddPVwiICsgSlNPTi5zdHJpbmdpZnkodmFsKSk7XG4gICAgICB9XG4gICAgfTtcbiAgICBydW5TdGF0aWMgPSBmdW5jdGlvbih3aW5kb3cpe1xuICAgICAgd2luZG93LnJlbmRlciA9IHJlbmRlcjtcbiAgICAgIHdpbmRvdy5yZXBsYWNlSHRtbCA9IHJlcGxhY2VIdG1sO1xuICAgICAgcmV0dXJuIHByZXBhcmUuY2FsbChwYXJhbXMsIHdpbmRvdywgZnVuY3Rpb24oZXJyKXtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBjYihlcnIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkcmF3LmNhbGwocGFyYW1zLCB3aW5kb3csIGZ1bmN0aW9uKGVycil7XG4gICAgICAgICAgdmFyIHM7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgcmV0dXJuIGNiKGVycik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh1c2VKc2RvbSkge1xuICAgICAgICAgICAgd2luZG93LiQoJ3NjcmlwdC5qc2RvbScpLnJlbW92ZSgpO1xuICAgICAgICAgICAgcyA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICAgICAgICAgIHdpbmRvdy4kKHMpLmF0dHIoJ3R5cGUnLCAndGV4dC9qYXZhc2NyaXB0Jyk7XG4gICAgICAgICAgICB3aW5kb3cuJChzKS50ZXh0KHZhclN0YXRlbWVudHMuam9pbignOycpKTtcbiAgICAgICAgICAgIHdpbmRvdy5kb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHMpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKFwiPHNjcmlwdCB0eXBlPVxcXCJ0ZXh0L2phdmFzY3JpcHRcXFwiPlwiICsgdmFyU3RhdGVtZW50cy5qb2luKCc7JykgKyBcIjwvc2NyaXB0PlwiKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNiKG51bGwsIHVzZUpzZG9tXG4gICAgICAgICAgICA/IFwiPCFkb2N0eXBlIGh0bWw+XCIgKyB3aW5kb3cuZG9jdW1lbnQub3V0ZXJIVE1MXG4gICAgICAgICAgICA6ICQuaHRtbCgpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICAgIGlmICh1c2VKc2RvbSkge1xuICAgICAgcmV0dXJuIGRvbVdpbmRvdyhodG1sLCBmdW5jdGlvbihlcnIsIGpzZG9tV2luZG93KXtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJldHVybiBjYihlcnIpO1xuICAgICAgICB9XG4gICAgICAgIGpzZG9tV2luZG93Lm1hcnNoYWwgPSBtYXJzaGFsO1xuICAgICAgICBqc2RvbVdpbmRvdy5yZW5kZXJNdXRhbnQgPSBmdW5jdGlvbih0YXJnZXQsIHRtcGwpe1xuICAgICAgICAgIHJldHVybiBqYWRlLnJlbmRlcihqc2RvbVdpbmRvdy5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXQpLCB0bXBsLCBwYXJhbXMpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcnVuU3RhdGljKGpzZG9tV2luZG93KTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAkID0gY2hlZXJpby5sb2FkKGh0bWwpO1xuICAgICAgcmV0dXJuIHJ1blN0YXRpYyh7XG4gICAgICAgIG1hcnNoYWw6IG1hcnNoYWwsXG4gICAgICAgIHJlbmRlck11dGFudDogcmVuZGVyTXV0YW50LFxuICAgICAgICAkOiAkXG4gICAgICB9KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwibmVlZCBodG1sIGZvciBzZXJ2ZXJzaWRlXCIpO1xuICB9XG59O1xuaXNTdXJmYWJsZSA9IGZ1bmN0aW9uKHIpe1xuICByZXR1cm4gci5jYWxsYmFja3Muc29tZShmdW5jdGlvbihtKXtcbiAgICByZXR1cm4gbS5zdXJmYWJsZTtcbiAgfSk7XG59O1xudGhpcy5zdXJmYWJsZVJvdXRlcyA9IGZ1bmN0aW9uKGFwcCl7XG4gIHZhciBpJCwgcmVmJCwgbGVuJCwgciwgcmVzdWx0cyQgPSBbXTtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IGFwcC5yb3V0ZXMuZ2V0KS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIHIgPSByZWYkW2kkXTtcbiAgICBpZiAoaXNTdXJmYWJsZShyKSkge1xuICAgICAgcmVzdWx0cyQucHVzaChyLnJlZ2V4cC50b1N0cmluZygpKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHJlc3VsdHMkO1xufTtcbmZ1bmN0aW9uIHBhcnRpYWxpemUkKGYsIGFyZ3MsIHdoZXJlKXtcbiAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICB2YXIgcGFyYW1zID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzKSwgaSxcbiAgICAgICAgbGVuID0gcGFyYW1zLmxlbmd0aCwgd2xlbiA9IHdoZXJlLmxlbmd0aCxcbiAgICAgICAgdGEgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdLCB0dyA9IHdoZXJlID8gd2hlcmUuY29uY2F0KCkgOiBbXTtcbiAgICBmb3IoaSA9IDA7IGkgPCBsZW47ICsraSkgeyB0YVt0d1swXV0gPSBwYXJhbXNbaV07IHR3LnNoaWZ0KCk7IH1cbiAgICByZXR1cm4gbGVuIDwgd2xlbiAmJiBsZW4gP1xuICAgICAgcGFydGlhbGl6ZSQuYXBwbHkoY29udGV4dCwgW2YsIHRhLCB0d10pIDogZi5hcHBseShjb250ZXh0LCB0YSk7XG4gIH07XG59IiwidmFyIENvbXBvbmVudCwgY2gsIHRlbXBsYXRlcywgQXV0aDtcbkNvbXBvbmVudCA9IHJlcXVpcmUoJ3lhY29tcG9uZW50Jyk7XG5jaCA9IHJlcXVpcmUoJy4uL2FwcC9jbGllbnQtaGVscGVycy5scycpO1xudGVtcGxhdGVzID0gcmVxdWlyZSgnLi4vYnVpbGQvY29tcG9uZW50LWphZGUuanMnKS50ZW1wbGF0ZXM7XG5tb2R1bGUuZXhwb3J0cyA9IEF1dGggPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKEF1dGgsIHN1cGVyY2xhc3MpLmRpc3BsYXlOYW1lID0gJ0F1dGgnLCBBdXRoKSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEF1dGg7XG4gIHByb3RvdHlwZS5jb21wb25lbnROYW1lID0gJ0F1dGgnO1xuICBwcm90b3R5cGUudGVtcGxhdGUgPSB0ZW1wbGF0ZXMuQXV0aDtcbiAgQXV0aC5zaG93TG9naW5EaWFsb2cgPSBmdW5jdGlvbihjYil7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICBjYiA9PSBudWxsICYmIChjYiA9IGZ1bmN0aW9uKCl7fSk7XG4gICAgcmV0dXJuIGNoLmxhenlMb2FkRmFuY3lib3goZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBjaC5sYXp5TG9hZChmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gd2luZG93LiQuZm4uY29tcGxleGlmeTtcbiAgICAgIH0sIHdpbmRvdy5jYWNoZVVybCArIFwiL2xvY2FsL2pxdWVyeS5jb21wbGV4aWZ5Lm1pbi5qc1wiLCBudWxsLCBmdW5jdGlvbigpe1xuICAgICAgICBpZiAoIXdpbmRvdy5fYXV0aCkge1xuICAgICAgICAgIHdpbmRvdy5fYXV0aCA9IG5ldyBBdXRoKHtcbiAgICAgICAgICAgIGxvY2Fsczoge1xuICAgICAgICAgICAgICBzaXRlTmFtZTogd2luZG93LnNpdGVOYW1lLFxuICAgICAgICAgICAgICBpbnZpdGVPbmx5OiB3aW5kb3cuaW52aXRlT25seVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sICQoJyNhdXRoJykpO1xuICAgICAgICAgIGlmIChBdXRoLmFmdGVyTG9naW4pIHtcbiAgICAgICAgICAgIHdpbmRvdy5fYXV0aC5hZnRlckxvZ2luID0gQXV0aC5hZnRlckxvZ2luO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoISQoJy5mYW5jeWJveC1vdmVybGF5OnZpc2libGUnKS5sZW5ndGgpIHtcbiAgICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oJyNhdXRoJywgd2luZG93LmZhbmN5Ym94UGFyYW1zKTtcbiAgICAgICAgfVxuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgcmV0dXJuICQoJyNhdXRoIGlucHV0W25hbWU9dXNlcm5hbWVdJykuZm9jdXMoKTtcbiAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgd2luZG93LkNPTVBMRVhJRllfQkFOTElTVCA9IFsnZ29kJywgJ21vbmV5JywgJ3Bhc3N3b3JkJywgJ2xvdmUnXTtcbiAgICAgICAgJCgnI2F1dGggW25hbWU9XCJwYXNzd29yZFwiXScpLmNvbXBsZXhpZnkoe30sIGZ1bmN0aW9uKHBhc3MsIHBlcmNlbnQpe1xuICAgICAgICAgIHZhciBlO1xuICAgICAgICAgIGUgPSAkKHRoaXMpLnBhcmVudCgpO1xuICAgICAgICAgIGUuZmluZCgnLnN0cmVuZ3RoLW1ldGVyJykudG9nZ2xlQ2xhc3MoJ3N0cm9uZycsIHBhc3MpO1xuICAgICAgICAgIHJldHVybiBlLmZpbmQoJy5zdHJlbmd0aCcpLmNzcyh7XG4gICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KHBlcmNlbnQpICsgJyUnXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gY2Iod2luZG93Ll9hdXRoLiQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIEF1dGguc2hvd0luZm9EaWFsb2cgPSBmdW5jdGlvbihtc2csIG1zZzIsIHJlbW92ZSwgY2Ipe1xuICAgIG1zZzIgPT0gbnVsbCAmJiAobXNnMiA9ICcnKTtcbiAgICByZW1vdmUgPT0gbnVsbCAmJiAocmVtb3ZlID0gJycpO1xuICAgIGNiID09IG51bGwgJiYgKGNiID0gZnVuY3Rpb24oKXt9KTtcbiAgICByZXR1cm4gQXV0aC5zaG93TG9naW5EaWFsb2coZnVuY3Rpb24oKXtcbiAgICAgIHZhciBmYjtcbiAgICAgIGZiID0gJCgnLmZhbmN5Ym94LXdyYXA6Zmlyc3QnKTtcbiAgICAgIGZiLmZpbmQoJyNtc2cnKS5odG1sKG1zZyk7XG4gICAgICBmYi5maW5kKCcuZGlhbG9nIC5tc2cyJykuaHRtbChtc2cyKTtcbiAgICAgIGNoLnN3aXRjaEFuZEZvY3VzKHJlbW92ZSwgJ29uLWRpYWxvZycsICcnKTtcbiAgICAgIHJldHVybiBjYih3aW5kb3cuX2F1dGguJCk7XG4gICAgfSk7XG4gIH07XG4gIEF1dGguc2hvd1JlZ2lzdGVyRGlhbG9nID0gZnVuY3Rpb24ocmVtb3ZlLCBjYil7XG4gICAgcmVtb3ZlID09IG51bGwgJiYgKHJlbW92ZSA9ICcnKTtcbiAgICBjYiA9PSBudWxsICYmIChjYiA9IGZ1bmN0aW9uKCl7fSk7XG4gICAgcmV0dXJuIEF1dGguc2hvd0xvZ2luRGlhbG9nKGZ1bmN0aW9uKCl7XG4gICAgICBjaC5zd2l0Y2hBbmRGb2N1cyhyZW1vdmUsICdvbi1yZWdpc3RlcicsICcucmVnaXN0ZXIgaW5wdXQ6Zmlyc3QnKTtcbiAgICAgIHJldHVybiBjYih3aW5kb3cuX2F1dGguJCk7XG4gICAgfSk7XG4gIH07XG4gIEF1dGguc2hvd1Jlc2V0UGFzc3dvcmREaWFsb2cgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBBdXRoLnNob3dMb2dpbkRpYWxvZyhmdW5jdGlvbigkYXV0aCl7XG4gICAgICB2YXIgJGZvcm0sIGhhc2g7XG4gICAgICAkZm9ybSA9ICRhdXRoLmZpbmQoJy5yZXNldCBmb3JtJyk7XG4gICAgICBjaC5zd2l0Y2hBbmRGb2N1cygnJywgJ29uLXJlc2V0JywgJyNhdXRoIC5yZXNldCBpbnB1dDpmaXJzdCcpO1xuICAgICAgaGFzaCA9IGxvY2F0aW9uLmhhc2guc3BsaXQoJz0nKVsxXTtcbiAgICAgICRmb3JtLmZpbmQoJ2lucHV0W3R5cGU9aGlkZGVuXScpLnZhbChoYXNoKTtcbiAgICAgIGNvbnNvbGUubG9nKGhhc2gsICRmb3JtLCAkYXV0aCk7XG4gICAgICByZXR1cm4gJC5wb3N0KCcvYXV0aC9mb3Jnb3QtdXNlcicsIHtcbiAgICAgICAgZm9yZ290OiBoYXNoXG4gICAgICB9LCBmdW5jdGlvbihyKXtcbiAgICAgICAgaWYgKHIuc3VjY2Vzcykge1xuICAgICAgICAgICRmb3JtLmZpbmQoJ2gyOmZpcnN0JykuaHRtbCgnQ2hvb3NlIGEgTmV3IFBhc3N3b3JkJyk7XG4gICAgICAgICAgcmV0dXJuICRmb3JtLmZpbmQoJ2lucHV0JykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuICRmb3JtLmZpbmQoJ2gyOmZpcnN0JykuaHRtbChcIkNvdWxkbid0IGZpbmQgeW91LiA6KFwiKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIEF1dGgubG9naW5XaXRoVG9rZW4gPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBjb3JzLmdldChhdXRoRG9tYWluICsgXCIvYXV0aC9vbmNlXCIsIHtcbiAgICAgIHNpdGVfaWQ6IHdpbmRvdy5zaXRlSWRcbiAgICB9LCBmdW5jdGlvbihyKXtcbiAgICAgIGlmIChyKSB7XG4gICAgICAgIHJldHVybiAkLnBvc3QoJy9hdXRoL29uY2UnLCB7XG4gICAgICAgICAgdG9rZW46IHIudG9rZW5cbiAgICAgICAgfSwgZnVuY3Rpb24ocnIpe1xuICAgICAgICAgIGlmIChyci5zdWNjZXNzKSB7XG4gICAgICAgICAgICBBdXRoLmFmdGVyTG9naW4oKTtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cubG9jYXRpb24uaGFzaCA9ICcnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIEF1dGgucmVxdWlyZUxvZ2luID0gZnVuY3Rpb24oZm4pe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgaWYgKHdpbmRvdy51c2VyKSB7XG4gICAgICAgIHJldHVybiBmbi5hcHBseSh3aW5kb3csIGFyZ3VtZW50cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBBdXRoLnNob3dMb2dpbkRpYWxvZygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgQXV0aC5yZXF1aXJlUmVnaXN0cmF0aW9uID0gZnVuY3Rpb24oZm4pe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgaWYgKHdpbmRvdy51c2VyKSB7XG4gICAgICAgIHJldHVybiBmbi5hcHBseSh3aW5kb3csIGFyZ3VtZW50cyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBBdXRoLnNob3dSZWdpc3RlckRpYWxvZygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfTtcbiAgfTtcbiAgZnVuY3Rpb24gQXV0aCgpe1xuICAgIHRoaXMuY2hvb3NlID0gYmluZCQodGhpcywgJ2Nob29zZScsIHByb3RvdHlwZSk7XG4gICAgdGhpcy50b2dnbGVQYXNzd29yZCA9IGJpbmQkKHRoaXMsICd0b2dnbGVQYXNzd29yZCcsIHByb3RvdHlwZSk7XG4gICAgdGhpcy5yZXNlbmQgPSBiaW5kJCh0aGlzLCAncmVzZW5kJywgcHJvdG90eXBlKTtcbiAgICB0aGlzLnJlc2V0UGFzc3dvcmQgPSBiaW5kJCh0aGlzLCAncmVzZXRQYXNzd29yZCcsIHByb3RvdHlwZSk7XG4gICAgdGhpcy5mb3Jnb3RQYXNzd29yZCA9IGJpbmQkKHRoaXMsICdmb3Jnb3RQYXNzd29yZCcsIHByb3RvdHlwZSk7XG4gICAgdGhpcy5yZWdpc3RlciA9IGJpbmQkKHRoaXMsICdyZWdpc3RlcicsIHByb3RvdHlwZSk7XG4gICAgdGhpcy5hZnRlckxvZ2luID0gYmluZCQodGhpcywgJ2FmdGVyTG9naW4nLCBwcm90b3R5cGUpO1xuICAgIHRoaXMubG9naW4gPSBiaW5kJCh0aGlzLCAnbG9naW4nLCBwcm90b3R5cGUpO1xuICAgIHRoaXMub25EZXRhY2ggPSBiaW5kJCh0aGlzLCAnb25EZXRhY2gnLCBwcm90b3R5cGUpO1xuICAgIHRoaXMub25BdHRhY2ggPSBiaW5kJCh0aGlzLCAnb25BdHRhY2gnLCBwcm90b3R5cGUpO1xuICAgIEF1dGguc3VwZXJjbGFzcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG4gIHByb3RvdHlwZS5vbkF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy4kLmZpbmQoJy5zb2NpYWwgYScpLmNsaWNrKHRoaXMub3Blbk9hdXRoV2luZG93KTtcbiAgICB0aGlzLiQub24oJ3N1Ym1pdCcsICcubG9naW4gZm9ybScsIHRoaXMubG9naW4pO1xuICAgIHRoaXMuJC5vbignc3VibWl0JywgJy5yZWdpc3RlciBmb3JtJywgdGhpcy5yZWdpc3Rlcik7XG4gICAgdGhpcy4kLm9uKCdzdWJtaXQnLCAnLmZvcmdvdCBmb3JtJywgdGhpcy5mb3Jnb3RQYXNzd29yZCk7XG4gICAgdGhpcy4kLm9uKCdzdWJtaXQnLCAnLnJlc2V0IGZvcm0nLCB0aGlzLnJlc2V0UGFzc3dvcmQpO1xuICAgIHRoaXMuJC5vbignY2xpY2snLCAnLnRvZ2dsZS1wYXNzd29yZCcsIHRoaXMudG9nZ2xlUGFzc3dvcmQpO1xuICAgIHRoaXMuJC5vbignc3VibWl0JywgJy5jaG9vc2UgZm9ybScsIHRoaXMuY2hvb3NlKTtcbiAgICB0aGlzLiQub24oJ2NsaWNrJywgJy5kaWFsb2cgYS5yZXNlbmQnLCB0aGlzLnJlc2VuZCk7XG4gICAgdGhpcy4kLm9uKCdjbGljaycsICcub25jbGljay1jbG9zZS1mYW5jeWJveCcsIGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gJC5mYW5jeWJveC5jbG9zZSgpO1xuICAgIH0pO1xuICAgIHRoaXMuJC5vbignY2xpY2snLCAnLm9uY2xpY2stc2hvdy1sb2dpbicsIGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gY2guc3dpdGNoQW5kRm9jdXMoJ29uLWZvcmdvdCBvbi1yZWdpc3RlciBvbi1yZXNldCcsICdvbi1sb2dpbicsICcjYXV0aCBpbnB1dFtuYW1lPXVzZXJuYW1lXScpO1xuICAgIH0pO1xuICAgIHRoaXMuJC5vbignY2xpY2snLCAnLm9uY2xpY2stc2hvdy1mb3Jnb3QnLCBmdW5jdGlvbigpe1xuICAgICAgcmV0dXJuIGNoLnN3aXRjaEFuZEZvY3VzKCdvbi1lcnJvcicsICdvbi1mb3Jnb3QnLCAnI2F1dGggaW5wdXRbbmFtZT1lbWFpbF0nKTtcbiAgICB9KTtcbiAgICB0aGlzLiQub24oJ2NsaWNrJywgJy5vbmNsaWNrLXNob3ctY2hvb3NlJywgZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBjaC5zd2l0Y2hBbmRGb2N1cygnb24tbG9naW4nLCAnb24tY2hvb3NlJywgJyNhdXRoIGlucHV0W25hbWU9dXNlcm5hbWVdJyk7XG4gICAgfSk7XG4gICAgdGhpcy4kLm9uKCdjbGljaycsICcub25jbGljay1zaG93LXJlZ2lzdGVyJywgZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiBjaC5zd2l0Y2hBbmRGb2N1cygnb24tbG9naW4nLCAnb24tcmVnaXN0ZXInLCAnI2F1dGggaW5wdXRbbmFtZT11c2VybmFtZV0nKTtcbiAgICB9KTtcbiAgICB0aGlzLiQub24oJ2tleXVwJywgJy5mYW5jeWJveC1pbm5lciBpbnB1dCcsIGZ1bmN0aW9uKGl0KXtcbiAgICAgIGlmIChpdC53aGljaCA9PT0gMjcpIHtcbiAgICAgICAgJC5mYW5jeWJveC5jbG9zZSgpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIHByb3RvdHlwZS5vbkRldGFjaCA9IGZ1bmN0aW9uKCl7fTtcbiAgcHJvdG90eXBlLm9wZW5PYXV0aFdpbmRvdyA9IGZ1bmN0aW9uKGV2KXtcbiAgICB2YXIgdXJsO1xuICAgIHVybCA9ICQodGhpcykuYXR0cignaHJlZicpO1xuICAgIHdpbmRvdy5vcGVuKHVybCwgJ3BvcHVwJywgXCJ3aWR0aD05ODAsaGVpZ2h0PTY1MCxzY3JvbGxiYXJzPW5vLHRvb2xiYXI9bm8sbG9jYXRpb249bm8sZGlyZWN0b3JpZXM9bm8sc3RhdHVzPW5vLG1lbnViYXI9bm9cIik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICBwcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbihldil7XG4gICAgdmFyICRmb3JtLCB1LCBwLCBzLCBwYXJhbXMsIHRoaXMkID0gdGhpcztcbiAgICAkZm9ybSA9ICQoZXYudGFyZ2V0KTtcbiAgICB1ID0gJGZvcm0uZmluZCgnaW5wdXRbbmFtZT11c2VybmFtZV0nKTtcbiAgICBwID0gJGZvcm0uZmluZCgnaW5wdXRbbmFtZT1wYXNzd29yZF0nKTtcbiAgICBzID0gJGZvcm0uZmluZCgnaW5wdXRbdHlwZT1zdWJtaXRdJyk7XG4gICAgcGFyYW1zID0ge1xuICAgICAgdXNlcm5hbWU6IHUudmFsKCksXG4gICAgICBwYXNzd29yZDogcC52YWwoKVxuICAgIH07XG4gICAgcy5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICQucG9zdCgkZm9ybS5hdHRyKCdhY3Rpb24nKSwgcGFyYW1zLCBmdW5jdGlvbihyKXtcbiAgICAgIHZhciByZXNlbmQsICRmYW5jeWJveDtcbiAgICAgIGlmIChyLnN1Y2Nlc3MpIHtcbiAgICAgICAgJC5mYW5jeWJveC5jbG9zZSgpO1xuICAgICAgICBpZiAodGhpcyQuYWZ0ZXJMb2dpbikge1xuICAgICAgICAgIHRoaXMkLmFmdGVyTG9naW4oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5pdGlhbE11dGFudCA9PT0gJ3ByaXZhdGVTaXRlJykge1xuICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHIudHlwZSA9PT0gJ3VudmVyaWZpZWQtdXNlcicpIHtcbiAgICAgICAgICByZXNlbmQgPSBcIlRvIHJlc2VuZCB5b3VyIHZlcmlmaWNhdGlvbiBlbWFpbCwgPGEgY2xhc3M9XFxcInJlc2VuZFxcXCIgZGF0YS1lbWFpbD1cXFwiXCIgKyByLmVtYWlsICsgXCJcXFwiPmNsaWNrIGhlcmU8L2E+LlwiO1xuICAgICAgICAgIGNvbnN0cnVjdG9yLnNob3dJbmZvRGlhbG9nKCdQbGVhc2UgdmVyaWZ5IHlvdXIgYWNjb3VudCBmaXJzdC4nLCByZXNlbmQsICdvbi1sb2dpbicpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRmYW5jeWJveCA9ICRmb3JtLnBhcmVudHMoJy5mYW5jeWJveC13cmFwOmZpcnN0Jyk7XG4gICAgICAgICAgJGZhbmN5Ym94LmFkZENsYXNzKCdvbi1lcnJvcicpO1xuICAgICAgICAgICRmYW5jeWJveC5yZW1vdmVDbGFzcygnc2hha2UnKTtcbiAgICAgICAgICBjaC5zaG93VG9vbHRpcCgkZm9ybS5maW5kKCcudG9vbHRpcCcpLCAnVHJ5IGFnYWluIScpO1xuICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICRmYW5jeWJveC5hZGRDbGFzcygnc2hha2UnKTtcbiAgICAgICAgICAgIHJldHVybiB1LmZvY3VzKCk7XG4gICAgICAgICAgfSwgMTApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcy5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgcHJvdG90eXBlLmFmdGVyTG9naW4gPSBmdW5jdGlvbigpe307XG4gIHByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uKGV2KXtcbiAgICB2YXIgJGZvcm0sIHMsIHRoaXMkID0gdGhpcztcbiAgICAkZm9ybSA9ICQoZXYudGFyZ2V0KTtcbiAgICAkZm9ybS5maW5kKCdpbnB1dCcpLnJlbW92ZUNsYXNzKCd2YWxpZGF0aW9uLWVycm9yJyk7XG4gICAgcyA9ICRmb3JtLmZpbmQoJ2lucHV0W3R5cGU9c3VibWl0XScpO1xuICAgIHMuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAkLnBvc3QoJGZvcm0uYXR0cignYWN0aW9uJyksICRmb3JtLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbihyKXtcbiAgICAgIHZhciBtc2dzLCByZWYkO1xuICAgICAgaWYgKHIuc3VjY2Vzcykge1xuICAgICAgICAkZm9ybS5maW5kKFwiaW5wdXQ6dGV4dCxpbnB1dDpwYXNzd29yZFwiKS5yZW1vdmVDbGFzcygndmFsaWRhdGlvbi1lcnJvcicpLnZhbCgnJyk7XG4gICAgICAgIGNoLnN3aXRjaEFuZEZvY3VzKCdvbi1yZWdpc3RlcicsICdvbi1kaWFsb2cnLCAnJyk7XG4gICAgICAgIEF1dGguYWZ0ZXJMb2dpbigpO1xuICAgICAgICBBdXRoLnNob3dJbmZvRGlhbG9nKFwiV2VsY29tZSB0byBcIiArIHNpdGVOYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1zZ3MgPSBbXTtcbiAgICAgICAgaWYgKChyZWYkID0gci5lcnJvcnMpICE9IG51bGwpIHtcbiAgICAgICAgICByZWYkLmZvckVhY2goZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICB2YXIgJGU7XG4gICAgICAgICAgICAkZSA9ICRmb3JtLmZpbmQoXCJpbnB1dFtuYW1lPVwiICsgZS5wYXJhbSArIFwiXVwiKTtcbiAgICAgICAgICAgICRlLmFkZENsYXNzKCd2YWxpZGF0aW9uLWVycm9yJykuZm9jdXMoKTtcbiAgICAgICAgICAgIHJldHVybiBtc2dzLnB1c2goZS5tc2cpO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGNoLnNob3dUb29sdGlwKCRmb3JtLmZpbmQoJy50b29sdGlwJyksIHVuaXF1ZShtc2dzKS5qb2luKCc8YnI+JykpO1xuICAgICAgICBzaGFrZURpYWxvZygkZm9ybSwgMTAwKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBzLnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuICBwcm90b3R5cGUuZm9yZ290UGFzc3dvcmQgPSBmdW5jdGlvbihldil7XG4gICAgdmFyICRmb3JtLCBzLCB0aGlzJCA9IHRoaXM7XG4gICAgJGZvcm0gPSAkKGV2LnRhcmdldCk7XG4gICAgcyA9ICRmb3JtLmZpbmQoJ2lucHV0W3R5cGU9c3VibWl0XScpO1xuICAgIHMuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAkLnBvc3QoJGZvcm0uYXR0cignYWN0aW9uJyksICRmb3JtLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbihyKXtcbiAgICAgIHZhciBtc2csIHJlZiQsIHJlZjEkO1xuICAgICAgaWYgKHIuc3VjY2Vzcykge1xuICAgICAgICBBdXRoLnNob3dJbmZvRGlhbG9nKCdDaGVjayB5b3VyIGluYm94IGZvciByZXNldCBsaW5rIScsICcnLCAnb24tZm9yZ290Jyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZm9ybS5maW5kKCdpbnB1dDpmaXJzdCcpLmZvY3VzKCk7XG4gICAgICAgIG1zZyA9ICgocmVmJCA9IHIuZXJyb3JzKSAhPSBudWxsID8gKHJlZjEkID0gcmVmJFswXSkgIT0gbnVsbCA/IHJlZjEkLm5hbWUgOiB2b2lkIDggOiB2b2lkIDgpIHx8ICgocmVmJCA9IHIuZXJyb3JzKSAhPSBudWxsID8gKHJlZjEkID0gcmVmJFswXSkgIT0gbnVsbCA/IHJlZjEkLm1zZyA6IHZvaWQgOCA6IHZvaWQgOCkgfHwgJ1VuYWJsZSB0byBmaW5kIHlvdSc7XG4gICAgICAgIGNoLnNob3dUb29sdGlwKCRmb3JtLmZpbmQoJy50b29sdGlwJyksIG1zZyk7XG4gICAgICAgIHNoYWtlRGlhbG9nKCRmb3JtLCAxMDApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHMucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS5yZXNldFBhc3N3b3JkID0gZnVuY3Rpb24oZXYpe1xuICAgIHZhciAkZm9ybSwgcGFzc3dvcmQsIHMsIHRoaXMkID0gdGhpcztcbiAgICAkZm9ybSA9ICQoZXYudGFyZ2V0KTtcbiAgICBwYXNzd29yZCA9ICRmb3JtLmZpbmQoJ2lucHV0W25hbWU9cGFzc3dvcmRdJykudmFsKCk7XG4gICAgaWYgKHBhc3N3b3JkLm1hdGNoKC9eXFxzKiQvKSkge1xuICAgICAgY2guc2hvd1Rvb2x0aXAoJGZvcm0uZmluZCgnLnRvb2x0aXAnKSwgXCJQYXNzd29yZCBtYXkgbm90IGJlIGJsYW5rXCIpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBzID0gJGZvcm0uZmluZCgnaW5wdXRbdHlwZT1zdWJtaXRdJyk7XG4gICAgcy5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICQucG9zdCgkZm9ybS5hdHRyKCdhY3Rpb24nKSwgJGZvcm0uc2VyaWFsaXplKCksIGZ1bmN0aW9uKHIpe1xuICAgICAgaWYgKHIuc3VjY2Vzcykge1xuICAgICAgICAkZm9ybS5maW5kKCdpbnB1dCcpLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIGNoLnNob3dUb29sdGlwKCRmb3JtLmZpbmQoJy50b29sdGlwJyksIFwiUGFzc3dvcmQgY2hhbmdlZCFcIik7XG4gICAgICAgIGxvY2F0aW9uLmhhc2ggPSAnJztcbiAgICAgICAgJGZvcm0uZmluZCgnaW5wdXRbbmFtZT1wYXNzd29yZF0nKS52YWwoJycpO1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgY2guc3dpdGNoQW5kRm9jdXMoJ29uLXJlc2V0JywgJ29uLWxvZ2luJywgJyNhdXRoIC5sb2dpbiBpbnB1dDpmaXJzdCcpO1xuICAgICAgICAgIHJldHVybiBjaC5zaG93VG9vbHRpcCgkKCcjYXV0aCAubG9naW4gZm9ybSAudG9vbHRpcCcpLCBcIk5vdyBsb2cgaW4hXCIpO1xuICAgICAgICB9LCAxNTAwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNoLnNob3dUb29sdGlwKCRmb3JtLmZpbmQoJy50b29sdGlwJyksIFwiQ2hvb3NlIGEgYmV0dGVyIHBhc3N3b3JkXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHMucmVtb3ZlQXR0cignZGlzYWJsZWQnKTtcbiAgICB9KTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS5yZXNlbmQgPSBmdW5jdGlvbihldil7XG4gICAgdmFyIGVtYWlsO1xuICAgIGVtYWlsID0gJCgnLmRpYWxvZyBhLnJlc2VuZCcpLmRhdGEoJ2VtYWlsJyk7XG4gICAgcmV0dXJuICQucG9zdCgnL2F1dGgvcmVzZW5kJywge1xuICAgICAgZW1haWw6IGVtYWlsXG4gICAgfSwgZnVuY3Rpb24ocil7XG4gICAgICBpZiAoci5zdWNjZXNzKSB7XG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5zaG93SW5mb0RpYWxvZygnVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQgYWdhaW4uJywgJ1BsZWFzZSBjaGVjayB5b3VyIGVtYWlsLiAgSXQgbWlnaHQgYmUgaW4geW91ciBzcGFtLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnNob3dJbmZvRGlhbG9nKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHNlbmRpbmcgdGhlIGVtYWlsJywgJ1BsZWFzZSB0cnkgYWdhaW4uJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIHByb3RvdHlwZS50b2dnbGVQYXNzd29yZCA9IGZ1bmN0aW9uKGV2KXtcbiAgICB2YXIgZSwgcDtcbiAgICBlID0gJChldi50YXJnZXQpO1xuICAgIHAgPSBlLnByZXYoJ1tuYW1lPXBhc3N3b3JkXScpO1xuICAgIGlmIChwLmF0dHIoJ3R5cGUnKSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgICAgZS5odG1sKCdIaWRlJyk7XG4gICAgICBwLmF0dHIoJ3R5cGUnLCAndGV4dCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlLmh0bWwoJ1Nob3cnKTtcbiAgICAgIHAuYXR0cigndHlwZScsICdwYXNzd29yZCcpO1xuICAgIH1cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gcC5mb2N1cygpO1xuICAgIH0sIDEwKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG4gIHByb3RvdHlwZS5jaG9vc2UgPSBmdW5jdGlvbihldil7XG4gICAgdmFyICRmb3JtLCBzLCB0aGlzJCA9IHRoaXM7XG4gICAgJGZvcm0gPSAkKGV2LnRhcmdldCk7XG4gICAgcyA9ICRmb3JtLmZpbmQoJ2lucHV0W3R5cGU9c3VibWl0XScpO1xuICAgIHMuYXR0cignZGlzYWJsZWQnLCAnZGlzYWJsZWQnKTtcbiAgICAkLnBvc3QoJGZvcm0uYXR0cignYWN0aW9uJyksICRmb3JtLnNlcmlhbGl6ZSgpLCBmdW5jdGlvbihyKXtcbiAgICAgIGlmIChyLnN1Y2Nlc3MpIHtcbiAgICAgICAgJC5mYW5jeWJveC5jbG9zZSgpO1xuICAgICAgICB0aGlzJC5hZnRlckxvZ2luKCk7XG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gJyc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkZm9ybS5maW5kKCdpbnB1dDpmaXJzdCcpLmZvY3VzKCk7XG4gICAgICAgIGNoLnNob3dUb29sdGlwKCRmb3JtLmZpbmQoJy50b29sdGlwJyksIHIubXNnKTtcbiAgICAgICAgc2hha2VEaWFsb2coJGZvcm0sIDEwMCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcy5yZW1vdmVBdHRyKCdkaXNhYmxlZCcpO1xuICAgIH0pO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcbiAgcmV0dXJuIEF1dGg7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gIHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gKHRhcmdldCB8fCBvYmopW2tleV0uYXBwbHkob2JqLCBhcmd1bWVudHMpIH07XG59XG5mdW5jdGlvbiBleHRlbmQkKHN1Yiwgc3VwKXtcbiAgZnVuY3Rpb24gZnVuKCl7fSBmdW4ucHJvdG90eXBlID0gKHN1Yi5zdXBlcmNsYXNzID0gc3VwKS5wcm90b3R5cGU7XG4gIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gIGlmICh0eXBlb2Ygc3VwLmV4dGVuZGVkID09ICdmdW5jdGlvbicpIHN1cC5leHRlbmRlZChzdWIpO1xuICByZXR1cm4gc3ViO1xufVxuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCJ2YXIgX18sIHNlY29uZHNUb0h1bWFuUmVhZGFibGUsIGRhdGVGaWVsZHM7XG5fXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xudGhpcy5hZGRDb21tYXMgPSBmdW5jdGlvbihzKXtcbiAgcmV0dXJuIFN0ci5yZXZlcnNlKFxuICBqb2luKCcsJykoXG4gIGZpbHRlcihmdW5jdGlvbihpdCl7XG4gICAgcmV0dXJuIGl0Lmxlbmd0aDtcbiAgfSkoXG4gIHNwbGl0KC8oXFxkezN9KS8pKFxuICBTdHIucmV2ZXJzZShcbiAgcy50b1N0cmluZygpKSkpKSk7XG59O1xudGhpcy50aXRsZUNhc2UgPSBmdW5jdGlvbihzKXtcbiAgcmV0dXJuIHMgIT0gbnVsbCA/IHMucmVwbGFjZSgvW1xcd11cXFMqL2csIGZ1bmN0aW9uKHdvcmQpe1xuICAgIGlmICh3b3JkID09PSB3b3JkLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgIGlmICh3b3JkLmluZGV4T2YoJy4nKSA+IC0xIHx8IHdvcmQuaW5kZXhPZignLScpID4gLTEgfHwgd29yZC5sZW5ndGggPCA2KSB7XG4gICAgICAgIHJldHVybiB3b3JkO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAod29yZC5sZW5ndGggPiAzKSB7XG4gICAgICByZXR1cm4gd29yZFswXS50b1VwcGVyQ2FzZSgpICsgd29yZC5zdWJzdHIoMSkudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIHdvcmQ7XG4gIH0pIDogdm9pZCA4O1xufTtcbnRoaXMuZWxsaXBzZSA9IGZ1bmN0aW9uKHMsIGxlbiwgc3VmZml4KXtcbiAgc3VmZml4ID09IG51bGwgJiYgKHN1ZmZpeCA9ICcuLi4nKTtcbiAgaWYgKChzICE9IG51bGwgPyBzLmxlbmd0aCA6IHZvaWQgOCkgPiBsZW4pIHtcbiAgICBzID0gcy5zdWJzdHIoMCwgbGVuKTtcbiAgICBpZiAocy5sYXN0SW5kZXhPZignICcpID4gMCkge1xuICAgICAgcyA9IHMuc3Vic3RyKDAsIHMubGFzdEluZGV4T2YoJyAnKSkgKyBzdWZmaXg7XG4gICAgfVxuICB9XG4gIHJldHVybiBzO1xufTtcbnRoaXMuZGF5TmFtZSA9IGZ1bmN0aW9uKGkpe1xuICBzd2l0Y2ggKGkpIHtcbiAgY2FzZSAwOlxuICAgIHJldHVybiAnc3VuJztcbiAgY2FzZSAxOlxuICAgIHJldHVybiAnbW9uJztcbiAgY2FzZSAyOlxuICAgIHJldHVybiAndHVlJztcbiAgY2FzZSAzOlxuICAgIHJldHVybiAnd2VkJztcbiAgY2FzZSA0OlxuICAgIHJldHVybiAndGh1JztcbiAgY2FzZSA1OlxuICAgIHJldHVybiAnZnJpJztcbiAgY2FzZSA2OlxuICAgIHJldHVybiAnc2F0JztcbiAgfVxufTtcbnRoaXMucHJldHR5RGF5TmFtZSA9IGZ1bmN0aW9uKGkpe1xuICBzd2l0Y2ggKGkpIHtcbiAgY2FzZSAwOlxuICAgIHJldHVybiAnU3VuZGF5JztcbiAgY2FzZSAxOlxuICAgIHJldHVybiAnTW9uZGF5JztcbiAgY2FzZSAyOlxuICAgIHJldHVybiAnVHVlc2RheSc7XG4gIGNhc2UgMzpcbiAgICByZXR1cm4gJ1dlZG5lc2RheSc7XG4gIGNhc2UgNDpcbiAgICByZXR1cm4gJ1RodXJzZGF5JztcbiAgY2FzZSA1OlxuICAgIHJldHVybiAnRnJpZGF5JztcbiAgY2FzZSA2OlxuICAgIHJldHVybiAnU2F0dXJkYXknO1xuICB9XG59O1xuc2Vjb25kc1RvSHVtYW5SZWFkYWJsZSA9IGZ1bmN0aW9uKHNlY3Mpe1xuICB2YXIgaG91cnMsIG1pbnV0ZXMsIHNlY29uZHMsIHRpbWVzdHJpbmc7XG4gIGhvdXJzID0gTWF0aC5mbG9vcihzZWNzIC8gKDYwICogNjApKTtcbiAgc2VjcyAtPSBob3VycyAqICg2MCAqIDYwKTtcbiAgbWludXRlcyA9IE1hdGguZmxvb3Ioc2VjcyAvIDYwKTtcbiAgc2VjcyAtPSBtaW51dGVzICogNjA7XG4gIHNlY29uZHMgPSBzZWNzO1xuICB0aW1lc3RyaW5nID0gJyc7XG4gIGlmIChob3VycyA+IDEpIHtcbiAgICB0aW1lc3RyaW5nICs9IGhvdXJzICsgJyBob3Vycyc7XG4gIH0gZWxzZSBpZiAoaG91cnMgPT09IDEpIHtcbiAgICB0aW1lc3RyaW5nICs9ICcxIGhvdXInO1xuICB9XG4gIGlmIChtaW51dGVzKSB7XG4gICAgaWYgKGhvdXJzKSB7XG4gICAgICB0aW1lc3RyaW5nICs9ICcsICc7XG4gICAgfVxuICAgIGlmIChtaW51dGVzID4gMSkge1xuICAgICAgdGltZXN0cmluZyArPSBtaW51dGVzICsgJyBtaW51dGVzJztcbiAgICB9IGVsc2UgaWYgKG1pbnV0ZXMgPT09IDEpIHtcbiAgICAgIHRpbWVzdHJpbmcgKz0gJzEgbWludXRlJztcbiAgICB9XG4gIH0gZWxzZSBpZiAoIWhvdXJzKSB7XG4gICAgaWYgKHNlY3MgPT09IDEpIHtcbiAgICAgIHRpbWVzdHJpbmcgPSBzZWNzICsgXCIgc2Vjb25kXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRpbWVzdHJpbmcgPSBzZWNzICsgXCIgc2Vjb25kc1wiO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdGltZXN0cmluZztcbn07XG50aGlzLmVsYXBzZWRUb0h1bWFuUmVhZGFibGUgPSBmdW5jdGlvbihzZWNzQWdvKXtcbiAgdmFyIHN1ZmZpeCwgaHVtYW4sIGQsIHdlZWtzLCBtb250aHMsIHllYXJzO1xuICBzdWZmaXggPSAnYWdvJztcbiAgaHVtYW4gPSBzZWNzQWdvIDwgMzBcbiAgICA/ICdKdXN0IG5vdyEnXG4gICAgOiBzZWNzQWdvIDwgNjBcbiAgICAgID8gXCJBIG1vbWVudCBcIiArIHN1ZmZpeFxuICAgICAgOiBzZWNzQWdvIDwgMTIwXG4gICAgICAgID8gXCJBIG1pbnV0ZSBcIiArIHN1ZmZpeFxuICAgICAgICA6IHNlY3NBZ28gPCA4NjQwMFxuICAgICAgICAgID8gc2Vjb25kc1RvSHVtYW5SZWFkYWJsZShzZWNzQWdvKSArICcgJyArIHN1ZmZpeFxuICAgICAgICAgIDogc2Vjc0FnbyA8IDE3MjgwMFxuICAgICAgICAgICAgPyAnWWVzdGVyZGF5J1xuICAgICAgICAgICAgOiBzZWNzQWdvIDwgNjA0ODAwXG4gICAgICAgICAgICAgID8gKGQgPSBuZXcgRGF0ZSgpLCBkLnNldFRpbWUoZC5nZXRUaW1lKCkgLSBzZWNzQWdvICogMTAwMCksIHRoaXMucHJldHR5RGF5TmFtZShkLmdldERheSgpKSlcbiAgICAgICAgICAgICAgOiBzZWNzQWdvIDwgMjYyODAwMFxuICAgICAgICAgICAgICAgID8gKHdlZWtzID0gTWF0aC5mbG9vcihzZWNzQWdvIC8gNjA0ODAwKSwgd2Vla3MgPT09IDFcbiAgICAgICAgICAgICAgICAgID8gXCJBIHdlZWsgXCIgKyBzdWZmaXhcbiAgICAgICAgICAgICAgICAgIDogd2Vla3MgKyBcIiB3ZWVrcyBcIiArIHN1ZmZpeClcbiAgICAgICAgICAgICAgICA6IHNlY3NBZ28gPCAzMTQ0NjkyNVxuICAgICAgICAgICAgICAgICAgPyAobW9udGhzID0gTWF0aC5mbG9vcihzZWNzQWdvIC8gMjYyODAwMCksIG1vbnRocyA9PT0gMVxuICAgICAgICAgICAgICAgICAgICA/IFwiQSBtb250aCBcIiArIHN1ZmZpeFxuICAgICAgICAgICAgICAgICAgICA6IG1vbnRocyArIFwiIG1vbnRocyBcIiArIHN1ZmZpeClcbiAgICAgICAgICAgICAgICAgIDogKHllYXJzID0gTWF0aC5mbG9vcihzZWNzQWdvIC8gMzE0NDY5MjUpLCB5ZWFycyA9PT0gMVxuICAgICAgICAgICAgICAgICAgICA/IFwiQSB5ZWFyIFwiICsgc3VmZml4XG4gICAgICAgICAgICAgICAgICAgIDogeWVhcnMgKyBcIiB5ZWFycyBcIiArIHN1ZmZpeCk7XG4gIHJldHVybiBodW1hbi5yZXBsYWNlKC8oXFxkKykvZywgJzxiPiQxPC9iPicpO1xufTtcbnRoaXMuZGpiMkhhc2ggPSBmdW5jdGlvbihzdHIpe1xuICB2YXIgaGFzaCwgaSQsIGxlbiQsIGksIGNoYXI7XG4gIGhhc2ggPSA1MzgxO1xuICBmb3IgKGkkID0gMCwgbGVuJCA9IHN0ci5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIGkgPSBzdHJbaSRdO1xuICAgIGNoYXIgPSBzdHIuY2hhckNvZGVBdChpKTtcbiAgICBoYXNoID0gKChoYXNoIDw8IDUpICsgaGFzaCkgKyBjaGFyO1xuICB9XG4gIHJldHVybiBoYXNoO1xufTtcbmRhdGVGaWVsZHMgPSBbJ2NyZWF0ZWQnLCAndXBkYXRlZCddO1xudGhpcy5hZGREYXRlcyA9IGZ1bmN0aW9uKG8pe1xuICB2YXIgbm93LCBpJCwgcmVmJCwgbGVuJCwgZGYsIHN1YiwgaywgaSwgdjtcbiAgbm93ID0gRGF0ZS5ub3coKTtcbiAgaWYgKCFvKSB7XG4gICAgcmV0dXJuIG87XG4gIH1cbiAgc3dpdGNoICh0eXBlb2Ygbykge1xuICBjYXNlICdvYmplY3QnOlxuICAgIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSBkYXRlRmllbGRzKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgZGYgPSByZWYkW2kkXTtcbiAgICAgIGlmIChvW2RmXSkge1xuICAgICAgICBvW2RmXSA9IG5ldyBEYXRlKG9bZGZdKTtcbiAgICAgICAgb1tkZiArIFwiX2h1bWFuXCJdID0gdGhpcy5lbGFwc2VkVG9IdW1hblJlYWRhYmxlKChub3cgLSBvW2RmXSkgLyAxMDAwKTtcbiAgICAgICAgb1tkZiArIFwiX2lzb1wiXSA9IG9bZGZdLnRvSVNPU3RyaW5nKCk7XG4gICAgICB9XG4gICAgfVxuICAgIHN1YiA9IF9fLmtleXMobykuZmlsdGVyKGZ1bmN0aW9uKGspe1xuICAgICAgcmV0dXJuIHR5cGVvZiBvW2tdID09PSAnYXJyYXknIHx8IHR5cGVvZiBvW2tdID09PSAnb2JqZWN0JztcbiAgICB9KTtcbiAgICBmb3IgKGkkID0gMCwgbGVuJCA9IHN1Yi5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgayA9IHN1YltpJF07XG4gICAgICBvW2tdID0gdGhpcy5hZGREYXRlcyhvW2tdKTtcbiAgICB9XG4gICAgcmV0dXJuIG87XG4gIGNhc2UgJ2FycmF5JzpcbiAgICBmb3IgKGkkID0gMCwgbGVuJCA9IG8ubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICAgIGkgPSBpJDtcbiAgICAgIHYgPSBvW2kkXTtcbiAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgb1tpXSA9IHRoaXMuYWRkRGF0ZXMob1tpXSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBvO1xuICBkZWZhdWx0OlxuICAgIHJldHVybiBvO1xuICB9XG59O1xudGhpcy5yZW5kZXJBbmQgPSBjdXJyeSQoZnVuY3Rpb24oZm4sIHcsIHRhcmdldCwgdG1wbCwgcGFyYW1zLCBjYil7XG4gIHZhciAkdCwgJGI7XG4gICR0ID0gdy4kKHRhcmdldCk7XG4gICRiID0gdy4kKCc8ZGl2PicpO1xuICAkYi5oaWRlKCk7XG4gICR0W2ZuXSgkYik7XG4gIHcuamFkZS5yZW5kZXIoJGJbMF0sIHRtcGwsIHBhcmFtcyk7XG4gICRiLnNob3coKS5hZGRDbGFzcygnZmFkZWluJyk7XG4gIHJldHVybiBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGNiKCRiKTtcbiAgfSwgMTAwKTtcbn0pO1xudGhpcy5yZW5kZXJBbmRBcHBlbmQgPSB0aGlzLnJlbmRlckFuZCgnYXBwZW5kJyk7XG50aGlzLnJlbmRlckFuZFByZXBlbmQgPSB0aGlzLnJlbmRlckFuZCgncHJlcGVuZCcpO1xudGhpcy5pc0VtYWlsID0gZnVuY3Rpb24obmFtZSl7XG4gIHJldHVybiBuYW1lLmluZGV4T2YoJ0AnKSAhPT0gLTE7XG59O1xudGhpcy5pc0ZvcnVtSG9tZXBhZ2UgPSBmdW5jdGlvbihwYXRoKXtcbiAgcmV0dXJuIGZ1cmwucGFyc2UocGF0aCkudHlwZSA9PT0gJ2ZvcnVtJztcbn07XG50aGlzLmlzRWRpdGluZyA9IGZ1bmN0aW9uKHBhdGgpe1xuICB2YXIgbWV0YTtcbiAgbWV0YSA9IGZ1cmwucGFyc2UocGF0aCk7XG4gIHN3aXRjaCAobWV0YS50eXBlKSB7XG4gIGNhc2UgJ25ldy10aHJlYWQnOlxuICAgIHJldHVybiB0cnVlO1xuICBjYXNlICdlZGl0JzpcbiAgICByZXR1cm4gbWV0YS5pZDtcbiAgZGVmYXVsdDpcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn07XG50aGlzLmZsaXBCYWNrZ3JvdW5kID0gZnVuY3Rpb24odywgY3VyLCBkaXJlY3Rpb24pe1xuICB2YXIgbGFzdCwgbmV4dDtcbiAgZGlyZWN0aW9uID09IG51bGwgJiYgKGRpcmVjdGlvbiA9ICdkb3duJyk7XG4gIGlmICh3LmJnQW5pbSkge1xuICAgIGNsZWFyVGltZW91dCh3LmJnQW5pbSk7XG4gIH1cbiAgbGFzdCA9IHcuJCgnLmJnLmFjdGl2ZScpO1xuICBuZXh0ID0gdy4kKCcjZm9ydW1fYmdfJyArIGN1ci5kYXRhKCdpZCcpKTtcbiAgbmV4dC5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcbiAgaWYgKCFsYXN0Lmxlbmd0aCkge1xuICAgIHJldHVybiBuZXh0LmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gdy5iZ0FuaW0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICBsYXN0LmNzcygndG9wJywgZGlyZWN0aW9uID09PSAnZG93bicgPyAtMzAwIDogMzAwKTtcbiAgICAgIGxhc3QucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgbmV4dC5hZGRDbGFzcygnYWN0aXZlJyk7XG4gICAgICByZXR1cm4gdy5iZ0FuaW0gPSAwO1xuICAgIH0sIDEwMCk7XG4gIH1cbn07XG50aGlzLnJVbmJpbmQgPSBmdW5jdGlvbihyZil7XG4gIHZhciBpJCwgcmVmJCwgbGVuJCwgZDtcbiAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IHJmLmRlcGVuZGVuY2llcykubGVuZ3RoOyBpJCA8IGxlbiQ7ICsraSQpIHtcbiAgICBkID0gcmVmJFtpJF07XG4gICAgZC5yZW1vdmVEZXBlbmRlbnQoKTtcbiAgfVxufTtcbmZ1bmN0aW9uIGN1cnJ5JChmLCBib3VuZCl7XG4gIHZhciBjb250ZXh0LFxuICBfY3VycnkgPSBmdW5jdGlvbihhcmdzKSB7XG4gICAgcmV0dXJuIGYubGVuZ3RoID4gMSA/IGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgcGFyYW1zID0gYXJncyA/IGFyZ3MuY29uY2F0KCkgOiBbXTtcbiAgICAgIGNvbnRleHQgPSBib3VuZCA/IGNvbnRleHQgfHwgdGhpcyA6IHRoaXM7XG4gICAgICByZXR1cm4gcGFyYW1zLnB1c2guYXBwbHkocGFyYW1zLCBhcmd1bWVudHMpIDxcbiAgICAgICAgICBmLmxlbmd0aCAmJiBhcmd1bWVudHMubGVuZ3RoID9cbiAgICAgICAgX2N1cnJ5LmNhbGwoY29udGV4dCwgcGFyYW1zKSA6IGYuYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcbiAgICB9IDogZjtcbiAgfTtcbiAgcmV0dXJuIF9jdXJyeSgpO1xufSIsInZhciBDb21wb25lbnQsIHRlbXBsYXRlcywgQnV5O1xuQ29tcG9uZW50ID0gcmVxdWlyZSgneWFjb21wb25lbnQnKTtcbnRlbXBsYXRlcyA9IHJlcXVpcmUoJy4uL2J1aWxkL2NvbXBvbmVudC1qYWRlLmpzJykudGVtcGxhdGVzO1xubW9kdWxlLmV4cG9ydHMgPSBCdXkgPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKEJ1eSwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnQnV5JywgQnV5KSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEJ1eTtcbiAgcHJvdG90eXBlLnRlbXBsYXRlID0gdGVtcGxhdGVzLkJ1eTtcbiAgcHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpe1xuICAgIGlmICh0aGlzLmxvY2FsKCdjYXJkTmVlZGVkJykgPT09IHZvaWQgOCkge1xuICAgICAgcmV0dXJuIHRoaXMubG9jYWwoJ2NhcmROZWVkZWQnLCB0cnVlKTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5vbkF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gY29uc3RydWN0b3IuJCgnLkJ1eS1jYXJkLW51bWJlcicpLmZvY3VzKCk7XG4gICAgfSwgMTAwKTtcbiAgICB0aGlzLiQub24oJ2NsaWNrJywgJy5CdXktY2hhbmdlLWNhcmQnLCBmdW5jdGlvbigpe1xuICAgICAgdmFyICRmYjtcbiAgICAgIHRoaXMkLmxvY2FsKCdjYXJkTmVlZGVkJywgdHJ1ZSk7XG4gICAgICB0aGlzJC5kZXRhY2goKS5yZW5kZXIoKS5hdHRhY2goKTtcbiAgICAgICRmYiA9IGNvbnN0cnVjdG9yLiQoJy5mYW5jeWJveC13cmFwOmZpcnN0Jyk7XG4gICAgICAkZmIucmVtb3ZlQ2xhc3MoJ3NsaWRlJyk7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiAkZmIuYWRkQ2xhc3MoJ3NsaWRlJyk7XG4gICAgICB9LCAxMCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuJC5vbignY2xpY2snLCAnLkJ1eS1jaGVja291dCcsIGZ1bmN0aW9uKGV2KXtcbiAgICAgIHZhciBkYXRhLCBwcm9kdWN0LCByZUVuYWJsZTtcbiAgICAgICQoZXYudGFyZ2V0KS5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpO1xuICAgICAgZGF0YSA9IHtcbiAgICAgICAgbnVtYmVyOiB0aGlzJC4kLmZpbmQoJy5CdXktY2FyZC1udW1iZXInKS52YWwoKSxcbiAgICAgICAgZXhwbW86IHRoaXMkLiQuZmluZCgnLkJ1eS1jYXJkLW1vbnRoJykudmFsKCksXG4gICAgICAgIGV4cHllYXI6IHRoaXMkLiQuZmluZCgnLkJ1eS1jYXJkLXllYXInKS52YWwoKSxcbiAgICAgICAgY29kZTogdGhpcyQuJC5maW5kKCcuQnV5LWNhcmQtY29kZScpLnZhbCgpXG4gICAgICB9O1xuICAgICAgcHJvZHVjdCA9IHRoaXMkLmxvY2FsKCdwcm9kdWN0JykuaWQ7XG4gICAgICByZUVuYWJsZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiAkKGV2LnRhcmdldCkuYXR0cignZGlzYWJsZWQnLCBudWxsKTtcbiAgICAgIH07XG4gICAgICBzaG93VG9vbHRpcCh0aGlzJC4kLmZpbmQoJy50b29sdGlwJyksICdTZWN1cmluZyBhIGNvbm5lY3Rpb24nKTtcbiAgICAgIGNvbnN0cnVjdG9yLiQucG9zdChcIi9hamF4L2NoZWNrb3V0L1wiICsgcHJvZHVjdCwgZGF0YSwgZnVuY3Rpb24ocil7XG4gICAgICAgIHZhciByZWYkLCBjYXJkTnVtYmVyLCBpJCwgbGVuJCwgZSwgJGZiO1xuICAgICAgICBpZiAoci5zdWNjZXNzKSB7XG4gICAgICAgICAgc2l0ZS5zdWJzY3JpcHRpb25zLnB1c2gocHJvZHVjdCk7XG4gICAgICAgICAgc2l0ZS5oYXNfc3RyaXBlID0gdHJ1ZTtcbiAgICAgICAgICAkKFwiI1wiICsgcHJvZHVjdCkuZm9jdXMoKTtcbiAgICAgICAgICBzaG93VG9vbHRpcCh0aGlzJC4kLmZpbmQoJy50b29sdGlwJyksIFsnU2luY2VyZSB0aGFua3MhJywgXCJBd2Vzb21lLiAgR28gYWhlYWQhXCIsICdZb3UgZ290IGl0IScsICdUaGFuayB5b3UhJ11bcGFyc2VJbnQoTWF0aC5yYW5kb20oKSAqIDUpXSk7XG4gICAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJlRW5hYmxlKCk7XG4gICAgICAgICAgICAkKFwiLlwiICsgcHJvZHVjdCArIFwiLWF2YWlsYWJsZVwiKS5oaWRlKCk7XG4gICAgICAgICAgICAkKFwiLlwiICsgcHJvZHVjdCArIFwiLXB1cmNoYXNlZFwiKS5zaG93KDUwMCk7XG4gICAgICAgICAgICByZXR1cm4gJC5mYW5jeWJveC5jbG9zZSgpO1xuICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNob3dUb29sdGlwKHRoaXMkLiQuZmluZCgnLnRvb2x0aXAnKSwgKHJlZiQgPSByLmVycm9ycykgIT0gbnVsbCAmJiByZWYkLmxlbmd0aCA/IHIuZXJyb3JzLmpvaW4oXCJcXG5cIikgOiAnSW52YWxpZCBwYXltZW50IScpO1xuICAgICAgICAgIGNhcmROdW1iZXIgPSB0aGlzJC4kLmZpbmQoJy5CdXktY2FyZC1udW1iZXInKTtcbiAgICAgICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gW2NhcmROdW1iZXIsIGNvbnN0cnVjdG9yLiQoJy5CdXktY2FyZC1jb2RlJyldKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgICAgICAgICAgZSA9IHJlZiRbaSRdO1xuICAgICAgICAgICAgZS5hZGRDbGFzcygnaGFzLWVycm9yJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgICRmYiA9IGNvbnN0cnVjdG9yLiQoJy5mYW5jeWJveC13cmFwOmZpcnN0Jyk7XG4gICAgICAgICAgJGZiLmFkZENsYXNzKCdvbi1lcnJvcicpO1xuICAgICAgICAgICRmYi5yZW1vdmVDbGFzcygnc2hha2UnKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAkZmIuYWRkQ2xhc3MoJ3NoYWtlJyk7XG4gICAgICAgICAgICByZXR1cm4gY2FyZE51bWJlci5mb2N1cygpO1xuICAgICAgICAgIH0sIDEwKTtcbiAgICAgICAgICByZXR1cm4gcmVFbmFibGUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gIH07XG4gIHByb3RvdHlwZS5vbkRldGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuJC5vZmYoKTtcbiAgfTtcbiAgZnVuY3Rpb24gQnV5KCl7XG4gICAgQnV5LnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICByZXR1cm4gQnV5O1xufShDb21wb25lbnQpKTtcbmZ1bmN0aW9uIGV4dGVuZCQoc3ViLCBzdXApe1xuICBmdW5jdGlvbiBmdW4oKXt9IGZ1bi5wcm90b3R5cGUgPSAoc3ViLnN1cGVyY2xhc3MgPSBzdXApLnByb3RvdHlwZTtcbiAgKHN1Yi5wcm90b3R5cGUgPSBuZXcgZnVuKS5jb25zdHJ1Y3RvciA9IHN1YjtcbiAgaWYgKHR5cGVvZiBzdXAuZXh0ZW5kZWQgPT0gJ2Z1bmN0aW9uJykgc3VwLmV4dGVuZGVkKHN1Yik7XG4gIHJldHVybiBzdWI7XG59XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsInZhciBDb21wb25lbnQsIFNhbGVzLCB0ZW1wbGF0ZXMsIFNhbGVzQXBwO1xuQ29tcG9uZW50ID0gcmVxdWlyZSgneWFjb21wb25lbnQnKTtcblNhbGVzID0gcmVxdWlyZSgnLi9TYWxlcy5scycpO1xudGVtcGxhdGVzID0gcmVxdWlyZSgnLi4vYnVpbGQvY29tcG9uZW50LWphZGUuanMnKS50ZW1wbGF0ZXM7XG5tb2R1bGUuZXhwb3J0cyA9IFNhbGVzQXBwID0gKGZ1bmN0aW9uKHN1cGVyY2xhc3Mpe1xuICB2YXIgcHJvdG90eXBlID0gZXh0ZW5kJCgoaW1wb3J0JChTYWxlc0FwcCwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnU2FsZXNBcHAnLCBTYWxlc0FwcCksIHN1cGVyY2xhc3MpLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBTYWxlc0FwcDtcbiAgcHJvdG90eXBlLnRlbXBsYXRlID0gdGVtcGxhdGVzLlNhbGVzQXBwO1xuICBwcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4gPSB7XG4gICAgICBzYWxlczogbmV3IFNhbGVzKHt9LCAnLlNhbGVzQXBwLWNvbnRlbnQnLCB0aGlzKVxuICAgIH07XG4gIH07XG4gIHByb3RvdHlwZS5vbkF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yLiQoJy5TYWxlcy1zdWJkb21haW46Zmlyc3QnKS5mb2N1cygpO1xuICB9O1xuICBwcm90b3R5cGUubG9naW4gPSBmdW5jdGlvbih1c2VyKXtcbiAgICB0aGlzLiQuZmluZCgnbGkuYXV0aCBhLm9uY2xpY2stbG9naW4nKS5oaWRlKCk7XG4gICAgcmV0dXJuIHRoaXMuJC5maW5kKCdsaS5hdXRoIGEub25jbGljay1sb2dvdXQnKS5zaG93KCk7XG4gIH07XG4gIHByb3RvdHlwZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuJC5maW5kKCdsaS5hdXRoIGEub25jbGljay1sb2dpbicpLnNob3coKTtcbiAgICByZXR1cm4gdGhpcy4kLmZpbmQoJ2xpLmF1dGggYS5vbmNsaWNrLWxvZ291dCcpLmhpZGUoKTtcbiAgfTtcbiAgZnVuY3Rpb24gU2FsZXNBcHAoKXtcbiAgICBTYWxlc0FwcC5zdXBlcmNsYXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cbiAgcmV0dXJuIFNhbGVzQXBwO1xufShDb21wb25lbnQpKTtcbmZ1bmN0aW9uIGV4dGVuZCQoc3ViLCBzdXApe1xuICBmdW5jdGlvbiBmdW4oKXt9IGZ1bi5wcm90b3R5cGUgPSAoc3ViLnN1cGVyY2xhc3MgPSBzdXApLnByb3RvdHlwZTtcbiAgKHN1Yi5wcm90b3R5cGUgPSBuZXcgZnVuKS5jb25zdHJ1Y3RvciA9IHN1YjtcbiAgaWYgKHR5cGVvZiBzdXAuZXh0ZW5kZWQgPT0gJ2Z1bmN0aW9uJykgc3VwLmV4dGVuZGVkKHN1Yik7XG4gIHJldHVybiBzdWI7XG59XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsIlxubW9kdWxlLmV4cG9ydHMgPSBqYWRlID0gKGZ1bmN0aW9uKGV4cG9ydHMpe1xuLyohXG4gKiBKYWRlIC0gcnVudGltZVxuICogQ29weXJpZ2h0KGMpIDIwMTAgVEogSG9sb3dheWNodWsgPHRqQHZpc2lvbi1tZWRpYS5jYT5cbiAqIE1JVCBMaWNlbnNlZFxuICovXG5cbi8qKlxuICogTGFtZSBBcnJheS5pc0FycmF5KCkgcG9seWZpbGwgZm9yIG5vdy5cbiAqL1xuXG5pZiAoIUFycmF5LmlzQXJyYXkpIHtcbiAgQXJyYXkuaXNBcnJheSA9IGZ1bmN0aW9uKGFycil7XG4gICAgcmV0dXJuICdbb2JqZWN0IEFycmF5XScgPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFycik7XG4gIH07XG59XG5cbi8qKlxuICogTGFtZSBPYmplY3Qua2V5cygpIHBvbHlmaWxsIGZvciBub3cuXG4gKi9cblxuaWYgKCFPYmplY3Qua2V5cykge1xuICBPYmplY3Qua2V5cyA9IGZ1bmN0aW9uKG9iail7XG4gICAgdmFyIGFyciA9IFtdO1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBhcnIucHVzaChrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gYXJyO1xuICB9XG59XG5cbi8qKlxuICogTWVyZ2UgdHdvIGF0dHJpYnV0ZSBvYmplY3RzIGdpdmluZyBwcmVjZWRlbmNlXG4gKiB0byB2YWx1ZXMgaW4gb2JqZWN0IGBiYC4gQ2xhc3NlcyBhcmUgc3BlY2lhbC1jYXNlZFxuICogYWxsb3dpbmcgZm9yIGFycmF5cyBhbmQgbWVyZ2luZy9qb2luaW5nIGFwcHJvcHJpYXRlbHlcbiAqIHJlc3VsdGluZyBpbiBhIHN0cmluZy5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gYVxuICogQHBhcmFtIHtPYmplY3R9IGJcbiAqIEByZXR1cm4ge09iamVjdH0gYVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZXhwb3J0cy5tZXJnZSA9IGZ1bmN0aW9uIG1lcmdlKGEsIGIpIHtcbiAgdmFyIGFjID0gYVsnY2xhc3MnXTtcbiAgdmFyIGJjID0gYlsnY2xhc3MnXTtcblxuICBpZiAoYWMgfHwgYmMpIHtcbiAgICBhYyA9IGFjIHx8IFtdO1xuICAgIGJjID0gYmMgfHwgW107XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGFjKSkgYWMgPSBbYWNdO1xuICAgIGlmICghQXJyYXkuaXNBcnJheShiYykpIGJjID0gW2JjXTtcbiAgICBhYyA9IGFjLmZpbHRlcihudWxscyk7XG4gICAgYmMgPSBiYy5maWx0ZXIobnVsbHMpO1xuICAgIGFbJ2NsYXNzJ10gPSBhYy5jb25jYXQoYmMpLmpvaW4oJyAnKTtcbiAgfVxuXG4gIGZvciAodmFyIGtleSBpbiBiKSB7XG4gICAgaWYgKGtleSAhPSAnY2xhc3MnKSB7XG4gICAgICBhW2tleV0gPSBiW2tleV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGE7XG59O1xuXG4vKipcbiAqIEZpbHRlciBudWxsIGB2YWxgcy5cbiAqXG4gKiBAcGFyYW0ge01peGVkfSB2YWxcbiAqIEByZXR1cm4ge01peGVkfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZnVuY3Rpb24gbnVsbHModmFsKSB7XG4gIHJldHVybiB2YWwgIT0gbnVsbDtcbn1cblxuLyoqXG4gKiBSZW5kZXIgdGhlIGdpdmVuIGF0dHJpYnV0ZXMgb2JqZWN0LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcbiAqIEBwYXJhbSB7T2JqZWN0fSBlc2NhcGVkXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5leHBvcnRzLmF0dHJzID0gZnVuY3Rpb24gYXR0cnMob2JqLCBlc2NhcGVkKXtcbiAgdmFyIGJ1ZiA9IFtdXG4gICAgLCB0ZXJzZSA9IG9iai50ZXJzZTtcblxuICBkZWxldGUgb2JqLnRlcnNlO1xuICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iailcbiAgICAsIGxlbiA9IGtleXMubGVuZ3RoO1xuXG4gIGlmIChsZW4pIHtcbiAgICBidWYucHVzaCgnJyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47ICsraSkge1xuICAgICAgdmFyIGtleSA9IGtleXNbaV1cbiAgICAgICAgLCB2YWwgPSBvYmpba2V5XTtcblxuICAgICAgaWYgKCdib29sZWFuJyA9PSB0eXBlb2YgdmFsIHx8IG51bGwgPT0gdmFsKSB7XG4gICAgICAgIGlmICh2YWwpIHtcbiAgICAgICAgICB0ZXJzZVxuICAgICAgICAgICAgPyBidWYucHVzaChrZXkpXG4gICAgICAgICAgICA6IGJ1Zi5wdXNoKGtleSArICc9XCInICsga2V5ICsgJ1wiJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoMCA9PSBrZXkuaW5kZXhPZignZGF0YScpICYmICdzdHJpbmcnICE9IHR5cGVvZiB2YWwpIHtcbiAgICAgICAgYnVmLnB1c2goa2V5ICsgXCI9J1wiICsgSlNPTi5zdHJpbmdpZnkodmFsKSArIFwiJ1wiKTtcbiAgICAgIH0gZWxzZSBpZiAoJ2NsYXNzJyA9PSBrZXkgJiYgQXJyYXkuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIGJ1Zi5wdXNoKGtleSArICc9XCInICsgZXhwb3J0cy5lc2NhcGUodmFsLmpvaW4oJyAnKSkgKyAnXCInKTtcbiAgICAgIH0gZWxzZSBpZiAoZXNjYXBlZCAmJiBlc2NhcGVkW2tleV0pIHtcbiAgICAgICAgYnVmLnB1c2goa2V5ICsgJz1cIicgKyBleHBvcnRzLmVzY2FwZSh2YWwpICsgJ1wiJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBidWYucHVzaChrZXkgKyAnPVwiJyArIHZhbCArICdcIicpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBidWYuam9pbignICcpO1xufTtcblxuLyoqXG4gKiBFc2NhcGUgdGhlIGdpdmVuIHN0cmluZyBvZiBgaHRtbGAuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGh0bWxcbiAqIEByZXR1cm4ge1N0cmluZ31cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmV4cG9ydHMuZXNjYXBlID0gZnVuY3Rpb24gZXNjYXBlKGh0bWwpe1xuICByZXR1cm4gU3RyaW5nKGh0bWwpXG4gICAgLnJlcGxhY2UoLyYoPyEoXFx3K3xcXCNcXGQrKTspL2csICcmYW1wOycpXG4gICAgLnJlcGxhY2UoLzwvZywgJyZsdDsnKVxuICAgIC5yZXBsYWNlKC8+L2csICcmZ3Q7JylcbiAgICAucmVwbGFjZSgvXCIvZywgJyZxdW90OycpO1xufTtcblxuLyoqXG4gKiBSZS10aHJvdyB0aGUgZ2l2ZW4gYGVycmAgaW4gY29udGV4dCB0byB0aGVcbiAqIHRoZSBqYWRlIGluIGBmaWxlbmFtZWAgYXQgdGhlIGdpdmVuIGBsaW5lbm9gLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVyclxuICogQHBhcmFtIHtTdHJpbmd9IGZpbGVuYW1lXG4gKiBAcGFyYW0ge1N0cmluZ30gbGluZW5vXG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5leHBvcnRzLnJldGhyb3cgPSBmdW5jdGlvbiByZXRocm93KGVyciwgZmlsZW5hbWUsIGxpbmVubyl7XG4gIGlmICghZmlsZW5hbWUpIHRocm93IGVycjtcblxuICB2YXIgY29udGV4dCA9IDNcbiAgICAsIHN0ciA9IHJlcXVpcmUoJ2ZzJykucmVhZEZpbGVTeW5jKGZpbGVuYW1lLCAndXRmOCcpXG4gICAgLCBsaW5lcyA9IHN0ci5zcGxpdCgnXFxuJylcbiAgICAsIHN0YXJ0ID0gTWF0aC5tYXgobGluZW5vIC0gY29udGV4dCwgMClcbiAgICAsIGVuZCA9IE1hdGgubWluKGxpbmVzLmxlbmd0aCwgbGluZW5vICsgY29udGV4dCk7XG5cbiAgLy8gRXJyb3IgY29udGV4dFxuICB2YXIgY29udGV4dCA9IGxpbmVzLnNsaWNlKHN0YXJ0LCBlbmQpLm1hcChmdW5jdGlvbihsaW5lLCBpKXtcbiAgICB2YXIgY3VyciA9IGkgKyBzdGFydCArIDE7XG4gICAgcmV0dXJuIChjdXJyID09IGxpbmVubyA/ICcgID4gJyA6ICcgICAgJylcbiAgICAgICsgY3VyclxuICAgICAgKyAnfCAnXG4gICAgICArIGxpbmU7XG4gIH0pLmpvaW4oJ1xcbicpO1xuXG4gIC8vIEFsdGVyIGV4Y2VwdGlvbiBtZXNzYWdlXG4gIGVyci5wYXRoID0gZmlsZW5hbWU7XG4gIGVyci5tZXNzYWdlID0gKGZpbGVuYW1lIHx8ICdKYWRlJykgKyAnOicgKyBsaW5lbm9cbiAgICArICdcXG4nICsgY29udGV4dCArICdcXG5cXG4nICsgZXJyLm1lc3NhZ2U7XG4gIHRocm93IGVycjtcbn07XG5cbiAgcmV0dXJuIGV4cG9ydHM7XG5cbn0pKHt9KTtcblxuamFkZS50ZW1wbGF0ZXMgPSB7fTtcbmphZGUucmVuZGVyID0gZnVuY3Rpb24obm9kZSwgdGVtcGxhdGUsIGRhdGEpIHtcbiAgdmFyIHRtcCA9IGphZGUudGVtcGxhdGVzW3RlbXBsYXRlXShkYXRhKTtcbiAgbm9kZS5pbm5lckhUTUwgPSB0bXA7XG59O1xuXG5qYWRlLnRlbXBsYXRlc1tcIkFkbWluTWVudVwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8bGkgY2xhc3M9XCJkZWZhdWx0XCI+PGRpdj48aW5wdXQgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIlRpdGxlXCIgY2xhc3M9XCJyb3dcIi8+PC9kaXY+PC9saT48Zm9ybScpO1xuYnVmLnB1c2goYXR0cnMoeyAnYWN0aW9uJzooXCIvcmVzb3VyY2VzL3NpdGVzL1wiICsgKHNpdGUuaWQpICsgXCJcIiksICdtZXRob2QnOihcInB1dFwiKSwgXCJjbGFzc1wiOiAoJ21lbnVzJykgKyAnICcgKyAoJ29uY2xpY2stc3VibWl0JykgfSwge1wiYWN0aW9uXCI6dHJ1ZSxcIm1ldGhvZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxpbnB1dCB0eXBlPVwiaGlkZGVuXCIgbmFtZT1cImFjdGlvblwiIHZhbHVlPVwibWVudVwiLz48ZGl2IGNsYXNzPVwiY29sMVwiPjxidXR0b24gY2xhc3M9XCJvbmNsaWNrLWFkZFwiPkFkZDwvYnV0dG9uPjxvbCBjbGFzcz1cInNvcnRhYmxlXCI+PC9vbD48L2Rpdj48ZGl2IGNsYXNzPVwiY29sMlwiPjxmaWVsZHNldD48bGFiZWwgY2xhc3M9XCJ0eXBlXCI+VHlwZTwvbGFiZWw+PHVsIGNsYXNzPVwib3B0aW9uc1wiPjxsaT48bGFiZWwgZm9yPVwiZm9ydW1cIiBjbGFzcz1cImhlYWRlclwiPkZvcnVtPC9sYWJlbD48aW5wdXQgaWQ9XCJmb3J1bVwiIHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJkaWFsb2dcIiBjaGVja2VkPVwiY2hlY2tlZFwiIGNsYXNzPVwib3B0aW9uXCIvPjxkaXYgY2xhc3M9XCJkaWFsb2dcIj48bGFiZWwgZm9yPVwiZm9ydW1fc2x1Z1wiPlNsdWc8L2xhYmVsPjxpbnB1dCBpZD1cImZvcnVtX3NsdWdcIiB0eXBlPVwidGV4dFwiIG5hbWU9XCJmb3J1bVNsdWdcIi8+PGRpdiBjbGFzcz1cIm5vdGVcIj5VUkwgc3VmZml4IGZvciB0aGlzIHBhZ2U8L2Rpdj48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48bGFiZWwgZm9yPVwibG9ja2VkXCI+QWRtaW4gT25seTwvbGFiZWw+PGRpdiBjbGFzcz1cImJveFwiPjxpbnB1dCBpZD1cImxvY2tlZFwiIHR5cGU9XCJjaGVja2JveFwiIHZhbHVlPVwiY2hlY2tlZFwiIG5hbWU9XCJsb2NrZWRcIi8+PGxhYmVsIGZvcj1cImxvY2tlZFwiIGNsYXNzPVwic3dpdGNoLWNvbnRyb2xcIj48ZGl2IGNsYXNzPVwic3dpdGNoXCI+PC9kaXY+PC9sYWJlbD48c3BhbiBjbGFzcz1cImxhYmVsIGNoZWNrZWRcIj5Mb2NrZWQ8L3NwYW4+PGRpdiBjbGFzcz1cIm5vdGVcIj5Mb2NrIGVudGlyZSBmb3J1bSAocmVhZC1vbmx5IGV4Y2VwdCBhZG1pbik8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiYnJlYWtcIj4gICA8L2Rpdj48bGFiZWwgZm9yPVwiY29tbWVudHNcIj5Db21tZW50czwvbGFiZWw+PGRpdiBjbGFzcz1cImJveFwiPjxpbnB1dCBpZD1cImNvbW1lbnRzXCIgdHlwZT1cImNoZWNrYm94XCIgdmFsdWU9XCJjaGVja2VkXCIgbmFtZT1cImNvbW1lbnRzXCIvPjxsYWJlbCBmb3I9XCJjb21tZW50c1wiIGNsYXNzPVwic3dpdGNoLWNvbnRyb2xcIj48ZGl2IGNsYXNzPVwic3dpdGNoXCI+PC9kaXY+PC9sYWJlbD48c3BhbiBjbGFzcz1cImxhYmVsIGNoZWNrZWRcIj5ZZXM8L3NwYW4+PGRpdiBjbGFzcz1cIm5vdGVcIj5Db21tZW50YWJsZSBmb3J1bXMgYXJlIHRocmVhZGVkIGxpa2UgUmVkZGl0PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz1cImJyZWFrXCI+ICAgPC9kaXY+PGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgdmFsdWU9XCJTYXZlXCI+U2F2ZTwvYnV0dG9uPjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PC9kaXY+PC9saT48bGk+PGxhYmVsIGZvcj1cInBhZ2VcIiBjbGFzcz1cImhlYWRlclwiPlBhZ2U8L2xhYmVsPjxpbnB1dCBpZD1cInBhZ2VcIiB0eXBlPVwicmFkaW9cIiBuYW1lPVwiZGlhbG9nXCIgY2xhc3M9XCJvcHRpb25cIi8+PGRpdiBjbGFzcz1cImRpYWxvZ1wiPjxsYWJlbCBmb3I9XCJwYWdlX3NsdWdcIj5TbHVnPC9sYWJlbD48aW5wdXQgaWQ9XCJwYWdlX3NsdWdcIiB0eXBlPVwidGV4dFwiIG5hbWU9XCJwYWdlU2x1Z1wiLz48ZGl2IGNsYXNzPVwibm90ZVwiPlVSTCBzdWZmaXggZm9yIHRoaXMgcGFnZTwvZGl2PjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxsYWJlbD5NYWluIE1lbnU8L2xhYmVsPjxkaXYgY2xhc3M9XCJib3hcIj48aW5wdXQgaWQ9XCJoaWRlX21lbnVcIiB0eXBlPVwiY2hlY2tib3hcIiB2YWx1ZT1cImNoZWNrZWRcIiBuYW1lPVwiaGlkZU1lbnVcIi8+PGxhYmVsIGZvcj1cImhpZGVfbWVudVwiIGNsYXNzPVwic3dpdGNoLWNvbnRyb2xcIj48ZGl2IGNsYXNzPVwic3dpdGNoXCI+PC9kaXY+PC9sYWJlbD48c3BhbiBjbGFzcz1cImxhYmVsIGNoZWNrZWRcIj5Pbjwvc3Bhbj48ZGl2IGNsYXNzPVwibm90ZVwiPlNob3dzICZhbXA7IGhpZGVzIHRoZSBtYWluIG1lbnUgZm9yIHRoaXMgcGFnZTwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxsYWJlbCBmb3I9XCJib2R5XCI+Qm9keTwvbGFiZWw+PHRleHRhcmVhIGlkPVwiYm9keVwiIG5hbWU9XCJib2R5XCI+PC90ZXh0YXJlYT48ZGl2IGNsYXNzPVwibm90ZVwiPlBhc3RlIHRoZSBjb250ZW50cyBvZiB0aGUgcGFnZSBhYm92ZTwvZGl2PjxkaXYgY2xhc3M9XCJicmVha1wiPiAgIDwvZGl2PjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiU2F2ZVwiPlNhdmU8L2J1dHRvbj48ZGl2IGNsYXNzPVwidG9vbHRpcFwiPjwvZGl2PjwvZGl2PjwvbGk+PGxpPjxsYWJlbCBmb3I9XCJsaW5rXCIgY2xhc3M9XCJoZWFkZXJcIj5FeHRlcm5hbCBMaW5rPC9sYWJlbD48aW5wdXQgaWQ9XCJsaW5rXCIgdHlwZT1cInJhZGlvXCIgbmFtZT1cImRpYWxvZ1wiIGNsYXNzPVwib3B0aW9uXCIvPjxkaXYgY2xhc3M9XCJkaWFsb2dcIj48bGFiZWwgZm9yPVwidXJsXCI+VXJsPC9sYWJlbD48aW5wdXQgaWQ9XCJ1cmxcIiB0eXBlPVwidGV4dFwiIG5hbWU9XCJ1cmxcIiBwbGFjZWhvbGRlcj1cImh0dHA6Ly9cIi8+PGRpdiBjbGFzcz1cImJyZWFrXCI+PC9kaXY+PGxhYmVsIGZvcj1cInNlcGFyYXRlX3RhYlwiPlNlcGFyYXRlIFRhYjwvbGFiZWw+PGRpdiBjbGFzcz1cImJveFwiPjxpbnB1dCBpZD1cInNlcGFyYXRlX3RhYlwiIHR5cGU9XCJjaGVja2JveFwiIHZhbHVlPVwiY2hlY2tlZFwiIG5hbWU9XCJzZXBhcmF0ZVRhYlwiLz48bGFiZWwgZm9yPVwic2VwYXJhdGVfdGFiXCIgY2xhc3M9XCJzd2l0Y2gtY29udHJvbFwiPjxkaXYgY2xhc3M9XCJzd2l0Y2hcIj48L2Rpdj48L2xhYmVsPjxzcGFuIGNsYXNzPVwibGFiZWwgY2hlY2tlZFwiPlllczwvc3Bhbj48ZGl2IGNsYXNzPVwibm90ZVwiPk9wZW4gbGluayBpbiBzZXBhcmF0ZSB3aW5kb3c8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiYnJlYWtcIj4gICA8L2Rpdj48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiB2YWx1ZT1cIlNhdmVcIj5TYXZlPC9idXR0b24+PGRpdiBjbGFzcz1cInRvb2x0aXBcIj48L2Rpdj48L2Rpdj48L2xpPjwvdWw+PC9maWVsZHNldD48L2Rpdj48L2Zvcm0+Jyk7XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcIkFkbWluVXBncmFkZVwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBwcm9kdWN0X21peGluID0gZnVuY3Rpb24ocCwgbXNnKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5pZiAoIHN1YnNjcmlwdGlvbnMuaW5kZXhPZihwKT09LTEpXG57XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyBcImNsYXNzXCI6IChcIlwiICsgKHApICsgXCItYXZhaWxhYmxlXCIpIH0sIHtcImNsYXNzXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGJ1dHRvbicpO1xuYnVmLnB1c2goYXR0cnMoeyAndHlwZSc6KCdidXR0b24nKSwgJ2RhdGEtcHJvZHVjdCc6KHApLCAndmFsdWUnOignR2V0IEl0JyksIFwiY2xhc3NcIjogKCdvbmNsaWNrLWJ1eScpIH0sIHtcInR5cGVcIjp0cnVlLFwiZGF0YS1wcm9kdWN0XCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+R2V0IEl0PC9idXR0b24+PC9kaXY+PGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyBcImNsYXNzXCI6IChcIlwiICsgKHApICsgXCItcHVyY2hhc2VkIGhpZGRlblwiKSB9LCB7XCJjbGFzc1wiOnRydWV9KSk7XG5idWYucHVzaCgnPjxwIGNsYXNzPVwiZ3JlZW5cIj4nKTtcbnZhciBfX3ZhbF9fID0gbXNnXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8c3Bhbj4mI3gyNzEzOzwvc3Bhbj48L3A+PC9kaXY+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyBcImNsYXNzXCI6IChcIlwiICsgKHApICsgXCItYXZhaWxhYmxlIGhpZGRlblwiKSB9LCB7XCJjbGFzc1wiOnRydWV9KSk7XG5idWYucHVzaCgnPjxidXR0b24nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignYnV0dG9uJyksICdkYXRhLXByb2R1Y3QnOihwKSwgJ3ZhbHVlJzooJ0dldCBJdCcpLCBcImNsYXNzXCI6ICgnb25jbGljay1idXknKSB9LCB7XCJ0eXBlXCI6dHJ1ZSxcImRhdGEtcHJvZHVjdFwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPkdldCBJdDwvYnV0dG9uPjwvZGl2PjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgXCJjbGFzc1wiOiAoXCJcIiArIChwKSArIFwiLXB1cmNoYXNlZFwiKSB9LCB7XCJjbGFzc1wiOnRydWV9KSk7XG5idWYucHVzaCgnPjxwIGNsYXNzPVwiZ3JlZW5cIj4nKTtcbnZhciBfX3ZhbF9fID0gbXNnXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8c3Bhbj4mI3gyNzEzOzwvc3Bhbj48L3A+PC9kaXY+Jyk7XG59XG59O1xuYnVmLnB1c2goJzxmaWVsZHNldD48aDI+Q3VzdG9tIERvbWFpbjwvaDI+PHA+QWRkIHlvdXIgb3duIHBlcnNvbmFsIGZsYWlyISAgR2V0IHNlcmlvdXMgYW5kIGFpbSBhbnkgZG9tYWluIGF0IHlvdXIgUG93ZXJCdWxsZXRpbiBzaXRlLjwvcD4nKTtcbnByb2R1Y3RfbWl4aW4oJ2N1c3RvbV9kb21haW4nLCAnQ3VzdG9tIERvbWFpbiBQdXJjaGFzZWQnKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwibm90ZXNcIj48YSBocmVmPVwiL2FkbWluL2RvbWFpbnNcIiBjbGFzcz1cIm11dGFudFwiPkNsaWNrIGhlcmUgdG8gYnJpbmcgeW91ciBkb21haW5zIG9ubGluZSE8L2E+PC9kaXY+PC9maWVsZHNldD48ZmllbGRzZXQ+PGgyPkdvIFByaXZhdGU8L2gyPjxwPlByaXZhY3k/ICBXZSBnb3QgeW91IGNvdmVyZWQuICBUaGlzIGZlYXR1cmUgaGlkZXMgeW91ciBjb250ZW50IGZyb20gU2VhcmNoIEVuZ2luZXMgYW5kIHRoZSBwdWJsaWMuPC9wPicpO1xucHJvZHVjdF9taXhpbigncHJpdmF0ZScsICdQcml2YXRlIFNpdGUgUHVyY2hhc2VkJyk7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cIm5vdGVzXCI+PGEgaHJlZj1cIi9hZG1pblwiIGNsYXNzPVwibXV0YW50XCI+Q2xpY2sgaGVyZSB0byB0b2dnbGUgcHJpdmFjeSBzZXR0aW5ncyE8L2E+PC9kaXY+PC9maWVsZHNldD48ZmllbGRzZXQ+PGgyPkFuYWx5dGljczwvaDI+PHA+WW91ciBlbnRlcnByaXNpbmcgUG93ZXJCdWxsZXRpbiBjb21tdW5pdHkgaXMgYnVzdGxpbmchICBLbm93IHdobywgd2hlcmUgYW5kIGhvdyB3aXRoIHlvdXIgZmF2b3JpdGUgYW5hbHl0aWNzIHRyYWNrZXIuPC9wPicpO1xucHJvZHVjdF9taXhpbignYW5hbHl0aWNzJywgJ0FuYWx5dGljcyBQdXJjaGFzZWQnKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwibm90ZXNcIj48YSBocmVmPVwiL2FkbWluXCIgY2xhc3M9XCJtdXRhbnRcIj5HZXQgc3RhcnRlZCB3aXRoIGFuYWx5dGljcyBoZXJlITwvYT48L2Rpdj48L2ZpZWxkc2V0PjxmaWVsZHNldD48aDI+U3VwZXIgQ29tcHV0aW5nIEluc3RhbmNlPC9oMj48cD5Zb3VyIHNpdGUgcmVhbGx5IHRvb2sgb2ZmIGFuZCB5b3VcXCdkIGxpa2UgbW9yZSBob3JzZXBvd2VyLS1zcGVlZCBpcyBldmVyeXRoaW5nISAgV2l0aCB5b3VyIHR1cmJvLWNoYXJnZWQgaW5zdGFuY2UgY29tZXMgYWRkaXRpb25hbCBzZWN1cml0eSwgbW9uaXRvcmluZyBhbmQgcGVhY2Ugb2YgbWluZC48L3A+Jyk7XG5wcm9kdWN0X21peGluKCdjb21wdXRlX2luc3RhbmNlJywgJ1N1cGVyIENvbXB1dGluZyBJbnN0YW5jZSBQdXJjaGFzZWQnKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwibm90ZXNcIj48cD5BIFBvd2VyQnVsbGV0aW4gdGVhbSBtZW1iZXIgd2lsbCBjb250YWN0IHlvdSBhZnRlciBwdXJjaGFzZSE8L3A+PC9kaXY+PC9maWVsZHNldD48ZmllbGRzZXQ+PGgyPkVuZ2luZWVyaW5nICZhbXA7IENyZWF0aXZlPC9oMj48cD5OZWVkIGV4dHJhIHBlcnNvbmFsaXphdGlvbiBmb3IgeW91ciBQb3dlckJ1bGxldGluIGNvbW11bml0eT8gIE91ciBlbmdpbmVlcmluZyBuaW5qYXMgZW50ZXJ0YWluIGludmVudGl2ZSBpZGVhcyE8L3A+Jyk7XG5wcm9kdWN0X21peGluKCdlbmdpbmVlcmluZycsICdFbmdpbmVlcmluZyBQdXJjaGFzZWQnKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwibm90ZXNcIj48cD5BIFBvd2VyQnVsbGV0aW4gdGVhbSBtZW1iZXIgd2lsbCBjb250YWN0IHlvdSBhZnRlciBwdXJjaGFzZSE8L3A+PC9kaXY+PC9maWVsZHNldD4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiQXV0aFwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8ZGl2IHN0eWxlPVwiZGlzcGxheTpub25lO1wiIGNsYXNzPVwicmVzZXRcIj48Zm9ybSBtZXRob2Q9XCJwb3N0XCIgYWN0aW9uPVwiL2F1dGgvcmVzZXQtcGFzc3dvcmRcIj48bGFiZWwgZm9yPVwicGFzc3dvcmRcIj48aDI+QXV0aGVudGljYXRpbmcuLi48L2gyPjwvbGFiZWw+PGZpZWxkc2V0PjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PGlucHV0IGlkPVwicGFzc3dvcmRcIiBuYW1lPVwicGFzc3dvcmRcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiUGFzc3dvcmRcIiBkaXNhYmxlZD1cImRpc2FibGVkXCIgYXV0b2NvbXBsZXRlPVwib2ZmXCIvPjxkaXYgY2xhc3M9XCJ0b2dnbGUtcGFzc3dvcmRcIj5IaWRlPC9kaXY+PGRpdiB0aXRsZT1cIlN0cm9uZ2VyIHBhc3N3b3JkcyBhcmUgZ3JlZW5cIiBjbGFzcz1cInN0cmVuZ3RoLW1ldGVyXCI+PGRpdiBjbGFzcz1cInN0cmVuZ3RoXCI+PC9kaXY+PC9kaXY+PGlucHV0IHR5cGU9XCJoaWRkZW5cIiBuYW1lPVwiZm9yZ290XCIvPjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiU2F2ZVwiIGRpc2FibGVkPVwiZGlzYWJsZWRcIj5TYXZlPC9idXR0b24+PGEgY2xhc3M9XCJtc2cgb25jbGljay1zaG93LWxvZ2luXCI+PGgzPkJhY2s8L2gzPjwvYT48L2ZpZWxkc2V0PjwvZm9ybT48L2Rpdj48ZGl2IHN0eWxlPVwiZGlzcGxheTpub25lO1wiIGNsYXNzPVwiY2hvb3NlXCI+PGZvcm0gbWV0aG9kPVwicG9zdFwiIGFjdGlvbj1cIi9hdXRoL2Nob29zZS11c2VybmFtZVwiPjxsYWJlbCBmb3I9XCJ1c2VybmFtZVwiPjxoMj5DaG9vc2UgYSBVc2VyIE5hbWU8aT4hPC9pPjwvaDI+PC9sYWJlbD48ZmllbGRzZXQ+PGRpdiBjbGFzcz1cInRvb2x0aXBcIj48L2Rpdj48aW5wdXQgaWQ9XCJ1c2VybmFtZVwiIG5hbWU9XCJ1c2VybmFtZVwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJVc2VybmFtZVwiLz48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiB2YWx1ZT1cIlNhdmVcIj5TYXZlPC9idXR0b24+PGEgY2xhc3M9XCJtc2cgb25jbGljay1zaG93LWxvZ2luXCI+PGgzPkJhY2s8L2gzPjwvYT48L2ZpZWxkc2V0PjwvZm9ybT48L2Rpdj48ZGl2IHN0eWxlPVwiZGlzcGxheTpub25lO1wiIGNsYXNzPVwiZm9yZ290XCI+PGZvcm0gbWV0aG9kPVwicG9zdFwiIGFjdGlvbj1cIi9hdXRoL2ZvcmdvdFwiPjxsYWJlbCBmb3I9XCJlbWFpbFwiPjxoMj5UZWxsIFVzIFlvdXIgRW1haWwgQWRkcmVzczxpPiE8L2k+PC9oMj48L2xhYmVsPjxmaWVsZHNldD48ZGl2IGNsYXNzPVwidG9vbHRpcFwiPjwvZGl2PjxpbnB1dCBpZD1cImVtYWlsXCIgbmFtZT1cImVtYWlsXCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cIkVtYWlsXCIgbWF4bGVuZ3RoPVwiMjU0XCIvPjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiU2VuZCBSZXNldFwiPlNlbmQgUmVzZXQ8L2J1dHRvbj48YSBjbGFzcz1cIm1zZyBvbmNsaWNrLXNob3ctbG9naW5cIj48aDM+QmFjazwvaDM+PC9hPjwvZmllbGRzZXQ+PC9mb3JtPjwvZGl2PjxkaXYgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCIgY2xhc3M9XCJkaWFsb2dcIj48aDIgaWQ9XCJtc2dcIj5DaGVjayB5b3VyIGluYm94IGZvciBhY3RpdmF0aW9uPGk+ITwvaT48L2gyPjxkaXYgY2xhc3M9XCJtc2cyXCI+PC9kaXY+PGEgY2xhc3M9XCJtc2cgb25jbGljay1jbG9zZS1mYW5jeWJveFwiPjxoMz5DbG9zZTwvaDM+PC9hPjwvZGl2PjxkaXYgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCIgY2xhc3M9XCJyZWdpc3RlclwiPjxmb3JtIG1ldGhvZD1cInBvc3RcIiBhY3Rpb249XCIvYXV0aC9yZWdpc3RlclwiPjxsYWJlbCBmb3I9XCJ1c2VybmFtZVwiPjxoMj5XZWxjb21lPGk+ITwvaT48L2gyPjwvbGFiZWw+PGZpZWxkc2V0PjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PGlucHV0IGlkPVwidXNlcm5hbWVcIiBuYW1lPVwidXNlcm5hbWVcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiVXNlcm5hbWVcIi8+PGlucHV0IG5hbWU9XCJwYXNzd29yZFwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJQYXNzd29yZFwiIGF1dG9jb21wbGV0ZT1cIm9mZlwiLz48ZGl2IGNsYXNzPVwidG9nZ2xlLXBhc3N3b3JkXCI+SGlkZTwvZGl2PjxkaXYgdGl0bGU9XCJTdHJvbmdlciBwYXNzd29yZHMgYXJlIGdyZWVuXCIgY2xhc3M9XCJzdHJlbmd0aC1tZXRlclwiPjxkaXYgY2xhc3M9XCJzdHJlbmd0aFwiPjwvZGl2PjwvZGl2PjxpbnB1dCBuYW1lPVwiZW1haWxcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiRW1haWxcIiBtYXhsZW5ndGg9XCIyNTRcIiBjbGFzcz1cInJlZ2lzdGVyLWVtYWlsXCIvPjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiUmVnaXN0ZXJcIj5SZWdpc3RlcjwvYnV0dG9uPjxhIGNsYXNzPVwibXNnIG9uY2xpY2stc2hvdy1sb2dpblwiPjxoMz5JIGFscmVhZHkgaGF2ZSBhbiBhY2NvdW50PC9oMz48L2E+PC9maWVsZHNldD48L2Zvcm0+PC9kaXY+PGRpdiBjbGFzcz1cImxvZ2luXCI+PGZvcm0gbWV0aG9kPVwicG9zdFwiIGFjdGlvbj1cIi9hdXRoL2xvZ2luXCI+PGxhYmVsIGZvcj1cInVzZXJuYW1lXCI+PGgyPicpO1xudmFyIF9fdmFsX18gPSBzaXRlTmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oMj48L2xhYmVsPjxmaWVsZHNldD48YSBjbGFzcz1cImZtc2cgbXNnIG9uY2xpY2stc2hvdy1mb3Jnb3RcIj48aDM+Rm9yZ290PzwvaDM+PC9hPjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PGlucHV0IGlkPVwidXNlcm5hbWVcIiBuYW1lPVwidXNlcm5hbWVcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiVXNlcm5hbWVcIi8+PGlucHV0IG5hbWU9XCJwYXNzd29yZFwiIHR5cGU9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiUGFzc3dvcmRcIiBhdXRvY29tcGxldGU9XCJvZmZcIi8+PGJ1dHRvbiB0eXBlPVwic3VibWl0XCIgdmFsdWU9XCJMb2dpblwiPkxvZ2luPC9idXR0b24+Jyk7XG5pZiAoISggaW52aXRlT25seSkpXG57XG5idWYucHVzaCgnPGEgY2xhc3M9XCJtc2cgb25jbGljay1zaG93LXJlZ2lzdGVyXCI+PGgzPlJlZ2lzdGVyPGk+ITwvaT48L2gzPjwvYT4nKTtcbn1cbmJ1Zi5wdXNoKCc8YSBjbGFzcz1cInNtYWxsIG1zZyBvbmNsaWNrLXNob3ctZm9yZ290XCI+PGgzPkhlbHA8aT4/PC9pPjwvaDM+PC9hPjwvZmllbGRzZXQ+PC9mb3JtPicpO1xuaWYgKCEoIGludml0ZU9ubHkpKVxue1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJzb2NpYWwgaGFzLWF1dGhcIj48aDM+T3IgTG9nIEluIFdpdGg8L2gzPjxhIGhyZWY9XCIvYXV0aC9mYWNlYm9va1wiIHRpdGxlPVwiRmFjZWJvb2shXCIgY2xhc3M9XCJoYXMtZmFjZWJvb2tcIj4gPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9pbWFnZXMvZmFjZWJvb2tfMzIucG5nXCIpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2E+PGEgaHJlZj1cIi9hdXRoL2dvb2dsZVwiIHRpdGxlPVwiR29vZ2xlK1wiIGNsYXNzPVwiaGFzLWdvb2dsZVwiPiA8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL2ltYWdlcy9nb29nbGVfMzIucG5nXCIpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2E+PGEgaHJlZj1cIi9hdXRoL3R3aXR0ZXJcIiB0aXRsZT1cIlR3aXR0ZXIhXCIgY2xhc3M9XCJoYXMtdHdpdHRlclwiPiA8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL2ltYWdlcy90d2l0dGVyXzMyLnBuZ1wiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9hPjwvZGl2PicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJCdXlcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgcHJpY2UgPSAoKHByb2R1Y3QucHJpY2UgLyAxMDAuMCkudG9GaXhlZCgwKSk7XG5idWYucHVzaCgnPGgxPicgKyBlc2NhcGUoKGludGVycCA9IHByb2R1Y3QuZGVzY3JpcHRpb24pID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnPC9oMT48ZGl2IGNsYXNzPVwicmlnaHQgY2NpbmZvXCI+PGZvcm0gYXV0b2NvbXBsZXRlPVwib2ZmXCI+PGRpdiBjbGFzcz1cInRvb2x0aXBcIj48L2Rpdj4nKTtcbmlmICggY2FyZE5lZWRlZClcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY2xlYXJcIj48L2Rpdj48bGFiZWwgZm9yPVwiY2FyZF9udW1iZXJcIj5DYXJkIE51bWJlcjwvbGFiZWw+PGlucHV0IGlkPVwiY2FyZF9udW1iZXJcIiB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiWFhYWCAtIFhYWFggLSBYWFhYIC0gWFhYWFwiIG1heGxlbmd0aD1cIjE5XCIgY2xhc3M9XCJCdXktY2FyZC1udW1iZXJcIi8+PGRpdiBjbGFzcz1cImNsZWFyXCI+PC9kaXY+PGxhYmVsIGZvcj1cImNhcmRfbW9udGhcIj5FeHBpcmF0aW9uPC9sYWJlbD48c2VsZWN0IGlkPVwiY2FyZF9tb250aFwiIGNsYXNzPVwiQnV5LWNhcmQtbW9udGhcIj48b3B0aW9uIGRpc2FibGVkPVwiZGlzYWJsZWRcIiBzZWxlY3RlZD1cInNlbGVjdGVkXCI+LSBNb250aCAtPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjFcIj5KYW4gLSAxPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjJcIj5GZWIgLSAyPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjNcIj5NYXIgLSAzPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjRcIj5BcHIgLSA0PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjVcIj5NYXkgLSA1PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjZcIj5KdW4gLSA2PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjdcIj5KdWwgLSA3PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjhcIj5BdWcgLSA4PC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjlcIj5TZXB0IC0gOTwvb3B0aW9uPjxvcHRpb24gdmFsdWU9XCIxMFwiPk9jdCAtIDEwPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cIjExXCI+Tm92IC0gMTE8L29wdGlvbj48b3B0aW9uIHZhbHVlPVwiMTJcIj5EZWMgLSAxMjwvb3B0aW9uPjwvc2VsZWN0PjxzbWFsbD4vPC9zbWFsbD48c2VsZWN0IGlkPVwiY2FyZF95ZWFyXCIgY2xhc3M9XCJCdXktY2FyZC15ZWFyXCI+PG9wdGlvbiBkaXNhYmxlZD1cImRpc2FibGVkXCIgc2VsZWN0ZWQ9XCJzZWxlY3RlZFwiPi0gWWVhciAtPC9vcHRpb24+Jyk7XG52YXIgZCA9IChuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkpO1xuIGZvciAodmFyIGk9MDsgaTw9MTY7IGkrKylcbntcbmJ1Zi5wdXNoKCc8b3B0aW9uPicpO1xudmFyIF9fdmFsX18gPSBkICsgaVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9vcHRpb24+Jyk7XG59XG5idWYucHVzaCgnPC9zZWxlY3Q+PGRpdiBjbGFzcz1cImNsZWFyXCI+PC9kaXY+PGxhYmVsIGZvcj1cImNhcmRfY29kZVwiPlNlY3VyaXR5IENvZGU8L2xhYmVsPjxpbnB1dCBpZD1cImNhcmRfY29kZVwiIHR5cGU9XCJwYXNzd29yZFwiIHBsYWNlaG9sZGVyPVwiQ0NWXCIgbWF4bGVuZ3RoPVwiNVwiIGNsYXNzPVwiQnV5LWNhcmQtY29kZVwiLz48c3BhbiBjbGFzcz1cImNvZGVcIj4/PGRpdiBjbGFzcz1cImN2dmluZm9cIj48aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihjYWNoZVVybCArICcvaW1hZ2VzL2N2djJfZXhhbXBsZS5naWYnKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooY2FjaGVVcmwgKyAnL2ltYWdlcy9jdnYyX2V4YW1wbGVfYW1leC5naWYnKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9kaXY+PC9zcGFuPicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxoMz5Zb3VyIHBheW1lbnQgaW5mb3JtYXRpb24gaXMgUmVhZHktdG8tR288aT4hPC9pPjwvaDM+PGEgaHJlZj1cIiNcIiBjbGFzcz1cIkJ1eS1jaGFuZ2UtY2FyZFwiPkVudGVyIGRpZmZlcmVudCBjcmVkaXQgY2FyZCBkZXRhaWxzPC9hPjxkaXYgY2xhc3M9XCJjbGVhclwiPjwvZGl2PjxlbT5TYXZlcyBmb3IgYWxsIHN1YnNjcmlwdGlvbnM8L2VtPicpO1xufVxuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJjbGVhclwiPjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiQ0hFQ0tPVVRcIiBjbGFzcz1cIkJ1eS1jaGVja291dFwiPkNIRUNLT1VUPC9idXR0b24+PC9kaXY+PC9mb3JtPjwvZGl2PjxkaXYgY2xhc3M9XCJyaWdodCBmZWF0dXJlc1wiPicpO1xuaWYgKCBwcmljZSAmJiAocHJpY2UgIT09ICcwJykpXG57XG5idWYucHVzaCgnPGgyPk9ubHkgPGI+PHNtYWxsPiQ8L3NtYWxsPicpO1xudmFyIF9fdmFsX18gPSBwcmljZVxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvYj48c21hbGw+L21vPC9zbWFsbD48L2gyPicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxoMj48Yj5GcmVlPGk+ITwvaT48L2I+PC9oMj4nKTtcbn1cbmJ1Zi5wdXNoKCc8bWVudT4nKTtcbi8vIGl0ZXJhdGUgcHJvZHVjdC5jb25maWcuZmVhdHVyZXNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiBwcm9kdWN0LmNvbmZpZy5mZWF0dXJlcy5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciAkaW5kZXggPSAwLCAkJGwgPSBwcm9kdWN0LmNvbmZpZy5mZWF0dXJlcy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBmID0gcHJvZHVjdC5jb25maWcuZmVhdHVyZXNbJGluZGV4XTtcblxuYnVmLnB1c2goJzxsaT4nKTtcbnZhciBfX3ZhbF9fID0gZlxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9saT4nKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZm9yICh2YXIgJGluZGV4IGluIHByb2R1Y3QuY29uZmlnLmZlYXR1cmVzKSB7XG4gICAgICB2YXIgZiA9IHByb2R1Y3QuY29uZmlnLmZlYXR1cmVzWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8bGk+Jyk7XG52YXIgX192YWxfXyA9IGZcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvbGk+Jyk7XG4gICB9XG4gIH1cbn0pLmNhbGwodGhpcyk7XG5cbmJ1Zi5wdXNoKCc8L21lbnU+PC9kaXY+PGRpdiBjbGFzcz1cImNhcmRzXCI+PGRpdiBjbGFzcz1cImpjYlwiPjwvZGl2PjxkaXYgY2xhc3M9XCJkaW5lcnNjbHViXCI+PC9kaXY+PGRpdiBjbGFzcz1cImRpc2NvdmVyXCI+PC9kaXY+PGRpdiBjbGFzcz1cImFtZXhcIj48L2Rpdj48ZGl2IGNsYXNzPVwibWFzdGVyY2FyZFwiPjwvZGl2PjxkaXYgY2xhc3M9XCJ2aXNhXCI+PC9kaXY+PC9kaXY+Jyk7XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcIkNoYXRcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImhlYWRlclwiPjxkaXYgY2xhc3M9XCJwcm9maWxlXCI+PGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOihvdGhlcnNbMF0ubmFtZSksIFwiY2xhc3NcIjogKCdtaW5pbWl6ZScpIH0sIHtcInRpdGxlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG5pZiAoIG90aGVyc1swXS5waG90by5tYXRjaCgvXmh0dHBzP1xcOi8pIHx8IG90aGVyc1swXS5waG90by5tYXRjaCgvXFwvXFwvLykpXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzoob3RoZXJzWzBdLnBob3RvKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArIChvdGhlcnNbMF0ucGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvZGl2PjxoMj4nICsgZXNjYXBlKChpbnRlcnAgPSBvdGhlcnNbMF0ubmFtZSkgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICc8L2gyPjxkaXYgdGl0bGU9XCJDbG9zZVwiIGNsYXNzPVwiY2xvc2Ugb25jbGljay1jbG9zZVwiPlg8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PGRpdiBjbGFzcz1cIm1lc3NhZ2VzXCI+PGRpdiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIiBjbGFzcz1cImxvYWQtbW9yZVwiPmxvYWQgbW9yZS4uLjwvZGl2PjwvZGl2PjxkaXYgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCIgY2xhc3M9XCJtc2dcIj48ZGl2IGNsYXNzPVwiZnJvbVwiPjxhIGNsYXNzPVwiZnJvbS1uYW1lIG11dGFudFwiPjwvYT48L2Rpdj48ZGl2IGNsYXNzPVwiYm9keVwiPjwvZGl2PjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJmb290ZXJcIj48Zm9ybT48dGV4dGFyZWEgbmFtZT1cImJvZHlcIj48L3RleHRhcmVhPjwvZm9ybT48L2Rpdj4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiUGFnaW5hdG9yXCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xuaWYgKCBwYWdlcy5sZW5ndGggPj0gMilcbntcbi8vIGl0ZXJhdGUgcGFnZXNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiBwYWdlcy5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciAkaW5kZXggPSAwLCAkJGwgPSBwYWdlcy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBwID0gcGFnZXNbJGluZGV4XTtcblxuaWYgKCBwLmFjdGl2ZSlcbntcbmJ1Zi5wdXNoKCc8c3Ryb25nIGNsYXNzPVwiUGFnaW5hdG9yLXBhZ2VcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zdHJvbmc+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLmhyZWYpLCAnZGF0YS1wYWdlJzoocC5udW0pLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ1BhZ2luYXRvci1wYWdlJykgfSwge1wiaHJlZlwiOnRydWUsXCJkYXRhLXBhZ2VcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gcC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPicpO1xufVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciAkaW5kZXggaW4gcGFnZXMpIHtcbiAgICAgIHZhciBwID0gcGFnZXNbJGluZGV4XTtcblxuaWYgKCBwLmFjdGl2ZSlcbntcbmJ1Zi5wdXNoKCc8c3Ryb25nIGNsYXNzPVwiUGFnaW5hdG9yLXBhZ2VcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zdHJvbmc+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLmhyZWYpLCAnZGF0YS1wYWdlJzoocC5udW0pLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ1BhZ2luYXRvci1wYWdlJykgfSwge1wiaHJlZlwiOnRydWUsXCJkYXRhLXBhZ2VcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gcC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPicpO1xufVxuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG59XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcIlBob3RvQ3JvcHBlclwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwidXBsb2FkXCI+PGgxPicpO1xudmFyIF9fdmFsX18gPSB0aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oMT48ZGl2PjxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCJcIiArIChwaG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9kaXY+PGRpdj48Zm9ybScpO1xuYnVmLnB1c2goYXR0cnMoeyAnbWV0aG9kJzooXCJQT1NUXCIpLCAnYWN0aW9uJzooXCJcIiArIChlbmRwb2ludFVybCkgKyBcIlwiKSwgJ2VuY3R5cGUnOihcIm11bHRpcGFydC9mb3JtLWRhdGFcIikgfSwge1wibWV0aG9kXCI6dHJ1ZSxcImFjdGlvblwiOnRydWUsXCJlbmN0eXBlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGRpdiBjbGFzcz1cImJ1dHRvblwiPiA8c3Bhbj5VcGxvYWQgSW1hZ2U8L3NwYW4+PGlucHV0IHR5cGU9XCJmaWxlXCIgbmFtZT1cImF2YXRhclwiLz48L2Rpdj48L2Zvcm0+PC9kaXY+PC9kaXY+PGRpdiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIiBjbGFzcz1cImNyb3BcIj48aDE+Jyk7XG52YXIgX192YWxfXyA9IHRpdGxlICsgXCIgKGNyb3ApXCJcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvaDE+PGRpdj48aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiXCIgKyAocGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjwvZGl2PjxkaXYgY2xhc3M9XCJidXR0b25cIj48c3Bhbj5Dcm9wIEltYWdlPC9zcGFuPjwvZGl2PjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJTYWxlc1wiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwibG9nb1wiPjxoMT5Qb3dlcjxiPkJ1bGxldGluPC9iPjwvaDE+PGVtPlRoZSBPZmZpY2lhbCBSZWFsLVRpbWUgQ29tbXVuaXR5IEJ1aWxkZXI8L2VtPjwvZGl2PjxoMiBpZD1cImltYWdpbmVcIiBjbGFzcz1cInN0aWNrXCI+SW1hZ2luZSByZWFsLXRpbWUgY29tbXVuaXRpZXMgYXQgdGhlIGNsaWNrIG9mIGEgYnV0dG9uLjwvaDI+PGRpdiBpZD1cInJlZ2lzdGVyX3RvcFwiPjwvZGl2PjxoMiBpZD1cImZlYXR1cmVzXCIgY2xhc3M9XCJzdGlja1wiPldoeSB5b3VcXCdsbCBsb3ZlIFBvd2VyQnVsbGV0aW4gLi4uPC9oMj48c2VjdGlvbiBjbGFzcz1cInRyYW5zbHVjZW50IHN0aWNrXCI+PGFydGljbGU+PGg0PkJyZWFrdGhyb3VnaCBOYXZpZ2F0aW9uPC9oND48cD5Gcm9tIFNFTyB0ZWNobm9sb2d5IHRoYXQgc3BlZWRpbHkgdHJhbnNtaXRzIHBhZ2UgZGVsdGEgaW5zdGVhZCBvZiByZWxvYWRpbmcgYnJvd3NlcnMsXFxudG8gYSBzcGxpdC10aHJlYWQgJmFtcDsgcG9zdCBpbnRlcmZhY2UsIHRoZSBQb3dlckJ1bGxldGluIGV4cGVyaWVuY2UgaXMgYWx3YXlzIHNlY3VyZSwgZmFzdCAmYW1wOyBmbHVpZC48L3A+PC9hcnRpY2xlPjwvc2VjdGlvbj48c2VjdGlvbiBjbGFzcz1cImJnIGZpcnN0XCI+PC9zZWN0aW9uPjxzZWN0aW9uIGNsYXNzPVwic3RpY2tcIj48YXJ0aWNsZT48aDQ+VW5tYXRjaGVkIFJlc3BvbnNpdmUgRGVzaWduPC9oND48cD5BIG1vZGVybiwgcmVzcG9uc2l2ZSBpbnRlcmZhY2UgdGhhdCBzY2FsZXMgZnJvbSB0byB5b3VyIHBob25lLFxcbnRhYmxldCBhbmQgUEMgdG8gd2lkZS1zY3JlZW4gcHJvamVjdG9ycy0teW91ciBQb3dlckJ1bGxldGluIGNvbW11bml0eSBhbHdheXMgc3R1bnMuPC9wPjwvYXJ0aWNsZT48L3NlY3Rpb24+PHNlY3Rpb24gY2xhc3M9XCJiZyBzZWNvbmRcIj48L3NlY3Rpb24+PHNlY3Rpb24gY2xhc3M9XCJzdGlja1wiPjxhcnRpY2xlPjxoND5SZWFsLVRpbWUgRmxvdzwvaDQ+PHA+VWx0cmFmYXN0IFBvd2VyQnVsbGV0aW4gaXMgYnVpbHQgb24gYSByZWFsLXRpbWUgZW5naW5lIHRoYXQgcG93ZXJzXFxuZXZlcnl0aGluZyBmcm9tIHVzZXIgY2hhdCAmYW1wOyBwb3N0cyB0byBhZG1pbmlzdHJhdGlvbiwgc3VjaCBhcyBjcmVhdGluZyBwcm9kdWN0cy48L3A+PC9hcnRpY2xlPjwvc2VjdGlvbj48c2VjdGlvbiBjbGFzcz1cImJnIHRoaXJkXCI+PC9zZWN0aW9uPjxzZWN0aW9uIGNsYXNzPVwic3RpY2tcIj48YXJ0aWNsZT48aDQ+UHJvZHVjdHMgJmFtcDsgZS1Db21tZXJjZSBDYXBhYmlsaXRpZXM8L2g0PjxwPlNlbGwgeW91ciBidXNpbmVzcyBwcm9kdWN0cyAmYW1wOyBzZXJ2aWNlcyBhcm91bmQgUG93ZXJCdWxsZXRpbiBjb21tdW5pdGllcy5cXG5PZmZlcmluZyBlLWNvbW1lcmNlIGlzIHNvIGVhc3kgdG8gdXNlLCBpdFxcJ3MgZWFzeSB0byBsb3ZlLjwvcD48L2FydGljbGU+PC9zZWN0aW9uPjxzZWN0aW9uIGNsYXNzPVwiYmcgZm91cnRoXCI+PC9zZWN0aW9uPjxzZWN0aW9uIGNsYXNzPVwic3RpY2tcIj48YXJ0aWNsZT48aDQ+TGl2ZSBTdXBwb3J0PC9oND48cD5Lbm93bGVkZ2UgaXMgUG93ZXJCdWxsZXRpbiEgIFdpdGg8YSBocmVmPVwibWFpbHRvOnN1cHBvcnRAcG93ZXJidWxsZXRpbi5jb21cIj5kaXJlY3QgYWNjZXNzIHRvIG91ciB0ZWFtPC9hPm9mIGZyaWVuZGx5IGRldmVsb3BlcnMgJmFtcDsgZGVzaWduZXJzXFxudGhlcmVcXCdzIGFsbW9zdCBubyBsaW1pdCB0byB3aGF0IHlvdSBjYW4gYnVpbGQuPC9wPjwvYXJ0aWNsZT48L3NlY3Rpb24+PHNlY3Rpb24gY2xhc3M9XCJsYXN0XCI+PGFydGljbGU+PGRpdiBpZD1cInJlZ2lzdGVyX2JvdHRvbVwiPjwvZGl2PjwvYXJ0aWNsZT48L3NlY3Rpb24+PHNlY3Rpb24gaWQ9XCJmYXFcIiBjbGFzcz1cImZhcVwiPjxhcnRpY2xlPjxoMz5GQVE8L2gzPjxtZW51PjxsaT48aDQ+Q2FuIEkgY2hhbmdlIHRoZSBsb29rIG9mIFBvd2VyQnVsbGV0aW4/PC9oND48cD5BYnNvbHV0ZWx5ISAgV2UgcHJvdmlkZSBhIHNvbGlkIGRlZmF1bHQgdGhlbWUgdG8gZ2V0IHN0YXJ0ZWQgcXVpY2tseS5cXG5Bbnl0aGluZyBpcyBwb3NzaWJsZSB3aXRoIHlvdXIgc3R5bGlzaCBleWU6PGEgaHJlZj1cImh0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS9jc3NyZWYvXCIgdGFyZ2V0PVwiX2JsYW5rXCI+Q1NTPC9hPiZhbXA7PGEgaHJlZj1cImh0dHA6Ly9sZWFybmJvb3N0LmdpdGh1Yi5pby9zdHlsdXMvXCIgdGFyZ2V0PVwiX2JsYW5rXCI+U3R5bHVzPC9hPmFyZSBzdXBwb3J0ZWQuPC9wPjwvbGk+PC9tZW51PjxtZW51PjxsaT48aDQ+Q29udGFjdDwvaDQ+PHA+V2VcXCdyZSBoZXJlIGZvciBZT1U6PGEgaHJlZj1cIm1haWx0bzpzdXBwb3J0QHBvd2VyYnVsbGV0aW4uY29tXCI+c3VwcG9ydEBwb3dlcmJ1bGxldGluLmNvbTwvYT48L3A+PC9saT48L21lbnU+PC9hcnRpY2xlPjwvc2VjdGlvbj48Zm9vdGVyPjxkaXYgY2xhc3M9XCJvbmNsaWNrLXNjcm9sbC10b3BcIj5Ub3A8L2Rpdj48L2Zvb3Rlcj4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiU2FsZXNBcHBcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGhlYWRlcj48dWw+PGxpPjxhIGRhdGEtc2Nyb2xsLXRvPVwiI2ZlYXR1cmVzXCIgY2xhc3M9XCJvbmNsaWNrLXNjcm9sbC10b1wiPkZlYXR1cmVzPC9hPjwvbGk+PGxpPjxhIGRhdGEtc2Nyb2xsLXRvPVwiI2ZhcVwiIGNsYXNzPVwib25jbGljay1zY3JvbGwtdG9cIj5GQVE8L2E+PC9saT48bGkgY2xhc3M9XCJhdXRoXCI+PGEgY2xhc3M9XCJvbmNsaWNrLWxvZ2luXCI+TG9naW48L2E+PGEgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCIgY2xhc3M9XCJvbmNsaWNrLWxvZ291dFwiPkxvZ291dDwvYT48L2xpPjwvdWw+PC9oZWFkZXI+PGRpdiBpZD1cIndyYXBwZXJcIiBjbGFzcz1cIlNhbGVzQXBwLWNvbnRlbnRcIj48L2Rpdj48ZGl2IGlkPVwiYXV0aFwiPjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJTYWxlc0xvYWRlclwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8IURPQ1RZUEUgaHRtbD48aHRtbD48aGVhZD48dGl0bGU+UG93ZXJCdWxsZXRpbjwvdGl0bGU+Jyk7XG4vLyBpdGVyYXRlIHN0eWxlc2hlZXRzXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2Ygc3R5bGVzaGVldHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gc3R5bGVzaGVldHMubGVuZ3RoOyAkaW5kZXggPCAkJGw7ICRpbmRleCsrKSB7XG4gICAgICB2YXIgc3R5bGVzaGVldCA9IHN0eWxlc2hlZXRzWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyB0ZXJzZTogdHJ1ZSwgJ3JlbCc6KCdzdHlsZXNoZWV0JyksICd0eXBlJzooJ3RleHQvY3NzJyksICdocmVmJzooc3R5bGVzaGVldCkgfSwge1wicmVsXCI6dHJ1ZSxcInR5cGVcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciAkaW5kZXggaW4gc3R5bGVzaGVldHMpIHtcbiAgICAgIHZhciBzdHlsZXNoZWV0ID0gc3R5bGVzaGVldHNbJGluZGV4XTtcblxuYnVmLnB1c2goJzxsaW5rJyk7XG5idWYucHVzaChhdHRycyh7IHRlcnNlOiB0cnVlLCAncmVsJzooJ3N0eWxlc2hlZXQnKSwgJ3R5cGUnOigndGV4dC9jc3MnKSwgJ2hyZWYnOihzdHlsZXNoZWV0KSB9LCB7XCJyZWxcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG4gICB9XG4gIH1cbn0pLmNhbGwodGhpcyk7XG5cbmJ1Zi5wdXNoKCc8c2NyaXB0Jyk7XG5idWYucHVzaChhdHRycyh7IHRlcnNlOiB0cnVlLCAndHlwZSc6KCd0ZXh0L2phdmFzY3JpcHQnKSwgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCIvbG9jYWwvaGVhZC0wLjk5LmxvYWQubWluLmpzXCIpIH0sIHtcInR5cGVcIjp0cnVlLFwic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PC9zY3JpcHQ+PHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI+XFxuIHdpbmRvdy5oZWFkanMgPSBoZWFkLmpzXFxuIHdpbmRvdy5lbnYgPSBcXCcnICsgKChpbnRlcnAgPSBlbnYpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnXFwnXFxuIHdpbmRvdy5jYWNoZVVybCA9IFxcJycgKyAoKGludGVycCA9IGNhY2hlVXJsKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJ1xcJztcXG4gd2luZG93LnNpdGVOYW1lID0gXFwnUG93ZXJCdWxsZXRpblxcJztcXG4gd2luZG93LmF1dGhEb21haW4gPSBcXCcnICsgKChpbnRlcnAgPSBhdXRoRG9tYWluKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJ1xcJztcXG4gaGVhZC5qcy5hcHBseShoZWFkLCAnICsgKChpbnRlcnAgPSBKU09OLnN0cmluZ2lmeShzY3JpcHRzKSkgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICcpO1xcbjwvc2NyaXB0PjwvaGVhZD48Ym9keT48L2JvZHk+PC9odG1sPicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJTaXRlUmVnaXN0ZXJcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGgzPlN0YXJ0IGJ5IGNyZWF0aW5nIGEgbmFtZSBub3c8aT4hPC9pPjwvaDM+PGRpdiBjbGFzcz1cInRvb2x0aXAgU2l0ZVJlZ2lzdGVyLWVycm9yc1wiPjwvZGl2Pjxmb3JtIGNsYXNzPVwic2l0ZS1yZWdpc3RlclwiPjxmaWVsZHNldD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOigndGV4dCcpLCAnbmFtZSc6KCdzdWJkb21haW4nKSwgJ3ZhbHVlJzoodHlwZW9mIHN1YmRvbWFpbiAhPSAndW5kZWZpbmVkJyA/IHN1YmRvbWFpbiA6ICcnKSwgJ2F1dG9jb21wbGV0ZSc6KFwib2ZmXCIpLCBcImNsYXNzXCI6ICgnU2l0ZVJlZ2lzdGVyLXN1YmRvbWFpbicpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWUsXCJhdXRvY29tcGxldGVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PHNwYW4gY2xhc3M9XCJob3N0bmFtZVwiPicpO1xudmFyIF9fdmFsX18gPSBob3N0bmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjxzcGFuIGNsYXNzPVwiU2l0ZVJlZ2lzdGVyLWF2YWlsYWJsZVwiPjxkaXYgY2xhc3M9XCJzdWNjZXNzXCI+JiN4MjcxMzs8L2Rpdj48ZGl2IGNsYXNzPVwiZXJyb3JcIj4mI3gyNzE4OzwvZGl2Pjwvc3Bhbj48ZGl2IGNsYXNzPVwiU2l0ZVJlZ2lzdGVyLWNyZWF0ZVwiPjwvZGl2PjwvZmllbGRzZXQ+PC9mb3JtPicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufSIsIihmdW5jdGlvbihnbG9iYWwpey8qIVxuICogTG8tRGFzaCAxLjAuMC1yYy4zIDxodHRwOi8vbG9kYXNoLmNvbT5cbiAqIChjKSAyMDEyIEpvaG4tRGF2aWQgRGFsdG9uIDxodHRwOi8vYWxseW91Y2FubGVldC5jb20vPlxuICogQmFzZWQgb24gVW5kZXJzY29yZS5qcyAxLjQuMyA8aHR0cDovL3VuZGVyc2NvcmVqcy5vcmc+XG4gKiAoYykgMjAwOS0yMDEyIEplcmVteSBBc2hrZW5hcywgRG9jdW1lbnRDbG91ZCBJbmMuXG4gKiBBdmFpbGFibGUgdW5kZXIgTUlUIGxpY2Vuc2UgPGh0dHA6Ly9sb2Rhc2guY29tL2xpY2Vuc2U+XG4gKi9cbjsoZnVuY3Rpb24od2luZG93LCB1bmRlZmluZWQpIHtcblxuICAvKiogRGV0ZWN0IGZyZWUgdmFyaWFibGUgYGV4cG9ydHNgICovXG4gIHZhciBmcmVlRXhwb3J0cyA9IHR5cGVvZiBleHBvcnRzID09ICdvYmplY3QnICYmIGV4cG9ydHM7XG5cbiAgLyoqIERldGVjdCBmcmVlIHZhcmlhYmxlIGBnbG9iYWxgIGFuZCB1c2UgaXQgYXMgYHdpbmRvd2AgKi9cbiAgdmFyIGZyZWVHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGdsb2JhbDtcbiAgaWYgKGZyZWVHbG9iYWwuZ2xvYmFsID09PSBmcmVlR2xvYmFsKSB7XG4gICAgd2luZG93ID0gZnJlZUdsb2JhbDtcbiAgfVxuXG4gIC8qKiBVc2VkIGZvciBhcnJheSBhbmQgb2JqZWN0IG1ldGhvZCByZWZlcmVuY2VzICovXG4gIHZhciBhcnJheVJlZiA9IFtdLFxuICAgICAgLy8gYXZvaWQgYSBDbG9zdXJlIENvbXBpbGVyIGJ1ZyBieSBjcmVhdGl2ZWx5IGNyZWF0aW5nIGFuIG9iamVjdFxuICAgICAgb2JqZWN0UmVmID0gbmV3IGZ1bmN0aW9uKCl7fTtcblxuICAvKiogVXNlZCB0byBnZW5lcmF0ZSB1bmlxdWUgSURzICovXG4gIHZhciBpZENvdW50ZXIgPSAwO1xuXG4gIC8qKiBVc2VkIGludGVybmFsbHkgdG8gaW5kaWNhdGUgdmFyaW91cyB0aGluZ3MgKi9cbiAgdmFyIGluZGljYXRvck9iamVjdCA9IG9iamVjdFJlZjtcblxuICAvKiogVXNlZCBieSBgY2FjaGVkQ29udGFpbnNgIGFzIHRoZSBkZWZhdWx0IHNpemUgd2hlbiBvcHRpbWl6YXRpb25zIGFyZSBlbmFibGVkIGZvciBsYXJnZSBhcnJheXMgKi9cbiAgdmFyIGxhcmdlQXJyYXlTaXplID0gMzA7XG5cbiAgLyoqIFVzZWQgdG8gcmVzdG9yZSB0aGUgb3JpZ2luYWwgYF9gIHJlZmVyZW5jZSBpbiBgbm9Db25mbGljdGAgKi9cbiAgdmFyIG9sZERhc2ggPSB3aW5kb3cuXztcblxuICAvKiogVXNlZCB0byBkZXRlY3QgdGVtcGxhdGUgZGVsaW1pdGVyIHZhbHVlcyB0aGF0IHJlcXVpcmUgYSB3aXRoLXN0YXRlbWVudCAqL1xuICB2YXIgcmVDb21wbGV4RGVsaW1pdGVyID0gL1stPys9IX4qJSZePD58eyhcXC9dfFxcW1xcRHxcXGIoPzpkZWxldGV8aW58aW5zdGFuY2VvZnxuZXd8dHlwZW9mfHZvaWQpXFxiLztcblxuICAvKiogVXNlZCB0byBtYXRjaCBIVE1MIGVudGl0aWVzICovXG4gIHZhciByZUVzY2FwZWRIdG1sID0gLyYoPzphbXB8bHR8Z3R8cXVvdHwjeDI3KTsvZztcblxuICAvKiogVXNlZCB0byBtYXRjaCBlbXB0eSBzdHJpbmcgbGl0ZXJhbHMgaW4gY29tcGlsZWQgdGVtcGxhdGUgc291cmNlICovXG4gIHZhciByZUVtcHR5U3RyaW5nTGVhZGluZyA9IC9cXGJfX3AgXFwrPSAnJzsvZyxcbiAgICAgIHJlRW1wdHlTdHJpbmdNaWRkbGUgPSAvXFxiKF9fcCBcXCs9KSAnJyBcXCsvZyxcbiAgICAgIHJlRW1wdHlTdHJpbmdUcmFpbGluZyA9IC8oX19lXFwoLio/XFwpfFxcYl9fdFxcKSkgXFwrXFxuJyc7L2c7XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggcmVnZXhwIGZsYWdzIGZyb20gdGhlaXIgY29lcmNlZCBzdHJpbmcgdmFsdWVzICovXG4gIHZhciByZUZsYWdzID0gL1xcdyokLztcblxuICAvKiogVXNlZCB0byBpbnNlcnQgdGhlIGRhdGEgb2JqZWN0IHZhcmlhYmxlIGludG8gY29tcGlsZWQgdGVtcGxhdGUgc291cmNlICovXG4gIHZhciByZUluc2VydFZhcmlhYmxlID0gLyg/Ol9fZXxfX3QgPSApXFwoXFxzKig/IVtcXGRcXHNcIiddfHRoaXNcXC4pL2c7XG5cbiAgLyoqIFVzZWQgdG8gZGV0ZWN0IGlmIGEgbWV0aG9kIGlzIG5hdGl2ZSAqL1xuICB2YXIgcmVOYXRpdmUgPSBSZWdFeHAoJ14nICtcbiAgICAob2JqZWN0UmVmLnZhbHVlT2YgKyAnJylcbiAgICAgIC5yZXBsYWNlKC9bLiorP149IToke30oKXxbXFxdXFwvXFxcXF0vZywgJ1xcXFwkJicpXG4gICAgICAucmVwbGFjZSgvdmFsdWVPZnxmb3IgW15cXF1dKy9nLCAnLis/JykgKyAnJCdcbiAgKTtcblxuICAvKipcbiAgICogVXNlZCB0byBtYXRjaCBFUzYgdGVtcGxhdGUgZGVsaW1pdGVyc1xuICAgKiBodHRwOi8vcGVvcGxlLm1vemlsbGEub3JnL35qb3JlbmRvcmZmL2VzNi1kcmFmdC5odG1sI3NlYy03LjguNlxuICAgKi9cbiAgdmFyIHJlRXNUZW1wbGF0ZSA9IC9cXCRcXHsoKD86KD89XFxcXD8pXFxcXD9bXFxzXFxTXSkqPyl9L2c7XG5cbiAgLyoqIFVzZWQgdG8gbWF0Y2ggXCJpbnRlcnBvbGF0ZVwiIHRlbXBsYXRlIGRlbGltaXRlcnMgKi9cbiAgdmFyIHJlSW50ZXJwb2xhdGUgPSAvPCU9KFtcXHNcXFNdKz8pJT4vZztcblxuICAvKiogVXNlZCB0byBlbnN1cmUgY2FwdHVyaW5nIG9yZGVyIG9mIHRlbXBsYXRlIGRlbGltaXRlcnMgKi9cbiAgdmFyIHJlTm9NYXRjaCA9IC8oJF4pLztcblxuICAvKiogVXNlZCB0byBtYXRjaCBIVE1MIGNoYXJhY3RlcnMgKi9cbiAgdmFyIHJlVW5lc2NhcGVkSHRtbCA9IC9bJjw+XCInXS9nO1xuXG4gIC8qKiBVc2VkIHRvIG1hdGNoIHVuZXNjYXBlZCBjaGFyYWN0ZXJzIGluIGNvbXBpbGVkIHN0cmluZyBsaXRlcmFscyAqL1xuICB2YXIgcmVVbmVzY2FwZWRTdHJpbmcgPSAvWydcXG5cXHJcXHRcXHUyMDI4XFx1MjAyOVxcXFxdL2c7XG5cbiAgLyoqIFVzZWQgdG8gZml4IHRoZSBKU2NyaXB0IFtbRG9udEVudW1dXSBidWcgKi9cbiAgdmFyIHNoYWRvd2VkID0gW1xuICAgICdjb25zdHJ1Y3RvcicsICdoYXNPd25Qcm9wZXJ0eScsICdpc1Byb3RvdHlwZU9mJywgJ3Byb3BlcnR5SXNFbnVtZXJhYmxlJyxcbiAgICAndG9Mb2NhbGVTdHJpbmcnLCAndG9TdHJpbmcnLCAndmFsdWVPZidcbiAgXTtcblxuICAvKiogVXNlZCB0byBtYWtlIHRlbXBsYXRlIHNvdXJjZVVSTHMgZWFzaWVyIHRvIGlkZW50aWZ5ICovXG4gIHZhciB0ZW1wbGF0ZUNvdW50ZXIgPSAwO1xuXG4gIC8qKiBOYXRpdmUgbWV0aG9kIHNob3J0Y3V0cyAqL1xuICB2YXIgY2VpbCA9IE1hdGguY2VpbCxcbiAgICAgIGNvbmNhdCA9IGFycmF5UmVmLmNvbmNhdCxcbiAgICAgIGZsb29yID0gTWF0aC5mbG9vcixcbiAgICAgIGdldFByb3RvdHlwZU9mID0gcmVOYXRpdmUudGVzdChnZXRQcm90b3R5cGVPZiA9IE9iamVjdC5nZXRQcm90b3R5cGVPZikgJiYgZ2V0UHJvdG90eXBlT2YsXG4gICAgICBoYXNPd25Qcm9wZXJ0eSA9IG9iamVjdFJlZi5oYXNPd25Qcm9wZXJ0eSxcbiAgICAgIHB1c2ggPSBhcnJheVJlZi5wdXNoLFxuICAgICAgcHJvcGVydHlJc0VudW1lcmFibGUgPSBvYmplY3RSZWYucHJvcGVydHlJc0VudW1lcmFibGUsXG4gICAgICB0b1N0cmluZyA9IG9iamVjdFJlZi50b1N0cmluZztcblxuICAvKiBOYXRpdmUgbWV0aG9kIHNob3J0Y3V0cyBmb3IgbWV0aG9kcyB3aXRoIHRoZSBzYW1lIG5hbWUgYXMgb3RoZXIgYGxvZGFzaGAgbWV0aG9kcyAqL1xuICB2YXIgbmF0aXZlQmluZCA9IHJlTmF0aXZlLnRlc3QobmF0aXZlQmluZCA9IHNsaWNlLmJpbmQpICYmIG5hdGl2ZUJpbmQsXG4gICAgICBuYXRpdmVJc0FycmF5ID0gcmVOYXRpdmUudGVzdChuYXRpdmVJc0FycmF5ID0gQXJyYXkuaXNBcnJheSkgJiYgbmF0aXZlSXNBcnJheSxcbiAgICAgIG5hdGl2ZUlzRmluaXRlID0gd2luZG93LmlzRmluaXRlLFxuICAgICAgbmF0aXZlSXNOYU4gPSB3aW5kb3cuaXNOYU4sXG4gICAgICBuYXRpdmVLZXlzID0gcmVOYXRpdmUudGVzdChuYXRpdmVLZXlzID0gT2JqZWN0LmtleXMpICYmIG5hdGl2ZUtleXMsXG4gICAgICBuYXRpdmVNYXggPSBNYXRoLm1heCxcbiAgICAgIG5hdGl2ZU1pbiA9IE1hdGgubWluLFxuICAgICAgbmF0aXZlUmFuZG9tID0gTWF0aC5yYW5kb207XG5cbiAgLyoqIGBPYmplY3QjdG9TdHJpbmdgIHJlc3VsdCBzaG9ydGN1dHMgKi9cbiAgdmFyIGFyZ3NDbGFzcyA9ICdbb2JqZWN0IEFyZ3VtZW50c10nLFxuICAgICAgYXJyYXlDbGFzcyA9ICdbb2JqZWN0IEFycmF5XScsXG4gICAgICBib29sQ2xhc3MgPSAnW29iamVjdCBCb29sZWFuXScsXG4gICAgICBkYXRlQ2xhc3MgPSAnW29iamVjdCBEYXRlXScsXG4gICAgICBmdW5jQ2xhc3MgPSAnW29iamVjdCBGdW5jdGlvbl0nLFxuICAgICAgbnVtYmVyQ2xhc3MgPSAnW29iamVjdCBOdW1iZXJdJyxcbiAgICAgIG9iamVjdENsYXNzID0gJ1tvYmplY3QgT2JqZWN0XScsXG4gICAgICByZWdleHBDbGFzcyA9ICdbb2JqZWN0IFJlZ0V4cF0nLFxuICAgICAgc3RyaW5nQ2xhc3MgPSAnW29iamVjdCBTdHJpbmddJztcblxuICAvKiogRGV0ZWN0IHZhcmlvdXMgZW52aXJvbm1lbnRzICovXG4gIHZhciBpc0llT3BlcmEgPSAhIXdpbmRvdy5hdHRhY2hFdmVudCxcbiAgICAgIGlzVjggPSBuYXRpdmVCaW5kICYmICEvXFxufHRydWUvLnRlc3QobmF0aXZlQmluZCArIGlzSWVPcGVyYSk7XG5cbiAgLyogRGV0ZWN0IGlmIGBGdW5jdGlvbiNiaW5kYCBleGlzdHMgYW5kIGlzIGluZmVycmVkIHRvIGJlIGZhc3QgKGFsbCBidXQgVjgpICovXG4gIHZhciBpc0JpbmRGYXN0ID0gbmF0aXZlQmluZCAmJiAhaXNWODtcblxuICAvKiBEZXRlY3QgaWYgYE9iamVjdC5rZXlzYCBleGlzdHMgYW5kIGlzIGluZmVycmVkIHRvIGJlIGZhc3QgKElFLCBPcGVyYSwgVjgpICovXG4gIHZhciBpc0tleXNGYXN0ID0gbmF0aXZlS2V5cyAmJiAoaXNJZU9wZXJhIHx8IGlzVjgpO1xuXG4gIC8qKlxuICAgKiBEZXRlY3QgdGhlIEpTY3JpcHQgW1tEb250RW51bV1dIGJ1ZzpcbiAgICpcbiAgICogSW4gSUUgPCA5IGFuIG9iamVjdHMgb3duIHByb3BlcnRpZXMsIHNoYWRvd2luZyBub24tZW51bWVyYWJsZSBvbmVzLCBhcmVcbiAgICogbWFkZSBub24tZW51bWVyYWJsZSBhcyB3ZWxsLlxuICAgKi9cbiAgdmFyIGhhc0RvbnRFbnVtQnVnO1xuXG4gIC8qKiBEZXRlY3QgaWYgb3duIHByb3BlcnRpZXMgYXJlIGl0ZXJhdGVkIGFmdGVyIGluaGVyaXRlZCBwcm9wZXJ0aWVzIChJRSA8IDkpICovXG4gIHZhciBpdGVyYXRlc093bkxhc3Q7XG5cbiAgLyoqXG4gICAqIERldGVjdCBpZiBgQXJyYXkjc2hpZnRgIGFuZCBgQXJyYXkjc3BsaWNlYCBhdWdtZW50IGFycmF5LWxpa2Ugb2JqZWN0c1xuICAgKiBpbmNvcnJlY3RseTpcbiAgICpcbiAgICogRmlyZWZveCA8IDEwLCBJRSBjb21wYXRpYmlsaXR5IG1vZGUsIGFuZCBJRSA8IDkgaGF2ZSBidWdneSBBcnJheSBgc2hpZnQoKWBcbiAgICogYW5kIGBzcGxpY2UoKWAgZnVuY3Rpb25zIHRoYXQgZmFpbCB0byByZW1vdmUgdGhlIGxhc3QgZWxlbWVudCwgYHZhbHVlWzBdYCxcbiAgICogb2YgYXJyYXktbGlrZSBvYmplY3RzIGV2ZW4gdGhvdWdoIHRoZSBgbGVuZ3RoYCBwcm9wZXJ0eSBpcyBzZXQgdG8gYDBgLlxuICAgKiBUaGUgYHNoaWZ0KClgIG1ldGhvZCBpcyBidWdneSBpbiBJRSA4IGNvbXBhdGliaWxpdHkgbW9kZSwgd2hpbGUgYHNwbGljZSgpYFxuICAgKiBpcyBidWdneSByZWdhcmRsZXNzIG9mIG1vZGUgaW4gSUUgPCA5IGFuZCBidWdneSBpbiBjb21wYXRpYmlsaXR5IG1vZGUgaW4gSUUgOS5cbiAgICovXG4gIHZhciBoYXNPYmplY3RTcGxpY2VCdWcgPSAoaGFzT2JqZWN0U3BsaWNlQnVnID0geyAnMCc6IDEsICdsZW5ndGgnOiAxIH0sXG4gICAgYXJyYXlSZWYuc3BsaWNlLmNhbGwoaGFzT2JqZWN0U3BsaWNlQnVnLCAwLCAxKSwgaGFzT2JqZWN0U3BsaWNlQnVnWzBdKTtcblxuICAvKiogRGV0ZWN0IGlmIGFuIGBhcmd1bWVudHNgIG9iamVjdCdzIGluZGV4ZXMgYXJlIG5vbi1lbnVtZXJhYmxlIChJRSA8IDkpICovXG4gIHZhciBub25FbnVtQXJncyA9IHRydWU7XG5cbiAgKGZ1bmN0aW9uKCkge1xuICAgIHZhciBwcm9wcyA9IFtdO1xuICAgIGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMueCA9IDE7IH1cbiAgICBjdG9yLnByb3RvdHlwZSA9IHsgJ3ZhbHVlT2YnOiAxLCAneSc6IDEgfTtcbiAgICBmb3IgKHZhciBwcm9wIGluIG5ldyBjdG9yKSB7IHByb3BzLnB1c2gocHJvcCk7IH1cbiAgICBmb3IgKHByb3AgaW4gYXJndW1lbnRzKSB7IG5vbkVudW1BcmdzID0gIXByb3A7IH1cblxuICAgIGhhc0RvbnRFbnVtQnVnID0gIS92YWx1ZU9mLy50ZXN0KHByb3BzKTtcbiAgICBpdGVyYXRlc093bkxhc3QgPSBwcm9wc1swXSAhPSAneCc7XG4gIH0oMSkpO1xuXG4gIC8qKiBEZXRlY3QgaWYgYGFyZ3VtZW50c2Agb2JqZWN0cyBhcmUgYE9iamVjdGAgb2JqZWN0cyAoYWxsIGJ1dCBPcGVyYSA8IDEwLjUpICovXG4gIHZhciBhcmdzQXJlT2JqZWN0cyA9IGFyZ3VtZW50cy5jb25zdHJ1Y3RvciA9PSBPYmplY3Q7XG5cbiAgLyoqIERldGVjdCBpZiBgYXJndW1lbnRzYCBvYmplY3RzIFtbQ2xhc3NdXSBpcyB1bnJlc29sdmFibGUgKEZpcmVmb3ggPCA0LCBJRSA8IDkpICovXG4gIHZhciBub0FyZ3NDbGFzcyA9ICFpc0FyZ3VtZW50cyhhcmd1bWVudHMpO1xuXG4gIC8qKlxuICAgKiBEZXRlY3QgbGFjayBvZiBzdXBwb3J0IGZvciBhY2Nlc3Npbmcgc3RyaW5nIGNoYXJhY3RlcnMgYnkgaW5kZXg6XG4gICAqXG4gICAqIElFIDwgOCBjYW4ndCBhY2Nlc3MgY2hhcmFjdGVycyBieSBpbmRleCBhbmQgSUUgOCBjYW4gb25seSBhY2Nlc3NcbiAgICogY2hhcmFjdGVycyBieSBpbmRleCBvbiBzdHJpbmcgbGl0ZXJhbHMuXG4gICAqL1xuICB2YXIgbm9DaGFyQnlJbmRleCA9ICgneCdbMF0gKyBPYmplY3QoJ3gnKVswXSkgIT0gJ3h4JztcblxuICAvKipcbiAgICogRGV0ZWN0IGlmIGEgbm9kZSdzIFtbQ2xhc3NdXSBpcyB1bnJlc29sdmFibGUgKElFIDwgOSlcbiAgICogYW5kIHRoYXQgdGhlIEpTIGVuZ2luZSB3b24ndCBlcnJvciB3aGVuIGF0dGVtcHRpbmcgdG8gY29lcmNlIGFuIG9iamVjdCB0b1xuICAgKiBhIHN0cmluZyB3aXRob3V0IGEgYHRvU3RyaW5nYCBwcm9wZXJ0eSB2YWx1ZSBvZiBgdHlwZW9mYCBcImZ1bmN0aW9uXCIuXG4gICAqL1xuICB0cnkge1xuICAgIHZhciBub05vZGVDbGFzcyA9ICh7ICd0b1N0cmluZyc6IDAgfSArICcnLCB0b1N0cmluZy5jYWxsKGRvY3VtZW50KSA9PSBvYmplY3RDbGFzcyk7XG4gIH0gY2F0Y2goZSkgeyB9XG5cbiAgLyoqXG4gICAqIERldGVjdCBpZiBzb3VyY2VVUkwgc3ludGF4IGlzIHVzYWJsZSB3aXRob3V0IGVycm9yaW5nOlxuICAgKlxuICAgKiBUaGUgSlMgZW5naW5lIGVtYmVkZGVkIGluIEFkb2JlIHByb2R1Y3RzIHdpbGwgdGhyb3cgYSBzeW50YXggZXJyb3Igd2hlblxuICAgKiBpdCBlbmNvdW50ZXJzIGEgc2luZ2xlIGxpbmUgY29tbWVudCBiZWdpbm5pbmcgd2l0aCB0aGUgYEBgIHN5bWJvbC5cbiAgICpcbiAgICogVGhlIEpTIGVuZ2luZSBpbiBOYXJ3aGFsIHdpbGwgZ2VuZXJhdGUgdGhlIGZ1bmN0aW9uIGBmdW5jdGlvbiBhbm9ueW1vdXMoKXsvL31gXG4gICAqIGFuZCB0aHJvdyBhIHN5bnRheCBlcnJvci5cbiAgICpcbiAgICogQXZvaWQgY29tbWVudHMgYmVnaW5uaW5nIGBAYCBzeW1ib2xzIGluIElFIGJlY2F1c2UgdGhleSBhcmUgcGFydCBvZiBpdHNcbiAgICogbm9uLXN0YW5kYXJkIGNvbmRpdGlvbmFsIGNvbXBpbGF0aW9uIHN1cHBvcnQuXG4gICAqIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS8xMjFoenRrMyh2PXZzLjk0KS5hc3B4XG4gICAqL1xuICB0cnkge1xuICAgIHZhciB1c2VTb3VyY2VVUkwgPSAoRnVuY3Rpb24oJy8vQCcpKCksICFpc0llT3BlcmEpO1xuICB9IGNhdGNoKGUpIHsgfVxuXG4gIC8qKiBVc2VkIHRvIGlkZW50aWZ5IG9iamVjdCBjbGFzc2lmaWNhdGlvbnMgdGhhdCBgXy5jbG9uZWAgc3VwcG9ydHMgKi9cbiAgdmFyIGNsb25lYWJsZUNsYXNzZXMgPSB7fTtcbiAgY2xvbmVhYmxlQ2xhc3Nlc1tmdW5jQ2xhc3NdID0gZmFsc2U7XG4gIGNsb25lYWJsZUNsYXNzZXNbYXJnc0NsYXNzXSA9IGNsb25lYWJsZUNsYXNzZXNbYXJyYXlDbGFzc10gPVxuICBjbG9uZWFibGVDbGFzc2VzW2Jvb2xDbGFzc10gPSBjbG9uZWFibGVDbGFzc2VzW2RhdGVDbGFzc10gPVxuICBjbG9uZWFibGVDbGFzc2VzW251bWJlckNsYXNzXSA9IGNsb25lYWJsZUNsYXNzZXNbb2JqZWN0Q2xhc3NdID1cbiAgY2xvbmVhYmxlQ2xhc3Nlc1tyZWdleHBDbGFzc10gPSBjbG9uZWFibGVDbGFzc2VzW3N0cmluZ0NsYXNzXSA9IHRydWU7XG5cbiAgLyoqIFVzZWQgdG8gbG9va3VwIGEgYnVpbHQtaW4gY29uc3RydWN0b3IgYnkgW1tDbGFzc11dICovXG4gIHZhciBjdG9yQnlDbGFzcyA9IHt9O1xuICBjdG9yQnlDbGFzc1thcnJheUNsYXNzXSA9IEFycmF5O1xuICBjdG9yQnlDbGFzc1tib29sQ2xhc3NdID0gQm9vbGVhbjtcbiAgY3RvckJ5Q2xhc3NbZGF0ZUNsYXNzXSA9IERhdGU7XG4gIGN0b3JCeUNsYXNzW29iamVjdENsYXNzXSA9IE9iamVjdDtcbiAgY3RvckJ5Q2xhc3NbbnVtYmVyQ2xhc3NdID0gTnVtYmVyO1xuICBjdG9yQnlDbGFzc1tyZWdleHBDbGFzc10gPSBSZWdFeHA7XG4gIGN0b3JCeUNsYXNzW3N0cmluZ0NsYXNzXSA9IFN0cmluZztcblxuICAvKiogVXNlZCB0byBkZXRlcm1pbmUgaWYgdmFsdWVzIGFyZSBvZiB0aGUgbGFuZ3VhZ2UgdHlwZSBPYmplY3QgKi9cbiAgdmFyIG9iamVjdFR5cGVzID0ge1xuICAgICdib29sZWFuJzogZmFsc2UsXG4gICAgJ2Z1bmN0aW9uJzogdHJ1ZSxcbiAgICAnb2JqZWN0JzogdHJ1ZSxcbiAgICAnbnVtYmVyJzogZmFsc2UsXG4gICAgJ3N0cmluZyc6IGZhbHNlLFxuICAgICd1bmRlZmluZWQnOiBmYWxzZVxuICB9O1xuXG4gIC8qKiBVc2VkIHRvIGVzY2FwZSBjaGFyYWN0ZXJzIGZvciBpbmNsdXNpb24gaW4gY29tcGlsZWQgc3RyaW5nIGxpdGVyYWxzICovXG4gIHZhciBzdHJpbmdFc2NhcGVzID0ge1xuICAgICdcXFxcJzogJ1xcXFwnLFxuICAgIFwiJ1wiOiBcIidcIixcbiAgICAnXFxuJzogJ24nLFxuICAgICdcXHInOiAncicsXG4gICAgJ1xcdCc6ICd0JyxcbiAgICAnXFx1MjAyOCc6ICd1MjAyOCcsXG4gICAgJ1xcdTIwMjknOiAndTIwMjknXG4gIH07XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBgbG9kYXNoYCBvYmplY3QsIHRoYXQgd3JhcHMgdGhlIGdpdmVuIGB2YWx1ZWAsIHRvIGVuYWJsZVxuICAgKiBtZXRob2QgY2hhaW5pbmcuXG4gICAqXG4gICAqIFRoZSBjaGFpbmFibGUgd3JhcHBlciBmdW5jdGlvbnMgYXJlOlxuICAgKiBgYWZ0ZXJgLCBgYXNzaWduYCwgYGJpbmRgLCBgYmluZEFsbGAsIGBiaW5kS2V5YCwgYGNoYWluYCwgYGNvbXBhY3RgLCBgY29tcG9zZWAsXG4gICAqIGBjb25jYXRgLCBgY291bnRCeWAsIGBkZWJvdW5jZWAsIGBkZWZhdWx0c2AsIGBkZWZlcmAsIGBkZWxheWAsIGBkaWZmZXJlbmNlYCxcbiAgICogYGZpbHRlcmAsIGBmbGF0dGVuYCwgYGZvckVhY2hgLCBgZm9ySW5gLCBgZm9yT3duYCwgYGZ1bmN0aW9uc2AsIGBncm91cEJ5YCxcbiAgICogYGluaXRpYWxgLCBgaW50ZXJzZWN0aW9uYCwgYGludmVydGAsIGBpbnZva2VgLCBga2V5c2AsIGBtYXBgLCBgbWF4YCwgYG1lbW9pemVgLFxuICAgKiBgbWVyZ2VgLCBgbWluYCwgYG9iamVjdGAsIGBvbWl0YCwgYG9uY2VgLCBgcGFpcnNgLCBgcGFydGlhbGAsIGBwaWNrYCwgYHBsdWNrYCxcbiAgICogYHB1c2hgLCBgcmFuZ2VgLCBgcmVqZWN0YCwgYHJlc3RgLCBgcmV2ZXJzZWAsIGBzaHVmZmxlYCwgYHNsaWNlYCwgYHNvcnRgLFxuICAgKiBgc29ydEJ5YCwgYHNwbGljZWAsIGB0YXBgLCBgdGhyb3R0bGVgLCBgdGltZXNgLCBgdG9BcnJheWAsIGB1bmlvbmAsIGB1bmlxYCxcbiAgICogYHVuc2hpZnRgLCBgdmFsdWVzYCwgYHdoZXJlYCwgYHdpdGhvdXRgLCBgd3JhcGAsIGFuZCBgemlwYFxuICAgKlxuICAgKiBUaGUgbm9uLWNoYWluYWJsZSB3cmFwcGVyIGZ1bmN0aW9ucyBhcmU6XG4gICAqIGBjbG9uZWAsIGBjbG9uZURlZXBgLCBgY29udGFpbnNgLCBgZXNjYXBlYCwgYGV2ZXJ5YCwgYGZpbmRgLCBgaGFzYCwgYGlkZW50aXR5YCxcbiAgICogYGluZGV4T2ZgLCBgaXNBcmd1bWVudHNgLCBgaXNBcnJheWAsIGBpc0Jvb2xlYW5gLCBgaXNEYXRlYCwgYGlzRWxlbWVudGAsIGBpc0VtcHR5YCxcbiAgICogYGlzRXF1YWxgLCBgaXNGaW5pdGVgLCBgaXNGdW5jdGlvbmAsIGBpc05hTmAsIGBpc051bGxgLCBgaXNOdW1iZXJgLCBgaXNPYmplY3RgLFxuICAgKiBgaXNQbGFpbk9iamVjdGAsIGBpc1JlZ0V4cGAsIGBpc1N0cmluZ2AsIGBpc1VuZGVmaW5lZGAsIGBqb2luYCwgYGxhc3RJbmRleE9mYCxcbiAgICogYG1peGluYCwgYG5vQ29uZmxpY3RgLCBgcG9wYCwgYHJhbmRvbWAsIGByZWR1Y2VgLCBgcmVkdWNlUmlnaHRgLCBgcmVzdWx0YCxcbiAgICogYHNoaWZ0YCwgYHNpemVgLCBgc29tZWAsIGBzb3J0ZWRJbmRleGAsIGB0ZW1wbGF0ZWAsIGB1bmVzY2FwZWAsIGFuZCBgdW5pcXVlSWRgXG4gICAqXG4gICAqIFRoZSB3cmFwcGVyIGZ1bmN0aW9ucyBgZmlyc3RgIGFuZCBgbGFzdGAgcmV0dXJuIHdyYXBwZWQgdmFsdWVzIHdoZW4gYG5gIGlzXG4gICAqIHBhc3NlZCwgb3RoZXJ3aXNlIHRoZXkgcmV0dXJuIHVud3JhcHBlZCB2YWx1ZXMuXG4gICAqXG4gICAqIEBuYW1lIF9cbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBjYXRlZ29yeSBDaGFpbmluZ1xuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gd3JhcCBpbiBhIGBsb2Rhc2hgIGluc3RhbmNlLlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGEgYGxvZGFzaGAgaW5zdGFuY2UuXG4gICAqL1xuICBmdW5jdGlvbiBsb2Rhc2godmFsdWUpIHtcbiAgICAvLyBleGl0IGVhcmx5IGlmIGFscmVhZHkgd3JhcHBlZCwgZXZlbiBpZiB3cmFwcGVkIGJ5IGEgZGlmZmVyZW50IGBsb2Rhc2hgIGNvbnN0cnVjdG9yXG4gICAgaWYgKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JyAmJiB2YWx1ZS5fX3dyYXBwZWRfXykge1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICAvLyBhbGxvdyBpbnZva2luZyBgbG9kYXNoYCB3aXRob3V0IHRoZSBgbmV3YCBvcGVyYXRvclxuICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBsb2Rhc2gpKSB7XG4gICAgICByZXR1cm4gbmV3IGxvZGFzaCh2YWx1ZSk7XG4gICAgfVxuICAgIHRoaXMuX193cmFwcGVkX18gPSB2YWx1ZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCeSBkZWZhdWx0LCB0aGUgdGVtcGxhdGUgZGVsaW1pdGVycyB1c2VkIGJ5IExvLURhc2ggYXJlIHNpbWlsYXIgdG8gdGhvc2UgaW5cbiAgICogZW1iZWRkZWQgUnVieSAoRVJCKS4gQ2hhbmdlIHRoZSBmb2xsb3dpbmcgdGVtcGxhdGUgc2V0dGluZ3MgdG8gdXNlIGFsdGVybmF0aXZlXG4gICAqIGRlbGltaXRlcnMuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQHR5cGUgT2JqZWN0XG4gICAqL1xuICBsb2Rhc2gudGVtcGxhdGVTZXR0aW5ncyA9IHtcblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZGV0ZWN0IGBkYXRhYCBwcm9wZXJ0eSB2YWx1ZXMgdG8gYmUgSFRNTC1lc2NhcGVkLlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3NcbiAgICAgKiBAdHlwZSBSZWdFeHBcbiAgICAgKi9cbiAgICAnZXNjYXBlJzogLzwlLShbXFxzXFxTXSs/KSU+L2csXG5cbiAgICAvKipcbiAgICAgKiBVc2VkIHRvIGRldGVjdCBjb2RlIHRvIGJlIGV2YWx1YXRlZC5cbiAgICAgKlxuICAgICAqIEBzdGF0aWNcbiAgICAgKiBAbWVtYmVyT2YgXy50ZW1wbGF0ZVNldHRpbmdzXG4gICAgICogQHR5cGUgUmVnRXhwXG4gICAgICovXG4gICAgJ2V2YWx1YXRlJzogLzwlKFtcXHNcXFNdKz8pJT4vZyxcblxuICAgIC8qKlxuICAgICAqIFVzZWQgdG8gZGV0ZWN0IGBkYXRhYCBwcm9wZXJ0eSB2YWx1ZXMgdG8gaW5qZWN0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3NcbiAgICAgKiBAdHlwZSBSZWdFeHBcbiAgICAgKi9cbiAgICAnaW50ZXJwb2xhdGUnOiByZUludGVycG9sYXRlLFxuXG4gICAgLyoqXG4gICAgICogVXNlZCB0byByZWZlcmVuY2UgdGhlIGRhdGEgb2JqZWN0IGluIHRoZSB0ZW1wbGF0ZSB0ZXh0LlxuICAgICAqXG4gICAgICogQHN0YXRpY1xuICAgICAqIEBtZW1iZXJPZiBfLnRlbXBsYXRlU2V0dGluZ3NcbiAgICAgKiBAdHlwZSBTdHJpbmdcbiAgICAgKi9cbiAgICAndmFyaWFibGUnOiAnJ1xuICB9O1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8qKlxuICAgKiBUaGUgdGVtcGxhdGUgdXNlZCB0byBjcmVhdGUgaXRlcmF0b3IgZnVuY3Rpb25zLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iZWN0fSBkYXRhIFRoZSBkYXRhIG9iamVjdCB1c2VkIHRvIHBvcHVsYXRlIHRoZSB0ZXh0LlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBSZXR1cm5zIHRoZSBpbnRlcnBvbGF0ZWQgdGV4dC5cbiAgICovXG4gIHZhciBpdGVyYXRvclRlbXBsYXRlID0gdGVtcGxhdGUoXG4gICAgLy8gY29uZGl0aW9uYWwgc3RyaWN0IG1vZGVcbiAgICBcIjwlIGlmIChvYmoudXNlU3RyaWN0KSB7ICU+J3VzZSBzdHJpY3QnO1xcbjwlIH0gJT5cIiArXG5cbiAgICAvLyB0aGUgYGl0ZXJhdGVlYCBtYXkgYmUgcmVhc3NpZ25lZCBieSB0aGUgYHRvcGAgc25pcHBldFxuICAgICd2YXIgaW5kZXgsIGl0ZXJhdGVlID0gPCU9IGZpcnN0QXJnICU+LCAnICtcbiAgICAvLyBhc3NpZ24gdGhlIGByZXN1bHRgIHZhcmlhYmxlIGFuIGluaXRpYWwgdmFsdWVcbiAgICAncmVzdWx0ID0gPCU9IGZpcnN0QXJnICU+O1xcbicgK1xuICAgIC8vIGV4aXQgZWFybHkgaWYgdGhlIGZpcnN0IGFyZ3VtZW50IGlzIGZhbHNleVxuICAgICdpZiAoITwlPSBmaXJzdEFyZyAlPikgcmV0dXJuIHJlc3VsdDtcXG4nICtcbiAgICAvLyBhZGQgY29kZSBiZWZvcmUgdGhlIGl0ZXJhdGlvbiBicmFuY2hlc1xuICAgICc8JT0gdG9wICU+O1xcbicgK1xuXG4gICAgLy8gYXJyYXktbGlrZSBpdGVyYXRpb246XG4gICAgJzwlIGlmIChhcnJheUxvb3ApIHsgJT4nICtcbiAgICAndmFyIGxlbmd0aCA9IGl0ZXJhdGVlLmxlbmd0aDsgaW5kZXggPSAtMTtcXG4nICtcbiAgICBcImlmICh0eXBlb2YgbGVuZ3RoID09ICdudW1iZXInKSB7XCIgK1xuXG4gICAgLy8gYWRkIHN1cHBvcnQgZm9yIGFjY2Vzc2luZyBzdHJpbmcgY2hhcmFjdGVycyBieSBpbmRleCBpZiBuZWVkZWRcbiAgICAnICA8JSBpZiAobm9DaGFyQnlJbmRleCkgeyAlPlxcbicgK1xuICAgICcgIGlmIChpc1N0cmluZyhpdGVyYXRlZSkpIHtcXG4nICtcbiAgICBcIiAgICBpdGVyYXRlZSA9IGl0ZXJhdGVlLnNwbGl0KCcnKVxcblwiICtcbiAgICAnICB9JyArXG4gICAgJyAgPCUgfSAlPlxcbicgK1xuXG4gICAgLy8gaXRlcmF0ZSBvdmVyIHRoZSBhcnJheS1saWtlIHZhbHVlXG4gICAgJyAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcXG4nICtcbiAgICAnICAgIDwlPSBhcnJheUxvb3AgJT5cXG4nICtcbiAgICAnICB9XFxuJyArXG4gICAgJ31cXG4nICtcbiAgICAnZWxzZSB7JyArXG5cbiAgICAvLyBvYmplY3QgaXRlcmF0aW9uOlxuICAgIC8vIGFkZCBzdXBwb3J0IGZvciBpdGVyYXRpbmcgb3ZlciBgYXJndW1lbnRzYCBvYmplY3RzIGlmIG5lZWRlZFxuICAgICcgIDwlICB9IGVsc2UgaWYgKG5vbkVudW1BcmdzKSB7ICU+XFxuJyArXG4gICAgJyAgdmFyIGxlbmd0aCA9IGl0ZXJhdGVlLmxlbmd0aDsgaW5kZXggPSAtMTtcXG4nICtcbiAgICAnICBpZiAobGVuZ3RoICYmIGlzQXJndW1lbnRzKGl0ZXJhdGVlKSkge1xcbicgK1xuICAgICcgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcXG4nICtcbiAgICBcIiAgICAgIGluZGV4ICs9ICcnO1xcblwiICtcbiAgICAnICAgICAgPCU9IG9iamVjdExvb3AgJT5cXG4nICtcbiAgICAnICAgIH1cXG4nICtcbiAgICAnICB9IGVsc2UgeycgK1xuICAgICcgIDwlIH0gJT4nICtcblxuICAgIC8vIEZpcmVmb3ggPCAzLjYsIE9wZXJhID4gOS41MCAtIE9wZXJhIDwgMTEuNjAsIGFuZCBTYWZhcmkgPCA1LjFcbiAgICAvLyAoaWYgdGhlIHByb3RvdHlwZSBvciBhIHByb3BlcnR5IG9uIHRoZSBwcm90b3R5cGUgaGFzIGJlZW4gc2V0KVxuICAgIC8vIGluY29ycmVjdGx5IHNldHMgYSBmdW5jdGlvbidzIGBwcm90b3R5cGVgIHByb3BlcnR5IFtbRW51bWVyYWJsZV1dXG4gICAgLy8gdmFsdWUgdG8gYHRydWVgLiBCZWNhdXNlIG9mIHRoaXMgTG8tRGFzaCBzdGFuZGFyZGl6ZXMgb24gc2tpcHBpbmdcbiAgICAvLyB0aGUgdGhlIGBwcm90b3R5cGVgIHByb3BlcnR5IG9mIGZ1bmN0aW9ucyByZWdhcmRsZXNzIG9mIGl0c1xuICAgIC8vIFtbRW51bWVyYWJsZV1dIHZhbHVlLlxuICAgICcgIDwlIGlmICghaGFzRG9udEVudW1CdWcpIHsgJT5cXG4nICtcbiAgICBcIiAgdmFyIHNraXBQcm90byA9IHR5cGVvZiBpdGVyYXRlZSA9PSAnZnVuY3Rpb24nICYmIFxcblwiICtcbiAgICBcIiAgICBwcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGl0ZXJhdGVlLCAncHJvdG90eXBlJyk7XFxuXCIgK1xuICAgICcgIDwlIH0gJT4nICtcblxuICAgIC8vIGl0ZXJhdGUgb3duIHByb3BlcnRpZXMgdXNpbmcgYE9iamVjdC5rZXlzYCBpZiBpdCdzIGZhc3RcbiAgICAnICA8JSBpZiAoaXNLZXlzRmFzdCAmJiB1c2VIYXMpIHsgJT5cXG4nICtcbiAgICAnICB2YXIgb3duSW5kZXggPSAtMSxcXG4nICtcbiAgICAnICAgICAgb3duUHJvcHMgPSBvYmplY3RUeXBlc1t0eXBlb2YgaXRlcmF0ZWVdID8gbmF0aXZlS2V5cyhpdGVyYXRlZSkgOiBbXSxcXG4nICtcbiAgICAnICAgICAgbGVuZ3RoID0gb3duUHJvcHMubGVuZ3RoO1xcblxcbicgK1xuICAgICcgIHdoaWxlICgrK293bkluZGV4IDwgbGVuZ3RoKSB7XFxuJyArXG4gICAgJyAgICBpbmRleCA9IG93blByb3BzW293bkluZGV4XTtcXG4nICtcbiAgICBcIiAgICA8JSBpZiAoIWhhc0RvbnRFbnVtQnVnKSB7ICU+aWYgKCEoc2tpcFByb3RvICYmIGluZGV4ID09ICdwcm90b3R5cGUnKSkge1xcbiAgPCUgfSAlPlwiICtcbiAgICAnICAgIDwlPSBvYmplY3RMb29wICU+XFxuJyArXG4gICAgJyAgICA8JSBpZiAoIWhhc0RvbnRFbnVtQnVnKSB7ICU+fVxcbjwlIH0gJT4nICtcbiAgICAnICB9JyArXG5cbiAgICAvLyBlbHNlIHVzaW5nIGEgZm9yLWluIGxvb3BcbiAgICAnICA8JSB9IGVsc2UgeyAlPlxcbicgK1xuICAgICcgIGZvciAoaW5kZXggaW4gaXRlcmF0ZWUpIHs8JScgK1xuICAgICcgICAgaWYgKCFoYXNEb250RW51bUJ1ZyB8fCB1c2VIYXMpIHsgJT5cXG4gICAgaWYgKDwlJyArXG4gICAgXCIgICAgICBpZiAoIWhhc0RvbnRFbnVtQnVnKSB7ICU+IShza2lwUHJvdG8gJiYgaW5kZXggPT0gJ3Byb3RvdHlwZScpPCUgfVwiICtcbiAgICAnICAgICAgaWYgKCFoYXNEb250RW51bUJ1ZyAmJiB1c2VIYXMpIHsgJT4gJiYgPCUgfScgK1xuICAgICcgICAgICBpZiAodXNlSGFzKSB7ICU+aGFzT3duUHJvcGVydHkuY2FsbChpdGVyYXRlZSwgaW5kZXgpPCUgfScgK1xuICAgICcgICAgJT4pIHsnICtcbiAgICAnICAgIDwlIH0gJT5cXG4nICtcbiAgICAnICAgIDwlPSBvYmplY3RMb29wICU+OycgK1xuICAgICcgICAgPCUgaWYgKCFoYXNEb250RW51bUJ1ZyB8fCB1c2VIYXMpIHsgJT5cXG4gICAgfTwlIH0gJT5cXG4nICtcbiAgICAnICB9JyArXG4gICAgJyAgPCUgfSAlPicgK1xuXG4gICAgLy8gQmVjYXVzZSBJRSA8IDkgY2FuJ3Qgc2V0IHRoZSBgW1tFbnVtZXJhYmxlXV1gIGF0dHJpYnV0ZSBvZiBhblxuICAgIC8vIGV4aXN0aW5nIHByb3BlcnR5IGFuZCB0aGUgYGNvbnN0cnVjdG9yYCBwcm9wZXJ0eSBvZiBhIHByb3RvdHlwZVxuICAgIC8vIGRlZmF1bHRzIHRvIG5vbi1lbnVtZXJhYmxlLCBMby1EYXNoIHNraXBzIHRoZSBgY29uc3RydWN0b3JgXG4gICAgLy8gcHJvcGVydHkgd2hlbiBpdCBpbmZlcnMgaXQncyBpdGVyYXRpbmcgb3ZlciBhIGBwcm90b3R5cGVgIG9iamVjdC5cbiAgICAnICA8JSBpZiAoaGFzRG9udEVudW1CdWcpIHsgJT5cXG5cXG4nICtcbiAgICAnICB2YXIgY3RvciA9IGl0ZXJhdGVlLmNvbnN0cnVjdG9yO1xcbicgK1xuICAgICcgICAgPCUgZm9yICh2YXIgayA9IDA7IGsgPCA3OyBrKyspIHsgJT5cXG4nICtcbiAgICBcIiAgaW5kZXggPSAnPCU9IHNoYWRvd2VkW2tdICU+JztcXG5cIiArXG4gICAgJyAgaWYgKDwlJyArXG4gICAgXCIgICAgICBpZiAoc2hhZG93ZWRba10gPT0gJ2NvbnN0cnVjdG9yJykge1wiICtcbiAgICAnICAgICAgICAlPiEoY3RvciAmJiBjdG9yLnByb3RvdHlwZSA9PT0gaXRlcmF0ZWUpICYmIDwlJyArXG4gICAgJyAgICAgIH0gJT5oYXNPd25Qcm9wZXJ0eS5jYWxsKGl0ZXJhdGVlLCBpbmRleCkpIHtcXG4nICtcbiAgICAnICAgIDwlPSBvYmplY3RMb29wICU+XFxuJyArXG4gICAgJyAgfScgK1xuICAgICcgICAgPCUgfSAlPicgK1xuICAgICcgIDwlIH0gJT4nICtcbiAgICAnICA8JSBpZiAoYXJyYXlMb29wIHx8IG5vbkVudW1BcmdzKSB7ICU+XFxufTwlIH0gJT5cXG4nICtcblxuICAgIC8vIGFkZCBjb2RlIHRvIHRoZSBib3R0b20gb2YgdGhlIGl0ZXJhdGlvbiBmdW5jdGlvblxuICAgICc8JT0gYm90dG9tICU+O1xcbicgK1xuICAgIC8vIGZpbmFsbHksIHJldHVybiB0aGUgYHJlc3VsdGBcbiAgICAncmV0dXJuIHJlc3VsdCdcbiAgKTtcblxuICAvKiogUmV1c2FibGUgaXRlcmF0b3Igb3B0aW9ucyBmb3IgYGFzc2lnbmAgYW5kIGBkZWZhdWx0c2AgKi9cbiAgdmFyIGFzc2lnbkl0ZXJhdG9yT3B0aW9ucyA9IHtcbiAgICAnYXJncyc6ICdvYmplY3QsIHNvdXJjZSwgZ3VhcmQnLFxuICAgICd0b3AnOlxuICAgICAgXCJmb3IgKHZhciBhcmdzSW5kZXggPSAxLCBhcmdzTGVuZ3RoID0gdHlwZW9mIGd1YXJkID09ICdudW1iZXInID8gMiA6IGFyZ3VtZW50cy5sZW5ndGg7IGFyZ3NJbmRleCA8IGFyZ3NMZW5ndGg7IGFyZ3NJbmRleCsrKSB7XFxuXCIgK1xuICAgICAgJyAgaWYgKChpdGVyYXRlZSA9IGFyZ3VtZW50c1thcmdzSW5kZXhdKSkgeycsXG4gICAgJ29iamVjdExvb3AnOiAncmVzdWx0W2luZGV4XSA9IGl0ZXJhdGVlW2luZGV4XScsXG4gICAgJ2JvdHRvbSc6ICcgIH1cXG59J1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXVzYWJsZSBpdGVyYXRvciBvcHRpb25zIHNoYXJlZCBieSBgZWFjaGAsIGBmb3JJbmAsIGFuZCBgZm9yT3duYC5cbiAgICovXG4gIHZhciBlYWNoSXRlcmF0b3JPcHRpb25zID0ge1xuICAgICdhcmdzJzogJ2NvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnJyxcbiAgICAndG9wJzogXCJjYWxsYmFjayA9IGNhbGxiYWNrICYmIHR5cGVvZiB0aGlzQXJnID09ICd1bmRlZmluZWQnID8gY2FsbGJhY2sgOiBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZylcIixcbiAgICAnYXJyYXlMb29wJzogJ2lmIChjYWxsYmFjayhpdGVyYXRlZVtpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKSA9PT0gZmFsc2UpIHJldHVybiByZXN1bHQnLFxuICAgICdvYmplY3RMb29wJzogJ2lmIChjYWxsYmFjayhpdGVyYXRlZVtpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKSA9PT0gZmFsc2UpIHJldHVybiByZXN1bHQnXG4gIH07XG5cbiAgLyoqIFJldXNhYmxlIGl0ZXJhdG9yIG9wdGlvbnMgZm9yIGBmb3JJbmAgYW5kIGBmb3JPd25gICovXG4gIHZhciBmb3JPd25JdGVyYXRvck9wdGlvbnMgPSB7XG4gICAgJ2FycmF5TG9vcCc6IG51bGxcbiAgfTtcblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIG9wdGltaXplZCB0byBzZWFyY2ggbGFyZ2UgYXJyYXlzIGZvciBhIGdpdmVuIGB2YWx1ZWAsXG4gICAqIHN0YXJ0aW5nIGF0IGBmcm9tSW5kZXhgLCB1c2luZyBzdHJpY3QgZXF1YWxpdHkgZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gc2VhcmNoLlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gc2VhcmNoIGZvci5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtmcm9tSW5kZXg9MF0gVGhlIGluZGV4IHRvIHNlYXJjaCBmcm9tLlxuICAgKiBAcGFyYW0ge051bWJlcn0gW2xhcmdlU2l6ZT0zMF0gVGhlIGxlbmd0aCBhdCB3aGljaCBhbiBhcnJheSBpcyBjb25zaWRlcmVkIGxhcmdlLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgYHZhbHVlYCBpcyBmb3VuZCwgZWxzZSBgZmFsc2VgLlxuICAgKi9cbiAgZnVuY3Rpb24gY2FjaGVkQ29udGFpbnMoYXJyYXksIGZyb21JbmRleCwgbGFyZ2VTaXplKSB7XG4gICAgZnJvbUluZGV4IHx8IChmcm9tSW5kZXggPSAwKTtcblxuICAgIHZhciBsZW5ndGggPSBhcnJheS5sZW5ndGgsXG4gICAgICAgIGlzTGFyZ2UgPSAobGVuZ3RoIC0gZnJvbUluZGV4KSA+PSAobGFyZ2VTaXplIHx8IGxhcmdlQXJyYXlTaXplKTtcblxuICAgIGlmIChpc0xhcmdlKSB7XG4gICAgICB2YXIgY2FjaGUgPSB7fSxcbiAgICAgICAgICBpbmRleCA9IGZyb21JbmRleCAtIDE7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIC8vIG1hbnVhbGx5IGNvZXJjZSBgdmFsdWVgIHRvIGEgc3RyaW5nIGJlY2F1c2UgYGhhc093blByb3BlcnR5YCwgaW4gc29tZVxuICAgICAgICAvLyBvbGRlciB2ZXJzaW9ucyBvZiBGaXJlZm94LCBjb2VyY2VzIG9iamVjdHMgaW5jb3JyZWN0bHlcbiAgICAgICAgdmFyIGtleSA9IGFycmF5W2luZGV4XSArICcnO1xuICAgICAgICAoaGFzT3duUHJvcGVydHkuY2FsbChjYWNoZSwga2V5KSA/IGNhY2hlW2tleV0gOiAoY2FjaGVba2V5XSA9IFtdKSkucHVzaChhcnJheVtpbmRleF0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmIChpc0xhcmdlKSB7XG4gICAgICAgIHZhciBrZXkgPSB2YWx1ZSArICcnO1xuICAgICAgICByZXR1cm4gaGFzT3duUHJvcGVydHkuY2FsbChjYWNoZSwga2V5KSAmJiBpbmRleE9mKGNhY2hlW2tleV0sIHZhbHVlKSA+IC0xO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGluZGV4T2YoYXJyYXksIHZhbHVlLCBmcm9tSW5kZXgpID4gLTE7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYF8ubWF4YCBhbmQgYF8ubWluYCBhcyB0aGUgZGVmYXVsdCBgY2FsbGJhY2tgIHdoZW4gYSBnaXZlblxuICAgKiBgY29sbGVjdGlvbmAgaXMgYSBzdHJpbmcgdmFsdWUuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZSBUaGUgY2hhcmFjdGVyIHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgdGhlIGNvZGUgdW5pdCBvZiBnaXZlbiBjaGFyYWN0ZXIuXG4gICAqL1xuICBmdW5jdGlvbiBjaGFyQXRDYWxsYmFjayh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZS5jaGFyQ29kZUF0KDApO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYHNvcnRCeWAgdG8gY29tcGFyZSB0cmFuc2Zvcm1lZCBgY29sbGVjdGlvbmAgdmFsdWVzLCBzdGFibGUgc29ydGluZ1xuICAgKiB0aGVtIGluIGFzY2VuZGluZyBvcmRlci5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtPYmplY3R9IGEgVGhlIG9iamVjdCB0byBjb21wYXJlIHRvIGBiYC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGIgVGhlIG9iamVjdCB0byBjb21wYXJlIHRvIGBhYC5cbiAgICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyB0aGUgc29ydCBvcmRlciBpbmRpY2F0b3Igb2YgYDFgIG9yIGAtMWAuXG4gICAqL1xuICBmdW5jdGlvbiBjb21wYXJlQXNjZW5kaW5nKGEsIGIpIHtcbiAgICB2YXIgYWkgPSBhLmluZGV4LFxuICAgICAgICBiaSA9IGIuaW5kZXg7XG5cbiAgICBhID0gYS5jcml0ZXJpYTtcbiAgICBiID0gYi5jcml0ZXJpYTtcblxuICAgIC8vIGVuc3VyZSBhIHN0YWJsZSBzb3J0IGluIFY4IGFuZCBvdGhlciBlbmdpbmVzXG4gICAgLy8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9OTBcbiAgICBpZiAoYSAhPT0gYikge1xuICAgICAgaWYgKGEgPiBiIHx8IHR5cGVvZiBhID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiAxO1xuICAgICAgfVxuICAgICAgaWYgKGEgPCBiIHx8IHR5cGVvZiBiID09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybiAtMTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFpIDwgYmkgPyAtMSA6IDE7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLCBpbnZva2VzIGBmdW5jYCB3aXRoIHRoZSBgdGhpc2BcbiAgICogYmluZGluZyBvZiBgdGhpc0FyZ2AgYW5kIHByZXBlbmRzIGFueSBgcGFydGFpbEFyZ3NgIHRvIHRoZSBhcmd1bWVudHMgcGFzc2VkXG4gICAqIHRvIHRoZSBib3VuZCBmdW5jdGlvbi5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGJpbmQgb3IgdGhlIG1ldGhvZCBuYW1lLlxuICAgKiBAcGFyYW0ge01peGVkfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBmdW5jYC5cbiAgICogQHBhcmFtIHtBcnJheX0gcGFydGlhbEFyZ3MgQW4gYXJyYXkgb2YgYXJndW1lbnRzIHRvIGJlIHBhcnRpYWxseSBhcHBsaWVkLlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBib3VuZCBmdW5jdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZUJvdW5kKGZ1bmMsIHRoaXNBcmcsIHBhcnRpYWxBcmdzKSB7XG4gICAgdmFyIGlzRnVuYyA9IGlzRnVuY3Rpb24oZnVuYyksXG4gICAgICAgIGlzUGFydGlhbCA9ICFwYXJ0aWFsQXJncyxcbiAgICAgICAga2V5ID0gdGhpc0FyZztcblxuICAgIC8vIGp1Z2dsZSBhcmd1bWVudHNcbiAgICBpZiAoaXNQYXJ0aWFsKSB7XG4gICAgICBwYXJ0aWFsQXJncyA9IHRoaXNBcmc7XG4gICAgfVxuICAgIGlmICghaXNGdW5jKSB7XG4gICAgICB0aGlzQXJnID0gZnVuYztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBib3VuZCgpIHtcbiAgICAgIC8vIGBGdW5jdGlvbiNiaW5kYCBzcGVjXG4gICAgICAvLyBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3gxNS4zLjQuNVxuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHMsXG4gICAgICAgICAgdGhpc0JpbmRpbmcgPSBpc1BhcnRpYWwgPyB0aGlzIDogdGhpc0FyZztcblxuICAgICAgaWYgKCFpc0Z1bmMpIHtcbiAgICAgICAgZnVuYyA9IHRoaXNBcmdba2V5XTtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJ0aWFsQXJncy5sZW5ndGgpIHtcbiAgICAgICAgYXJncyA9IGFyZ3MubGVuZ3RoXG4gICAgICAgICAgPyBwYXJ0aWFsQXJncy5jb25jYXQoc2xpY2UoYXJncykpXG4gICAgICAgICAgOiBwYXJ0aWFsQXJncztcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzIGluc3RhbmNlb2YgYm91bmQpIHtcbiAgICAgICAgLy8gZW5zdXJlIGBuZXcgYm91bmRgIGlzIGFuIGluc3RhbmNlIG9mIGBib3VuZGAgYW5kIGBmdW5jYFxuICAgICAgICBub29wLnByb3RvdHlwZSA9IGZ1bmMucHJvdG90eXBlO1xuICAgICAgICB0aGlzQmluZGluZyA9IG5ldyBub29wO1xuICAgICAgICBub29wLnByb3RvdHlwZSA9IG51bGw7XG5cbiAgICAgICAgLy8gbWltaWMgdGhlIGNvbnN0cnVjdG9yJ3MgYHJldHVybmAgYmVoYXZpb3JcbiAgICAgICAgLy8gaHR0cDovL2VzNS5naXRodWIuY29tLyN4MTMuMi4yXG4gICAgICAgIHZhciByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNCaW5kaW5nLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIGlzT2JqZWN0KHJlc3VsdCkgPyByZXN1bHQgOiB0aGlzQmluZGluZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXNCaW5kaW5nLCBhcmdzKTtcbiAgICB9XG4gICAgcmV0dXJuIGJvdW5kO1xuICB9XG5cbiAgLyoqXG4gICAqIFByb2R1Y2VzIGFuIGl0ZXJhdGlvbiBjYWxsYmFjayBib3VuZCB0byBhbiBvcHRpb25hbCBgdGhpc0FyZ2AuIElmIGBmdW5jYCBpc1xuICAgKiBhIHByb3BlcnR5IG5hbWUsIHRoZSBjYWxsYmFjayB3aWxsIHJldHVybiB0aGUgcHJvcGVydHkgdmFsdWUgZm9yIGEgZ2l2ZW4gZWxlbWVudC5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtGdW5jdGlvbnxTdHJpbmd9IFtmdW5jPWlkZW50aXR5fHByb3BlcnR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlclxuICAgKiBpdGVyYXRpb24gb3IgcHJvcGVydHkgbmFtZSB0byBxdWVyeS5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcGFyYW0ge09iamVjdH0gW2FjY3VtdWxhdGluZ10gVXNlZCB0byBpbmRpY2F0ZSB0aGF0IHRoZSBjYWxsYmFjayBzaG91bGRcbiAgICogIGFjY2VwdCBhbiBgYWNjdW11bGF0b3JgIGFyZ3VtZW50LlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgYSBjYWxsYmFjayBmdW5jdGlvbi5cbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZUNhbGxiYWNrKGZ1bmMsIHRoaXNBcmcsIGFjY3VtdWxhdGluZykge1xuICAgIGlmICghZnVuYykge1xuICAgICAgcmV0dXJuIGlkZW50aXR5O1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGZ1bmMgIT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKG9iamVjdCkge1xuICAgICAgICByZXR1cm4gb2JqZWN0W2Z1bmNdO1xuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiB0aGlzQXJnICE9ICd1bmRlZmluZWQnKSB7XG4gICAgICBpZiAoYWNjdW11bGF0aW5nKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihhY2N1bXVsYXRvciwgdmFsdWUsIGluZGV4LCBvYmplY3QpIHtcbiAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXNBcmcsIGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIG9iamVjdCk7XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGluZGV4LCBvYmplY3QpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmMuY2FsbCh0aGlzQXJnLCB2YWx1ZSwgaW5kZXgsIG9iamVjdCk7XG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZnVuYztcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGNvbXBpbGVkIGl0ZXJhdGlvbiBmdW5jdGlvbnMuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbb3B0aW9uczEsIG9wdGlvbnMyLCAuLi5dIFRoZSBjb21waWxlIG9wdGlvbnMgb2JqZWN0KHMpLlxuICAgKiAgdXNlSGFzIC0gQSBib29sZWFuIHRvIHNwZWNpZnkgdXNpbmcgYGhhc093blByb3BlcnR5YCBjaGVja3MgaW4gdGhlIG9iamVjdCBsb29wLlxuICAgKiAgYXJncyAtIEEgc3RyaW5nIG9mIGNvbW1hIHNlcGFyYXRlZCBhcmd1bWVudHMgdGhlIGl0ZXJhdGlvbiBmdW5jdGlvbiB3aWxsIGFjY2VwdC5cbiAgICogIHRvcCAtIEEgc3RyaW5nIG9mIGNvZGUgdG8gZXhlY3V0ZSBiZWZvcmUgdGhlIGl0ZXJhdGlvbiBicmFuY2hlcy5cbiAgICogIGFycmF5TG9vcCAtIEEgc3RyaW5nIG9mIGNvZGUgdG8gZXhlY3V0ZSBpbiB0aGUgYXJyYXkgbG9vcC5cbiAgICogIG9iamVjdExvb3AgLSBBIHN0cmluZyBvZiBjb2RlIHRvIGV4ZWN1dGUgaW4gdGhlIG9iamVjdCBsb29wLlxuICAgKiAgYm90dG9tIC0gQSBzdHJpbmcgb2YgY29kZSB0byBleGVjdXRlIGFmdGVyIHRoZSBpdGVyYXRpb24gYnJhbmNoZXMuXG4gICAqXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgY29tcGlsZWQgZnVuY3Rpb24uXG4gICAqL1xuICBmdW5jdGlvbiBjcmVhdGVJdGVyYXRvcigpIHtcbiAgICB2YXIgZGF0YSA9IHtcbiAgICAgICdhcnJheUxvb3AnOiAnJyxcbiAgICAgICdib3R0b20nOiAnJyxcbiAgICAgICdoYXNEb250RW51bUJ1Zyc6IGhhc0RvbnRFbnVtQnVnLFxuICAgICAgJ2lzS2V5c0Zhc3QnOiBpc0tleXNGYXN0LFxuICAgICAgJ29iamVjdExvb3AnOiAnJyxcbiAgICAgICdub25FbnVtQXJncyc6IG5vbkVudW1BcmdzLFxuICAgICAgJ25vQ2hhckJ5SW5kZXgnOiBub0NoYXJCeUluZGV4LFxuICAgICAgJ3NoYWRvd2VkJzogc2hhZG93ZWQsXG4gICAgICAndG9wJzogJycsXG4gICAgICAndXNlSGFzJzogdHJ1ZVxuICAgIH07XG5cbiAgICAvLyBtZXJnZSBvcHRpb25zIGludG8gYSB0ZW1wbGF0ZSBkYXRhIG9iamVjdFxuICAgIGZvciAodmFyIG9iamVjdCwgaW5kZXggPSAwOyBvYmplY3QgPSBhcmd1bWVudHNbaW5kZXhdOyBpbmRleCsrKSB7XG4gICAgICBmb3IgKHZhciBrZXkgaW4gb2JqZWN0KSB7XG4gICAgICAgIGRhdGFba2V5XSA9IG9iamVjdFtrZXldO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgYXJncyA9IGRhdGEuYXJncztcbiAgICBkYXRhLmZpcnN0QXJnID0gL15bXixdKy8uZXhlYyhhcmdzKVswXTtcblxuICAgIC8vIGNyZWF0ZSB0aGUgZnVuY3Rpb24gZmFjdG9yeVxuICAgIHZhciBmYWN0b3J5ID0gRnVuY3Rpb24oXG4gICAgICAgICdjcmVhdGVDYWxsYmFjaywgaGFzT3duUHJvcGVydHksIGlzQXJndW1lbnRzLCBpc1N0cmluZywgb2JqZWN0VHlwZXMsICcgK1xuICAgICAgICAnbmF0aXZlS2V5cywgcHJvcGVydHlJc0VudW1lcmFibGUnLFxuICAgICAgJ3JldHVybiBmdW5jdGlvbignICsgYXJncyArICcpIHtcXG4nICsgaXRlcmF0b3JUZW1wbGF0ZShkYXRhKSArICdcXG59J1xuICAgICk7XG4gICAgLy8gcmV0dXJuIHRoZSBjb21waWxlZCBmdW5jdGlvblxuICAgIHJldHVybiBmYWN0b3J5KFxuICAgICAgY3JlYXRlQ2FsbGJhY2ssIGhhc093blByb3BlcnR5LCBpc0FyZ3VtZW50cywgaXNTdHJpbmcsIG9iamVjdFR5cGVzLFxuICAgICAgbmF0aXZlS2V5cywgcHJvcGVydHlJc0VudW1lcmFibGVcbiAgICApO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgZnVuY3Rpb24gY29tcGlsZWQgdG8gaXRlcmF0ZSBgYXJndW1lbnRzYCBvYmplY3RzLCBhcnJheXMsIG9iamVjdHMsIGFuZFxuICAgKiBzdHJpbmdzIGNvbnNpc3Rlbmx5IGFjcm9zcyBlbnZpcm9ubWVudHMsIGV4ZWN1dGluZyB0aGUgYGNhbGxiYWNrYCBmb3IgZWFjaFxuICAgKiBlbGVtZW50IGluIHRoZSBgY29sbGVjdGlvbmAuIFRoZSBgY2FsbGJhY2tgIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZFxuICAgKiB3aXRoIHRocmVlIGFyZ3VtZW50czsgKHZhbHVlLCBpbmRleHxrZXksIGNvbGxlY3Rpb24pLiBDYWxsYmFja3MgbWF5IGV4aXRcbiAgICogaXRlcmF0aW9uIGVhcmx5IGJ5IGV4cGxpY2l0bHkgcmV0dXJuaW5nIGBmYWxzZWAuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAqIEByZXR1cm5zIHtBcnJheXxPYmplY3R8U3RyaW5nfSBSZXR1cm5zIGBjb2xsZWN0aW9uYC5cbiAgICovXG4gIHZhciBlYWNoID0gY3JlYXRlSXRlcmF0b3IoZWFjaEl0ZXJhdG9yT3B0aW9ucyk7XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYHRlbXBsYXRlYCB0byBlc2NhcGUgY2hhcmFjdGVycyBmb3IgaW5jbHVzaW9uIGluIGNvbXBpbGVkXG4gICAqIHN0cmluZyBsaXRlcmFscy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtTdHJpbmd9IG1hdGNoIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byBlc2NhcGUuXG4gICAqIEByZXR1cm5zIHtTdHJpbmd9IFJldHVybnMgdGhlIGVzY2FwZWQgY2hhcmFjdGVyLlxuICAgKi9cbiAgZnVuY3Rpb24gZXNjYXBlU3RyaW5nQ2hhcihtYXRjaCkge1xuICAgIHJldHVybiAnXFxcXCcgKyBzdHJpbmdFc2NhcGVzW21hdGNoXTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIGJ5IGBlc2NhcGVgIHRvIGNvbnZlcnQgY2hhcmFjdGVycyB0byBIVE1MIGVudGl0aWVzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge1N0cmluZ30gbWF0Y2ggVGhlIG1hdGNoZWQgY2hhcmFjdGVyIHRvIGVzY2FwZS5cbiAgICogQHJldHVybnMge1N0cmluZ30gUmV0dXJucyB0aGUgZXNjYXBlZCBjaGFyYWN0ZXIuXG4gICAqL1xuICBmdW5jdGlvbiBlc2NhcGVIdG1sQ2hhcihtYXRjaCkge1xuICAgIHJldHVybiBodG1sRXNjYXBlc1ttYXRjaF07XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBET00gbm9kZSBpbiBJRSA8IDkuXG4gICAqXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgRE9NIG5vZGUsIGVsc2UgYGZhbHNlYC5cbiAgICovXG4gIGZ1bmN0aW9uIGlzTm9kZSh2YWx1ZSkge1xuICAgIC8vIElFIDwgOSBwcmVzZW50cyBET00gbm9kZXMgYXMgYE9iamVjdGAgb2JqZWN0cyBleGNlcHQgdGhleSBoYXZlIGB0b1N0cmluZ2BcbiAgICAvLyBtZXRob2RzIHRoYXQgYXJlIGB0eXBlb2ZgIFwic3RyaW5nXCIgYW5kIHN0aWxsIGNhbiBjb2VyY2Ugbm9kZXMgdG8gc3RyaW5nc1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUudG9TdHJpbmcgIT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2YgKHZhbHVlICsgJycpID09ICdzdHJpbmcnO1xuICB9XG5cbiAgLyoqXG4gICAqIEEgbm8tb3BlcmF0aW9uIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgZnVuY3Rpb24gbm9vcCgpIHtcbiAgICAvLyBubyBvcGVyYXRpb24gcGVyZm9ybWVkXG4gIH1cblxuICAvKipcbiAgICogU2xpY2VzIHRoZSBgY29sbGVjdGlvbmAgZnJvbSB0aGUgYHN0YXJ0YCBpbmRleCB1cCB0bywgYnV0IG5vdCBpbmNsdWRpbmcsXG4gICAqIHRoZSBgZW5kYCBpbmRleC5cbiAgICpcbiAgICogTm90ZTogVGhpcyBmdW5jdGlvbiBpcyB1c2VkLCBpbnN0ZWFkIG9mIGBBcnJheSNzbGljZWAsIHRvIHN1cHBvcnQgbm9kZSBsaXN0c1xuICAgKiBpbiBJRSA8IDkgYW5kIHRvIGVuc3VyZSBkZW5zZSBhcnJheXMgYXJlIHJldHVybmVkLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gc2xpY2UuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydCBUaGUgc3RhcnQgaW5kZXguXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBlbmQgVGhlIGVuZCBpbmRleC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIHRoZSBuZXcgYXJyYXkuXG4gICAqL1xuICBmdW5jdGlvbiBzbGljZShhcnJheSwgc3RhcnQsIGVuZCkge1xuICAgIHN0YXJ0IHx8IChzdGFydCA9IDApO1xuICAgIGlmICh0eXBlb2YgZW5kID09ICd1bmRlZmluZWQnKSB7XG4gICAgICBlbmQgPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDA7XG4gICAgfVxuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBlbmQgLSBzdGFydCB8fCAwLFxuICAgICAgICByZXN1bHQgPSBBcnJheShsZW5ndGggPCAwID8gMCA6IGxlbmd0aCk7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgcmVzdWx0W2luZGV4XSA9IGFycmF5W3N0YXJ0ICsgaW5kZXhdO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZWQgYnkgYHVuZXNjYXBlYCB0byBjb252ZXJ0IEhUTUwgZW50aXRpZXMgdG8gY2hhcmFjdGVycy5cbiAgICpcbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtTdHJpbmd9IG1hdGNoIFRoZSBtYXRjaGVkIGNoYXJhY3RlciB0byB1bmVzY2FwZS5cbiAgICogQHJldHVybnMge1N0cmluZ30gUmV0dXJucyB0aGUgdW5lc2NhcGVkIGNoYXJhY3Rlci5cbiAgICovXG4gIGZ1bmN0aW9uIHVuZXNjYXBlSHRtbENoYXIobWF0Y2gpIHtcbiAgICByZXR1cm4gaHRtbFVuZXNjYXBlc1ttYXRjaF07XG4gIH1cblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogQXNzaWducyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzIG9mIHNvdXJjZSBvYmplY3QocykgdG8gdGhlIGBkZXN0aW5hdGlvbmBcbiAgICogb2JqZWN0LiBTdWJzZXF1ZW50IHNvdXJjZXMgd2lsbCBvdmVyd3JpdGUgcHJvcGVyeSBhc3NpZ25tZW50cyBvZiBwcmV2aW91c1xuICAgKiBzb3VyY2VzLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBhbGlhcyBleHRlbmRcbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgZGVzdGluYXRpb24gb2JqZWN0LlxuICAgKiBAcGFyYW0ge09iamVjdH0gW3NvdXJjZTEsIHNvdXJjZTIsIC4uLl0gVGhlIHNvdXJjZSBvYmplY3RzLlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIHRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uYXNzaWduKHsgJ25hbWUnOiAnbW9lJyB9LCB7ICdhZ2UnOiA0MCB9KTtcbiAgICogLy8gPT4geyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfVxuICAgKi9cbiAgdmFyIGFzc2lnbiA9IGNyZWF0ZUl0ZXJhdG9yKGFzc2lnbkl0ZXJhdG9yT3B0aW9ucyk7XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGFuIGBhcmd1bWVudHNgIG9iamVjdC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhbiBgYXJndW1lbnRzYCBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogKGZ1bmN0aW9uKCkgeyByZXR1cm4gXy5pc0FyZ3VtZW50cyhhcmd1bWVudHMpOyB9KSgxLCAyLCAzKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzQXJndW1lbnRzKFsxLCAyLCAzXSk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqL1xuICBmdW5jdGlvbiBpc0FyZ3VtZW50cyh2YWx1ZSkge1xuICAgIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbHVlKSA9PSBhcmdzQ2xhc3M7XG4gIH1cbiAgLy8gZmFsbGJhY2sgZm9yIGJyb3dzZXJzIHRoYXQgY2FuJ3QgZGV0ZWN0IGBhcmd1bWVudHNgIG9iamVjdHMgYnkgW1tDbGFzc11dXG4gIGlmIChub0FyZ3NDbGFzcykge1xuICAgIGlzQXJndW1lbnRzID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSA/IGhhc093blByb3BlcnR5LmNhbGwodmFsdWUsICdjYWxsZWUnKSA6IGZhbHNlO1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogSXRlcmF0ZXMgb3ZlciBgb2JqZWN0YCdzIG93biBhbmQgaW5oZXJpdGVkIGVudW1lcmFibGUgcHJvcGVydGllcywgZXhlY3V0aW5nXG4gICAqIHRoZSBgY2FsbGJhY2tgIGZvciBlYWNoIHByb3BlcnR5LiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kXG4gICAqIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwga2V5LCBvYmplY3QpLiBDYWxsYmFja3MgbWF5IGV4aXQgaXRlcmF0aW9uXG4gICAqIGVhcmx5IGJ5IGV4cGxpY2l0bHkgcmV0dXJuaW5nIGBmYWxzZWAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBgb2JqZWN0YC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogZnVuY3Rpb24gRG9nKG5hbWUpIHtcbiAgICogICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgKiB9XG4gICAqXG4gICAqIERvZy5wcm90b3R5cGUuYmFyayA9IGZ1bmN0aW9uKCkge1xuICAgKiAgIGFsZXJ0KCdXb29mLCB3b29mIScpO1xuICAgKiB9O1xuICAgKlxuICAgKiBfLmZvckluKG5ldyBEb2coJ0RhZ255JyksIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICogICBhbGVydChrZXkpO1xuICAgKiB9KTtcbiAgICogLy8gPT4gYWxlcnRzICduYW1lJyBhbmQgJ2JhcmsnIChvcmRlciBpcyBub3QgZ3VhcmFudGVlZClcbiAgICovXG4gIHZhciBmb3JJbiA9IGNyZWF0ZUl0ZXJhdG9yKGVhY2hJdGVyYXRvck9wdGlvbnMsIGZvck93bkl0ZXJhdG9yT3B0aW9ucywge1xuICAgICd1c2VIYXMnOiBmYWxzZVxuICB9KTtcblxuICAvKipcbiAgICogSXRlcmF0ZXMgb3ZlciBhbiBvYmplY3QncyBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzLCBleGVjdXRpbmcgdGhlIGBjYWxsYmFja2BcbiAgICogZm9yIGVhY2ggcHJvcGVydHkuIFRoZSBgY2FsbGJhY2tgIGlzIGJvdW5kIHRvIGB0aGlzQXJnYCBhbmQgaW52b2tlZCB3aXRoIHRocmVlXG4gICAqIGFyZ3VtZW50czsgKHZhbHVlLCBrZXksIG9iamVjdCkuIENhbGxiYWNrcyBtYXkgZXhpdCBpdGVyYXRpb24gZWFybHkgYnkgZXhwbGljaXRseVxuICAgKiByZXR1cm5pbmcgYGZhbHNlYC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7T2JqZWN0fSBSZXR1cm5zIGBvYmplY3RgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmZvck93bih7ICcwJzogJ3plcm8nLCAnMSc6ICdvbmUnLCAnbGVuZ3RoJzogMiB9LCBmdW5jdGlvbihudW0sIGtleSkge1xuICAgKiAgIGFsZXJ0KGtleSk7XG4gICAqIH0pO1xuICAgKiAvLyA9PiBhbGVydHMgJzAnLCAnMScsIGFuZCAnbGVuZ3RoJyAob3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAqL1xuICB2YXIgZm9yT3duID0gY3JlYXRlSXRlcmF0b3IoZWFjaEl0ZXJhdG9yT3B0aW9ucywgZm9yT3duSXRlcmF0b3JPcHRpb25zKTtcblxuICAvKipcbiAgICogQSBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbiBvZiBgaXNQbGFpbk9iamVjdGAgdGhhdCBjaGVja3MgaWYgYSBnaXZlbiBgdmFsdWVgXG4gICAqIGlzIGFuIG9iamVjdCBjcmVhdGVkIGJ5IHRoZSBgT2JqZWN0YCBjb25zdHJ1Y3RvciwgYXNzdW1pbmcgb2JqZWN0cyBjcmVhdGVkXG4gICAqIGJ5IHRoZSBgT2JqZWN0YCBjb25zdHJ1Y3RvciBoYXZlIG5vIGluaGVyaXRlZCBlbnVtZXJhYmxlIHByb3BlcnRpZXMgYW5kIHRoYXRcbiAgICogdGhlcmUgYXJlIG5vIGBPYmplY3QucHJvdG90eXBlYCBleHRlbnNpb25zLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiBgdmFsdWVgIGlzIGEgcGxhaW4gb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gICAqL1xuICBmdW5jdGlvbiBzaGltSXNQbGFpbk9iamVjdCh2YWx1ZSkge1xuICAgIC8vIGF2b2lkIG5vbi1vYmplY3RzIGFuZCBmYWxzZSBwb3NpdGl2ZXMgZm9yIGBhcmd1bWVudHNgIG9iamVjdHNcbiAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG4gICAgaWYgKCEodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09ICdvYmplY3QnKSB8fCBpc0FyZ3VtZW50cyh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIC8vIGNoZWNrIHRoYXQgdGhlIGNvbnN0cnVjdG9yIGlzIGBPYmplY3RgIChpLmUuIGBPYmplY3QgaW5zdGFuY2VvZiBPYmplY3RgKVxuICAgIHZhciBjdG9yID0gdmFsdWUuY29uc3RydWN0b3I7XG4gICAgaWYgKCghaXNGdW5jdGlvbihjdG9yKSAmJiAoIW5vTm9kZUNsYXNzIHx8ICFpc05vZGUodmFsdWUpKSkgfHwgY3RvciBpbnN0YW5jZW9mIGN0b3IpIHtcbiAgICAgIC8vIElFIDwgOSBpdGVyYXRlcyBpbmhlcml0ZWQgcHJvcGVydGllcyBiZWZvcmUgb3duIHByb3BlcnRpZXMuIElmIHRoZSBmaXJzdFxuICAgICAgLy8gaXRlcmF0ZWQgcHJvcGVydHkgaXMgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnR5IHRoZW4gdGhlcmUgYXJlIG5vIGluaGVyaXRlZFxuICAgICAgLy8gZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICAgICAgaWYgKGl0ZXJhdGVzT3duTGFzdCkge1xuICAgICAgICBmb3JJbih2YWx1ZSwgZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqZWN0KSB7XG4gICAgICAgICAgcmVzdWx0ID0gIWhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBrZXkpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZXN1bHQgPT09IGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8gSW4gbW9zdCBlbnZpcm9ubWVudHMgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgYXJlIGl0ZXJhdGVkIGJlZm9yZVxuICAgICAgLy8gaXRzIGluaGVyaXRlZCBwcm9wZXJ0aWVzLiBJZiB0aGUgbGFzdCBpdGVyYXRlZCBwcm9wZXJ0eSBpcyBhbiBvYmplY3Qnc1xuICAgICAgLy8gb3duIHByb3BlcnR5IHRoZW4gdGhlcmUgYXJlIG5vIGluaGVyaXRlZCBlbnVtZXJhYmxlIHByb3BlcnRpZXMuXG4gICAgICBmb3JJbih2YWx1ZSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICByZXN1bHQgPSBrZXk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXN1bHQgPT09IGZhbHNlIHx8IGhhc093blByb3BlcnR5LmNhbGwodmFsdWUsIHJlc3VsdCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQSBmYWxsYmFjayBpbXBsZW1lbnRhdGlvbiBvZiBgT2JqZWN0LmtleXNgIHRoYXQgcHJvZHVjZXMgYW4gYXJyYXkgb2YgdGhlXG4gICAqIGdpdmVuIG9iamVjdCdzIG93biBlbnVtZXJhYmxlIHByb3BlcnR5IG5hbWVzLlxuICAgKlxuICAgKiBAcHJpdmF0ZVxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHByb3BlcnR5IG5hbWVzLlxuICAgKi9cbiAgZnVuY3Rpb24gc2hpbUtleXMob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGZvck93bihvYmplY3QsIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2VkIHRvIGNvbnZlcnQgY2hhcmFjdGVycyB0byBIVE1MIGVudGl0aWVzOlxuICAgKlxuICAgKiBUaG91Z2ggdGhlIGA+YCBjaGFyYWN0ZXIgaXMgZXNjYXBlZCBmb3Igc3ltbWV0cnksIGNoYXJhY3RlcnMgbGlrZSBgPmAgYW5kIGAvYFxuICAgKiBkb24ndCByZXF1aXJlIGVzY2FwaW5nIGluIEhUTUwgYW5kIGhhdmUgbm8gc3BlY2lhbCBtZWFuaW5nIHVubGVzcyB0aGV5J3JlIHBhcnRcbiAgICogb2YgYSB0YWcgb3IgYW4gdW5xdW90ZWQgYXR0cmlidXRlIHZhbHVlLlxuICAgKiBodHRwOi8vbWF0aGlhc2J5bmVucy5iZS9ub3Rlcy9hbWJpZ3VvdXMtYW1wZXJzYW5kcyAodW5kZXIgXCJzZW1pLXJlbGF0ZWQgZnVuIGZhY3RcIilcbiAgICovXG4gIHZhciBodG1sRXNjYXBlcyA9IHtcbiAgICAnJic6ICcmYW1wOycsXG4gICAgJzwnOiAnJmx0OycsXG4gICAgJz4nOiAnJmd0OycsXG4gICAgJ1wiJzogJyZxdW90OycsXG4gICAgXCInXCI6ICcmI3gyNzsnXG4gIH07XG5cbiAgLyoqIFVzZWQgdG8gY29udmVydCBIVE1MIGVudGl0aWVzIHRvIGNoYXJhY3RlcnMgKi9cbiAgdmFyIGh0bWxVbmVzY2FwZXMgPSBpbnZlcnQoaHRtbEVzY2FwZXMpO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgY2xvbmUgb2YgYHZhbHVlYC4gSWYgYGRlZXBgIGlzIGB0cnVlYCwgbmVzdGVkIG9iamVjdHMgd2lsbCBhbHNvXG4gICAqIGJlIGNsb25lZCwgb3RoZXJ3aXNlIHRoZXkgd2lsbCBiZSBhc3NpZ25lZCBieSByZWZlcmVuY2UuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNsb25lLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGRlZXAgQSBmbGFnIHRvIGluZGljYXRlIGEgZGVlcCBjbG9uZS5cbiAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEludGVybmFsbHkgdXNlZCB0byBhbGxvdyB0aGlzIG1ldGhvZCB0byB3b3JrIHdpdGhcbiAgICogIG90aGVycyBsaWtlIGBfLm1hcGAgd2l0aG91dCB1c2luZyB0aGVpciBjYWxsYmFjayBgaW5kZXhgIGFyZ3VtZW50IGZvciBgZGVlcGAuXG4gICAqIEBwYXJhbS0ge0FycmF5fSBbc3RhY2tBPVtdXSBJbnRlcm5hbGx5IHVzZWQgdG8gdHJhY2sgdHJhdmVyc2VkIHNvdXJjZSBvYmplY3RzLlxuICAgKiBAcGFyYW0tIHtBcnJheX0gW3N0YWNrQj1bXV0gSW50ZXJuYWxseSB1c2VkIHRvIGFzc29jaWF0ZSBjbG9uZXMgd2l0aCB0aGVpclxuICAgKiAgc291cmNlIGNvdW50ZXJwYXJ0cy5cbiAgICogQHJldHVybnMge01peGVkfSBSZXR1cm5zIHRoZSBjbG9uZWQgYHZhbHVlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIHN0b29nZXMgPSBbXG4gICAqICAgeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfSxcbiAgICogICB7ICduYW1lJzogJ2xhcnJ5JywgJ2FnZSc6IDUwIH0sXG4gICAqICAgeyAnbmFtZSc6ICdjdXJseScsICdhZ2UnOiA2MCB9XG4gICAqIF07XG4gICAqXG4gICAqIHZhciBzaGFsbG93ID0gXy5jbG9uZShzdG9vZ2VzKTtcbiAgICogc2hhbGxvd1swXSA9PT0gc3Rvb2dlc1swXTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiB2YXIgZGVlcCA9IF8uY2xvbmUoc3Rvb2dlcywgdHJ1ZSk7XG4gICAqIGRlZXBbMF0gPT09IHN0b29nZXNbMF07XG4gICAqIC8vID0+IGZhbHNlXG4gICAqL1xuICBmdW5jdGlvbiBjbG9uZSh2YWx1ZSwgZGVlcCwgZ3VhcmQsIHN0YWNrQSwgc3RhY2tCKSB7XG4gICAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgaWYgKGd1YXJkKSB7XG4gICAgICBkZWVwID0gZmFsc2U7XG4gICAgfVxuICAgIC8vIGluc3BlY3QgW1tDbGFzc11dXG4gICAgdmFyIGlzT2JqID0gaXNPYmplY3QodmFsdWUpO1xuICAgIGlmIChpc09iaikge1xuICAgICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwodmFsdWUpO1xuICAgICAgaWYgKCFjbG9uZWFibGVDbGFzc2VzW2NsYXNzTmFtZV0gfHwgKG5vTm9kZUNsYXNzICYmIGlzTm9kZSh2YWx1ZSkpKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgIH1cbiAgICAgIHZhciBpc0FyciA9IGlzQXJyYXkodmFsdWUpO1xuICAgIH1cbiAgICAvLyBzaGFsbG93IGNsb25lXG4gICAgaWYgKCFpc09iaiB8fCAhZGVlcCkge1xuICAgICAgcmV0dXJuIGlzT2JqXG4gICAgICAgID8gKGlzQXJyID8gc2xpY2UodmFsdWUpIDogYXNzaWduKHt9LCB2YWx1ZSkpXG4gICAgICAgIDogdmFsdWU7XG4gICAgfVxuICAgIHZhciBjdG9yID0gY3RvckJ5Q2xhc3NbY2xhc3NOYW1lXTtcbiAgICBzd2l0Y2ggKGNsYXNzTmFtZSkge1xuICAgICAgY2FzZSBib29sQ2xhc3M6XG4gICAgICBjYXNlIGRhdGVDbGFzczpcbiAgICAgICAgcmV0dXJuIG5ldyBjdG9yKCt2YWx1ZSk7XG5cbiAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG4gICAgICBjYXNlIHN0cmluZ0NsYXNzOlxuICAgICAgICByZXR1cm4gbmV3IGN0b3IodmFsdWUpO1xuXG4gICAgICBjYXNlIHJlZ2V4cENsYXNzOlxuICAgICAgICByZXR1cm4gY3Rvcih2YWx1ZS5zb3VyY2UsIHJlRmxhZ3MuZXhlYyh2YWx1ZSkpO1xuICAgIH1cbiAgICAvLyBjaGVjayBmb3IgY2lyY3VsYXIgcmVmZXJlbmNlcyBhbmQgcmV0dXJuIGNvcnJlc3BvbmRpbmcgY2xvbmVcbiAgICBzdGFja0EgfHwgKHN0YWNrQSA9IFtdKTtcbiAgICBzdGFja0IgfHwgKHN0YWNrQiA9IFtdKTtcblxuICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgaWYgKHN0YWNrQVtsZW5ndGhdID09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBzdGFja0JbbGVuZ3RoXTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gaW5pdCBjbG9uZWQgb2JqZWN0XG4gICAgdmFyIHJlc3VsdCA9IGlzQXJyID8gY3Rvcih2YWx1ZS5sZW5ndGgpIDoge307XG5cbiAgICAvLyBhZGQgdGhlIHNvdXJjZSB2YWx1ZSB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcbiAgICAvLyBhbmQgYXNzb2NpYXRlIGl0IHdpdGggaXRzIGNsb25lXG4gICAgc3RhY2tBLnB1c2godmFsdWUpO1xuICAgIHN0YWNrQi5wdXNoKHJlc3VsdCk7XG5cbiAgICAvLyByZWN1cnNpdmVseSBwb3B1bGF0ZSBjbG9uZSAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgKGlzQXJyID8gZm9yRWFjaCA6IGZvck93bikodmFsdWUsIGZ1bmN0aW9uKG9ialZhbHVlLCBrZXkpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gY2xvbmUob2JqVmFsdWUsIGRlZXAsIG51bGwsIHN0YWNrQSwgc3RhY2tCKTtcbiAgICB9KTtcblxuICAgIC8vIGFkZCBhcnJheSBwcm9wZXJ0aWVzIGFzc2lnbmVkIGJ5IGBSZWdFeHAjZXhlY2BcbiAgICBpZiAoaXNBcnIpIHtcbiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnaW5kZXgnKSkge1xuICAgICAgICByZXN1bHQuaW5kZXggPSB2YWx1ZS5pbmRleDtcbiAgICAgIH1cbiAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHZhbHVlLCAnaW5wdXQnKSkge1xuICAgICAgICByZXN1bHQuaW5wdXQgPSB2YWx1ZS5pbnB1dDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgZGVlcCBjbG9uZSBvZiBgdmFsdWVgLiBGdW5jdGlvbnMgYW5kIERPTSBub2RlcyBhcmUgKipub3QqKiBjbG9uZWQuXG4gICAqIFRoZSBlbnVtZXJhYmxlIHByb3BlcnRpZXMgb2YgYGFyZ3VtZW50c2Agb2JqZWN0cyBhbmQgb2JqZWN0cyBjcmVhdGVkIGJ5XG4gICAqIGNvbnN0cnVjdG9ycyBvdGhlciB0aGFuIGBPYmplY3RgIGFyZSBjbG9uZWQgdG8gcGxhaW4gYE9iamVjdGAgb2JqZWN0cy5cbiAgICpcbiAgICogTm90ZTogVGhpcyBmdW5jdGlvbiBpcyBsb29zZWx5IGJhc2VkIG9uIHRoZSBzdHJ1Y3R1cmVkIGNsb25lIGFsZ29yaXRobS5cbiAgICogU2VlIGh0dHA6Ly93d3cudzMub3JnL1RSL2h0bWw1L2NvbW1vbi1kb20taW50ZXJmYWNlcy5odG1sI2ludGVybmFsLXN0cnVjdHVyZWQtY2xvbmluZy1hbGdvcml0aG0uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGRlZXAgY2xvbmUuXG4gICAqIEByZXR1cm5zIHtNaXhlZH0gUmV0dXJucyB0aGUgZGVlcCBjbG9uZWQgYHZhbHVlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIHN0b29nZXMgPSBbXG4gICAqICAgeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfSxcbiAgICogICB7ICduYW1lJzogJ2xhcnJ5JywgJ2FnZSc6IDUwIH0sXG4gICAqICAgeyAnbmFtZSc6ICdjdXJseScsICdhZ2UnOiA2MCB9XG4gICAqIF07XG4gICAqXG4gICAqIHZhciBkZWVwID0gXy5jbG9uZURlZXAoc3Rvb2dlcyk7XG4gICAqIGRlZXBbMF0gPT09IHN0b29nZXNbMF07XG4gICAqIC8vID0+IGZhbHNlXG4gICAqL1xuICBmdW5jdGlvbiBjbG9uZURlZXAodmFsdWUpIHtcbiAgICByZXR1cm4gY2xvbmUodmFsdWUsIHRydWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIEFzc2lnbnMgb3duIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiBzb3VyY2Ugb2JqZWN0KHMpIHRvIHRoZSBgZGVzdGluYXRpb25gXG4gICAqIG9iamVjdCBmb3IgYWxsIGBkZXN0aW5hdGlvbmAgcHJvcGVydGllcyB0aGF0IHJlc29sdmUgdG8gYG51bGxgL2B1bmRlZmluZWRgLlxuICAgKiBPbmNlIGEgcHJvcGVydHkgaXMgc2V0LCBhZGRpdGlvbmFsIGRlZmF1bHRzIG9mIHRoZSBzYW1lIHByb3BlcnR5IHdpbGwgYmVcbiAgICogaWdub3JlZC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbZGVmYXVsdDEsIGRlZmF1bHQyLCAuLi5dIFRoZSBkZWZhdWx0IG9iamVjdHMuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGljZUNyZWFtID0geyAnZmxhdm9yJzogJ2Nob2NvbGF0ZScgfTtcbiAgICogXy5kZWZhdWx0cyhpY2VDcmVhbSwgeyAnZmxhdm9yJzogJ3ZhbmlsbGEnLCAnc3ByaW5rbGVzJzogJ3JhaW5ib3cnIH0pO1xuICAgKiAvLyA9PiB7ICdmbGF2b3InOiAnY2hvY29sYXRlJywgJ3Nwcmlua2xlcyc6ICdyYWluYm93JyB9XG4gICAqL1xuICB2YXIgZGVmYXVsdHMgPSBjcmVhdGVJdGVyYXRvcihhc3NpZ25JdGVyYXRvck9wdGlvbnMsIHtcbiAgICAnb2JqZWN0TG9vcCc6ICdpZiAocmVzdWx0W2luZGV4XSA9PSBudWxsKSAnICsgYXNzaWduSXRlcmF0b3JPcHRpb25zLm9iamVjdExvb3BcbiAgfSk7XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBzb3J0ZWQgYXJyYXkgb2YgYWxsIGVudW1lcmFibGUgcHJvcGVydGllcywgb3duIGFuZCBpbmhlcml0ZWQsXG4gICAqIG9mIGBvYmplY3RgIHRoYXQgaGF2ZSBmdW5jdGlvbiB2YWx1ZXMuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGFsaWFzIG1ldGhvZHNcbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcyB0aGF0IGhhdmUgZnVuY3Rpb24gdmFsdWVzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmZ1bmN0aW9ucyhfKTtcbiAgICogLy8gPT4gWydhbGwnLCAnYW55JywgJ2JpbmQnLCAnYmluZEFsbCcsICdjbG9uZScsICdjb21wYWN0JywgJ2NvbXBvc2UnLCAuLi5dXG4gICAqL1xuICBmdW5jdGlvbiBmdW5jdGlvbnMob2JqZWN0KSB7XG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIGZvckluKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgaWYgKGlzRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKGtleSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdC5zb3J0KCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBzcGVjaWZpZWQgb2JqZWN0IGBwcm9wZXJ0eWAgZXhpc3RzIGFuZCBpcyBhIGRpcmVjdCBwcm9wZXJ0eSxcbiAgICogaW5zdGVhZCBvZiBhbiBpbmhlcml0ZWQgcHJvcGVydHkuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGNoZWNrLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gcHJvcGVydHkgVGhlIHByb3BlcnR5IHRvIGNoZWNrIGZvci5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGtleSBpcyBhIGRpcmVjdCBwcm9wZXJ0eSwgZWxzZSBgZmFsc2VgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmhhcyh7ICdhJzogMSwgJ2InOiAyLCAnYyc6IDMgfSwgJ2InKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKi9cbiAgZnVuY3Rpb24gaGFzKG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICByZXR1cm4gb2JqZWN0ID8gaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KSA6IGZhbHNlO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBpbnZlcnRlZCBrZXlzIGFuZCB2YWx1ZXMgb2YgdGhlIGdpdmVuIGBvYmplY3RgLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBpbnZlcnQuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNyZWF0ZWQgaW52ZXJ0ZWQgb2JqZWN0LlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiAgXy5pbnZlcnQoeyAnZmlyc3QnOiAnTW9lJywgJ3NlY29uZCc6ICdMYXJyeScsICd0aGlyZCc6ICdDdXJseScgfSk7XG4gICAqIC8vID0+IHsgJ01vZSc6ICdmaXJzdCcsICdMYXJyeSc6ICdzZWNvbmQnLCAnQ3VybHknOiAndGhpcmQnIH0gKG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgKi9cbiAgZnVuY3Rpb24gaW52ZXJ0KG9iamVjdCkge1xuICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICBmb3JPd24ob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICByZXN1bHRbdmFsdWVdID0ga2V5O1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYW4gYXJyYXkuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYW4gYXJyYXksIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogKGZ1bmN0aW9uKCkgeyByZXR1cm4gXy5pc0FycmF5KGFyZ3VtZW50cyk7IH0pKCk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqXG4gICAqIF8uaXNBcnJheShbMSwgMiwgM10pO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICB2YXIgaXNBcnJheSA9IG5hdGl2ZUlzQXJyYXkgfHwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAvLyBgaW5zdGFuY2VvZmAgbWF5IGNhdXNlIGEgbWVtb3J5IGxlYWsgaW4gSUUgNyBpZiBgdmFsdWVgIGlzIGEgaG9zdCBvYmplY3RcbiAgICAvLyBodHRwOi8vYWpheGlhbi5jb20vYXJjaGl2ZXMvd29ya2luZy1hcm91bmctdGhlLWluc3RhbmNlb2YtbWVtb3J5LWxlYWtcbiAgICByZXR1cm4gKGFyZ3NBcmVPYmplY3RzICYmIHZhbHVlIGluc3RhbmNlb2YgQXJyYXkpIHx8IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGFycmF5Q2xhc3M7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgYm9vbGVhbiAoYHRydWVgIG9yIGBmYWxzZWApIHZhbHVlLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgYm9vbGVhbiB2YWx1ZSwgZWxzZSBgZmFsc2VgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmlzQm9vbGVhbihudWxsKTtcbiAgICogLy8gPT4gZmFsc2VcbiAgICovXG4gIGZ1bmN0aW9uIGlzQm9vbGVhbih2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA9PT0gdHJ1ZSB8fCB2YWx1ZSA9PT0gZmFsc2UgfHwgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gYm9vbENsYXNzO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgZGF0ZS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhIGRhdGUsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc0RhdGUobmV3IERhdGUpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICBmdW5jdGlvbiBpc0RhdGUodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBEYXRlIHx8IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGRhdGVDbGFzcztcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBhIERPTSBlbGVtZW50LlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgRE9NIGVsZW1lbnQsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc0VsZW1lbnQoZG9jdW1lbnQuYm9keSk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIGlzRWxlbWVudCh2YWx1ZSkge1xuICAgIHJldHVybiB2YWx1ZSA/IHZhbHVlLm5vZGVUeXBlID09PSAxIDogZmFsc2U7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgZW1wdHkuIEFycmF5cywgc3RyaW5ncywgb3IgYGFyZ3VtZW50c2Agb2JqZWN0cyB3aXRoIGFcbiAgICogbGVuZ3RoIG9mIGAwYCBhbmQgb2JqZWN0cyB3aXRoIG5vIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMgYXJlIGNvbnNpZGVyZWRcbiAgICogXCJlbXB0eVwiLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gdmFsdWUgVGhlIHZhbHVlIHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBlbXB0eSwgZWxzZSBgZmFsc2VgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmlzRW1wdHkoWzEsIDIsIDNdKTtcbiAgICogLy8gPT4gZmFsc2VcbiAgICpcbiAgICogXy5pc0VtcHR5KHt9KTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzRW1wdHkoJycpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICBmdW5jdGlvbiBpc0VtcHR5KHZhbHVlKSB7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgdmFyIGNsYXNzTmFtZSA9IHRvU3RyaW5nLmNhbGwodmFsdWUpLFxuICAgICAgICBsZW5ndGggPSB2YWx1ZS5sZW5ndGg7XG5cbiAgICBpZiAoKGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzIHx8IGNsYXNzTmFtZSA9PSBzdHJpbmdDbGFzcyB8fFxuICAgICAgICBjbGFzc05hbWUgPT0gYXJnc0NsYXNzIHx8IChub0FyZ3NDbGFzcyAmJiBpc0FyZ3VtZW50cyh2YWx1ZSkpKSB8fFxuICAgICAgICAoY2xhc3NOYW1lID09IG9iamVjdENsYXNzICYmIHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgJiYgaXNGdW5jdGlvbih2YWx1ZS5zcGxpY2UpKSkge1xuICAgICAgcmV0dXJuICFsZW5ndGg7XG4gICAgfVxuICAgIGZvck93bih2YWx1ZSwgZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gKHJlc3VsdCA9IGZhbHNlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFBlcmZvcm1zIGEgZGVlcCBjb21wYXJpc29uIGJldHdlZW4gdHdvIHZhbHVlcyB0byBkZXRlcm1pbmUgaWYgdGhleSBhcmVcbiAgICogZXF1aXZhbGVudCB0byBlYWNoIG90aGVyLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGEgVGhlIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IGIgVGhlIG90aGVyIHZhbHVlIHRvIGNvbXBhcmUuXG4gICAqIEBwYXJhbS0ge09iamVjdH0gW3N0YWNrQT1bXV0gSW50ZXJuYWxseSB1c2VkIHRyYWNrIHRyYXZlcnNlZCBgYWAgb2JqZWN0cy5cbiAgICogQHBhcmFtLSB7T2JqZWN0fSBbc3RhY2tCPVtdXSBJbnRlcm5hbGx5IHVzZWQgdHJhY2sgdHJhdmVyc2VkIGBiYCBvYmplY3RzLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIHZhbHVlcyBhcmUgZXF1dmFsZW50LCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBtb2UgPSB7ICduYW1lJzogJ21vZScsICdsdWNreU51bWJlcnMnOiBbMTMsIDI3LCAzNF0gfTtcbiAgICogdmFyIGNsb25lID0geyAnbmFtZSc6ICdtb2UnLCAnbHVja3lOdW1iZXJzJzogWzEzLCAyNywgMzRdIH07XG4gICAqXG4gICAqIG1vZSA9PSBjbG9uZTtcbiAgICogLy8gPT4gZmFsc2VcbiAgICpcbiAgICogXy5pc0VxdWFsKG1vZSwgY2xvbmUpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICBmdW5jdGlvbiBpc0VxdWFsKGEsIGIsIHN0YWNrQSwgc3RhY2tCKSB7XG4gICAgLy8gZXhpdCBlYXJseSBmb3IgaWRlbnRpY2FsIHZhbHVlc1xuICAgIGlmIChhID09PSBiKSB7XG4gICAgICAvLyB0cmVhdCBgKzBgIHZzLiBgLTBgIGFzIG5vdCBlcXVhbFxuICAgICAgcmV0dXJuIGEgIT09IDAgfHwgKDEgLyBhID09IDEgLyBiKTtcbiAgICB9XG4gICAgLy8gYSBzdHJpY3QgY29tcGFyaXNvbiBpcyBuZWNlc3NhcnkgYmVjYXVzZSBgbnVsbCA9PSB1bmRlZmluZWRgXG4gICAgaWYgKGEgPT0gbnVsbCB8fCBiID09IG51bGwpIHtcbiAgICAgIHJldHVybiBhID09PSBiO1xuICAgIH1cbiAgICAvLyBjb21wYXJlIFtbQ2xhc3NdXSBuYW1lc1xuICAgIHZhciBjbGFzc05hbWUgPSB0b1N0cmluZy5jYWxsKGEpLFxuICAgICAgICBvdGhlck5hbWUgPSB0b1N0cmluZy5jYWxsKGIpO1xuXG4gICAgaWYgKGNsYXNzTmFtZSA9PSBhcmdzQ2xhc3MpIHtcbiAgICAgIGNsYXNzTmFtZSA9IG9iamVjdENsYXNzO1xuICAgIH1cbiAgICBpZiAob3RoZXJOYW1lID09IGFyZ3NDbGFzcykge1xuICAgICAgb3RoZXJOYW1lID0gb2JqZWN0Q2xhc3M7XG4gICAgfVxuICAgIGlmIChjbGFzc05hbWUgIT0gb3RoZXJOYW1lKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHN3aXRjaCAoY2xhc3NOYW1lKSB7XG4gICAgICBjYXNlIGJvb2xDbGFzczpcbiAgICAgIGNhc2UgZGF0ZUNsYXNzOlxuICAgICAgICAvLyBjb2VyY2UgZGF0ZXMgYW5kIGJvb2xlYW5zIHRvIG51bWJlcnMsIGRhdGVzIHRvIG1pbGxpc2Vjb25kcyBhbmQgYm9vbGVhbnNcbiAgICAgICAgLy8gdG8gYDFgIG9yIGAwYCwgdHJlYXRpbmcgaW52YWxpZCBkYXRlcyBjb2VyY2VkIHRvIGBOYU5gIGFzIG5vdCBlcXVhbFxuICAgICAgICByZXR1cm4gK2EgPT0gK2I7XG5cbiAgICAgIGNhc2UgbnVtYmVyQ2xhc3M6XG4gICAgICAgIC8vIHRyZWF0IGBOYU5gIHZzLiBgTmFOYCBhcyBlcXVhbFxuICAgICAgICByZXR1cm4gYSAhPSArYVxuICAgICAgICAgID8gYiAhPSArYlxuICAgICAgICAgIC8vIGJ1dCB0cmVhdCBgKzBgIHZzLiBgLTBgIGFzIG5vdCBlcXVhbFxuICAgICAgICAgIDogKGEgPT0gMCA/ICgxIC8gYSA9PSAxIC8gYikgOiBhID09ICtiKTtcblxuICAgICAgY2FzZSByZWdleHBDbGFzczpcbiAgICAgIGNhc2Ugc3RyaW5nQ2xhc3M6XG4gICAgICAgIC8vIGNvZXJjZSByZWdleGVzIHRvIHN0cmluZ3MgKGh0dHA6Ly9lczUuZ2l0aHViLmNvbS8jeDE1LjEwLjYuNClcbiAgICAgICAgLy8gdHJlYXQgc3RyaW5nIHByaW1pdGl2ZXMgYW5kIHRoZWlyIGNvcnJlc3BvbmRpbmcgb2JqZWN0IGluc3RhbmNlcyBhcyBlcXVhbFxuICAgICAgICByZXR1cm4gYSA9PSBiICsgJyc7XG4gICAgfVxuICAgIHZhciBpc0FyciA9IGNsYXNzTmFtZSA9PSBhcnJheUNsYXNzO1xuICAgIGlmICghaXNBcnIpIHtcbiAgICAgIC8vIHVud3JhcCBhbnkgYGxvZGFzaGAgd3JhcHBlZCB2YWx1ZXNcbiAgICAgIGlmIChhLl9fd3JhcHBlZF9fIHx8IGIuX193cmFwcGVkX18pIHtcbiAgICAgICAgcmV0dXJuIGlzRXF1YWwoYS5fX3dyYXBwZWRfXyB8fCBhLCBiLl9fd3JhcHBlZF9fIHx8IGIpO1xuICAgICAgfVxuICAgICAgLy8gZXhpdCBmb3IgZnVuY3Rpb25zIGFuZCBET00gbm9kZXNcbiAgICAgIGlmIChjbGFzc05hbWUgIT0gb2JqZWN0Q2xhc3MgfHwgKG5vTm9kZUNsYXNzICYmIChpc05vZGUoYSkgfHwgaXNOb2RlKGIpKSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgLy8gaW4gb2xkZXIgdmVyc2lvbnMgb2YgT3BlcmEsIGBhcmd1bWVudHNgIG9iamVjdHMgaGF2ZSBgQXJyYXlgIGNvbnN0cnVjdG9yc1xuICAgICAgdmFyIGN0b3JBID0gIWFyZ3NBcmVPYmplY3RzICYmIGlzQXJndW1lbnRzKGEpID8gT2JqZWN0IDogYS5jb25zdHJ1Y3RvcixcbiAgICAgICAgICBjdG9yQiA9ICFhcmdzQXJlT2JqZWN0cyAmJiBpc0FyZ3VtZW50cyhiKSA/IE9iamVjdCA6IGIuY29uc3RydWN0b3I7XG5cbiAgICAgIC8vIG5vbiBgT2JqZWN0YCBvYmplY3QgaW5zdGFuY2VzIHdpdGggZGlmZmVyZW50IGNvbnN0cnVjdG9ycyBhcmUgbm90IGVxdWFsXG4gICAgICBpZiAoY3RvckEgIT0gY3RvckIgJiYgIShcbiAgICAgICAgICAgIGlzRnVuY3Rpb24oY3RvckEpICYmIGN0b3JBIGluc3RhbmNlb2YgY3RvckEgJiZcbiAgICAgICAgICAgIGlzRnVuY3Rpb24oY3RvckIpICYmIGN0b3JCIGluc3RhbmNlb2YgY3RvckJcbiAgICAgICAgICApKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gYXNzdW1lIGN5Y2xpYyBzdHJ1Y3R1cmVzIGFyZSBlcXVhbFxuICAgIC8vIHRoZSBhbGdvcml0aG0gZm9yIGRldGVjdGluZyBjeWNsaWMgc3RydWN0dXJlcyBpcyBhZGFwdGVkIGZyb20gRVMgNS4xXG4gICAgLy8gc2VjdGlvbiAxNS4xMi4zLCBhYnN0cmFjdCBvcGVyYXRpb24gYEpPYCAoaHR0cDovL2VzNS5naXRodWIuY29tLyN4MTUuMTIuMylcbiAgICBzdGFja0EgfHwgKHN0YWNrQSA9IFtdKTtcbiAgICBzdGFja0IgfHwgKHN0YWNrQiA9IFtdKTtcblxuICAgIHZhciBsZW5ndGggPSBzdGFja0EubGVuZ3RoO1xuICAgIHdoaWxlIChsZW5ndGgtLSkge1xuICAgICAgaWYgKHN0YWNrQVtsZW5ndGhdID09IGEpIHtcbiAgICAgICAgcmV0dXJuIHN0YWNrQltsZW5ndGhdID09IGI7XG4gICAgICB9XG4gICAgfVxuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICByZXN1bHQgPSB0cnVlLFxuICAgICAgICBzaXplID0gMDtcblxuICAgIC8vIGFkZCBgYWAgYW5kIGBiYCB0byB0aGUgc3RhY2sgb2YgdHJhdmVyc2VkIG9iamVjdHNcbiAgICBzdGFja0EucHVzaChhKTtcbiAgICBzdGFja0IucHVzaChiKTtcblxuICAgIC8vIHJlY3Vyc2l2ZWx5IGNvbXBhcmUgb2JqZWN0cyBhbmQgYXJyYXlzIChzdXNjZXB0aWJsZSB0byBjYWxsIHN0YWNrIGxpbWl0cylcbiAgICBpZiAoaXNBcnIpIHtcbiAgICAgIC8vIGNvbXBhcmUgbGVuZ3RocyB0byBkZXRlcm1pbmUgaWYgYSBkZWVwIGNvbXBhcmlzb24gaXMgbmVjZXNzYXJ5XG4gICAgICBzaXplID0gYS5sZW5ndGg7XG4gICAgICByZXN1bHQgPSBzaXplID09IGIubGVuZ3RoO1xuXG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIC8vIGRlZXAgY29tcGFyZSB0aGUgY29udGVudHMsIGlnbm9yaW5nIG5vbi1udW1lcmljIHByb3BlcnRpZXNcbiAgICAgICAgd2hpbGUgKHNpemUtLSkge1xuICAgICAgICAgIGlmICghKHJlc3VsdCA9IGlzRXF1YWwoYVtzaXplXSwgYltzaXplXSwgc3RhY2tBLCBzdGFja0IpKSkge1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICAvLyBkZWVwIGNvbXBhcmUgb2JqZWN0cyB1c2luZyBgZm9ySW5gLCBpbnN0ZWFkIG9mIGBmb3JPd25gLCB0byBhdm9pZCBgT2JqZWN0LmtleXNgXG4gICAgLy8gd2hpY2gsIGluIHRoaXMgY2FzZSwgaXMgbW9yZSBjb3N0bHlcbiAgICBmb3JJbihhLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBhKSB7XG4gICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChhLCBrZXkpKSB7XG4gICAgICAgIC8vIGNvdW50IHRoZSBudW1iZXIgb2YgcHJvcGVydGllcy5cbiAgICAgICAgc2l6ZSsrO1xuICAgICAgICAvLyBkZWVwIGNvbXBhcmUgZWFjaCBwcm9wZXJ0eSB2YWx1ZS5cbiAgICAgICAgcmV0dXJuIChyZXN1bHQgPSBoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIGtleSkgJiYgaXNFcXVhbCh2YWx1ZSwgYltrZXldLCBzdGFja0EsIHN0YWNrQikpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgaWYgKHJlc3VsdCkge1xuICAgICAgLy8gZW5zdXJlIGJvdGggb2JqZWN0cyBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBwcm9wZXJ0aWVzXG4gICAgICBmb3JJbihiLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBiKSB7XG4gICAgICAgIGlmIChoYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIGtleSkpIHtcbiAgICAgICAgICAvLyBgc2l6ZWAgd2lsbCBiZSBgLTFgIGlmIGBiYCBoYXMgbW9yZSBwcm9wZXJ0aWVzIHRoYW4gYGFgXG4gICAgICAgICAgcmV0dXJuIChyZXN1bHQgPSAtLXNpemUgPiAtMSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzLCBvciBjYW4gYmUgY29lcmNlZCB0bywgYSBmaW5pdGUgbnVtYmVyLlxuICAgKlxuICAgKiBOb3RlOiBUaGlzIGlzIG5vdCB0aGUgc2FtZSBhcyBuYXRpdmUgYGlzRmluaXRlYCwgd2hpY2ggd2lsbCByZXR1cm4gdHJ1ZSBmb3JcbiAgICogYm9vbGVhbnMgYW5kIGVtcHR5IHN0cmluZ3MuIFNlZSBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3gxNS4xLjIuNS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gY2hlY2suXG4gICAqIEByZXR1cm5zIHtCb29sZWFufSBSZXR1cm5zIGB0cnVlYCBpZiB0aGUgYHZhbHVlYCBpcyBhIGZpbml0ZSBudW1iZXIsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc0Zpbml0ZSgtMTAxKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzRmluaXRlKCcxMCcpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqXG4gICAqIF8uaXNGaW5pdGUodHJ1ZSk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqXG4gICAqIF8uaXNGaW5pdGUoJycpO1xuICAgKiAvLyA9PiBmYWxzZVxuICAgKlxuICAgKiBfLmlzRmluaXRlKEluZmluaXR5KTtcbiAgICogLy8gPT4gZmFsc2VcbiAgICovXG4gIGZ1bmN0aW9uIGlzRmluaXRlKHZhbHVlKSB7XG4gICAgcmV0dXJuIG5hdGl2ZUlzRmluaXRlKHZhbHVlKSAmJiAhbmF0aXZlSXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgZnVuY3Rpb24uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSBmdW5jdGlvbiwgZWxzZSBgZmFsc2VgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmlzRnVuY3Rpb24oXyk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdmdW5jdGlvbic7XG4gIH1cbiAgLy8gZmFsbGJhY2sgZm9yIG9sZGVyIHZlcnNpb25zIG9mIENocm9tZSBhbmQgU2FmYXJpXG4gIGlmIChpc0Z1bmN0aW9uKC94LykpIHtcbiAgICBpc0Z1bmN0aW9uID0gZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJldHVybiB2YWx1ZSBpbnN0YW5jZW9mIEZ1bmN0aW9uIHx8IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IGZ1bmNDbGFzcztcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIHRoZSBsYW5ndWFnZSB0eXBlIG9mIE9iamVjdC5cbiAgICogKGUuZy4gYXJyYXlzLCBmdW5jdGlvbnMsIG9iamVjdHMsIHJlZ2V4ZXMsIGBuZXcgTnVtYmVyKDApYCwgYW5kIGBuZXcgU3RyaW5nKCcnKWApXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYW4gb2JqZWN0LCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaXNPYmplY3Qoe30pO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqXG4gICAqIF8uaXNPYmplY3QoWzEsIDIsIDNdKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzT2JqZWN0KDEpO1xuICAgKiAvLyA9PiBmYWxzZVxuICAgKi9cbiAgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICAvLyBjaGVjayBpZiB0aGUgdmFsdWUgaXMgdGhlIEVDTUFTY3JpcHQgbGFuZ3VhZ2UgdHlwZSBvZiBPYmplY3RcbiAgICAvLyBodHRwOi8vZXM1LmdpdGh1Yi5jb20vI3g4XG4gICAgLy8gYW5kIGF2b2lkIGEgVjggYnVnXG4gICAgLy8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL3Y4L2lzc3Vlcy9kZXRhaWw/aWQ9MjI5MVxuICAgIHJldHVybiB2YWx1ZSA/IG9iamVjdFR5cGVzW3R5cGVvZiB2YWx1ZV0gOiBmYWxzZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBgTmFOYC5cbiAgICpcbiAgICogTm90ZTogVGhpcyBpcyBub3QgdGhlIHNhbWUgYXMgbmF0aXZlIGBpc05hTmAsIHdoaWNoIHdpbGwgcmV0dXJuIGB0cnVlYCBmb3JcbiAgICogYHVuZGVmaW5lZGAgYW5kIG90aGVyIHZhbHVlcy4gU2VlIGh0dHA6Ly9lczUuZ2l0aHViLmNvbS8jeDE1LjEuMi40LlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGBOYU5gLCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaXNOYU4oTmFOKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzTmFOKG5ldyBOdW1iZXIoTmFOKSk7XG4gICAqIC8vID0+IHRydWVcbiAgICpcbiAgICogaXNOYU4odW5kZWZpbmVkKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmlzTmFOKHVuZGVmaW5lZCk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqL1xuICBmdW5jdGlvbiBpc05hTih2YWx1ZSkge1xuICAgIC8vIGBOYU5gIGFzIGEgcHJpbWl0aXZlIGlzIHRoZSBvbmx5IHZhbHVlIHRoYXQgaXMgbm90IGVxdWFsIHRvIGl0c2VsZlxuICAgIC8vIChwZXJmb3JtIHRoZSBbW0NsYXNzXV0gY2hlY2sgZmlyc3QgdG8gYXZvaWQgZXJyb3JzIHdpdGggc29tZSBob3N0IG9iamVjdHMgaW4gSUUpXG4gICAgcmV0dXJuIGlzTnVtYmVyKHZhbHVlKSAmJiB2YWx1ZSAhPSArdmFsdWVcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgYHZhbHVlYCBpcyBgbnVsbGAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYG51bGxgLCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaXNOdWxsKG51bGwpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqXG4gICAqIF8uaXNOdWxsKHVuZGVmaW5lZCk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqL1xuICBmdW5jdGlvbiBpc051bGwodmFsdWUpIHtcbiAgICByZXR1cm4gdmFsdWUgPT09IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSBudW1iZXIuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSBudW1iZXIsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc051bWJlcig4LjQgKiA1KTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKi9cbiAgZnVuY3Rpb24gaXNOdW1iZXIodmFsdWUpIHtcbiAgICByZXR1cm4gdHlwZW9mIHZhbHVlID09ICdudW1iZXInIHx8IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IG51bWJlckNsYXNzO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBhIGdpdmVuIGB2YWx1ZWAgaXMgYW4gb2JqZWN0IGNyZWF0ZWQgYnkgdGhlIGBPYmplY3RgIGNvbnN0cnVjdG9yLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGB2YWx1ZWAgaXMgYSBwbGFpbiBvYmplY3QsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogZnVuY3Rpb24gU3Rvb2dlKG5hbWUsIGFnZSkge1xuICAgKiAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAqICAgdGhpcy5hZ2UgPSBhZ2U7XG4gICAqIH1cbiAgICpcbiAgICogXy5pc1BsYWluT2JqZWN0KG5ldyBTdG9vZ2UoJ21vZScsIDQwKSk7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqXG4gICAqIF8uaXNQbGFpbk9iamVjdChbMSwgMiwgM10pO1xuICAgKiAvLyA9PiBmYWxzZVxuICAgKlxuICAgKiBfLmlzUGxhaW5PYmplY3QoeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfSk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIHZhciBpc1BsYWluT2JqZWN0ID0gIWdldFByb3RvdHlwZU9mID8gc2hpbUlzUGxhaW5PYmplY3QgOiBmdW5jdGlvbih2YWx1ZSkge1xuICAgIGlmICghKHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PSAnb2JqZWN0JykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgdmFyIHZhbHVlT2YgPSB2YWx1ZS52YWx1ZU9mLFxuICAgICAgICBvYmpQcm90byA9IHR5cGVvZiB2YWx1ZU9mID09ICdmdW5jdGlvbicgJiYgKG9ialByb3RvID0gZ2V0UHJvdG90eXBlT2YodmFsdWVPZikpICYmIGdldFByb3RvdHlwZU9mKG9ialByb3RvKTtcblxuICAgIHJldHVybiBvYmpQcm90b1xuICAgICAgPyB2YWx1ZSA9PSBvYmpQcm90byB8fCAoZ2V0UHJvdG90eXBlT2YodmFsdWUpID09IG9ialByb3RvICYmICFpc0FyZ3VtZW50cyh2YWx1ZSkpXG4gICAgICA6IHNoaW1Jc1BsYWluT2JqZWN0KHZhbHVlKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYSByZWd1bGFyIGV4cHJlc3Npb24uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYSByZWd1bGFyIGV4cHJlc3Npb24sIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc1JlZ0V4cCgvbW9lLyk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIGlzUmVnRXhwKHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlIGluc3RhbmNlb2YgUmVnRXhwIHx8IHRvU3RyaW5nLmNhbGwodmFsdWUpID09IHJlZ2V4cENsYXNzO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBgdmFsdWVgIGlzIGEgc3RyaW5nLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBPYmplY3RzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBjaGVjay5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdmFsdWVgIGlzIGEgc3RyaW5nLCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaXNTdHJpbmcoJ21vZScpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICBmdW5jdGlvbiBpc1N0cmluZyh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3N0cmluZycgfHwgdG9TdHJpbmcuY2FsbCh2YWx1ZSkgPT0gc3RyaW5nQ2xhc3M7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIGB2YWx1ZWAgaXMgYHVuZGVmaW5lZGAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7Qm9vbGVhbn0gUmV0dXJucyBgdHJ1ZWAgaWYgdGhlIGB2YWx1ZWAgaXMgYHVuZGVmaW5lZGAsIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5pc1VuZGVmaW5lZCh2b2lkIDApO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqL1xuICBmdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWx1ZSkge1xuICAgIHJldHVybiB0eXBlb2YgdmFsdWUgPT0gJ3VuZGVmaW5lZCc7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBhcnJheSBjb21wb3NlZCBvZiB0aGUgb3duIGVudW1lcmFibGUgcHJvcGVydHkgbmFtZXMgb2YgYG9iamVjdGAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBwcm9wZXJ0eSBuYW1lcy5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5rZXlzKHsgJ29uZSc6IDEsICd0d28nOiAyLCAndGhyZWUnOiAzIH0pO1xuICAgKiAvLyA9PiBbJ29uZScsICd0d28nLCAndGhyZWUnXSAob3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAqL1xuICB2YXIga2V5cyA9ICFuYXRpdmVLZXlzID8gc2hpbUtleXMgOiBmdW5jdGlvbihvYmplY3QpIHtcbiAgICAvLyBhdm9pZCBpdGVyYXRpbmcgb3ZlciB0aGUgYHByb3RvdHlwZWAgcHJvcGVydHlcbiAgICByZXR1cm4gdHlwZW9mIG9iamVjdCA9PSAnZnVuY3Rpb24nICYmIHByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwob2JqZWN0LCAncHJvdG90eXBlJylcbiAgICAgID8gc2hpbUtleXMob2JqZWN0KVxuICAgICAgOiAoaXNPYmplY3Qob2JqZWN0KSA/IG5hdGl2ZUtleXMob2JqZWN0KSA6IFtdKTtcbiAgfTtcblxuICAvKipcbiAgICogTWVyZ2VzIGVudW1lcmFibGUgcHJvcGVydGllcyBvZiB0aGUgc291cmNlIG9iamVjdChzKSBpbnRvIHRoZSBgZGVzdGluYXRpb25gXG4gICAqIG9iamVjdC4gU3Vic2VxdWVudCBzb3VyY2VzIHdpbGwgb3ZlcndyaXRlIHByb3BlcnkgYXNzaWdubWVudHMgb2YgcHJldmlvdXNcbiAgICogc291cmNlcy5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBkZXN0aW5hdGlvbiBvYmplY3QuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBbc291cmNlMSwgc291cmNlMiwgLi4uXSBUaGUgc291cmNlIG9iamVjdHMuXG4gICAqIEBwYXJhbS0ge09iamVjdH0gW2luZGljYXRvcl0gSW50ZXJuYWxseSB1c2VkIHRvIGluZGljYXRlIHRoYXQgdGhlIGBzdGFja2BcbiAgICogIGFyZ3VtZW50IGlzIGFuIGFycmF5IG9mIHRyYXZlcnNlZCBvYmplY3RzIGluc3RlYWQgb2YgYW5vdGhlciBzb3VyY2Ugb2JqZWN0LlxuICAgKiBAcGFyYW0tIHtBcnJheX0gW3N0YWNrQT1bXV0gSW50ZXJuYWxseSB1c2VkIHRvIHRyYWNrIHRyYXZlcnNlZCBzb3VyY2Ugb2JqZWN0cy5cbiAgICogQHBhcmFtLSB7QXJyYXl9IFtzdGFja0I9W11dIEludGVybmFsbHkgdXNlZCB0byBhc3NvY2lhdGUgdmFsdWVzIHdpdGggdGhlaXJcbiAgICogIHNvdXJjZSBjb3VudGVycGFydHMuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGRlc3RpbmF0aW9uIG9iamVjdC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIHN0b29nZXMgPSBbXG4gICAqICAgeyAnbmFtZSc6ICdtb2UnIH0sXG4gICAqICAgeyAnbmFtZSc6ICdsYXJyeScgfVxuICAgKiBdO1xuICAgKlxuICAgKiB2YXIgYWdlcyA9IFtcbiAgICogICB7ICdhZ2UnOiA0MCB9LFxuICAgKiAgIHsgJ2FnZSc6IDUwIH1cbiAgICogXTtcbiAgICpcbiAgICogXy5tZXJnZShzdG9vZ2VzLCBhZ2VzKTtcbiAgICogLy8gPT4gW3sgJ25hbWUnOiAnbW9lJywgJ2FnZSc6IDQwIH0sIHsgJ25hbWUnOiAnbGFycnknLCAnYWdlJzogNTAgfV1cbiAgICovXG4gIGZ1bmN0aW9uIG1lcmdlKG9iamVjdCwgc291cmNlLCBpbmRpY2F0b3IpIHtcbiAgICB2YXIgYXJncyA9IGFyZ3VtZW50cyxcbiAgICAgICAgaW5kZXggPSAwLFxuICAgICAgICBsZW5ndGggPSAyLFxuICAgICAgICBzdGFja0EgPSBhcmdzWzNdLFxuICAgICAgICBzdGFja0IgPSBhcmdzWzRdO1xuXG4gICAgaWYgKGluZGljYXRvciAhPT0gaW5kaWNhdG9yT2JqZWN0KSB7XG4gICAgICBzdGFja0EgPSBbXTtcbiAgICAgIHN0YWNrQiA9IFtdO1xuXG4gICAgICAvLyB3b3JrIHdpdGggYF8ucmVkdWNlYCBieSBvbmx5IHVzaW5nIGl0cyBjYWxsYmFjayBgYWNjdW11bGF0b3JgIGFuZCBgdmFsdWVgIGFyZ3VtZW50c1xuICAgICAgaWYgKHR5cGVvZiBpbmRpY2F0b3IgIT0gJ251bWJlcicpIHtcbiAgICAgICAgbGVuZ3RoID0gYXJncy5sZW5ndGg7XG4gICAgICB9XG4gICAgfVxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICBmb3JPd24oYXJnc1tpbmRleF0sIGZ1bmN0aW9uKHNvdXJjZSwga2V5KSB7XG4gICAgICAgIHZhciBmb3VuZCwgaXNBcnIsIHZhbHVlO1xuICAgICAgICBpZiAoc291cmNlICYmICgoaXNBcnIgPSBpc0FycmF5KHNvdXJjZSkpIHx8IGlzUGxhaW5PYmplY3Qoc291cmNlKSkpIHtcbiAgICAgICAgICAvLyBhdm9pZCBtZXJnaW5nIHByZXZpb3VzbHkgbWVyZ2VkIGN5Y2xpYyBzb3VyY2VzXG4gICAgICAgICAgdmFyIHN0YWNrTGVuZ3RoID0gc3RhY2tBLmxlbmd0aDtcbiAgICAgICAgICB3aGlsZSAoc3RhY2tMZW5ndGgtLSkge1xuICAgICAgICAgICAgZm91bmQgPSBzdGFja0Fbc3RhY2tMZW5ndGhdID09IHNvdXJjZTtcbiAgICAgICAgICAgIGlmIChmb3VuZCkge1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGZvdW5kKSB7XG4gICAgICAgICAgICBvYmplY3Rba2V5XSA9IHN0YWNrQltzdGFja0xlbmd0aF07XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gYWRkIGBzb3VyY2VgIGFuZCBhc3NvY2lhdGVkIGB2YWx1ZWAgdG8gdGhlIHN0YWNrIG9mIHRyYXZlcnNlZCBvYmplY3RzXG4gICAgICAgICAgICBzdGFja0EucHVzaChzb3VyY2UpO1xuICAgICAgICAgICAgc3RhY2tCLnB1c2godmFsdWUgPSAodmFsdWUgPSBvYmplY3Rba2V5XSwgaXNBcnIpXG4gICAgICAgICAgICAgID8gKGlzQXJyYXkodmFsdWUpID8gdmFsdWUgOiBbXSlcbiAgICAgICAgICAgICAgOiAoaXNQbGFpbk9iamVjdCh2YWx1ZSkgPyB2YWx1ZSA6IHt9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIC8vIHJlY3Vyc2l2ZWx5IG1lcmdlIG9iamVjdHMgYW5kIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgICAgICAgICBvYmplY3Rba2V5XSA9IG1lcmdlKHZhbHVlLCBzb3VyY2UsIGluZGljYXRvck9iamVjdCwgc3RhY2tBLCBzdGFja0IpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChzb3VyY2UgIT0gbnVsbCkge1xuICAgICAgICAgIG9iamVjdFtrZXldID0gc291cmNlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG9iamVjdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgc2hhbGxvdyBjbG9uZSBvZiBgb2JqZWN0YCBleGNsdWRpbmcgdGhlIHNwZWNpZmllZCBwcm9wZXJ0aWVzLlxuICAgKiBQcm9wZXJ0eSBuYW1lcyBtYXkgYmUgc3BlY2lmaWVkIGFzIGluZGl2aWR1YWwgYXJndW1lbnRzIG9yIGFzIGFycmF5cyBvZlxuICAgKiBwcm9wZXJ0eSBuYW1lcy4gSWYgYGNhbGxiYWNrYCBpcyBwYXNzZWQsIGl0IHdpbGwgYmUgZXhlY3V0ZWQgZm9yIGVhY2ggcHJvcGVydHlcbiAgICogaW4gdGhlIGBvYmplY3RgLCBvbWl0dGluZyB0aGUgcHJvcGVydGllcyBgY2FsbGJhY2tgIHJldHVybnMgdHJ1dGh5IGZvci4gVGhlXG4gICAqIGBjYWxsYmFja2AgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGtleSwgb2JqZWN0KS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gY2FsbGJhY2t8W3Byb3AxLCBwcm9wMiwgLi4uXSBUaGUgcHJvcGVydGllcyB0byBvbWl0XG4gICAqICBvciB0aGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBhbiBvYmplY3Qgd2l0aG91dCB0aGUgb21pdHRlZCBwcm9wZXJ0aWVzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLm9taXQoeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAsICd1c2VyaWQnOiAnbW9lMScgfSwgJ3VzZXJpZCcpO1xuICAgKiAvLyA9PiB7ICduYW1lJzogJ21vZScsICdhZ2UnOiA0MCB9XG4gICAqXG4gICAqIF8ub21pdCh7ICduYW1lJzogJ21vZScsICdfaGludCc6ICdrbnVja2xlaGVhZCcsICdfc2VlZCc6ICc5NmM0ZWInIH0sIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICogICByZXR1cm4ga2V5LmNoYXJBdCgwKSA9PSAnXyc7XG4gICAqIH0pO1xuICAgKiAvLyA9PiB7ICduYW1lJzogJ21vZScgfVxuICAgKi9cbiAgZnVuY3Rpb24gb21pdChvYmplY3QsIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgdmFyIGlzRnVuYyA9IHR5cGVvZiBjYWxsYmFjayA9PSAnZnVuY3Rpb24nLFxuICAgICAgICByZXN1bHQgPSB7fTtcblxuICAgIGlmIChpc0Z1bmMpIHtcbiAgICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgcHJvcHMgPSBjb25jYXQuYXBwbHkoYXJyYXlSZWYsIGFyZ3VtZW50cyk7XG4gICAgfVxuICAgIGZvckluKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSwgb2JqZWN0KSB7XG4gICAgICBpZiAoaXNGdW5jXG4gICAgICAgICAgICA/ICFjYWxsYmFjayh2YWx1ZSwga2V5LCBvYmplY3QpXG4gICAgICAgICAgICA6IGluZGV4T2YocHJvcHMsIGtleSwgMSkgPCAwXG4gICAgICAgICAgKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgdHdvIGRpbWVuc2lvbmFsIGFycmF5IG9mIHRoZSBnaXZlbiBvYmplY3QncyBrZXktdmFsdWUgcGFpcnMsXG4gICAqIGkuZS4gYFtba2V5MSwgdmFsdWUxXSwgW2tleTIsIHZhbHVlMl1dYC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIG5ldyBhcnJheSBvZiBrZXktdmFsdWUgcGFpcnMuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ucGFpcnMoeyAnbW9lJzogMzAsICdsYXJyeSc6IDQwLCAnY3VybHknOiA1MCB9KTtcbiAgICogLy8gPT4gW1snbW9lJywgMzBdLCBbJ2xhcnJ5JywgNDBdLCBbJ2N1cmx5JywgNTBdXSAob3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAqL1xuICBmdW5jdGlvbiBwYWlycyhvYmplY3QpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgZm9yT3duKG9iamVjdCwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgcmVzdWx0LnB1c2goW2tleSwgdmFsdWVdKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBzaGFsbG93IGNsb25lIG9mIGBvYmplY3RgIGNvbXBvc2VkIG9mIHRoZSBzcGVjaWZpZWQgcHJvcGVydGllcy5cbiAgICogUHJvcGVydHkgbmFtZXMgbWF5IGJlIHNwZWNpZmllZCBhcyBpbmRpdmlkdWFsIGFyZ3VtZW50cyBvciBhcyBhcnJheXMgb2ZcbiAgICogcHJvcGVydHkgbmFtZXMuIElmIGBjYWxsYmFja2AgaXMgcGFzc2VkLCBpdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIHByb3BlcnR5XG4gICAqIGluIHRoZSBgb2JqZWN0YCwgcGlja2luZyB0aGUgcHJvcGVydGllcyBgY2FsbGJhY2tgIHJldHVybnMgdHJ1dGh5IGZvci4gVGhlXG4gICAqIGBjYWxsYmFja2AgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGtleSwgb2JqZWN0KS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgT2JqZWN0c1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBzb3VyY2Ugb2JqZWN0LlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gY2FsbGJhY2t8W3Byb3AxLCBwcm9wMiwgLi4uXSBUaGUgcHJvcGVydGllcyB0byBwaWNrXG4gICAqICBvciB0aGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyBhbiBvYmplY3QgY29tcG9zZWQgb2YgdGhlIHBpY2tlZCBwcm9wZXJ0aWVzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLnBpY2soeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAsICd1c2VyaWQnOiAnbW9lMScgfSwgJ25hbWUnLCAnYWdlJyk7XG4gICAqIC8vID0+IHsgJ25hbWUnOiAnbW9lJywgJ2FnZSc6IDQwIH1cbiAgICpcbiAgICogXy5waWNrKHsgJ25hbWUnOiAnbW9lJywgJ19oaW50JzogJ2tudWNrbGVoZWFkJywgJ19zZWVkJzogJzk2YzRlYicgfSwgZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgKiAgIHJldHVybiBrZXkuY2hhckF0KDApICE9ICdfJztcbiAgICogfSk7XG4gICAqIC8vID0+IHsgJ25hbWUnOiAnbW9lJyB9XG4gICAqL1xuICBmdW5jdGlvbiBwaWNrKG9iamVjdCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPSAnZnVuY3Rpb24nKSB7XG4gICAgICB2YXIgaW5kZXggPSAwLFxuICAgICAgICAgIHByb3BzID0gY29uY2F0LmFwcGx5KGFycmF5UmVmLCBhcmd1bWVudHMpLFxuICAgICAgICAgIGxlbmd0aCA9IHByb3BzLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgdmFyIGtleSA9IHByb3BzW2luZGV4XTtcbiAgICAgICAgaWYgKGtleSBpbiBvYmplY3QpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IG9iamVjdFtrZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgICAgZm9ySW4ob2JqZWN0LCBmdW5jdGlvbih2YWx1ZSwga2V5LCBvYmplY3QpIHtcbiAgICAgICAgaWYgKGNhbGxiYWNrKHZhbHVlLCBrZXksIG9iamVjdCkpIHtcbiAgICAgICAgICByZXN1bHRba2V5XSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGFycmF5IGNvbXBvc2VkIG9mIHRoZSBvd24gZW51bWVyYWJsZSBwcm9wZXJ0eSB2YWx1ZXMgb2YgYG9iamVjdGAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IE9iamVjdHNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRvIGluc3BlY3QuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8udmFsdWVzKHsgJ29uZSc6IDEsICd0d28nOiAyLCAndGhyZWUnOiAzIH0pO1xuICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICovXG4gIGZ1bmN0aW9uIHZhbHVlcyhvYmplY3QpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgZm9yT3duKG9iamVjdCwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiBhIGdpdmVuIGB0YXJnZXRgIGVsZW1lbnQgaXMgcHJlc2VudCBpbiBhIGBjb2xsZWN0aW9uYCB1c2luZyBzdHJpY3RcbiAgICogZXF1YWxpdHkgZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLiBJZiBgZnJvbUluZGV4YCBpcyBuZWdhdGl2ZSwgaXQgaXMgdXNlZFxuICAgKiBhcyB0aGUgb2Zmc2V0IGZyb20gdGhlIGVuZCBvZiB0aGUgY29sbGVjdGlvbi5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgaW5jbHVkZVxuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtNaXhlZH0gdGFyZ2V0IFRoZSB2YWx1ZSB0byBjaGVjayBmb3IuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZnJvbUluZGV4PTBdIFRoZSBpbmRleCB0byBzZWFyY2ggZnJvbS5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIHRoZSBgdGFyZ2V0YCBlbGVtZW50IGlzIGZvdW5kLCBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uY29udGFpbnMoWzEsIDIsIDNdLCAxKTtcbiAgICogLy8gPT4gdHJ1ZVxuICAgKlxuICAgKiBfLmNvbnRhaW5zKFsxLCAyLCAzXSwgMSwgMik7XG4gICAqIC8vID0+IGZhbHNlXG4gICAqXG4gICAqIF8uY29udGFpbnMoeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfSwgJ21vZScpO1xuICAgKiAvLyA9PiB0cnVlXG4gICAqXG4gICAqIF8uY29udGFpbnMoJ2N1cmx5JywgJ3VyJyk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIGNvbnRhaW5zKGNvbGxlY3Rpb24sIHRhcmdldCwgZnJvbUluZGV4KSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDAsXG4gICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuXG4gICAgZnJvbUluZGV4ID0gKGZyb21JbmRleCA8IDAgPyBuYXRpdmVNYXgoMCwgbGVuZ3RoICsgZnJvbUluZGV4KSA6IGZyb21JbmRleCkgfHwgMDtcbiAgICBpZiAodHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJykge1xuICAgICAgcmVzdWx0ID0gKGlzU3RyaW5nKGNvbGxlY3Rpb24pXG4gICAgICAgID8gY29sbGVjdGlvbi5pbmRleE9mKHRhcmdldCwgZnJvbUluZGV4KVxuICAgICAgICA6IGluZGV4T2YoY29sbGVjdGlvbiwgdGFyZ2V0LCBmcm9tSW5kZXgpXG4gICAgICApID4gLTE7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgaWYgKCsraW5kZXggPj0gZnJvbUluZGV4KSB7XG4gICAgICAgICAgcmV0dXJuICEocmVzdWx0ID0gdmFsdWUgPT09IHRhcmdldCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIGtleXMgcmV0dXJuZWQgZnJvbSBydW5uaW5nIGVhY2ggZWxlbWVudCBvZlxuICAgKiBgY29sbGVjdGlvbmAgdGhyb3VnaCBhIGBjYWxsYmFja2AuIFRoZSBjb3JyZXNwb25kaW5nIHZhbHVlIG9mIGVhY2gga2V5IGlzXG4gICAqIHRoZSBudW1iZXIgb2YgdGltZXMgdGhlIGtleSB3YXMgcmV0dXJuZWQgYnkgYGNhbGxiYWNrYC4gVGhlIGBjYWxsYmFja2AgaXNcbiAgICogYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAqIFRoZSBgY2FsbGJhY2tgIGFyZ3VtZW50IG1heSBhbHNvIGJlIHRoZSBuYW1lIG9mIGEgcHJvcGVydHkgdG8gY291bnQgYnkgKGUuZy4gJ2xlbmd0aCcpLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gY2FsbGJhY2t8cHJvcGVydHkgVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uXG4gICAqICBvciBwcm9wZXJ0eSBuYW1lIHRvIGNvdW50IGJ5LlxuICAgKiBAcGFyYW0ge01peGVkfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGNvbXBvc2VkIGFnZ3JlZ2F0ZSBvYmplY3QuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uY291bnRCeShbNC4zLCA2LjEsIDYuNF0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gTWF0aC5mbG9vcihudW0pOyB9KTtcbiAgICogLy8gPT4geyAnNCc6IDEsICc2JzogMiB9XG4gICAqXG4gICAqIF8uY291bnRCeShbNC4zLCA2LjEsIDYuNF0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gdGhpcy5mbG9vcihudW0pOyB9LCBNYXRoKTtcbiAgICogLy8gPT4geyAnNCc6IDEsICc2JzogMiB9XG4gICAqXG4gICAqIF8uY291bnRCeShbJ29uZScsICd0d28nLCAndGhyZWUnXSwgJ2xlbmd0aCcpO1xuICAgKiAvLyA9PiB7ICczJzogMiwgJzUnOiAxIH1cbiAgICovXG4gIGZ1bmN0aW9uIGNvdW50QnkoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgY2FsbGJhY2sgPSBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZyk7XG5cbiAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pIHtcbiAgICAgIGtleSA9IGNhbGxiYWNrKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pO1xuICAgICAgKGhhc093blByb3BlcnR5LmNhbGwocmVzdWx0LCBrZXkpID8gcmVzdWx0W2tleV0rKyA6IHJlc3VsdFtrZXldID0gMSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVja3MgaWYgdGhlIGBjYWxsYmFja2AgcmV0dXJucyBhIHRydXRoeSB2YWx1ZSBmb3IgKiphbGwqKiBlbGVtZW50cyBvZiBhXG4gICAqIGBjb2xsZWN0aW9uYC4gVGhlIGBjYWxsYmFja2AgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWVcbiAgICogYXJndW1lbnRzOyAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGFsaWFzIGFsbFxuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFsbCBlbGVtZW50cyBwYXNzIHRoZSBjYWxsYmFjayBjaGVjayxcbiAgICogIGVsc2UgYGZhbHNlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5ldmVyeShbdHJ1ZSwgMSwgbnVsbCwgJ3llcyddLCBCb29sZWFuKTtcbiAgICogLy8gPT4gZmFsc2VcbiAgICovXG4gIGZ1bmN0aW9uIGV2ZXJ5KGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgdmFyIHJlc3VsdCA9IHRydWU7XG4gICAgY2FsbGJhY2sgPSBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZyk7XG5cbiAgICBpZiAoaXNBcnJheShjb2xsZWN0aW9uKSkge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIGlmICghKHJlc3VsdCA9ICEhY2FsbGJhY2soY29sbGVjdGlvbltpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKSkpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICByZXR1cm4gKHJlc3VsdCA9ICEhY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGFtaW5lcyBlYWNoIGVsZW1lbnQgaW4gYSBgY29sbGVjdGlvbmAsIHJldHVybmluZyBhbiBhcnJheSBvZiBhbGwgZWxlbWVudHNcbiAgICogdGhlIGBjYWxsYmFja2AgcmV0dXJucyB0cnV0aHkgZm9yLiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kXG4gICAqIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgc2VsZWN0XG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgZWxlbWVudHMgdGhhdCBwYXNzZWQgdGhlIGNhbGxiYWNrIGNoZWNrLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgZXZlbnMgPSBfLmZpbHRlcihbMSwgMiwgMywgNCwgNSwgNl0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gbnVtICUgMiA9PSAwOyB9KTtcbiAgICogLy8gPT4gWzIsIDQsIDZdXG4gICAqL1xuICBmdW5jdGlvbiBmaWx0ZXIoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgY2FsbGJhY2sgPSBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZyk7XG5cbiAgICBpZiAoaXNBcnJheShjb2xsZWN0aW9uKSkge1xuICAgICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IGNvbGxlY3Rpb25baW5kZXhdO1xuICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgICBpZiAoY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSkge1xuICAgICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogRXhhbWluZXMgZWFjaCBlbGVtZW50IGluIGEgYGNvbGxlY3Rpb25gLCByZXR1cm5pbmcgdGhlIGZpcnN0IG9uZSB0aGUgYGNhbGxiYWNrYFxuICAgKiByZXR1cm5zIHRydXRoeSBmb3IuIFRoZSBmdW5jdGlvbiByZXR1cm5zIGFzIHNvb24gYXMgaXQgZmluZHMgYW4gYWNjZXB0YWJsZVxuICAgKiBlbGVtZW50LCBhbmQgZG9lcyBub3QgaXRlcmF0ZSBvdmVyIHRoZSBlbnRpcmUgYGNvbGxlY3Rpb25gLiBUaGUgYGNhbGxiYWNrYCBpc1xuICAgKiBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgZGV0ZWN0XG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgdGhlIGVsZW1lbnQgdGhhdCBwYXNzZWQgdGhlIGNhbGxiYWNrIGNoZWNrLFxuICAgKiAgZWxzZSBgdW5kZWZpbmVkYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGV2ZW4gPSBfLmZpbmQoWzEsIDIsIDMsIDQsIDUsIDZdLCBmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAlIDIgPT0gMDsgfSk7XG4gICAqIC8vID0+IDJcbiAgICovXG4gIGZ1bmN0aW9uIGZpbmQoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0O1xuICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuXG4gICAgZm9yRWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgIGlmIChjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pKSB7XG4gICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBJdGVyYXRlcyBvdmVyIGEgYGNvbGxlY3Rpb25gLCBleGVjdXRpbmcgdGhlIGBjYWxsYmFja2AgZm9yIGVhY2ggZWxlbWVudCBpblxuICAgKiB0aGUgYGNvbGxlY3Rpb25gLiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZVxuICAgKiBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS4gQ2FsbGJhY2tzIG1heSBleGl0IGl0ZXJhdGlvbiBlYXJseVxuICAgKiBieSBleHBsaWNpdGx5IHJldHVybmluZyBgZmFsc2VgLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBhbGlhcyBlYWNoXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7QXJyYXl8T2JqZWN0fFN0cmluZ30gUmV0dXJucyBgY29sbGVjdGlvbmAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8oWzEsIDIsIDNdKS5mb3JFYWNoKGFsZXJ0KS5qb2luKCcsJyk7XG4gICAqIC8vID0+IGFsZXJ0cyBlYWNoIG51bWJlciBhbmQgcmV0dXJucyAnMSwyLDMnXG4gICAqXG4gICAqIF8uZm9yRWFjaCh7ICdvbmUnOiAxLCAndHdvJzogMiwgJ3RocmVlJzogMyB9LCBhbGVydCk7XG4gICAqIC8vID0+IGFsZXJ0cyBlYWNoIG51bWJlciB2YWx1ZSAob3JkZXIgaXMgbm90IGd1YXJhbnRlZWQpXG4gICAqL1xuICBmdW5jdGlvbiBmb3JFYWNoKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgaWYgKGNhbGxiYWNrICYmIHR5cGVvZiB0aGlzQXJnID09ICd1bmRlZmluZWQnICYmIGlzQXJyYXkoY29sbGVjdGlvbikpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICBpZiAoY2FsbGJhY2soY29sbGVjdGlvbltpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBlYWNoKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbGxlY3Rpb247XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBvYmplY3QgY29tcG9zZWQgb2Yga2V5cyByZXR1cm5lZCBmcm9tIHJ1bm5pbmcgZWFjaCBlbGVtZW50IG9mXG4gICAqIGBjb2xsZWN0aW9uYCB0aHJvdWdoIGEgYGNhbGxiYWNrYC4gVGhlIGNvcnJlc3BvbmRpbmcgdmFsdWUgb2YgZWFjaCBrZXkgaXMgYW5cbiAgICogYXJyYXkgb2YgZWxlbWVudHMgcGFzc2VkIHRvIGBjYWxsYmFja2AgdGhhdCByZXR1cm5lZCB0aGUga2V5LiBUaGUgYGNhbGxiYWNrYFxuICAgKiBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICogVGhlIGBjYWxsYmFja2AgYXJndW1lbnQgbWF5IGFsc28gYmUgdGhlIG5hbWUgb2YgYSBwcm9wZXJ0eSB0byBncm91cCBieSAoZS5nLiAnbGVuZ3RoJykuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBjYWxsYmFja3xwcm9wZXJ0eSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb25cbiAgICogIG9yIHByb3BlcnR5IG5hbWUgdG8gZ3JvdXAgYnkuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge09iamVjdH0gUmV0dXJucyB0aGUgY29tcG9zZWQgYWdncmVnYXRlIG9iamVjdC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5ncm91cEJ5KFs0LjIsIDYuMSwgNi40XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBNYXRoLmZsb29yKG51bSk7IH0pO1xuICAgKiAvLyA9PiB7ICc0JzogWzQuMl0sICc2JzogWzYuMSwgNi40XSB9XG4gICAqXG4gICAqIF8uZ3JvdXBCeShbNC4yLCA2LjEsIDYuNF0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gdGhpcy5mbG9vcihudW0pOyB9LCBNYXRoKTtcbiAgICogLy8gPT4geyAnNCc6IFs0LjJdLCAnNic6IFs2LjEsIDYuNF0gfVxuICAgKlxuICAgKiBfLmdyb3VwQnkoWydvbmUnLCAndHdvJywgJ3RocmVlJ10sICdsZW5ndGgnKTtcbiAgICogLy8gPT4geyAnMyc6IFsnb25lJywgJ3R3byddLCAnNSc6IFsndGhyZWUnXSB9XG4gICAqL1xuICBmdW5jdGlvbiBncm91cEJ5KGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuXG4gICAgZm9yRWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKSB7XG4gICAgICBrZXkgPSBjYWxsYmFjayh2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKTtcbiAgICAgIChoYXNPd25Qcm9wZXJ0eS5jYWxsKHJlc3VsdCwga2V5KSA/IHJlc3VsdFtrZXldIDogcmVzdWx0W2tleV0gPSBbXSkucHVzaCh2YWx1ZSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbnZva2VzIHRoZSBtZXRob2QgbmFtZWQgYnkgYG1ldGhvZE5hbWVgIG9uIGVhY2ggZWxlbWVudCBpbiB0aGUgYGNvbGxlY3Rpb25gLFxuICAgKiByZXR1cm5pbmcgYW4gYXJyYXkgb2YgdGhlIHJlc3VsdHMgb2YgZWFjaCBpbnZva2VkIG1ldGhvZC4gQWRkaXRpb25hbCBhcmd1bWVudHNcbiAgICogd2lsbCBiZSBwYXNzZWQgdG8gZWFjaCBpbnZva2VkIG1ldGhvZC4gSWYgYG1ldGhvZE5hbWVgIGlzIGEgZnVuY3Rpb24gaXQgd2lsbFxuICAgKiBiZSBpbnZva2VkIGZvciwgYW5kIGB0aGlzYCBib3VuZCB0bywgZWFjaCBlbGVtZW50IGluIHRoZSBgY29sbGVjdGlvbmAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBtZXRob2ROYW1lIFRoZSBuYW1lIG9mIHRoZSBtZXRob2QgdG8gaW52b2tlIG9yXG4gICAqICB0aGUgZnVuY3Rpb24gaW52b2tlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBbYXJnMSwgYXJnMiwgLi4uXSBBcmd1bWVudHMgdG8gaW52b2tlIHRoZSBtZXRob2Qgd2l0aC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHRoZSByZXN1bHRzIG9mIGVhY2ggaW52b2tlZCBtZXRob2QuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaW52b2tlKFtbNSwgMSwgN10sIFszLCAyLCAxXV0sICdzb3J0Jyk7XG4gICAqIC8vID0+IFtbMSwgNSwgN10sIFsxLCAyLCAzXV1cbiAgICpcbiAgICogXy5pbnZva2UoWzEyMywgNDU2XSwgU3RyaW5nLnByb3RvdHlwZS5zcGxpdCwgJycpO1xuICAgKiAvLyA9PiBbWycxJywgJzInLCAnMyddLCBbJzQnLCAnNScsICc2J11dXG4gICAqL1xuICBmdW5jdGlvbiBpbnZva2UoY29sbGVjdGlvbiwgbWV0aG9kTmFtZSkge1xuICAgIHZhciBhcmdzID0gc2xpY2UoYXJndW1lbnRzLCAyKSxcbiAgICAgICAgaXNGdW5jID0gdHlwZW9mIG1ldGhvZE5hbWUgPT0gJ2Z1bmN0aW9uJyxcbiAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICByZXN1bHQucHVzaCgoaXNGdW5jID8gbWV0aG9kTmFtZSA6IHZhbHVlW21ldGhvZE5hbWVdKS5hcHBseSh2YWx1ZSwgYXJncykpO1xuICAgIH0pO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiB2YWx1ZXMgYnkgcnVubmluZyBlYWNoIGVsZW1lbnQgaW4gdGhlIGBjb2xsZWN0aW9uYFxuICAgKiB0aHJvdWdoIGEgYGNhbGxiYWNrYC4gVGhlIGBjYWxsYmFja2AgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGhcbiAgICogdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGFsaWFzIGNvbGxlY3RcbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiB0aGUgcmVzdWx0cyBvZiBlYWNoIGBjYWxsYmFja2AgZXhlY3V0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLm1hcChbMSwgMiwgM10sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gbnVtICogMzsgfSk7XG4gICAqIC8vID0+IFszLCA2LCA5XVxuICAgKlxuICAgKiBfLm1hcCh7ICdvbmUnOiAxLCAndHdvJzogMiwgJ3RocmVlJzogMyB9LCBmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAqIDM7IH0pO1xuICAgKiAvLyA9PiBbMywgNiwgOV0gKG9yZGVyIGlzIG5vdCBndWFyYW50ZWVkKVxuICAgKi9cbiAgZnVuY3Rpb24gbWFwKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24gPyBjb2xsZWN0aW9uLmxlbmd0aCA6IDAsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KHR5cGVvZiBsZW5ndGggPT0gJ251bWJlcicgPyBsZW5ndGggOiAwKTtcblxuICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIGlmIChpc0FycmF5KGNvbGxlY3Rpb24pKSB7XG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICByZXN1bHRbaW5kZXhdID0gY2FsbGJhY2soY29sbGVjdGlvbltpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwga2V5LCBjb2xsZWN0aW9uKSB7XG4gICAgICAgIHJlc3VsdFsrK2luZGV4XSA9IGNhbGxiYWNrKHZhbHVlLCBrZXksIGNvbGxlY3Rpb24pO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIHRoZSBtYXhpbXVtIHZhbHVlIG9mIGFuIGBhcnJheWAuIElmIGBjYWxsYmFja2AgaXMgcGFzc2VkLFxuICAgKiBpdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBlYWNoIHZhbHVlIGluIHRoZSBgYXJyYXlgIHRvIGdlbmVyYXRlIHRoZVxuICAgKiBjcml0ZXJpb24gYnkgd2hpY2ggdGhlIHZhbHVlIGlzIHJhbmtlZC4gVGhlIGBjYWxsYmFja2AgaXMgYm91bmQgdG9cbiAgICogYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrXSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge01peGVkfSBSZXR1cm5zIHRoZSBtYXhpbXVtIHZhbHVlLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgc3Rvb2dlcyA9IFtcbiAgICogICB7ICduYW1lJzogJ21vZScsICdhZ2UnOiA0MCB9LFxuICAgKiAgIHsgJ25hbWUnOiAnbGFycnknLCAnYWdlJzogNTAgfSxcbiAgICogICB7ICduYW1lJzogJ2N1cmx5JywgJ2FnZSc6IDYwIH1cbiAgICogXTtcbiAgICpcbiAgICogXy5tYXgoc3Rvb2dlcywgZnVuY3Rpb24oc3Rvb2dlKSB7IHJldHVybiBzdG9vZ2UuYWdlOyB9KTtcbiAgICogLy8gPT4geyAnbmFtZSc6ICdjdXJseScsICdhZ2UnOiA2MCB9O1xuICAgKi9cbiAgZnVuY3Rpb24gbWF4KGNvbGxlY3Rpb24sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgdmFyIGNvbXB1dGVkID0gLUluZmluaXR5LFxuICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwLFxuICAgICAgICByZXN1bHQgPSBjb21wdXRlZDtcblxuICAgIGlmIChjYWxsYmFjayB8fCAhaXNBcnJheShjb2xsZWN0aW9uKSkge1xuICAgICAgY2FsbGJhY2sgPSAhY2FsbGJhY2sgJiYgaXNTdHJpbmcoY29sbGVjdGlvbilcbiAgICAgICAgPyBjaGFyQXRDYWxsYmFja1xuICAgICAgICA6IGNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnKTtcblxuICAgICAgZWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICBpZiAoY3VycmVudCA+IGNvbXB1dGVkKSB7XG4gICAgICAgICAgY29tcHV0ZWQgPSBjdXJyZW50O1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKGNvbGxlY3Rpb25baW5kZXhdID4gcmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0ID0gY29sbGVjdGlvbltpbmRleF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgdGhlIG1pbmltdW0gdmFsdWUgb2YgYW4gYGFycmF5YC4gSWYgYGNhbGxiYWNrYCBpcyBwYXNzZWQsXG4gICAqIGl0IHdpbGwgYmUgZXhlY3V0ZWQgZm9yIGVhY2ggdmFsdWUgaW4gdGhlIGBhcnJheWAgdG8gZ2VuZXJhdGUgdGhlXG4gICAqIGNyaXRlcmlvbiBieSB3aGljaCB0aGUgdmFsdWUgaXMgcmFua2VkLiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2BcbiAgICogYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2tdIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgdGhlIG1pbmltdW0gdmFsdWUuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ubWluKFsxMCwgNSwgMTAwLCAyLCAxMDAwXSk7XG4gICAqIC8vID0+IDJcbiAgICovXG4gIGZ1bmN0aW9uIG1pbihjb2xsZWN0aW9uLCBjYWxsYmFjaywgdGhpc0FyZykge1xuICAgIHZhciBjb21wdXRlZCA9IEluZmluaXR5LFxuICAgICAgICBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwLFxuICAgICAgICByZXN1bHQgPSBjb21wdXRlZDtcblxuICAgIGlmIChjYWxsYmFjayB8fCAhaXNBcnJheShjb2xsZWN0aW9uKSkge1xuICAgICAgY2FsbGJhY2sgPSAhY2FsbGJhY2sgJiYgaXNTdHJpbmcoY29sbGVjdGlvbilcbiAgICAgICAgPyBjaGFyQXRDYWxsYmFja1xuICAgICAgICA6IGNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnKTtcblxuICAgICAgZWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgICAgICBpZiAoY3VycmVudCA8IGNvbXB1dGVkKSB7XG4gICAgICAgICAgY29tcHV0ZWQgPSBjdXJyZW50O1xuICAgICAgICAgIHJlc3VsdCA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKGNvbGxlY3Rpb25baW5kZXhdIDwgcmVzdWx0KSB7XG4gICAgICAgICAgcmVzdWx0ID0gY29sbGVjdGlvbltpbmRleF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgdGhlIHZhbHVlIG9mIGEgc3BlY2lmaWVkIHByb3BlcnR5IGZyb20gYWxsIGVsZW1lbnRzIGluXG4gICAqIHRoZSBgY29sbGVjdGlvbmAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBwcm9wZXJ0eSBUaGUgcHJvcGVydHkgdG8gcGx1Y2suXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBwcm9wZXJ0eSB2YWx1ZXMuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBzdG9vZ2VzID0gW1xuICAgKiAgIHsgJ25hbWUnOiAnbW9lJywgJ2FnZSc6IDQwIH0sXG4gICAqICAgeyAnbmFtZSc6ICdsYXJyeScsICdhZ2UnOiA1MCB9LFxuICAgKiAgIHsgJ25hbWUnOiAnY3VybHknLCAnYWdlJzogNjAgfVxuICAgKiBdO1xuICAgKlxuICAgKiBfLnBsdWNrKHN0b29nZXMsICduYW1lJyk7XG4gICAqIC8vID0+IFsnbW9lJywgJ2xhcnJ5JywgJ2N1cmx5J11cbiAgICovXG4gIGZ1bmN0aW9uIHBsdWNrKGNvbGxlY3Rpb24sIHByb3BlcnR5KSB7XG4gICAgcmV0dXJuIG1hcChjb2xsZWN0aW9uLCBwcm9wZXJ0eSArICcnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCb2lscyBkb3duIGEgYGNvbGxlY3Rpb25gIHRvIGEgc2luZ2xlIHZhbHVlLiBUaGUgaW5pdGlhbCBzdGF0ZSBvZiB0aGVcbiAgICogcmVkdWN0aW9uIGlzIGBhY2N1bXVsYXRvcmAgYW5kIGVhY2ggc3VjY2Vzc2l2ZSBzdGVwIG9mIGl0IHNob3VsZCBiZSByZXR1cm5lZFxuICAgKiBieSB0aGUgYGNhbGxiYWNrYC4gVGhlIGBjYWxsYmFja2AgaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggNFxuICAgKiBhcmd1bWVudHM7IGZvciBhcnJheXMgdGhleSBhcmUgKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXh8a2V5LCBjb2xsZWN0aW9uKS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgZm9sZGwsIGluamVjdFxuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFthY2N1bXVsYXRvcl0gSW5pdGlhbCB2YWx1ZSBvZiB0aGUgYWNjdW11bGF0b3IuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge01peGVkfSBSZXR1cm5zIHRoZSBhY2N1bXVsYXRlZCB2YWx1ZS5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIHN1bSA9IF8ucmVkdWNlKFsxLCAyLCAzXSwgZnVuY3Rpb24obWVtbywgbnVtKSB7IHJldHVybiBtZW1vICsgbnVtOyB9KTtcbiAgICogLy8gPT4gNlxuICAgKi9cbiAgZnVuY3Rpb24gcmVkdWNlKGNvbGxlY3Rpb24sIGNhbGxiYWNrLCBhY2N1bXVsYXRvciwgdGhpc0FyZykge1xuICAgIHZhciBub2FjY3VtID0gYXJndW1lbnRzLmxlbmd0aCA8IDM7XG4gICAgY2FsbGJhY2sgPSBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZywgaW5kaWNhdG9yT2JqZWN0KTtcblxuICAgIGlmIChpc0FycmF5KGNvbGxlY3Rpb24pKSB7XG4gICAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgICBsZW5ndGggPSBjb2xsZWN0aW9uLmxlbmd0aDtcblxuICAgICAgaWYgKG5vYWNjdW0pIHtcbiAgICAgICAgYWNjdW11bGF0b3IgPSBjb2xsZWN0aW9uWysraW5kZXhdO1xuICAgICAgfVxuICAgICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgICAgYWNjdW11bGF0b3IgPSBjYWxsYmFjayhhY2N1bXVsYXRvciwgY29sbGVjdGlvbltpbmRleF0sIGluZGV4LCBjb2xsZWN0aW9uKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgYWNjdW11bGF0b3IgPSBub2FjY3VtXG4gICAgICAgICAgPyAobm9hY2N1bSA9IGZhbHNlLCB2YWx1ZSlcbiAgICAgICAgICA6IGNhbGxiYWNrKGFjY3VtdWxhdG9yLCB2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pXG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSByaWdodC1hc3NvY2lhdGl2ZSB2ZXJzaW9uIG9mIGBfLnJlZHVjZWAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGFsaWFzIGZvbGRyXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaXRlcmF0ZSBvdmVyLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY2FsbGJhY2s9aWRlbnRpdHldIFRoZSBmdW5jdGlvbiBjYWxsZWQgcGVyIGl0ZXJhdGlvbi5cbiAgICogQHBhcmFtIHtNaXhlZH0gW2FjY3VtdWxhdG9yXSBJbml0aWFsIHZhbHVlIG9mIHRoZSBhY2N1bXVsYXRvci5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgdGhlIGFjY3VtdWxhdGVkIHZhbHVlLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgbGlzdCA9IFtbMCwgMV0sIFsyLCAzXSwgWzQsIDVdXTtcbiAgICogdmFyIGZsYXQgPSBfLnJlZHVjZVJpZ2h0KGxpc3QsIGZ1bmN0aW9uKGEsIGIpIHsgcmV0dXJuIGEuY29uY2F0KGIpOyB9LCBbXSk7XG4gICAqIC8vID0+IFs0LCA1LCAyLCAzLCAwLCAxXVxuICAgKi9cbiAgZnVuY3Rpb24gcmVkdWNlUmlnaHQoY29sbGVjdGlvbiwgY2FsbGJhY2ssIGFjY3VtdWxhdG9yLCB0aGlzQXJnKSB7XG4gICAgdmFyIGl0ZXJhdGVlID0gY29sbGVjdGlvbixcbiAgICAgICAgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMCxcbiAgICAgICAgbm9hY2N1bSA9IGFyZ3VtZW50cy5sZW5ndGggPCAzO1xuXG4gICAgaWYgKHR5cGVvZiBsZW5ndGggIT0gJ251bWJlcicpIHtcbiAgICAgIHZhciBwcm9wcyA9IGtleXMoY29sbGVjdGlvbik7XG4gICAgICBsZW5ndGggPSBwcm9wcy5sZW5ndGg7XG4gICAgfSBlbHNlIGlmIChub0NoYXJCeUluZGV4ICYmIGlzU3RyaW5nKGNvbGxlY3Rpb24pKSB7XG4gICAgICBpdGVyYXRlZSA9IGNvbGxlY3Rpb24uc3BsaXQoJycpO1xuICAgIH1cbiAgICBjYWxsYmFjayA9IGNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnLCBpbmRpY2F0b3JPYmplY3QpO1xuICAgIGZvckVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSB7XG4gICAgICBpbmRleCA9IHByb3BzID8gcHJvcHNbLS1sZW5ndGhdIDogLS1sZW5ndGg7XG4gICAgICBhY2N1bXVsYXRvciA9IG5vYWNjdW1cbiAgICAgICAgPyAobm9hY2N1bSA9IGZhbHNlLCBpdGVyYXRlZVtpbmRleF0pXG4gICAgICAgIDogY2FsbGJhY2soYWNjdW11bGF0b3IsIGl0ZXJhdGVlW2luZGV4XSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgIH0pO1xuICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGUgb3Bwb3NpdGUgb2YgYF8uZmlsdGVyYCwgdGhpcyBtZXRob2QgcmV0dXJucyB0aGUgdmFsdWVzIG9mIGFcbiAgICogYGNvbGxlY3Rpb25gIHRoYXQgYGNhbGxiYWNrYCBkb2VzICoqbm90KiogcmV0dXJuIHRydXRoeSBmb3IuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjYWxsYmFjaz1pZGVudGl0eV0gVGhlIGZ1bmN0aW9uIGNhbGxlZCBwZXIgaXRlcmF0aW9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBbdGhpc0FyZ10gVGhlIGB0aGlzYCBiaW5kaW5nIG9mIGBjYWxsYmFja2AuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBhcnJheSBvZiBlbGVtZW50cyB0aGF0IGRpZCAqKm5vdCoqIHBhc3MgdGhlXG4gICAqICBjYWxsYmFjayBjaGVjay5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIG9kZHMgPSBfLnJlamVjdChbMSwgMiwgMywgNCwgNSwgNl0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gbnVtICUgMiA9PSAwOyB9KTtcbiAgICogLy8gPT4gWzEsIDMsIDVdXG4gICAqL1xuICBmdW5jdGlvbiByZWplY3QoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICBjYWxsYmFjayA9IGNyZWF0ZUNhbGxiYWNrKGNhbGxiYWNrLCB0aGlzQXJnKTtcbiAgICByZXR1cm4gZmlsdGVyKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgcmV0dXJuICFjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pO1xuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gYXJyYXkgb2Ygc2h1ZmZsZWQgYGFycmF5YCB2YWx1ZXMsIHVzaW5nIGEgdmVyc2lvbiBvZiB0aGVcbiAgICogRmlzaGVyLVlhdGVzIHNodWZmbGUuIFNlZSBodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Zpc2hlci1ZYXRlc19zaHVmZmxlLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gc2h1ZmZsZS5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IHNodWZmbGVkIGNvbGxlY3Rpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uc2h1ZmZsZShbMSwgMiwgMywgNCwgNSwgNl0pO1xuICAgKiAvLyA9PiBbNCwgMSwgNiwgMywgNSwgMl1cbiAgICovXG4gIGZ1bmN0aW9uIHNodWZmbGUoY29sbGVjdGlvbikge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICByZXN1bHQgPSBBcnJheShjb2xsZWN0aW9uID8gY29sbGVjdGlvbi5sZW5ndGggOiAwKTtcblxuICAgIGZvckVhY2goY29sbGVjdGlvbiwgZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIHZhciByYW5kID0gZmxvb3IobmF0aXZlUmFuZG9tKCkgKiAoKytpbmRleCArIDEpKTtcbiAgICAgIHJlc3VsdFtpbmRleF0gPSByZXN1bHRbcmFuZF07XG4gICAgICByZXN1bHRbcmFuZF0gPSB2YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIHNpemUgb2YgdGhlIGBjb2xsZWN0aW9uYCBieSByZXR1cm5pbmcgYGNvbGxlY3Rpb24ubGVuZ3RoYCBmb3IgYXJyYXlzXG4gICAqIGFuZCBhcnJheS1saWtlIG9iamVjdHMgb3IgdGhlIG51bWJlciBvZiBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGZvciBvYmplY3RzLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBDb2xsZWN0aW9uc1xuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdHxTdHJpbmd9IGNvbGxlY3Rpb24gVGhlIGNvbGxlY3Rpb24gdG8gaW5zcGVjdC5cbiAgICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBgY29sbGVjdGlvbi5sZW5ndGhgIG9yIG51bWJlciBvZiBvd24gZW51bWVyYWJsZSBwcm9wZXJ0aWVzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLnNpemUoWzEsIDJdKTtcbiAgICogLy8gPT4gMlxuICAgKlxuICAgKiBfLnNpemUoeyAnb25lJzogMSwgJ3R3byc6IDIsICd0aHJlZSc6IDMgfSk7XG4gICAqIC8vID0+IDNcbiAgICpcbiAgICogXy5zaXplKCdjdXJseScpO1xuICAgKiAvLyA9PiA1XG4gICAqL1xuICBmdW5jdGlvbiBzaXplKGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMDtcbiAgICByZXR1cm4gdHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJyA/IGxlbmd0aCA6IGtleXMoY29sbGVjdGlvbikubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiB0aGUgYGNhbGxiYWNrYCByZXR1cm5zIGEgdHJ1dGh5IHZhbHVlIGZvciAqKmFueSoqIGVsZW1lbnQgb2YgYVxuICAgKiBgY29sbGVjdGlvbmAuIFRoZSBmdW5jdGlvbiByZXR1cm5zIGFzIHNvb24gYXMgaXQgZmluZHMgcGFzc2luZyB2YWx1ZSwgYW5kXG4gICAqIGRvZXMgbm90IGl0ZXJhdGUgb3ZlciB0aGUgZW50aXJlIGBjb2xsZWN0aW9uYC4gVGhlIGBjYWxsYmFja2AgaXMgYm91bmQgdG9cbiAgICogYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGFsaWFzIGFueVxuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge0Jvb2xlYW59IFJldHVybnMgYHRydWVgIGlmIGFueSBlbGVtZW50IHBhc3NlcyB0aGUgY2FsbGJhY2sgY2hlY2ssXG4gICAqICBlbHNlIGBmYWxzZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uc29tZShbbnVsbCwgMCwgJ3llcycsIGZhbHNlXSwgQm9vbGVhbik7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIHNvbWUoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0O1xuICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuXG4gICAgaWYgKGlzQXJyYXkoY29sbGVjdGlvbikpIHtcbiAgICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICAgIGxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoO1xuXG4gICAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgICBpZiAoKHJlc3VsdCA9IGNhbGxiYWNrKGNvbGxlY3Rpb25baW5kZXhdLCBpbmRleCwgY29sbGVjdGlvbikpKSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZWFjaChjb2xsZWN0aW9uLCBmdW5jdGlvbih2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pIHtcbiAgICAgICAgcmV0dXJuICEocmVzdWx0ID0gY2FsbGJhY2sodmFsdWUsIGluZGV4LCBjb2xsZWN0aW9uKSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuICEhcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gYXJyYXksIHN0YWJsZSBzb3J0ZWQgaW4gYXNjZW5kaW5nIG9yZGVyIGJ5IHRoZSByZXN1bHRzIG9mXG4gICAqIHJ1bm5pbmcgZWFjaCBlbGVtZW50IG9mIGBjb2xsZWN0aW9uYCB0aHJvdWdoIGEgYGNhbGxiYWNrYC4gVGhlIGBjYWxsYmFja2BcbiAgICogaXMgYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggdGhyZWUgYXJndW1lbnRzOyAodmFsdWUsIGluZGV4fGtleSwgY29sbGVjdGlvbikuXG4gICAqIFRoZSBgY2FsbGJhY2tgIGFyZ3VtZW50IG1heSBhbHNvIGJlIHRoZSBuYW1lIG9mIGEgcHJvcGVydHkgdG8gc29ydCBieSAoZS5nLiAnbGVuZ3RoJykuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBpdGVyYXRlIG92ZXIuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb258U3RyaW5nfSBjYWxsYmFja3xwcm9wZXJ0eSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb25cbiAgICogIG9yIHByb3BlcnR5IG5hbWUgdG8gc29ydCBieS5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgY2FsbGJhY2tgLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2Ygc29ydGVkIGVsZW1lbnRzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLnNvcnRCeShbMSwgMiwgM10sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gTWF0aC5zaW4obnVtKTsgfSk7XG4gICAqIC8vID0+IFszLCAxLCAyXVxuICAgKlxuICAgKiBfLnNvcnRCeShbMSwgMiwgM10sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gdGhpcy5zaW4obnVtKTsgfSwgTWF0aCk7XG4gICAqIC8vID0+IFszLCAxLCAyXVxuICAgKlxuICAgKiBfLnNvcnRCeShbJ2xhcnJ5JywgJ2JyZW5kYW4nLCAnbW9lJ10sICdsZW5ndGgnKTtcbiAgICogLy8gPT4gWydtb2UnLCAnbGFycnknLCAnYnJlbmRhbiddXG4gICAqL1xuICBmdW5jdGlvbiBzb3J0QnkoY29sbGVjdGlvbiwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgY2FsbGJhY2sgPSBjcmVhdGVDYWxsYmFjayhjYWxsYmFjaywgdGhpc0FyZyk7XG5cbiAgICBmb3JFYWNoKGNvbGxlY3Rpb24sIGZ1bmN0aW9uKHZhbHVlLCBpbmRleCwgY29sbGVjdGlvbikge1xuICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAnY3JpdGVyaWEnOiBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGNvbGxlY3Rpb24pLFxuICAgICAgICAnaW5kZXgnOiBpbmRleCxcbiAgICAgICAgJ3ZhbHVlJzogdmFsdWVcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdmFyIGxlbmd0aCA9IHJlc3VsdC5sZW5ndGg7XG4gICAgcmVzdWx0LnNvcnQoY29tcGFyZUFzY2VuZGluZyk7XG4gICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICByZXN1bHRbbGVuZ3RoXSA9IHJlc3VsdFtsZW5ndGhdLnZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZlcnRzIHRoZSBgY29sbGVjdGlvbmAgdG8gYW4gYXJyYXkuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IENvbGxlY3Rpb25zXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fFN0cmluZ30gY29sbGVjdGlvbiBUaGUgY29sbGVjdGlvbiB0byBjb252ZXJ0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgdGhlIG5ldyBjb252ZXJ0ZWQgYXJyYXkuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIChmdW5jdGlvbigpIHsgcmV0dXJuIF8udG9BcnJheShhcmd1bWVudHMpLnNsaWNlKDEpOyB9KSgxLCAyLCAzLCA0KTtcbiAgICogLy8gPT4gWzIsIDMsIDRdXG4gICAqL1xuICBmdW5jdGlvbiB0b0FycmF5KGNvbGxlY3Rpb24pIHtcbiAgICB2YXIgbGVuZ3RoID0gY29sbGVjdGlvbiA/IGNvbGxlY3Rpb24ubGVuZ3RoIDogMDtcbiAgICBpZiAodHlwZW9mIGxlbmd0aCA9PSAnbnVtYmVyJykge1xuICAgICAgcmV0dXJuIG5vQ2hhckJ5SW5kZXggJiYgaXNTdHJpbmcoY29sbGVjdGlvbilcbiAgICAgICAgPyBjb2xsZWN0aW9uLnNwbGl0KCcnKVxuICAgICAgICA6IHNsaWNlKGNvbGxlY3Rpb24pO1xuICAgIH1cbiAgICByZXR1cm4gdmFsdWVzKGNvbGxlY3Rpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4YW1pbmVzIGVhY2ggZWxlbWVudCBpbiBhIGBjb2xsZWN0aW9uYCwgcmV0dXJuaW5nIGFuIGFycmF5IG9mIGFsbCBlbGVtZW50c1xuICAgKiB0aGF0IGNvbnRhaW4gdGhlIGdpdmVuIGBwcm9wZXJ0aWVzYC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQ29sbGVjdGlvbnNcbiAgICogQHBhcmFtIHtBcnJheXxPYmplY3R8U3RyaW5nfSBjb2xsZWN0aW9uIFRoZSBjb2xsZWN0aW9uIHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtPYmplY3R9IHByb3BlcnRpZXMgVGhlIG9iamVjdCBvZiBwcm9wZXJ0eSB2YWx1ZXMgdG8gZmlsdGVyIGJ5LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgZWxlbWVudHMgdGhhdCBjb250YWluIHRoZSBnaXZlbiBgcHJvcGVydGllc2AuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBzdG9vZ2VzID0gW1xuICAgKiAgIHsgJ25hbWUnOiAnbW9lJywgJ2FnZSc6IDQwIH0sXG4gICAqICAgeyAnbmFtZSc6ICdsYXJyeScsICdhZ2UnOiA1MCB9LFxuICAgKiAgIHsgJ25hbWUnOiAnY3VybHknLCAnYWdlJzogNjAgfVxuICAgKiBdO1xuICAgKlxuICAgKiBfLndoZXJlKHN0b29nZXMsIHsgJ2FnZSc6IDQwIH0pO1xuICAgKiAvLyA9PiBbeyAnbmFtZSc6ICdtb2UnLCAnYWdlJzogNDAgfV1cbiAgICovXG4gIGZ1bmN0aW9uIHdoZXJlKGNvbGxlY3Rpb24sIHByb3BlcnRpZXMpIHtcbiAgICB2YXIgcHJvcHMgPSBrZXlzKHByb3BlcnRpZXMpO1xuICAgIHJldHVybiBmaWx0ZXIoY29sbGVjdGlvbiwgZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gcHJvcHMubGVuZ3RoO1xuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSBvYmplY3RbcHJvcHNbbGVuZ3RoXV0gPT09IHByb3BlcnRpZXNbcHJvcHNbbGVuZ3RoXV07XG4gICAgICAgIGlmICghcmVzdWx0KSB7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiAhIXJlc3VsdDtcbiAgICB9KTtcbiAgfVxuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuIGFycmF5IHdpdGggYWxsIGZhbHNleSB2YWx1ZXMgb2YgYGFycmF5YCByZW1vdmVkLiBUaGUgdmFsdWVzXG4gICAqIGBmYWxzZWAsIGBudWxsYCwgYDBgLCBgXCJcImAsIGB1bmRlZmluZWRgIGFuZCBgTmFOYCBhcmUgYWxsIGZhbHNleS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBjb21wYWN0LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgZmlsdGVyZWQgYXJyYXkuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uY29tcGFjdChbMCwgMSwgZmFsc2UsIDIsICcnLCAzXSk7XG4gICAqIC8vID0+IFsxLCAyLCAzXVxuICAgKi9cbiAgZnVuY3Rpb24gY29tcGFjdChhcnJheSkge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICByZXN1bHQucHVzaCh2YWx1ZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhbiBhcnJheSBvZiBgYXJyYXlgIGVsZW1lbnRzIG5vdCBwcmVzZW50IGluIHRoZSBvdGhlciBhcnJheXNcbiAgICogdXNpbmcgc3RyaWN0IGVxdWFsaXR5IGZvciBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBwcm9jZXNzLlxuICAgKiBAcGFyYW0ge0FycmF5fSBbYXJyYXkxLCBhcnJheTIsIC4uLl0gQXJyYXlzIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgYGFycmF5YCBlbGVtZW50cyBub3QgcHJlc2VudCBpbiB0aGVcbiAgICogIG90aGVyIGFycmF5cy5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5kaWZmZXJlbmNlKFsxLCAyLCAzLCA0LCA1XSwgWzUsIDIsIDEwXSk7XG4gICAqIC8vID0+IFsxLCAzLCA0XVxuICAgKi9cbiAgZnVuY3Rpb24gZGlmZmVyZW5jZShhcnJheSkge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgIGZsYXR0ZW5lZCA9IGNvbmNhdC5hcHBseShhcnJheVJlZiwgYXJndW1lbnRzKSxcbiAgICAgICAgY29udGFpbnMgPSBjYWNoZWRDb250YWlucyhmbGF0dGVuZWQsIGxlbmd0aCksXG4gICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgIGlmICghY29udGFpbnModmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBmaXJzdCBlbGVtZW50IG9mIHRoZSBgYXJyYXlgLiBQYXNzIGBuYCB0byByZXR1cm4gdGhlIGZpcnN0IGBuYFxuICAgKiBlbGVtZW50cyBvZiB0aGUgYGFycmF5YC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgaGVhZCwgdGFrZVxuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtuXSBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHJldHVybi5cbiAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEludGVybmFsbHkgdXNlZCB0byBhbGxvdyB0aGlzIG1ldGhvZCB0byB3b3JrIHdpdGhcbiAgICogIG90aGVycyBsaWtlIGBfLm1hcGAgd2l0aG91dCB1c2luZyB0aGVpciBjYWxsYmFjayBgaW5kZXhgIGFyZ3VtZW50IGZvciBgbmAuXG4gICAqIEByZXR1cm5zIHtNaXhlZH0gUmV0dXJucyB0aGUgZmlyc3QgZWxlbWVudCwgb3IgYW4gYXJyYXkgb2YgdGhlIGZpcnN0IGBuYFxuICAgKiAgZWxlbWVudHMsIG9mIGBhcnJheWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uZmlyc3QoWzUsIDQsIDMsIDIsIDFdKTtcbiAgICogLy8gPT4gNVxuICAgKi9cbiAgZnVuY3Rpb24gZmlyc3QoYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgaWYgKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgICAgcmV0dXJuIChuID09IG51bGwgfHwgZ3VhcmQpXG4gICAgICAgID8gYXJyYXlbMF1cbiAgICAgICAgOiBzbGljZShhcnJheSwgMCwgbmF0aXZlTWluKG5hdGl2ZU1heCgwLCBuKSwgbGVuZ3RoKSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEZsYXR0ZW5zIGEgbmVzdGVkIGFycmF5ICh0aGUgbmVzdGluZyBjYW4gYmUgdG8gYW55IGRlcHRoKS4gSWYgYHNoYWxsb3dgIGlzXG4gICAqIHRydXRoeSwgYGFycmF5YCB3aWxsIG9ubHkgYmUgZmxhdHRlbmVkIGEgc2luZ2xlIGxldmVsLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGNvbXBhY3QuXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc2hhbGxvdyBBIGZsYWcgdG8gaW5kaWNhdGUgb25seSBmbGF0dGVuaW5nIGEgc2luZ2xlIGxldmVsLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgZmxhdHRlbmVkIGFycmF5LlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLmZsYXR0ZW4oWzEsIFsyXSwgWzMsIFtbNF1dXV0pO1xuICAgKiAvLyA9PiBbMSwgMiwgMywgNF07XG4gICAqXG4gICAqIF8uZmxhdHRlbihbMSwgWzJdLCBbMywgW1s0XV1dXSwgdHJ1ZSk7XG4gICAqIC8vID0+IFsxLCAyLCAzLCBbWzRdXV07XG4gICAqL1xuICBmdW5jdGlvbiBmbGF0dGVuKGFycmF5LCBzaGFsbG93KSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMCxcbiAgICAgICAgcmVzdWx0ID0gW107XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdO1xuXG4gICAgICAvLyByZWN1cnNpdmVseSBmbGF0dGVuIGFycmF5cyAoc3VzY2VwdGlibGUgdG8gY2FsbCBzdGFjayBsaW1pdHMpXG4gICAgICBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgcHVzaC5hcHBseShyZXN1bHQsIHNoYWxsb3cgPyB2YWx1ZSA6IGZsYXR0ZW4odmFsdWUpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBpbmRleCBhdCB3aGljaCB0aGUgZmlyc3Qgb2NjdXJyZW5jZSBvZiBgdmFsdWVgIGlzIGZvdW5kIHVzaW5nXG4gICAqIHN0cmljdCBlcXVhbGl0eSBmb3IgY29tcGFyaXNvbnMsIGkuZS4gYD09PWAuIElmIHRoZSBgYXJyYXlgIGlzIGFscmVhZHlcbiAgICogc29ydGVkLCBwYXNzaW5nIGB0cnVlYCBmb3IgYGZyb21JbmRleGAgd2lsbCBydW4gYSBmYXN0ZXIgYmluYXJ5IHNlYXJjaC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBzZWFyY2guXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byBzZWFyY2ggZm9yLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW58TnVtYmVyfSBbZnJvbUluZGV4PTBdIFRoZSBpbmRleCB0byBzZWFyY2ggZnJvbSBvciBgdHJ1ZWAgdG9cbiAgICogIHBlcmZvcm0gYSBiaW5hcnkgc2VhcmNoIG9uIGEgc29ydGVkIGBhcnJheWAuXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlIG9yIGAtMWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaW5kZXhPZihbMSwgMiwgMywgMSwgMiwgM10sIDIpO1xuICAgKiAvLyA9PiAxXG4gICAqXG4gICAqIF8uaW5kZXhPZihbMSwgMiwgMywgMSwgMiwgM10sIDIsIDMpO1xuICAgKiAvLyA9PiA0XG4gICAqXG4gICAqIF8uaW5kZXhPZihbMSwgMSwgMiwgMiwgMywgM10sIDIsIHRydWUpO1xuICAgKiAvLyA9PiAyXG4gICAqL1xuICBmdW5jdGlvbiBpbmRleE9mKGFycmF5LCB2YWx1ZSwgZnJvbUluZGV4KSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMDtcblxuICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ID09ICdudW1iZXInKSB7XG4gICAgICBpbmRleCA9IChmcm9tSW5kZXggPCAwID8gbmF0aXZlTWF4KDAsIGxlbmd0aCArIGZyb21JbmRleCkgOiBmcm9tSW5kZXggfHwgMCkgLSAxO1xuICAgIH0gZWxzZSBpZiAoZnJvbUluZGV4KSB7XG4gICAgICBpbmRleCA9IHNvcnRlZEluZGV4KGFycmF5LCB2YWx1ZSk7XG4gICAgICByZXR1cm4gYXJyYXlbaW5kZXhdID09PSB2YWx1ZSA/IGluZGV4IDogLTE7XG4gICAgfVxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICBpZiAoYXJyYXlbaW5kZXhdID09PSB2YWx1ZSkge1xuICAgICAgICByZXR1cm4gaW5kZXg7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFsbCBidXQgdGhlIGxhc3QgZWxlbWVudCBvZiBgYXJyYXlgLiBQYXNzIGBuYCB0byBleGNsdWRlIHRoZSBsYXN0IGBuYFxuICAgKiBlbGVtZW50cyBmcm9tIHRoZSByZXN1bHQuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbj0xXSBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIGV4Y2x1ZGUuXG4gICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBJbnRlcm5hbGx5IHVzZWQgdG8gYWxsb3cgdGhpcyBtZXRob2QgdG8gd29yayB3aXRoXG4gICAqICBvdGhlcnMgbGlrZSBgXy5tYXBgIHdpdGhvdXQgdXNpbmcgdGhlaXIgY2FsbGJhY2sgYGluZGV4YCBhcmd1bWVudCBmb3IgYG5gLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYWxsIGJ1dCB0aGUgbGFzdCBlbGVtZW50LCBvciBgbmAgZWxlbWVudHMsIG9mIGBhcnJheWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaW5pdGlhbChbMywgMiwgMV0pO1xuICAgKiAvLyA9PiBbMywgMl1cbiAgICovXG4gIGZ1bmN0aW9uIGluaXRpYWwoYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgaWYgKCFhcnJheSkge1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgIG4gPSBuID09IG51bGwgfHwgZ3VhcmQgPyAxIDogbiB8fCAwO1xuICAgIHJldHVybiBzbGljZShhcnJheSwgMCwgbmF0aXZlTWluKG5hdGl2ZU1heCgwLCBsZW5ndGggLSBuKSwgbGVuZ3RoKSk7XG4gIH1cblxuICAvKipcbiAgICogQ29tcHV0ZXMgdGhlIGludGVyc2VjdGlvbiBvZiBhbGwgdGhlIHBhc3NlZC1pbiBhcnJheXMgdXNpbmcgc3RyaWN0IGVxdWFsaXR5XG4gICAqIGZvciBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheTEsIGFycmF5MiwgLi4uXSBBcnJheXMgdG8gcHJvY2Vzcy5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHVuaXF1ZSBlbGVtZW50cyB0aGF0IGFyZSBwcmVzZW50XG4gICAqICBpbiAqKmFsbCoqIG9mIHRoZSBhcnJheXMuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8uaW50ZXJzZWN0aW9uKFsxLCAyLCAzXSwgWzEwMSwgMiwgMSwgMTBdLCBbMiwgMV0pO1xuICAgKiAvLyA9PiBbMSwgMl1cbiAgICovXG4gIGZ1bmN0aW9uIGludGVyc2VjdGlvbihhcnJheSkge1xuICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICBhcmdzTGVuZ3RoID0gYXJncy5sZW5ndGgsXG4gICAgICAgIGNhY2hlID0geyAnMCc6IHt9IH0sXG4gICAgICAgIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogMCxcbiAgICAgICAgaXNMYXJnZSA9IGxlbmd0aCA+PSAxMDAsXG4gICAgICAgIHJlc3VsdCA9IFtdLFxuICAgICAgICBzZWVuID0gcmVzdWx0O1xuXG4gICAgb3V0ZXI6XG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgIGlmIChpc0xhcmdlKSB7XG4gICAgICAgIHZhciBrZXkgPSB2YWx1ZSArICcnO1xuICAgICAgICB2YXIgaW5pdGVkID0gaGFzT3duUHJvcGVydHkuY2FsbChjYWNoZVswXSwga2V5KVxuICAgICAgICAgID8gIShzZWVuID0gY2FjaGVbMF1ba2V5XSlcbiAgICAgICAgICA6IChzZWVuID0gY2FjaGVbMF1ba2V5XSA9IFtdKTtcbiAgICAgIH1cbiAgICAgIGlmIChpbml0ZWQgfHwgaW5kZXhPZihzZWVuLCB2YWx1ZSkgPCAwKSB7XG4gICAgICAgIGlmIChpc0xhcmdlKSB7XG4gICAgICAgICAgc2Vlbi5wdXNoKHZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYXJnc0luZGV4ID0gYXJnc0xlbmd0aDtcbiAgICAgICAgd2hpbGUgKC0tYXJnc0luZGV4KSB7XG4gICAgICAgICAgaWYgKCEoY2FjaGVbYXJnc0luZGV4XSB8fCAoY2FjaGVbYXJnc0luZGV4XSA9IGNhY2hlZENvbnRhaW5zKGFyZ3NbYXJnc0luZGV4XSwgMCwgMTAwKSkpKHZhbHVlKSkge1xuICAgICAgICAgICAgY29udGludWUgb3V0ZXI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBsYXN0IGVsZW1lbnQgb2YgdGhlIGBhcnJheWAuIFBhc3MgYG5gIHRvIHJldHVybiB0aGUgbGFzdCBgbmBcbiAgICogZWxlbWVudHMgb2YgdGhlIGBhcnJheWAuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEFycmF5c1xuICAgKiBAcGFyYW0ge0FycmF5fSBhcnJheSBUaGUgYXJyYXkgdG8gcXVlcnkuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbl0gVGhlIG51bWJlciBvZiBlbGVtZW50cyB0byByZXR1cm4uXG4gICAqIEBwYXJhbS0ge09iamVjdH0gW2d1YXJkXSBJbnRlcm5hbGx5IHVzZWQgdG8gYWxsb3cgdGhpcyBtZXRob2QgdG8gd29yayB3aXRoXG4gICAqICBvdGhlcnMgbGlrZSBgXy5tYXBgIHdpdGhvdXQgdXNpbmcgdGhlaXIgY2FsbGJhY2sgYGluZGV4YCBhcmd1bWVudCBmb3IgYG5gLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgdGhlIGxhc3QgZWxlbWVudCwgb3IgYW4gYXJyYXkgb2YgdGhlIGxhc3QgYG5gXG4gICAqICBlbGVtZW50cywgb2YgYGFycmF5YC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5sYXN0KFszLCAyLCAxXSk7XG4gICAqIC8vID0+IDFcbiAgICovXG4gIGZ1bmN0aW9uIGxhc3QoYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgaWYgKGFycmF5KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gYXJyYXkubGVuZ3RoO1xuICAgICAgcmV0dXJuIChuID09IG51bGwgfHwgZ3VhcmQpID8gYXJyYXlbbGVuZ3RoIC0gMV0gOiBzbGljZShhcnJheSwgbmF0aXZlTWF4KDAsIGxlbmd0aCAtIG4pKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgaW5kZXggYXQgd2hpY2ggdGhlIGxhc3Qgb2NjdXJyZW5jZSBvZiBgdmFsdWVgIGlzIGZvdW5kIHVzaW5nIHN0cmljdFxuICAgKiBlcXVhbGl0eSBmb3IgY29tcGFyaXNvbnMsIGkuZS4gYD09PWAuIElmIGBmcm9tSW5kZXhgIGlzIG5lZ2F0aXZlLCBpdCBpcyB1c2VkXG4gICAqIGFzIHRoZSBvZmZzZXQgZnJvbSB0aGUgZW5kIG9mIHRoZSBjb2xsZWN0aW9uLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHNlYXJjaC5cbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIHNlYXJjaCBmb3IuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbZnJvbUluZGV4PWFycmF5Lmxlbmd0aC0xXSBUaGUgaW5kZXggdG8gc2VhcmNoIGZyb20uXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9IFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBtYXRjaGVkIHZhbHVlIG9yIGAtMWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ubGFzdEluZGV4T2YoWzEsIDIsIDMsIDEsIDIsIDNdLCAyKTtcbiAgICogLy8gPT4gNFxuICAgKlxuICAgKiBfLmxhc3RJbmRleE9mKFsxLCAyLCAzLCAxLCAyLCAzXSwgMiwgMyk7XG4gICAqIC8vID0+IDFcbiAgICovXG4gIGZ1bmN0aW9uIGxhc3RJbmRleE9mKGFycmF5LCB2YWx1ZSwgZnJvbUluZGV4KSB7XG4gICAgdmFyIGluZGV4ID0gYXJyYXkgPyBhcnJheS5sZW5ndGggOiAwO1xuICAgIGlmICh0eXBlb2YgZnJvbUluZGV4ID09ICdudW1iZXInKSB7XG4gICAgICBpbmRleCA9IChmcm9tSW5kZXggPCAwID8gbmF0aXZlTWF4KDAsIGluZGV4ICsgZnJvbUluZGV4KSA6IG5hdGl2ZU1pbihmcm9tSW5kZXgsIGluZGV4IC0gMSkpICsgMTtcbiAgICB9XG4gICAgd2hpbGUgKGluZGV4LS0pIHtcbiAgICAgIGlmIChhcnJheVtpbmRleF0gPT09IHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBpbmRleDtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIC0xO1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gb2JqZWN0IGNvbXBvc2VkIGZyb20gYXJyYXlzIG9mIGBrZXlzYCBhbmQgYHZhbHVlc2AuIFBhc3MgZWl0aGVyXG4gICAqIGEgc2luZ2xlIHR3byBkaW1lbnNpb25hbCBhcnJheSwgaS5lLiBgW1trZXkxLCB2YWx1ZTFdLCBba2V5MiwgdmFsdWUyXV1gLCBvclxuICAgKiB0d28gYXJyYXlzLCBvbmUgb2YgYGtleXNgIGFuZCBvbmUgb2YgY29ycmVzcG9uZGluZyBgdmFsdWVzYC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGtleXMgVGhlIGFycmF5IG9mIGtleXMuXG4gICAqIEBwYXJhbSB7QXJyYXl9IFt2YWx1ZXM9W11dIFRoZSBhcnJheSBvZiB2YWx1ZXMuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYW4gb2JqZWN0IGNvbXBvc2VkIG9mIHRoZSBnaXZlbiBrZXlzIGFuZFxuICAgKiAgY29ycmVzcG9uZGluZyB2YWx1ZXMuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ub2JqZWN0KFsnbW9lJywgJ2xhcnJ5JywgJ2N1cmx5J10sIFszMCwgNDAsIDUwXSk7XG4gICAqIC8vID0+IHsgJ21vZSc6IDMwLCAnbGFycnknOiA0MCwgJ2N1cmx5JzogNTAgfVxuICAgKi9cbiAgZnVuY3Rpb24gb2JqZWN0KGtleXMsIHZhbHVlcykge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBrZXlzID8ga2V5cy5sZW5ndGggOiAwLFxuICAgICAgICByZXN1bHQgPSB7fTtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIga2V5ID0ga2V5c1tpbmRleF07XG4gICAgICBpZiAodmFsdWVzKSB7XG4gICAgICAgIHJlc3VsdFtrZXldID0gdmFsdWVzW2luZGV4XTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdFtrZXlbMF1dID0ga2V5WzFdO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gYXJyYXkgb2YgbnVtYmVycyAocG9zaXRpdmUgYW5kL29yIG5lZ2F0aXZlKSBwcm9ncmVzc2luZyBmcm9tXG4gICAqIGBzdGFydGAgdXAgdG8gYnV0IG5vdCBpbmNsdWRpbmcgYHN0b3BgLiBUaGlzIG1ldGhvZCBpcyBhIHBvcnQgb2YgUHl0aG9uJ3NcbiAgICogYHJhbmdlKClgIGZ1bmN0aW9uLiBTZWUgaHR0cDovL2RvY3MucHl0aG9uLm9yZy9saWJyYXJ5L2Z1bmN0aW9ucy5odG1sI3JhbmdlLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtzdGFydD0wXSBUaGUgc3RhcnQgb2YgdGhlIHJhbmdlLlxuICAgKiBAcGFyYW0ge051bWJlcn0gZW5kIFRoZSBlbmQgb2YgdGhlIHJhbmdlLlxuICAgKiBAcGFyYW0ge051bWJlcn0gW3N0ZXA9MV0gVGhlIHZhbHVlIHRvIGluY3JlbWVudCBvciBkZXNjcmVtZW50IGJ5LlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgcmFuZ2UgYXJyYXkuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ucmFuZ2UoMTApO1xuICAgKiAvLyA9PiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgNywgOCwgOV1cbiAgICpcbiAgICogXy5yYW5nZSgxLCAxMSk7XG4gICAqIC8vID0+IFsxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5LCAxMF1cbiAgICpcbiAgICogXy5yYW5nZSgwLCAzMCwgNSk7XG4gICAqIC8vID0+IFswLCA1LCAxMCwgMTUsIDIwLCAyNV1cbiAgICpcbiAgICogXy5yYW5nZSgwLCAtMTAsIC0xKTtcbiAgICogLy8gPT4gWzAsIC0xLCAtMiwgLTMsIC00LCAtNSwgLTYsIC03LCAtOCwgLTldXG4gICAqXG4gICAqIF8ucmFuZ2UoMCk7XG4gICAqIC8vID0+IFtdXG4gICAqL1xuICBmdW5jdGlvbiByYW5nZShzdGFydCwgZW5kLCBzdGVwKSB7XG4gICAgc3RhcnQgPSArc3RhcnQgfHwgMDtcbiAgICBzdGVwID0gK3N0ZXAgfHwgMTtcblxuICAgIGlmIChlbmQgPT0gbnVsbCkge1xuICAgICAgZW5kID0gc3RhcnQ7XG4gICAgICBzdGFydCA9IDA7XG4gICAgfVxuICAgIC8vIHVzZSBgQXJyYXkobGVuZ3RoKWAgc28gVjggd2lsbCBhdm9pZCB0aGUgc2xvd2VyIFwiZGljdGlvbmFyeVwiIG1vZGVcbiAgICAvLyBodHRwOi8veW91dHUuYmUvWEFxSXBHVThaWmsjdD0xN20yNXNcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgbGVuZ3RoID0gbmF0aXZlTWF4KDAsIGNlaWwoKGVuZCAtIHN0YXJ0KSAvIHN0ZXApKSxcbiAgICAgICAgcmVzdWx0ID0gQXJyYXkobGVuZ3RoKTtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICByZXN1bHRbaW5kZXhdID0gc3RhcnQ7XG4gICAgICBzdGFydCArPSBzdGVwO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIFRoZSBvcHBvc2l0ZSBvZiBgXy5pbml0aWFsYCwgdGhpcyBtZXRob2QgZ2V0cyBhbGwgYnV0IHRoZSBmaXJzdCB2YWx1ZSBvZlxuICAgKiBgYXJyYXlgLiBQYXNzIGBuYCB0byBleGNsdWRlIHRoZSBmaXJzdCBgbmAgdmFsdWVzIGZyb20gdGhlIHJlc3VsdC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgZHJvcCwgdGFpbFxuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IGFycmF5IFRoZSBhcnJheSB0byBxdWVyeS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IFtuPTFdIFRoZSBudW1iZXIgb2YgZWxlbWVudHMgdG8gZXhjbHVkZS5cbiAgICogQHBhcmFtLSB7T2JqZWN0fSBbZ3VhcmRdIEludGVybmFsbHkgdXNlZCB0byBhbGxvdyB0aGlzIG1ldGhvZCB0byB3b3JrIHdpdGhcbiAgICogIG90aGVycyBsaWtlIGBfLm1hcGAgd2l0aG91dCB1c2luZyB0aGVpciBjYWxsYmFjayBgaW5kZXhgIGFyZ3VtZW50IGZvciBgbmAuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhbGwgYnV0IHRoZSBmaXJzdCBlbGVtZW50LCBvciBgbmAgZWxlbWVudHMsIG9mIGBhcnJheWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ucmVzdChbMywgMiwgMV0pO1xuICAgKiAvLyA9PiBbMiwgMV1cbiAgICovXG4gIGZ1bmN0aW9uIHJlc3QoYXJyYXksIG4sIGd1YXJkKSB7XG4gICAgcmV0dXJuIHNsaWNlKGFycmF5LCAobiA9PSBudWxsIHx8IGd1YXJkKSA/IDEgOiBuYXRpdmVNYXgoMCwgbikpO1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZXMgYSBiaW5hcnkgc2VhcmNoIHRvIGRldGVybWluZSB0aGUgc21hbGxlc3QgaW5kZXggYXQgd2hpY2ggdGhlIGB2YWx1ZWBcbiAgICogc2hvdWxkIGJlIGluc2VydGVkIGludG8gYGFycmF5YCBpbiBvcmRlciB0byBtYWludGFpbiB0aGUgc29ydCBvcmRlciBvZiB0aGVcbiAgICogc29ydGVkIGBhcnJheWAuIElmIGBjYWxsYmFja2AgaXMgcGFzc2VkLCBpdCB3aWxsIGJlIGV4ZWN1dGVkIGZvciBgdmFsdWVgIGFuZFxuICAgKiBlYWNoIGVsZW1lbnQgaW4gYGFycmF5YCB0byBjb21wdXRlIHRoZWlyIHNvcnQgcmFua2luZy4gVGhlIGBjYWxsYmFja2AgaXNcbiAgICogYm91bmQgdG8gYHRoaXNBcmdgIGFuZCBpbnZva2VkIHdpdGggb25lIGFyZ3VtZW50OyAodmFsdWUpLiBUaGUgYGNhbGxiYWNrYFxuICAgKiBhcmd1bWVudCBtYXkgYWxzbyBiZSB0aGUgbmFtZSBvZiBhIHByb3BlcnR5IHRvIG9yZGVyIGJ5LlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGl0ZXJhdGUgb3Zlci5cbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsdWUgVGhlIHZhbHVlIHRvIGV2YWx1YXRlLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufFN0cmluZ30gW2NhbGxiYWNrPWlkZW50aXR5fHByb3BlcnR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkXG4gICAqICBwZXIgaXRlcmF0aW9uIG9yIHByb3BlcnR5IG5hbWUgdG8gb3JkZXIgYnkuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyB0aGUgaW5kZXggYXQgd2hpY2ggdGhlIHZhbHVlIHNob3VsZCBiZSBpbnNlcnRlZFxuICAgKiAgaW50byBgYXJyYXlgLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLnNvcnRlZEluZGV4KFsyMCwgMzAsIDUwXSwgNDApO1xuICAgKiAvLyA9PiAyXG4gICAqXG4gICAqIF8uc29ydGVkSW5kZXgoW3sgJ3gnOiAyMCB9LCB7ICd4JzogMzAgfSwgeyAneCc6IDUwIH1dLCB7ICd4JzogNDAgfSwgJ3gnKTtcbiAgICogLy8gPT4gMlxuICAgKlxuICAgKiB2YXIgZGljdCA9IHtcbiAgICogICAnd29yZFRvTnVtYmVyJzogeyAndHdlbnR5JzogMjAsICd0aGlydHknOiAzMCwgJ2ZvdXJ0eSc6IDQwLCAnZmlmdHknOiA1MCB9XG4gICAqIH07XG4gICAqXG4gICAqIF8uc29ydGVkSW5kZXgoWyd0d2VudHknLCAndGhpcnR5JywgJ2ZpZnR5J10sICdmb3VydHknLCBmdW5jdGlvbih3b3JkKSB7XG4gICAqICAgcmV0dXJuIGRpY3Qud29yZFRvTnVtYmVyW3dvcmRdO1xuICAgKiB9KTtcbiAgICogLy8gPT4gMlxuICAgKlxuICAgKiBfLnNvcnRlZEluZGV4KFsndHdlbnR5JywgJ3RoaXJ0eScsICdmaWZ0eSddLCAnZm91cnR5JywgZnVuY3Rpb24od29yZCkge1xuICAgKiAgIHJldHVybiB0aGlzLndvcmRUb051bWJlclt3b3JkXTtcbiAgICogfSwgZGljdCk7XG4gICAqIC8vID0+IDJcbiAgICovXG4gIGZ1bmN0aW9uIHNvcnRlZEluZGV4KGFycmF5LCB2YWx1ZSwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgbG93ID0gMCxcbiAgICAgICAgaGlnaCA9IGFycmF5ID8gYXJyYXkubGVuZ3RoIDogbG93O1xuXG4gICAgLy8gZXhwbGljaXRseSByZWZlcmVuY2UgYGlkZW50aXR5YCBmb3IgYmV0dGVyIGlubGluaW5nIGluIEZpcmVmb3hcbiAgICBjYWxsYmFjayA9IGNhbGxiYWNrID8gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpIDogaWRlbnRpdHk7XG4gICAgdmFsdWUgPSBjYWxsYmFjayh2YWx1ZSk7XG5cbiAgICB3aGlsZSAobG93IDwgaGlnaCkge1xuICAgICAgdmFyIG1pZCA9IChsb3cgKyBoaWdoKSA+Pj4gMTtcbiAgICAgIGNhbGxiYWNrKGFycmF5W21pZF0pIDwgdmFsdWVcbiAgICAgICAgPyBsb3cgPSBtaWQgKyAxXG4gICAgICAgIDogaGlnaCA9IG1pZDtcbiAgICB9XG4gICAgcmV0dXJuIGxvdztcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlcyB0aGUgdW5pb24gb2YgdGhlIHBhc3NlZC1pbiBhcnJheXMgdXNpbmcgc3RyaWN0IGVxdWFsaXR5IGZvclxuICAgKiBjb21wYXJpc29ucywgaS5lLiBgPT09YC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQXJyYXlzXG4gICAqIEBwYXJhbSB7QXJyYXl9IFthcnJheTEsIGFycmF5MiwgLi4uXSBBcnJheXMgdG8gcHJvY2Vzcy5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHVuaXF1ZSB2YWx1ZXMsIGluIG9yZGVyLCB0aGF0IGFyZVxuICAgKiAgcHJlc2VudCBpbiBvbmUgb3IgbW9yZSBvZiB0aGUgYXJyYXlzLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfLnVuaW9uKFsxLCAyLCAzXSwgWzEwMSwgMiwgMSwgMTBdLCBbMiwgMV0pO1xuICAgKiAvLyA9PiBbMSwgMiwgMywgMTAxLCAxMF1cbiAgICovXG4gIGZ1bmN0aW9uIHVuaW9uKCkge1xuICAgIHJldHVybiB1bmlxKGNvbmNhdC5hcHBseShhcnJheVJlZiwgYXJndW1lbnRzKSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGR1cGxpY2F0ZS12YWx1ZS1mcmVlIHZlcnNpb24gb2YgdGhlIGBhcnJheWAgdXNpbmcgc3RyaWN0IGVxdWFsaXR5XG4gICAqIGZvciBjb21wYXJpc29ucywgaS5lLiBgPT09YC4gSWYgdGhlIGBhcnJheWAgaXMgYWxyZWFkeSBzb3J0ZWQsIHBhc3NpbmcgYHRydWVgXG4gICAqIGZvciBgaXNTb3J0ZWRgIHdpbGwgcnVuIGEgZmFzdGVyIGFsZ29yaXRobS4gSWYgYGNhbGxiYWNrYCBpcyBwYXNzZWQsIGVhY2hcbiAgICogZWxlbWVudCBvZiBgYXJyYXlgIGlzIHBhc3NlZCB0aHJvdWdoIGEgY2FsbGJhY2tgIGJlZm9yZSB1bmlxdWVuZXNzIGlzIGNvbXB1dGVkLlxuICAgKiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWQgd2l0aCB0aHJlZSBhcmd1bWVudHM7ICh2YWx1ZSwgaW5kZXgsIGFycmF5KS5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAYWxpYXMgdW5pcXVlXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIHByb2Nlc3MuXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2lzU29ydGVkPWZhbHNlXSBBIGZsYWcgdG8gaW5kaWNhdGUgdGhhdCB0aGUgYGFycmF5YCBpcyBhbHJlYWR5IHNvcnRlZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NhbGxiYWNrPWlkZW50aXR5XSBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgZHVwbGljYXRlLXZhbHVlLWZyZWUgYXJyYXkuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8udW5pcShbMSwgMiwgMSwgMywgMV0pO1xuICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICpcbiAgICogXy51bmlxKFsxLCAxLCAyLCAyLCAzXSwgdHJ1ZSk7XG4gICAqIC8vID0+IFsxLCAyLCAzXVxuICAgKlxuICAgKiBfLnVuaXEoWzEsIDIsIDEuNSwgMywgMi41XSwgZnVuY3Rpb24obnVtKSB7IHJldHVybiBNYXRoLmZsb29yKG51bSk7IH0pO1xuICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICpcbiAgICogXy51bmlxKFsxLCAyLCAxLjUsIDMsIDIuNV0sIGZ1bmN0aW9uKG51bSkgeyByZXR1cm4gdGhpcy5mbG9vcihudW0pOyB9LCBNYXRoKTtcbiAgICogLy8gPT4gWzEsIDIsIDNdXG4gICAqL1xuICBmdW5jdGlvbiB1bmlxKGFycmF5LCBpc1NvcnRlZCwgY2FsbGJhY2ssIHRoaXNBcmcpIHtcbiAgICB2YXIgaW5kZXggPSAtMSxcbiAgICAgICAgbGVuZ3RoID0gYXJyYXkgPyBhcnJheS5sZW5ndGggOiAwLFxuICAgICAgICByZXN1bHQgPSBbXSxcbiAgICAgICAgc2VlbiA9IHJlc3VsdDtcblxuICAgIC8vIGp1Z2dsZSBhcmd1bWVudHNcbiAgICBpZiAodHlwZW9mIGlzU29ydGVkID09ICdmdW5jdGlvbicpIHtcbiAgICAgIHRoaXNBcmcgPSBjYWxsYmFjaztcbiAgICAgIGNhbGxiYWNrID0gaXNTb3J0ZWQ7XG4gICAgICBpc1NvcnRlZCA9IGZhbHNlO1xuICAgIH1cbiAgICAvLyBpbml0IHZhbHVlIGNhY2hlIGZvciBsYXJnZSBhcnJheXNcbiAgICB2YXIgaXNMYXJnZSA9ICFpc1NvcnRlZCAmJiBsZW5ndGggPj0gNzU7XG4gICAgaWYgKGlzTGFyZ2UpIHtcbiAgICAgIHZhciBjYWNoZSA9IHt9O1xuICAgIH1cbiAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgIHNlZW4gPSBbXTtcbiAgICAgIGNhbGxiYWNrID0gY3JlYXRlQ2FsbGJhY2soY2FsbGJhY2ssIHRoaXNBcmcpO1xuICAgIH1cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgdmFyIHZhbHVlID0gYXJyYXlbaW5kZXhdLFxuICAgICAgICAgIGNvbXB1dGVkID0gY2FsbGJhY2sgPyBjYWxsYmFjayh2YWx1ZSwgaW5kZXgsIGFycmF5KSA6IHZhbHVlO1xuXG4gICAgICBpZiAoaXNMYXJnZSkge1xuICAgICAgICB2YXIga2V5ID0gY29tcHV0ZWQgKyAnJztcbiAgICAgICAgdmFyIGluaXRlZCA9IGhhc093blByb3BlcnR5LmNhbGwoY2FjaGUsIGtleSlcbiAgICAgICAgICA/ICEoc2VlbiA9IGNhY2hlW2tleV0pXG4gICAgICAgICAgOiAoc2VlbiA9IGNhY2hlW2tleV0gPSBbXSk7XG4gICAgICB9XG4gICAgICBpZiAoaXNTb3J0ZWRcbiAgICAgICAgICAgID8gIWluZGV4IHx8IHNlZW5bc2Vlbi5sZW5ndGggLSAxXSAhPT0gY29tcHV0ZWRcbiAgICAgICAgICAgIDogaW5pdGVkIHx8IGluZGV4T2Yoc2VlbiwgY29tcHV0ZWQpIDwgMFxuICAgICAgICAgICkge1xuICAgICAgICBpZiAoY2FsbGJhY2sgfHwgaXNMYXJnZSkge1xuICAgICAgICAgIHNlZW4ucHVzaChjb21wdXRlZCk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0LnB1c2godmFsdWUpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW4gYXJyYXkgd2l0aCBhbGwgb2NjdXJyZW5jZXMgb2YgdGhlIHBhc3NlZCB2YWx1ZXMgcmVtb3ZlZCB1c2luZ1xuICAgKiBzdHJpY3QgZXF1YWxpdHkgZm9yIGNvbXBhcmlzb25zLCBpLmUuIGA9PT1gLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gYXJyYXkgVGhlIGFycmF5IHRvIGZpbHRlci5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3ZhbHVlMSwgdmFsdWUyLCAuLi5dIFZhbHVlcyB0byByZW1vdmUuXG4gICAqIEByZXR1cm5zIHtBcnJheX0gUmV0dXJucyBhIG5ldyBmaWx0ZXJlZCBhcnJheS5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy53aXRob3V0KFsxLCAyLCAxLCAwLCAzLCAxLCA0XSwgMCwgMSk7XG4gICAqIC8vID0+IFsyLCAzLCA0XVxuICAgKi9cbiAgZnVuY3Rpb24gd2l0aG91dChhcnJheSkge1xuICAgIHZhciBpbmRleCA9IC0xLFxuICAgICAgICBsZW5ndGggPSBhcnJheSA/IGFycmF5Lmxlbmd0aCA6IDAsXG4gICAgICAgIGNvbnRhaW5zID0gY2FjaGVkQ29udGFpbnMoYXJndW1lbnRzLCAxLCAyMCksXG4gICAgICAgIHJlc3VsdCA9IFtdO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBsZW5ndGgpIHtcbiAgICAgIHZhciB2YWx1ZSA9IGFycmF5W2luZGV4XTtcbiAgICAgIGlmICghY29udGFpbnModmFsdWUpKSB7XG4gICAgICAgIHJlc3VsdC5wdXNoKHZhbHVlKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHcm91cHMgdGhlIGVsZW1lbnRzIG9mIGVhY2ggYXJyYXkgYXQgdGhlaXIgY29ycmVzcG9uZGluZyBpbmRleGVzLiBVc2VmdWwgZm9yXG4gICAqIHNlcGFyYXRlIGRhdGEgc291cmNlcyB0aGF0IGFyZSBjb29yZGluYXRlZCB0aHJvdWdoIG1hdGNoaW5nIGFycmF5IGluZGV4ZXMuXG4gICAqIEZvciBhIG1hdHJpeCBvZiBuZXN0ZWQgYXJyYXlzLCBgXy56aXAuYXBwbHkoLi4uKWAgY2FuIHRyYW5zcG9zZSB0aGUgbWF0cml4XG4gICAqIGluIGEgc2ltaWxhciBmYXNoaW9uLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBBcnJheXNcbiAgICogQHBhcmFtIHtBcnJheX0gW2FycmF5MSwgYXJyYXkyLCAuLi5dIEFycmF5cyB0byBwcm9jZXNzLlxuICAgKiBAcmV0dXJucyB7QXJyYXl9IFJldHVybnMgYSBuZXcgYXJyYXkgb2YgZ3JvdXBlZCBlbGVtZW50cy5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy56aXAoWydtb2UnLCAnbGFycnknLCAnY3VybHknXSwgWzMwLCA0MCwgNTBdLCBbdHJ1ZSwgZmFsc2UsIGZhbHNlXSk7XG4gICAqIC8vID0+IFtbJ21vZScsIDMwLCB0cnVlXSwgWydsYXJyeScsIDQwLCBmYWxzZV0sIFsnY3VybHknLCA1MCwgZmFsc2VdXVxuICAgKi9cbiAgZnVuY3Rpb24gemlwKGFycmF5KSB7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIGxlbmd0aCA9IGFycmF5ID8gbWF4KHBsdWNrKGFyZ3VtZW50cywgJ2xlbmd0aCcpKSA6IDAsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KGxlbmd0aCk7XG5cbiAgICB3aGlsZSAoKytpbmRleCA8IGxlbmd0aCkge1xuICAgICAgcmVzdWx0W2luZGV4XSA9IHBsdWNrKGFyZ3VtZW50cywgaW5kZXgpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGlzIHJlc3RyaWN0ZWQgdG8gZXhlY3V0aW5nIGBmdW5jYCBvbmx5IGFmdGVyIGl0IGlzXG4gICAqIGNhbGxlZCBgbmAgdGltZXMuIFRoZSBgZnVuY2AgaXMgZXhlY3V0ZWQgd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlXG4gICAqIGNyZWF0ZWQgZnVuY3Rpb24uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge051bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRoZSBmdW5jdGlvbiBtdXN0IGJlIGNhbGxlZCBiZWZvcmVcbiAgICogaXQgaXMgZXhlY3V0ZWQuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIHJlc3RyaWN0LlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyByZXN0cmljdGVkIGZ1bmN0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgcmVuZGVyTm90ZXMgPSBfLmFmdGVyKG5vdGVzLmxlbmd0aCwgcmVuZGVyKTtcbiAgICogXy5mb3JFYWNoKG5vdGVzLCBmdW5jdGlvbihub3RlKSB7XG4gICAqICAgbm90ZS5hc3luY1NhdmUoeyAnc3VjY2Vzcyc6IHJlbmRlck5vdGVzIH0pO1xuICAgKiB9KTtcbiAgICogLy8gYHJlbmRlck5vdGVzYCBpcyBydW4gb25jZSwgYWZ0ZXIgYWxsIG5vdGVzIGhhdmUgc2F2ZWRcbiAgICovXG4gIGZ1bmN0aW9uIGFmdGVyKG4sIGZ1bmMpIHtcbiAgICBpZiAobiA8IDEpIHtcbiAgICAgIHJldHVybiBmdW5jKCk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGlmICgtLW4gPCAxKSB7XG4gICAgICAgIHJldHVybiBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsIGludm9rZXMgYGZ1bmNgIHdpdGggdGhlIGB0aGlzYFxuICAgKiBiaW5kaW5nIG9mIGB0aGlzQXJnYCBhbmQgcHJlcGVuZHMgYW55IGFkZGl0aW9uYWwgYGJpbmRgIGFyZ3VtZW50cyB0byB0aG9zZVxuICAgKiBwYXNzZWQgdG8gdGhlIGJvdW5kIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gZnVuYyBUaGUgZnVuY3Rpb24gdG8gYmluZC5cbiAgICogQHBhcmFtIHtNaXhlZH0gW3RoaXNBcmddIFRoZSBgdGhpc2AgYmluZGluZyBvZiBgZnVuY2AuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFthcmcxLCBhcmcyLCAuLi5dIEFyZ3VtZW50cyB0byBiZSBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYm91bmQgZnVuY3Rpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBmdW5jID0gZnVuY3Rpb24oZ3JlZXRpbmcpIHtcbiAgICogICByZXR1cm4gZ3JlZXRpbmcgKyAnICcgKyB0aGlzLm5hbWU7XG4gICAqIH07XG4gICAqXG4gICAqIGZ1bmMgPSBfLmJpbmQoZnVuYywgeyAnbmFtZSc6ICdtb2UnIH0sICdoaScpO1xuICAgKiBmdW5jKCk7XG4gICAqIC8vID0+ICdoaSBtb2UnXG4gICAqL1xuICBmdW5jdGlvbiBiaW5kKGZ1bmMsIHRoaXNBcmcpIHtcbiAgICAvLyB1c2UgYEZ1bmN0aW9uI2JpbmRgIGlmIGl0IGV4aXN0cyBhbmQgaXMgZmFzdFxuICAgIC8vIChpbiBWOCBgRnVuY3Rpb24jYmluZGAgaXMgc2xvd2VyIGV4Y2VwdCB3aGVuIHBhcnRpYWxseSBhcHBsaWVkKVxuICAgIHJldHVybiBpc0JpbmRGYXN0IHx8IChuYXRpdmVCaW5kICYmIGFyZ3VtZW50cy5sZW5ndGggPiAyKVxuICAgICAgPyBuYXRpdmVCaW5kLmNhbGwuYXBwbHkobmF0aXZlQmluZCwgYXJndW1lbnRzKVxuICAgICAgOiBjcmVhdGVCb3VuZChmdW5jLCB0aGlzQXJnLCBzbGljZShhcmd1bWVudHMsIDIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCaW5kcyBtZXRob2RzIG9uIGBvYmplY3RgIHRvIGBvYmplY3RgLCBvdmVyd3JpdGluZyB0aGUgZXhpc3RpbmcgbWV0aG9kLlxuICAgKiBJZiBubyBtZXRob2QgbmFtZXMgYXJlIHByb3ZpZGVkLCBhbGwgdGhlIGZ1bmN0aW9uIHByb3BlcnRpZXMgb2YgYG9iamVjdGBcbiAgICogd2lsbCBiZSBib3VuZC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCB0byBiaW5kIGFuZCBhc3NpZ24gdGhlIGJvdW5kIG1ldGhvZHMgdG8uXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBbbWV0aG9kTmFtZTEsIG1ldGhvZE5hbWUyLCAuLi5dIE1ldGhvZCBuYW1lcyBvbiB0aGUgb2JqZWN0IHRvIGJpbmQuXG4gICAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgYG9iamVjdGAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBidXR0b25WaWV3ID0ge1xuICAgKiAgJ2xhYmVsJzogJ2xvZGFzaCcsXG4gICAqICAnb25DbGljayc6IGZ1bmN0aW9uKCkgeyBhbGVydCgnY2xpY2tlZDogJyArIHRoaXMubGFiZWwpOyB9XG4gICAqIH07XG4gICAqXG4gICAqIF8uYmluZEFsbChidXR0b25WaWV3KTtcbiAgICogalF1ZXJ5KCcjbG9kYXNoX2J1dHRvbicpLm9uKCdjbGljaycsIGJ1dHRvblZpZXcub25DbGljayk7XG4gICAqIC8vID0+IFdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkLCBgdGhpcy5sYWJlbGAgd2lsbCBoYXZlIHRoZSBjb3JyZWN0IHZhbHVlXG4gICAqL1xuICBmdW5jdGlvbiBiaW5kQWxsKG9iamVjdCkge1xuICAgIHZhciBmdW5jcyA9IGFyZ3VtZW50cyxcbiAgICAgICAgaW5kZXggPSBmdW5jcy5sZW5ndGggPiAxID8gMCA6IChmdW5jcyA9IGZ1bmN0aW9ucyhvYmplY3QpLCAtMSksXG4gICAgICAgIGxlbmd0aCA9IGZ1bmNzLmxlbmd0aDtcblxuICAgIHdoaWxlICgrK2luZGV4IDwgbGVuZ3RoKSB7XG4gICAgICB2YXIga2V5ID0gZnVuY3NbaW5kZXhdO1xuICAgICAgb2JqZWN0W2tleV0gPSBiaW5kKG9iamVjdFtrZXldLCBvYmplY3QpO1xuICAgIH1cbiAgICByZXR1cm4gb2JqZWN0O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0LCB3aGVuIGNhbGxlZCwgaW52b2tlcyB0aGUgbWV0aG9kIGF0IGBvYmplY3Rba2V5XWBcbiAgICogYW5kIHByZXBlbmRzIGFueSBhZGRpdGlvbmFsIGBiaW5kS2V5YCBhcmd1bWVudHMgdG8gdGhvc2UgcGFzc2VkIHRvIHRoZSBib3VuZFxuICAgKiBmdW5jdGlvbi4gVGhpcyBtZXRob2QgZGlmZmVycyBmcm9tIGBfLmJpbmRgIGJ5IGFsbG93aW5nIGJvdW5kIGZ1bmN0aW9ucyB0b1xuICAgKiByZWZlcmVuY2UgbWV0aG9kcyB0aGF0IHdpbGwgYmUgcmVkZWZpbmVkIG9yIGRvbid0IHlldCBleGlzdC5cbiAgICogU2VlIGh0dHA6Ly9taWNoYXV4LmNhL2FydGljbGVzL2xhenktZnVuY3Rpb24tZGVmaW5pdGlvbi1wYXR0ZXJuLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICogQHBhcmFtIHtPYmplY3R9IG9iamVjdCBUaGUgb2JqZWN0IHRoZSBtZXRob2QgYmVsb25ncyB0by5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGtleSBUaGUga2V5IG9mIHRoZSBtZXRob2QuXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFthcmcxLCBhcmcyLCAuLi5dIEFyZ3VtZW50cyB0byBiZSBwYXJ0aWFsbHkgYXBwbGllZC5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgYm91bmQgZnVuY3Rpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBvYmplY3QgPSB7XG4gICAqICAgJ25hbWUnOiAnbW9lJyxcbiAgICogICAnZ3JlZXQnOiBmdW5jdGlvbihncmVldGluZykge1xuICAgKiAgICAgcmV0dXJuIGdyZWV0aW5nICsgJyAnICsgdGhpcy5uYW1lO1xuICAgKiAgIH1cbiAgICogfTtcbiAgICpcbiAgICogdmFyIGZ1bmMgPSBfLmJpbmRLZXkob2JqZWN0LCAnZ3JlZXQnLCAnaGknKTtcbiAgICogZnVuYygpO1xuICAgKiAvLyA9PiAnaGkgbW9lJ1xuICAgKlxuICAgKiBvYmplY3QuZ3JlZXQgPSBmdW5jdGlvbihncmVldGluZykge1xuICAgKiAgIHJldHVybiBncmVldGluZyArICcsICcgKyB0aGlzLm5hbWUgKyAnISc7XG4gICAqIH07XG4gICAqXG4gICAqIGZ1bmMoKTtcbiAgICogLy8gPT4gJ2hpLCBtb2UhJ1xuICAgKi9cbiAgZnVuY3Rpb24gYmluZEtleShvYmplY3QsIGtleSkge1xuICAgIHJldHVybiBjcmVhdGVCb3VuZChvYmplY3QsIGtleSwgc2xpY2UoYXJndW1lbnRzLCAyKSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgaXMgdGhlIGNvbXBvc2l0aW9uIG9mIHRoZSBwYXNzZWQgZnVuY3Rpb25zLFxuICAgKiB3aGVyZSBlYWNoIGZ1bmN0aW9uIGNvbnN1bWVzIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZ1bmN0aW9uIHRoYXQgZm9sbG93cy5cbiAgICogSW4gbWF0aCB0ZXJtcywgY29tcG9zaW5nIHRoZSBmdW5jdGlvbnMgYGYoKWAsIGBnKClgLCBhbmQgYGgoKWAgcHJvZHVjZXMgYGYoZyhoKCkpKWAuXG4gICAqIEVhY2ggZnVuY3Rpb24gaXMgZXhlY3V0ZWQgd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlIGNvbXBvc2VkIGZ1bmN0aW9uLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBGdW5jdGlvbnNcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2Z1bmMxLCBmdW5jMiwgLi4uXSBGdW5jdGlvbnMgdG8gY29tcG9zZS5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgY29tcG9zZWQgZnVuY3Rpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBncmVldCA9IGZ1bmN0aW9uKG5hbWUpIHsgcmV0dXJuICdoaTogJyArIG5hbWU7IH07XG4gICAqIHZhciBleGNsYWltID0gZnVuY3Rpb24oc3RhdGVtZW50KSB7IHJldHVybiBzdGF0ZW1lbnQgKyAnISc7IH07XG4gICAqIHZhciB3ZWxjb21lID0gXy5jb21wb3NlKGV4Y2xhaW0sIGdyZWV0KTtcbiAgICogd2VsY29tZSgnbW9lJyk7XG4gICAqIC8vID0+ICdoaTogbW9lISdcbiAgICovXG4gIGZ1bmN0aW9uIGNvbXBvc2UoKSB7XG4gICAgdmFyIGZ1bmNzID0gYXJndW1lbnRzO1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gYXJndW1lbnRzLFxuICAgICAgICAgIGxlbmd0aCA9IGZ1bmNzLmxlbmd0aDtcblxuICAgICAgd2hpbGUgKGxlbmd0aC0tKSB7XG4gICAgICAgIGFyZ3MgPSBbZnVuY3NbbGVuZ3RoXS5hcHBseSh0aGlzLCBhcmdzKV07XG4gICAgICB9XG4gICAgICByZXR1cm4gYXJnc1swXTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHdpbGwgZGVsYXkgdGhlIGV4ZWN1dGlvbiBvZiBgZnVuY2AgdW50aWwgYWZ0ZXJcbiAgICogYHdhaXRgIG1pbGxpc2Vjb25kcyBoYXZlIGVsYXBzZWQgc2luY2UgdGhlIGxhc3QgdGltZSBpdCB3YXMgaW52b2tlZC4gUGFzc1xuICAgKiBgdHJ1ZWAgZm9yIGBpbW1lZGlhdGVgIHRvIGNhdXNlIGRlYm91bmNlIHRvIGludm9rZSBgZnVuY2Agb24gdGhlIGxlYWRpbmcsXG4gICAqIGluc3RlYWQgb2YgdGhlIHRyYWlsaW5nLCBlZGdlIG9mIHRoZSBgd2FpdGAgdGltZW91dC4gU3Vic2VxdWVudCBjYWxscyB0b1xuICAgKiB0aGUgZGVib3VuY2VkIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgYGZ1bmNgIGNhbGwuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBkZWJvdW5jZS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gZGVsYXkuXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gaW1tZWRpYXRlIEEgZmxhZyB0byBpbmRpY2F0ZSBleGVjdXRpb24gaXMgb24gdGhlIGxlYWRpbmdcbiAgICogIGVkZ2Ugb2YgdGhlIHRpbWVvdXQuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IGRlYm91bmNlZCBmdW5jdGlvbi5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGxhenlMYXlvdXQgPSBfLmRlYm91bmNlKGNhbGN1bGF0ZUxheW91dCwgMzAwKTtcbiAgICogalF1ZXJ5KHdpbmRvdykub24oJ3Jlc2l6ZScsIGxhenlMYXlvdXQpO1xuICAgKi9cbiAgZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCwgaW1tZWRpYXRlKSB7XG4gICAgdmFyIGFyZ3MsXG4gICAgICAgIHJlc3VsdCxcbiAgICAgICAgdGhpc0FyZyxcbiAgICAgICAgdGltZW91dElkO1xuXG4gICAgZnVuY3Rpb24gZGVsYXllZCgpIHtcbiAgICAgIHRpbWVvdXRJZCA9IG51bGw7XG4gICAgICBpZiAoIWltbWVkaWF0ZSkge1xuICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgaXNJbW1lZGlhdGUgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXRJZDtcbiAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICB0aGlzQXJnID0gdGhpcztcblxuICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KGRlbGF5ZWQsIHdhaXQpO1xuXG4gICAgICBpZiAoaXNJbW1lZGlhdGUpIHtcbiAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzQXJnLCBhcmdzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyB0aGUgYGZ1bmNgIGZ1bmN0aW9uIGFmdGVyIGB3YWl0YCBtaWxsaXNlY29uZHMuIEFkZGl0aW9uYWwgYXJndW1lbnRzXG4gICAqIHdpbGwgYmUgcGFzc2VkIHRvIGBmdW5jYCB3aGVuIGl0IGlzIGludm9rZWQuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBkZWxheS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gZGVsYXkgZXhlY3V0aW9uLlxuICAgKiBAcGFyYW0ge01peGVkfSBbYXJnMSwgYXJnMiwgLi4uXSBBcmd1bWVudHMgdG8gaW52b2tlIHRoZSBmdW5jdGlvbiB3aXRoLlxuICAgKiBAcmV0dXJucyB7TnVtYmVyfSBSZXR1cm5zIHRoZSBgc2V0VGltZW91dGAgdGltZW91dCBpZC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGxvZyA9IF8uYmluZChjb25zb2xlLmxvZywgY29uc29sZSk7XG4gICAqIF8uZGVsYXkobG9nLCAxMDAwLCAnbG9nZ2VkIGxhdGVyJyk7XG4gICAqIC8vID0+ICdsb2dnZWQgbGF0ZXInIChBcHBlYXJzIGFmdGVyIG9uZSBzZWNvbmQuKVxuICAgKi9cbiAgZnVuY3Rpb24gZGVsYXkoZnVuYywgd2FpdCkge1xuICAgIHZhciBhcmdzID0gc2xpY2UoYXJndW1lbnRzLCAyKTtcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHsgZnVuYy5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOyB9LCB3YWl0KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWZlcnMgZXhlY3V0aW5nIHRoZSBgZnVuY2AgZnVuY3Rpb24gdW50aWwgdGhlIGN1cnJlbnQgY2FsbCBzdGFjayBoYXMgY2xlYXJlZC5cbiAgICogQWRkaXRpb25hbCBhcmd1bWVudHMgd2lsbCBiZSBwYXNzZWQgdG8gYGZ1bmNgIHdoZW4gaXQgaXMgaW52b2tlZC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGRlZmVyLlxuICAgKiBAcGFyYW0ge01peGVkfSBbYXJnMSwgYXJnMiwgLi4uXSBBcmd1bWVudHMgdG8gaW52b2tlIHRoZSBmdW5jdGlvbiB3aXRoLlxuICAgKiBAcmV0dXJucyB7TnVtYmVyfSBSZXR1cm5zIHRoZSBgc2V0VGltZW91dGAgdGltZW91dCBpZC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5kZWZlcihmdW5jdGlvbigpIHsgYWxlcnQoJ2RlZmVycmVkJyk7IH0pO1xuICAgKiAvLyByZXR1cm5zIGZyb20gdGhlIGZ1bmN0aW9uIGJlZm9yZSBgYWxlcnRgIGlzIGNhbGxlZFxuICAgKi9cbiAgZnVuY3Rpb24gZGVmZXIoZnVuYykge1xuICAgIHZhciBhcmdzID0gc2xpY2UoYXJndW1lbnRzLCAxKTtcbiAgICByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHsgZnVuYy5hcHBseSh1bmRlZmluZWQsIGFyZ3MpOyB9LCAxKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCBtZW1vaXplcyB0aGUgcmVzdWx0IG9mIGBmdW5jYC4gSWYgYHJlc29sdmVyYCBpc1xuICAgKiBwYXNzZWQsIGl0IHdpbGwgYmUgdXNlZCB0byBkZXRlcm1pbmUgdGhlIGNhY2hlIGtleSBmb3Igc3RvcmluZyB0aGUgcmVzdWx0XG4gICAqIGJhc2VkIG9uIHRoZSBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBtZW1vaXplZCBmdW5jdGlvbi4gQnkgZGVmYXVsdCwgdGhlIGZpcnN0XG4gICAqIGFyZ3VtZW50IHBhc3NlZCB0byB0aGUgbWVtb2l6ZWQgZnVuY3Rpb24gaXMgdXNlZCBhcyB0aGUgY2FjaGUga2V5LiBUaGUgYGZ1bmNgXG4gICAqIGlzIGV4ZWN1dGVkIHdpdGggdGhlIGB0aGlzYCBiaW5kaW5nIG9mIHRoZSBtZW1vaXplZCBmdW5jdGlvbi5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmMgVGhlIGZ1bmN0aW9uIHRvIGhhdmUgaXRzIG91dHB1dCBtZW1vaXplZC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3Jlc29sdmVyXSBBIGZ1bmN0aW9uIHVzZWQgdG8gcmVzb2x2ZSB0aGUgY2FjaGUga2V5LlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBtZW1vaXppbmcgZnVuY3Rpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBmaWJvbmFjY2kgPSBfLm1lbW9pemUoZnVuY3Rpb24obikge1xuICAgKiAgIHJldHVybiBuIDwgMiA/IG4gOiBmaWJvbmFjY2kobiAtIDEpICsgZmlib25hY2NpKG4gLSAyKTtcbiAgICogfSk7XG4gICAqL1xuICBmdW5jdGlvbiBtZW1vaXplKGZ1bmMsIHJlc29sdmVyKSB7XG4gICAgdmFyIGNhY2hlID0ge307XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGtleSA9IHJlc29sdmVyID8gcmVzb2x2ZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSA6IGFyZ3VtZW50c1swXTtcbiAgICAgIHJldHVybiBoYXNPd25Qcm9wZXJ0eS5jYWxsKGNhY2hlLCBrZXkpXG4gICAgICAgID8gY2FjaGVba2V5XVxuICAgICAgICA6IChjYWNoZVtrZXldID0gZnVuYy5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IGlzIHJlc3RyaWN0ZWQgdG8gZXhlY3V0ZSBgZnVuY2Agb25jZS4gUmVwZWF0IGNhbGxzIHRvXG4gICAqIHRoZSBmdW5jdGlvbiB3aWxsIHJldHVybiB0aGUgdmFsdWUgb2YgdGhlIGZpcnN0IGNhbGwuIFRoZSBgZnVuY2AgaXMgZXhlY3V0ZWRcbiAgICogd2l0aCB0aGUgYHRoaXNgIGJpbmRpbmcgb2YgdGhlIGNyZWF0ZWQgZnVuY3Rpb24uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byByZXN0cmljdC5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgcmVzdHJpY3RlZCBmdW5jdGlvbi5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGluaXRpYWxpemUgPSBfLm9uY2UoY3JlYXRlQXBwbGljYXRpb24pO1xuICAgKiBpbml0aWFsaXplKCk7XG4gICAqIGluaXRpYWxpemUoKTtcbiAgICogLy8gQXBwbGljYXRpb24gaXMgb25seSBjcmVhdGVkIG9uY2UuXG4gICAqL1xuICBmdW5jdGlvbiBvbmNlKGZ1bmMpIHtcbiAgICB2YXIgcmVzdWx0LFxuICAgICAgICByYW4gPSBmYWxzZTtcblxuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChyYW4pIHtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH1cbiAgICAgIHJhbiA9IHRydWU7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG5cbiAgICAgIC8vIGNsZWFyIHRoZSBgZnVuY2AgdmFyaWFibGUgc28gdGhlIGZ1bmN0aW9uIG1heSBiZSBnYXJiYWdlIGNvbGxlY3RlZFxuICAgICAgZnVuYyA9IG51bGw7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLCBpbnZva2VzIGBmdW5jYCB3aXRoIGFueSBhZGRpdGlvbmFsXG4gICAqIGBwYXJ0aWFsYCBhcmd1bWVudHMgcHJlcGVuZGVkIHRvIHRob3NlIHBhc3NlZCB0byB0aGUgbmV3IGZ1bmN0aW9uLiBUaGlzXG4gICAqIG1ldGhvZCBpcyBzaW1pbGFyIHRvIGBiaW5kYCwgZXhjZXB0IGl0IGRvZXMgKipub3QqKiBhbHRlciB0aGUgYHRoaXNgIGJpbmRpbmcuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byBwYXJ0aWFsbHkgYXBwbHkgYXJndW1lbnRzIHRvLlxuICAgKiBAcGFyYW0ge01peGVkfSBbYXJnMSwgYXJnMiwgLi4uXSBBcmd1bWVudHMgdG8gYmUgcGFydGlhbGx5IGFwcGxpZWQuXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbn0gUmV0dXJucyB0aGUgbmV3IHBhcnRpYWxseSBhcHBsaWVkIGZ1bmN0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgZ3JlZXQgPSBmdW5jdGlvbihncmVldGluZywgbmFtZSkgeyByZXR1cm4gZ3JlZXRpbmcgKyAnOiAnICsgbmFtZTsgfTtcbiAgICogdmFyIGhpID0gXy5wYXJ0aWFsKGdyZWV0LCAnaGknKTtcbiAgICogaGkoJ21vZScpO1xuICAgKiAvLyA9PiAnaGk6IG1vZSdcbiAgICovXG4gIGZ1bmN0aW9uIHBhcnRpYWwoZnVuYykge1xuICAgIHJldHVybiBjcmVhdGVCb3VuZChmdW5jLCBzbGljZShhcmd1bWVudHMsIDEpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBleGVjdXRlZCwgd2lsbCBvbmx5IGNhbGwgdGhlIGBmdW5jYFxuICAgKiBmdW5jdGlvbiBhdCBtb3N0IG9uY2UgcGVyIGV2ZXJ5IGB3YWl0YCBtaWxsaXNlY29uZHMuIElmIHRoZSB0aHJvdHRsZWRcbiAgICogZnVuY3Rpb24gaXMgaW52b2tlZCBtb3JlIHRoYW4gb25jZSBkdXJpbmcgdGhlIGB3YWl0YCB0aW1lb3V0LCBgZnVuY2Agd2lsbFxuICAgKiBhbHNvIGJlIGNhbGxlZCBvbiB0aGUgdHJhaWxpbmcgZWRnZSBvZiB0aGUgdGltZW91dC4gU3Vic2VxdWVudCBjYWxscyB0byB0aGVcbiAgICogdGhyb3R0bGVkIGZ1bmN0aW9uIHdpbGwgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlIGxhc3QgYGZ1bmNgIGNhbGwuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IEZ1bmN0aW9uc1xuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdW5jIFRoZSBmdW5jdGlvbiB0byB0aHJvdHRsZS5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHdhaXQgVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gdGhyb3R0bGUgZXhlY3V0aW9ucyB0by5cbiAgICogQHJldHVybnMge0Z1bmN0aW9ufSBSZXR1cm5zIHRoZSBuZXcgdGhyb3R0bGVkIGZ1bmN0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgdGhyb3R0bGVkID0gXy50aHJvdHRsZSh1cGRhdGVQb3NpdGlvbiwgMTAwKTtcbiAgICogalF1ZXJ5KHdpbmRvdykub24oJ3Njcm9sbCcsIHRocm90dGxlZCk7XG4gICAqL1xuICBmdW5jdGlvbiB0aHJvdHRsZShmdW5jLCB3YWl0KSB7XG4gICAgdmFyIGFyZ3MsXG4gICAgICAgIHJlc3VsdCxcbiAgICAgICAgdGhpc0FyZyxcbiAgICAgICAgdGltZW91dElkLFxuICAgICAgICBsYXN0Q2FsbGVkID0gMDtcblxuICAgIGZ1bmN0aW9uIHRyYWlsaW5nQ2FsbCgpIHtcbiAgICAgIGxhc3RDYWxsZWQgPSBuZXcgRGF0ZTtcbiAgICAgIHRpbWVvdXRJZCA9IG51bGw7XG4gICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgbm93ID0gbmV3IERhdGUsXG4gICAgICAgICAgcmVtYWluaW5nID0gd2FpdCAtIChub3cgLSBsYXN0Q2FsbGVkKTtcblxuICAgICAgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHRoaXNBcmcgPSB0aGlzO1xuXG4gICAgICBpZiAocmVtYWluaW5nIDw9IDApIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXRJZCk7XG4gICAgICAgIHRpbWVvdXRJZCA9IG51bGw7XG4gICAgICAgIGxhc3RDYWxsZWQgPSBub3c7XG4gICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkodGhpc0FyZywgYXJncyk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmICghdGltZW91dElkKSB7XG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQodHJhaWxpbmdDYWxsLCByZW1haW5pbmcpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYSBmdW5jdGlvbiB0aGF0IHBhc3NlcyBgdmFsdWVgIHRvIHRoZSBgd3JhcHBlcmAgZnVuY3Rpb24gYXMgaXRzXG4gICAqIGZpcnN0IGFyZ3VtZW50LiBBZGRpdGlvbmFsIGFyZ3VtZW50cyBwYXNzZWQgdG8gdGhlIGZ1bmN0aW9uIGFyZSBhcHBlbmRlZFxuICAgKiB0byB0aG9zZSBwYXNzZWQgdG8gdGhlIGB3cmFwcGVyYCBmdW5jdGlvbi4gVGhlIGB3cmFwcGVyYCBpcyBleGVjdXRlZCB3aXRoXG4gICAqIHRoZSBgdGhpc2AgYmluZGluZyBvZiB0aGUgY3JlYXRlZCBmdW5jdGlvbi5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgRnVuY3Rpb25zXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIFRoZSB2YWx1ZSB0byB3cmFwLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSB3cmFwcGVyIFRoZSB3cmFwcGVyIGZ1bmN0aW9uLlxuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIG5ldyBmdW5jdGlvbi5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogdmFyIGhlbGxvID0gZnVuY3Rpb24obmFtZSkgeyByZXR1cm4gJ2hlbGxvICcgKyBuYW1lOyB9O1xuICAgKiBoZWxsbyA9IF8ud3JhcChoZWxsbywgZnVuY3Rpb24oZnVuYykge1xuICAgKiAgIHJldHVybiAnYmVmb3JlLCAnICsgZnVuYygnbW9lJykgKyAnLCBhZnRlcic7XG4gICAqIH0pO1xuICAgKiBoZWxsbygpO1xuICAgKiAvLyA9PiAnYmVmb3JlLCBoZWxsbyBtb2UsIGFmdGVyJ1xuICAgKi9cbiAgZnVuY3Rpb24gd3JhcCh2YWx1ZSwgd3JhcHBlcikge1xuICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBhcmdzID0gW3ZhbHVlXTtcbiAgICAgIHB1c2guYXBwbHkoYXJncywgYXJndW1lbnRzKTtcbiAgICAgIHJldHVybiB3cmFwcGVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH07XG4gIH1cblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogQ29udmVydHMgdGhlIGNoYXJhY3RlcnMgYCZgLCBgPGAsIGA+YCwgYFwiYCwgYW5kIGAnYCBpbiBgc3RyaW5nYCB0byB0aGVpclxuICAgKiBjb3JyZXNwb25kaW5nIEhUTUwgZW50aXRpZXMuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgKiBAcGFyYW0ge1N0cmluZ30gc3RyaW5nIFRoZSBzdHJpbmcgdG8gZXNjYXBlLlxuICAgKiBAcmV0dXJucyB7U3RyaW5nfSBSZXR1cm5zIHRoZSBlc2NhcGVkIHN0cmluZy5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5lc2NhcGUoJ01vZSwgTGFycnkgJiBDdXJseScpO1xuICAgKiAvLyA9PiAnTW9lLCBMYXJyeSAmYW1wOyBDdXJseSdcbiAgICovXG4gIGZ1bmN0aW9uIGVzY2FwZShzdHJpbmcpIHtcbiAgICByZXR1cm4gc3RyaW5nID09IG51bGwgPyAnJyA6IChzdHJpbmcgKyAnJykucmVwbGFjZShyZVVuZXNjYXBlZEh0bWwsIGVzY2FwZUh0bWxDaGFyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBUaGlzIGZ1bmN0aW9uIHJldHVybnMgdGhlIGZpcnN0IGFyZ3VtZW50IHBhc3NlZCB0byBpdC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAqIEBwYXJhbSB7TWl4ZWR9IHZhbHVlIEFueSB2YWx1ZS5cbiAgICogQHJldHVybnMge01peGVkfSBSZXR1cm5zIGB2YWx1ZWAuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBtb2UgPSB7ICduYW1lJzogJ21vZScgfTtcbiAgICogbW9lID09PSBfLmlkZW50aXR5KG1vZSk7XG4gICAqIC8vID0+IHRydWVcbiAgICovXG4gIGZ1bmN0aW9uIGlkZW50aXR5KHZhbHVlKSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG5cbiAgLyoqXG4gICAqIEFkZHMgZnVuY3Rpb25zIHByb3BlcnRpZXMgb2YgYG9iamVjdGAgdG8gdGhlIGBsb2Rhc2hgIGZ1bmN0aW9uIGFuZCBjaGFpbmFibGVcbiAgICogd3JhcHBlci5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgVGhlIG9iamVjdCBvZiBmdW5jdGlvbiBwcm9wZXJ0aWVzIHRvIGFkZCB0byBgbG9kYXNoYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5taXhpbih7XG4gICAqICAgJ2NhcGl0YWxpemUnOiBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICogICAgIHJldHVybiBzdHJpbmcuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHJpbmcuc2xpY2UoMSkudG9Mb3dlckNhc2UoKTtcbiAgICogICB9XG4gICAqIH0pO1xuICAgKlxuICAgKiBfLmNhcGl0YWxpemUoJ2xhcnJ5Jyk7XG4gICAqIC8vID0+ICdMYXJyeSdcbiAgICpcbiAgICogXygnY3VybHknKS5jYXBpdGFsaXplKCk7XG4gICAqIC8vID0+ICdDdXJseSdcbiAgICovXG4gIGZ1bmN0aW9uIG1peGluKG9iamVjdCkge1xuICAgIGZvckVhY2goZnVuY3Rpb25zKG9iamVjdCksIGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gbG9kYXNoW21ldGhvZE5hbWVdID0gb2JqZWN0W21ldGhvZE5hbWVdO1xuXG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBhcmdzID0gW3RoaXMuX193cmFwcGVkX19dO1xuICAgICAgICBwdXNoLmFwcGx5KGFyZ3MsIGFyZ3VtZW50cyk7XG5cbiAgICAgICAgdmFyIHJlc3VsdCA9IGZ1bmMuYXBwbHkobG9kYXNoLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIG5ldyBsb2Rhc2gocmVzdWx0KTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogUmV2ZXJ0cyB0aGUgJ18nIHZhcmlhYmxlIHRvIGl0cyBwcmV2aW91cyB2YWx1ZSBhbmQgcmV0dXJucyBhIHJlZmVyZW5jZSB0b1xuICAgKiB0aGUgYGxvZGFzaGAgZnVuY3Rpb24uXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgKiBAcmV0dXJucyB7RnVuY3Rpb259IFJldHVybnMgdGhlIGBsb2Rhc2hgIGZ1bmN0aW9uLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgbG9kYXNoID0gXy5ub0NvbmZsaWN0KCk7XG4gICAqL1xuICBmdW5jdGlvbiBub0NvbmZsaWN0KCkge1xuICAgIHdpbmRvdy5fID0gb2xkRGFzaDtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9kdWNlcyBhIHJhbmRvbSBudW1iZXIgYmV0d2VlbiBgbWluYCBhbmQgYG1heGAgKGluY2x1c2l2ZSkuIElmIG9ubHkgb25lXG4gICAqIGFyZ3VtZW50IGlzIHBhc3NlZCwgYSBudW1iZXIgYmV0d2VlbiBgMGAgYW5kIHRoZSBnaXZlbiBudW1iZXIgd2lsbCBiZSByZXR1cm5lZC5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBbbWluPTBdIFRoZSBtaW5pbXVtIHBvc3NpYmxlIHZhbHVlLlxuICAgKiBAcGFyYW0ge051bWJlcn0gW21heD0xXSBUaGUgbWF4aW11bSBwb3NzaWJsZSB2YWx1ZS5cbiAgICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBhIHJhbmRvbSBudW1iZXIuXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIF8ucmFuZG9tKDAsIDUpO1xuICAgKiAvLyA9PiBhIG51bWJlciBiZXR3ZWVuIDEgYW5kIDVcbiAgICpcbiAgICogXy5yYW5kb20oNSk7XG4gICAqIC8vID0+IGFsc28gYSBudW1iZXIgYmV0d2VlbiAxIGFuZCA1XG4gICAqL1xuICBmdW5jdGlvbiByYW5kb20obWluLCBtYXgpIHtcbiAgICBpZiAobWluID09IG51bGwgJiYgbWF4ID09IG51bGwpIHtcbiAgICAgIG1heCA9IDE7XG4gICAgfVxuICAgIG1pbiA9ICttaW4gfHwgMDtcbiAgICBpZiAobWF4ID09IG51bGwpIHtcbiAgICAgIG1heCA9IG1pbjtcbiAgICAgIG1pbiA9IDA7XG4gICAgfVxuICAgIHJldHVybiBtaW4gKyBmbG9vcihuYXRpdmVSYW5kb20oKSAqICgoK21heCB8fCAwKSAtIG1pbiArIDEpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNvbHZlcyB0aGUgdmFsdWUgb2YgYHByb3BlcnR5YCBvbiBgb2JqZWN0YC4gSWYgYHByb3BlcnR5YCBpcyBhIGZ1bmN0aW9uXG4gICAqIGl0IHdpbGwgYmUgaW52b2tlZCBhbmQgaXRzIHJlc3VsdCByZXR1cm5lZCwgZWxzZSB0aGUgcHJvcGVydHkgdmFsdWUgaXNcbiAgICogcmV0dXJuZWQuIElmIGBvYmplY3RgIGlzIGZhbHNleSwgdGhlbiBgbnVsbGAgaXMgcmV0dXJuZWQuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IFRoZSBvYmplY3QgdG8gaW5zcGVjdC5cbiAgICogQHBhcmFtIHtTdHJpbmd9IHByb3BlcnR5IFRoZSBwcm9wZXJ0eSB0byBnZXQgdGhlIHZhbHVlIG9mLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgdGhlIHJlc29sdmVkIHZhbHVlLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiB2YXIgb2JqZWN0ID0ge1xuICAgKiAgICdjaGVlc2UnOiAnY3J1bXBldHMnLFxuICAgKiAgICdzdHVmZic6IGZ1bmN0aW9uKCkge1xuICAgKiAgICAgcmV0dXJuICdub25zZW5zZSc7XG4gICAqICAgfVxuICAgKiB9O1xuICAgKlxuICAgKiBfLnJlc3VsdChvYmplY3QsICdjaGVlc2UnKTtcbiAgICogLy8gPT4gJ2NydW1wZXRzJ1xuICAgKlxuICAgKiBfLnJlc3VsdChvYmplY3QsICdzdHVmZicpO1xuICAgKiAvLyA9PiAnbm9uc2Vuc2UnXG4gICAqL1xuICBmdW5jdGlvbiByZXN1bHQob2JqZWN0LCBwcm9wZXJ0eSkge1xuICAgIC8vIGJhc2VkIG9uIEJhY2tib25lJ3MgcHJpdmF0ZSBgZ2V0VmFsdWVgIGZ1bmN0aW9uXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2RvY3VtZW50Y2xvdWQvYmFja2JvbmUvYmxvYi8wLjkuMi9iYWNrYm9uZS5qcyNMMTQxOS0xNDI0XG4gICAgdmFyIHZhbHVlID0gb2JqZWN0ID8gb2JqZWN0W3Byb3BlcnR5XSA6IG51bGw7XG4gICAgcmV0dXJuIGlzRnVuY3Rpb24odmFsdWUpID8gb2JqZWN0W3Byb3BlcnR5XSgpIDogdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogQSBtaWNyby10ZW1wbGF0aW5nIG1ldGhvZCB0aGF0IGhhbmRsZXMgYXJiaXRyYXJ5IGRlbGltaXRlcnMsIHByZXNlcnZlc1xuICAgKiB3aGl0ZXNwYWNlLCBhbmQgY29ycmVjdGx5IGVzY2FwZXMgcXVvdGVzIHdpdGhpbiBpbnRlcnBvbGF0ZWQgY29kZS5cbiAgICpcbiAgICogTm90ZTogSW4gdGhlIGRldmVsb3BtZW50IGJ1aWxkIGBfLnRlbXBsYXRlYCB1dGlsaXplcyBzb3VyY2VVUkxzIGZvciBlYXNpZXJcbiAgICogZGVidWdnaW5nLiBTZWUgaHR0cDovL3d3dy5odG1sNXJvY2tzLmNvbS9lbi90dXRvcmlhbHMvZGV2ZWxvcGVydG9vbHMvc291cmNlbWFwcy8jdG9jLXNvdXJjZXVybFxuICAgKlxuICAgKiBOb3RlOiBMby1EYXNoIG1heSBiZSB1c2VkIGluIENocm9tZSBleHRlbnNpb25zIGJ5IGVpdGhlciBjcmVhdGluZyBhIGBsb2Rhc2ggY3NwYFxuICAgKiBidWlsZCBhbmQgYXZvaWRpbmcgYF8udGVtcGxhdGVgIHVzZSwgb3IgbG9hZGluZyBMby1EYXNoIGluIGEgc2FuZGJveGVkIHBhZ2UuXG4gICAqIFNlZSBodHRwOi8vZGV2ZWxvcGVyLmNocm9tZS5jb20vdHJ1bmsvZXh0ZW5zaW9ucy9zYW5kYm94aW5nRXZhbC5odG1sXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgKiBAcGFyYW0ge1N0cmluZ30gdGV4dCBUaGUgdGVtcGxhdGUgdGV4dC5cbiAgICogQHBhcmFtIHtPYmVjdH0gZGF0YSBUaGUgZGF0YSBvYmplY3QgdXNlZCB0byBwb3B1bGF0ZSB0aGUgdGV4dC5cbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgVGhlIG9wdGlvbnMgb2JqZWN0LlxuICAgKiAgZXNjYXBlIC0gVGhlIFwiZXNjYXBlXCIgZGVsaW1pdGVyIHJlZ2V4cC5cbiAgICogIGV2YWx1YXRlIC0gVGhlIFwiZXZhbHVhdGVcIiBkZWxpbWl0ZXIgcmVnZXhwLlxuICAgKiAgaW50ZXJwb2xhdGUgLSBUaGUgXCJpbnRlcnBvbGF0ZVwiIGRlbGltaXRlciByZWdleHAuXG4gICAqICBzb3VyY2VVUkwgLSBUaGUgc291cmNlVVJMIG9mIHRoZSB0ZW1wbGF0ZSdzIGNvbXBpbGVkIHNvdXJjZS5cbiAgICogIHZhcmlhYmxlIC0gVGhlIGRhdGEgb2JqZWN0IHZhcmlhYmxlIG5hbWUuXG4gICAqXG4gICAqIEByZXR1cm5zIHtGdW5jdGlvbnxTdHJpbmd9IFJldHVybnMgYSBjb21waWxlZCBmdW5jdGlvbiB3aGVuIG5vIGBkYXRhYCBvYmplY3RcbiAgICogIGlzIGdpdmVuLCBlbHNlIGl0IHJldHVybnMgdGhlIGludGVycG9sYXRlZCB0ZXh0LlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiAvLyB1c2luZyBhIGNvbXBpbGVkIHRlbXBsYXRlXG4gICAqIHZhciBjb21waWxlZCA9IF8udGVtcGxhdGUoJ2hlbGxvIDwlPSBuYW1lICU+Jyk7XG4gICAqIGNvbXBpbGVkKHsgJ25hbWUnOiAnbW9lJyB9KTtcbiAgICogLy8gPT4gJ2hlbGxvIG1vZSdcbiAgICpcbiAgICogdmFyIGxpc3QgPSAnPCUgXy5mb3JFYWNoKHBlb3BsZSwgZnVuY3Rpb24obmFtZSkgeyAlPjxsaT48JT0gbmFtZSAlPjwvbGk+PCUgfSk7ICU+JztcbiAgICogXy50ZW1wbGF0ZShsaXN0LCB7ICdwZW9wbGUnOiBbJ21vZScsICdsYXJyeScsICdjdXJseSddIH0pO1xuICAgKiAvLyA9PiAnPGxpPm1vZTwvbGk+PGxpPmxhcnJ5PC9saT48bGk+Y3VybHk8L2xpPidcbiAgICpcbiAgICogLy8gdXNpbmcgdGhlIFwiZXNjYXBlXCIgZGVsaW1pdGVyIHRvIGVzY2FwZSBIVE1MIGluIGRhdGEgcHJvcGVydHkgdmFsdWVzXG4gICAqIF8udGVtcGxhdGUoJzxiPjwlLSB2YWx1ZSAlPjwvYj4nLCB7ICd2YWx1ZSc6ICc8c2NyaXB0PicgfSk7XG4gICAqIC8vID0+ICc8Yj4mbHQ7c2NyaXB0Jmd0OzwvYj4nXG4gICAqXG4gICAqIC8vIHVzaW5nIHRoZSBFUzYgZGVsaW1pdGVyIGFzIGFuIGFsdGVybmF0aXZlIHRvIHRoZSBkZWZhdWx0IFwiaW50ZXJwb2xhdGVcIiBkZWxpbWl0ZXJcbiAgICogXy50ZW1wbGF0ZSgnaGVsbG8gJHsgbmFtZSB9JywgeyAnbmFtZSc6ICdjdXJseScgfSk7XG4gICAqIC8vID0+ICdoZWxsbyBjdXJseSdcbiAgICpcbiAgICogLy8gdXNpbmcgdGhlIGludGVybmFsIGBwcmludGAgZnVuY3Rpb24gaW4gXCJldmFsdWF0ZVwiIGRlbGltaXRlcnNcbiAgICogXy50ZW1wbGF0ZSgnPCUgcHJpbnQoXCJoZWxsbyBcIiArIGVwaXRoZXQpOyAlPiEnLCB7ICdlcGl0aGV0JzogJ3N0b29nZScgfSk7XG4gICAqIC8vID0+ICdoZWxsbyBzdG9vZ2UhJ1xuICAgKlxuICAgKiAvLyB1c2luZyBjdXN0b20gdGVtcGxhdGUgZGVsaW1pdGVyc1xuICAgKiBfLnRlbXBsYXRlU2V0dGluZ3MgPSB7XG4gICAqICAgJ2ludGVycG9sYXRlJzogL3t7KFtcXHNcXFNdKz8pfX0vZ1xuICAgKiB9O1xuICAgKlxuICAgKiBfLnRlbXBsYXRlKCdoZWxsbyB7eyBuYW1lIH19IScsIHsgJ25hbWUnOiAnbXVzdGFjaGUnIH0pO1xuICAgKiAvLyA9PiAnaGVsbG8gbXVzdGFjaGUhJ1xuICAgKlxuICAgKiAvLyB1c2luZyB0aGUgYHNvdXJjZVVSTGAgb3B0aW9uIHRvIHNwZWNpZnkgYSBjdXN0b20gc291cmNlVVJMIGZvciB0aGUgdGVtcGxhdGVcbiAgICogdmFyIGNvbXBpbGVkID0gXy50ZW1wbGF0ZSgnaGVsbG8gPCU9IG5hbWUgJT4nLCBudWxsLCB7ICdzb3VyY2VVUkwnOiAnL2Jhc2ljL2dyZWV0aW5nLmpzdCcgfSk7XG4gICAqIGNvbXBpbGVkKGRhdGEpO1xuICAgKiAvLyA9PiBmaW5kIHRoZSBzb3VyY2Ugb2YgXCJncmVldGluZy5qc3RcIiB1bmRlciB0aGUgU291cmNlcyB0YWIgb3IgUmVzb3VyY2VzIHBhbmVsIG9mIHRoZSB3ZWIgaW5zcGVjdG9yXG4gICAqXG4gICAqIC8vIHVzaW5nIHRoZSBgdmFyaWFibGVgIG9wdGlvbiB0byBlbnN1cmUgYSB3aXRoLXN0YXRlbWVudCBpc24ndCB1c2VkIGluIHRoZSBjb21waWxlZCB0ZW1wbGF0ZVxuICAgKiB2YXIgY29tcGlsZWQgPSBfLnRlbXBsYXRlKCdoZWxsbyA8JT0gZGF0YS5uYW1lICU+IScsIG51bGwsIHsgJ3ZhcmlhYmxlJzogJ2RhdGEnIH0pO1xuICAgKiBjb21waWxlZC5zb3VyY2U7XG4gICAqIC8vID0+IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICogICB2YXIgX190LCBfX3AgPSAnJywgX19lID0gXy5lc2NhcGU7XG4gICAqICAgX19wICs9ICdoZWxsbyAnICsgKChfX3QgPSAoIGRhdGEubmFtZSApKSA9PSBudWxsID8gJycgOiBfX3QpICsgJyEnO1xuICAgKiAgIHJldHVybiBfX3A7XG4gICAqIH1cbiAgICpcbiAgICogLy8gdXNpbmcgdGhlIGBzb3VyY2VgIHByb3BlcnR5IHRvIGlubGluZSBjb21waWxlZCB0ZW1wbGF0ZXMgZm9yIG1lYW5pbmdmdWxcbiAgICogLy8gbGluZSBudW1iZXJzIGluIGVycm9yIG1lc3NhZ2VzIGFuZCBhIHN0YWNrIHRyYWNlXG4gICAqIGZzLndyaXRlRmlsZVN5bmMocGF0aC5qb2luKGN3ZCwgJ2pzdC5qcycpLCAnXFxcbiAgICogICB2YXIgSlNUID0ge1xcXG4gICAqICAgICBcIm1haW5cIjogJyArIF8udGVtcGxhdGUobWFpblRleHQpLnNvdXJjZSArICdcXFxuICAgKiAgIH07XFxcbiAgICogJyk7XG4gICAqL1xuICBmdW5jdGlvbiB0ZW1wbGF0ZSh0ZXh0LCBkYXRhLCBvcHRpb25zKSB7XG4gICAgLy8gYmFzZWQgb24gSm9obiBSZXNpZydzIGB0bXBsYCBpbXBsZW1lbnRhdGlvblxuICAgIC8vIGh0dHA6Ly9lam9obi5vcmcvYmxvZy9qYXZhc2NyaXB0LW1pY3JvLXRlbXBsYXRpbmcvXG4gICAgLy8gYW5kIExhdXJhIERva3Rvcm92YSdzIGRvVC5qc1xuICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9vbGFkby9kb1RcbiAgICB0ZXh0IHx8ICh0ZXh0ID0gJycpO1xuICAgIG9wdGlvbnMgfHwgKG9wdGlvbnMgPSB7fSk7XG5cbiAgICB2YXIgaXNFdmFsdWF0aW5nLFxuICAgICAgICByZXN1bHQsXG4gICAgICAgIHNldHRpbmdzID0gbG9kYXNoLnRlbXBsYXRlU2V0dGluZ3MsXG4gICAgICAgIGluZGV4ID0gMCxcbiAgICAgICAgaW50ZXJwb2xhdGUgPSBvcHRpb25zLmludGVycG9sYXRlIHx8IHNldHRpbmdzLmludGVycG9sYXRlIHx8IHJlTm9NYXRjaCxcbiAgICAgICAgc291cmNlID0gXCJfX3AgKz0gJ1wiLFxuICAgICAgICB2YXJpYWJsZSA9IG9wdGlvbnMudmFyaWFibGUgfHwgc2V0dGluZ3MudmFyaWFibGUsXG4gICAgICAgIGhhc1ZhcmlhYmxlID0gdmFyaWFibGU7XG5cbiAgICAvLyBjb21waWxlIHJlZ2V4cCB0byBtYXRjaCBlYWNoIGRlbGltaXRlclxuICAgIHZhciByZURlbGltaXRlcnMgPSBSZWdFeHAoXG4gICAgICAob3B0aW9ucy5lc2NhcGUgfHwgc2V0dGluZ3MuZXNjYXBlIHx8IHJlTm9NYXRjaCkuc291cmNlICsgJ3wnICtcbiAgICAgIGludGVycG9sYXRlLnNvdXJjZSArICd8JyArXG4gICAgICAoaW50ZXJwb2xhdGUgPT09IHJlSW50ZXJwb2xhdGUgPyByZUVzVGVtcGxhdGUgOiByZU5vTWF0Y2gpLnNvdXJjZSArICd8JyArXG4gICAgICAob3B0aW9ucy5ldmFsdWF0ZSB8fCBzZXR0aW5ncy5ldmFsdWF0ZSB8fCByZU5vTWF0Y2gpLnNvdXJjZSArICd8JCdcbiAgICAsICdnJyk7XG5cbiAgICB0ZXh0LnJlcGxhY2UocmVEZWxpbWl0ZXJzLCBmdW5jdGlvbihtYXRjaCwgZXNjYXBlVmFsdWUsIGludGVycG9sYXRlVmFsdWUsIGVzVGVtcGxhdGVWYWx1ZSwgZXZhbHVhdGVWYWx1ZSwgb2Zmc2V0KSB7XG4gICAgICBpbnRlcnBvbGF0ZVZhbHVlIHx8IChpbnRlcnBvbGF0ZVZhbHVlID0gZXNUZW1wbGF0ZVZhbHVlKTtcblxuICAgICAgLy8gZXNjYXBlIGNoYXJhY3RlcnMgdGhhdCBjYW5ub3QgYmUgaW5jbHVkZWQgaW4gc3RyaW5nIGxpdGVyYWxzXG4gICAgICBzb3VyY2UgKz0gdGV4dC5zbGljZShpbmRleCwgb2Zmc2V0KS5yZXBsYWNlKHJlVW5lc2NhcGVkU3RyaW5nLCBlc2NhcGVTdHJpbmdDaGFyKTtcblxuICAgICAgLy8gcmVwbGFjZSBkZWxpbWl0ZXJzIHdpdGggc25pcHBldHNcbiAgICAgIGlmIChlc2NhcGVWYWx1ZSkge1xuICAgICAgICBzb3VyY2UgKz0gXCInICtcXG5fX2UoXCIgKyBlc2NhcGVWYWx1ZSArIFwiKSArXFxuJ1wiO1xuICAgICAgfVxuICAgICAgaWYgKGV2YWx1YXRlVmFsdWUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJztcXG5cIiArIGV2YWx1YXRlVmFsdWUgKyBcIjtcXG5fX3AgKz0gJ1wiO1xuICAgICAgfVxuICAgICAgaWYgKGludGVycG9sYXRlVmFsdWUpIHtcbiAgICAgICAgc291cmNlICs9IFwiJyArXFxuKChfX3QgPSAoXCIgKyBpbnRlcnBvbGF0ZVZhbHVlICsgXCIpKSA9PSBudWxsID8gJycgOiBfX3QpICtcXG4nXCI7XG4gICAgICB9XG4gICAgICBpc0V2YWx1YXRpbmcgfHwgKGlzRXZhbHVhdGluZyA9IGV2YWx1YXRlVmFsdWUgfHwgcmVDb21wbGV4RGVsaW1pdGVyLnRlc3QoZXNjYXBlVmFsdWUgfHwgaW50ZXJwb2xhdGVWYWx1ZSkpO1xuICAgICAgaW5kZXggPSBvZmZzZXQgKyBtYXRjaC5sZW5ndGg7XG5cbiAgICAgIC8vIHRoZSBKUyBlbmdpbmUgZW1iZWRkZWQgaW4gQWRvYmUgcHJvZHVjdHMgcmVxdWlyZXMgcmV0dXJuaW5nIHRoZSBgbWF0Y2hgXG4gICAgICAvLyBzdHJpbmcgaW4gb3JkZXIgdG8gcHJvZHVjZSB0aGUgY29ycmVjdCBgb2Zmc2V0YCB2YWx1ZVxuICAgICAgcmV0dXJuIG1hdGNoO1xuICAgIH0pO1xuXG4gICAgc291cmNlICs9IFwiJztcXG5cIjtcblxuICAgIC8vIGlmIGB2YXJpYWJsZWAgaXMgbm90IHNwZWNpZmllZCBhbmQgdGhlIHRlbXBsYXRlIGNvbnRhaW5zIFwiZXZhbHVhdGVcIlxuICAgIC8vIGRlbGltaXRlcnMsIHdyYXAgYSB3aXRoLXN0YXRlbWVudCBhcm91bmQgdGhlIGdlbmVyYXRlZCBjb2RlIHRvIGFkZCB0aGVcbiAgICAvLyBkYXRhIG9iamVjdCB0byB0aGUgdG9wIG9mIHRoZSBzY29wZSBjaGFpblxuICAgIGlmICghaGFzVmFyaWFibGUpIHtcbiAgICAgIHZhcmlhYmxlID0gJ29iaic7XG4gICAgICBpZiAoaXNFdmFsdWF0aW5nKSB7XG4gICAgICAgIHNvdXJjZSA9ICd3aXRoICgnICsgdmFyaWFibGUgKyAnKSB7XFxuJyArIHNvdXJjZSArICdcXG59XFxuJztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBhdm9pZCBhIHdpdGgtc3RhdGVtZW50IGJ5IHByZXBlbmRpbmcgZGF0YSBvYmplY3QgcmVmZXJlbmNlcyB0byBwcm9wZXJ0eSBuYW1lc1xuICAgICAgICB2YXIgcmVEb3VibGVWYXJpYWJsZSA9IFJlZ0V4cCgnKFxcXFwoXFxcXHMqKScgKyB2YXJpYWJsZSArICdcXFxcLicgKyB2YXJpYWJsZSArICdcXFxcYicsICdnJyk7XG4gICAgICAgIHNvdXJjZSA9IHNvdXJjZVxuICAgICAgICAgIC5yZXBsYWNlKHJlSW5zZXJ0VmFyaWFibGUsICckJicgKyB2YXJpYWJsZSArICcuJylcbiAgICAgICAgICAucmVwbGFjZShyZURvdWJsZVZhcmlhYmxlLCAnJDFfX2QnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBjbGVhbnVwIGNvZGUgYnkgc3RyaXBwaW5nIGVtcHR5IHN0cmluZ3NcbiAgICBzb3VyY2UgPSAoaXNFdmFsdWF0aW5nID8gc291cmNlLnJlcGxhY2UocmVFbXB0eVN0cmluZ0xlYWRpbmcsICcnKSA6IHNvdXJjZSlcbiAgICAgIC5yZXBsYWNlKHJlRW1wdHlTdHJpbmdNaWRkbGUsICckMScpXG4gICAgICAucmVwbGFjZShyZUVtcHR5U3RyaW5nVHJhaWxpbmcsICckMTsnKTtcblxuICAgIC8vIGZyYW1lIGNvZGUgYXMgdGhlIGZ1bmN0aW9uIGJvZHlcbiAgICBzb3VyY2UgPSAnZnVuY3Rpb24oJyArIHZhcmlhYmxlICsgJykge1xcbicgK1xuICAgICAgKGhhc1ZhcmlhYmxlID8gJycgOiB2YXJpYWJsZSArICcgfHwgKCcgKyB2YXJpYWJsZSArICcgPSB7fSk7XFxuJykgK1xuICAgICAgXCJ2YXIgX190LCBfX3AgPSAnJywgX19lID0gXy5lc2NhcGVcIiArXG4gICAgICAoaXNFdmFsdWF0aW5nXG4gICAgICAgID8gJywgX19qID0gQXJyYXkucHJvdG90eXBlLmpvaW47XFxuJyArXG4gICAgICAgICAgXCJmdW5jdGlvbiBwcmludCgpIHsgX19wICs9IF9fai5jYWxsKGFyZ3VtZW50cywgJycpIH1cXG5cIlxuICAgICAgICA6IChoYXNWYXJpYWJsZSA/ICcnIDogJywgX19kID0gJyArIHZhcmlhYmxlICsgJy4nICsgdmFyaWFibGUgKyAnIHx8ICcgKyB2YXJpYWJsZSkgKyAnO1xcbidcbiAgICAgICkgK1xuICAgICAgc291cmNlICtcbiAgICAgICdyZXR1cm4gX19wXFxufSc7XG5cbiAgICAvLyB1c2UgYSBzb3VyY2VVUkwgZm9yIGVhc2llciBkZWJ1Z2dpbmdcbiAgICAvLyBodHRwOi8vd3d3Lmh0bWw1cm9ja3MuY29tL2VuL3R1dG9yaWFscy9kZXZlbG9wZXJ0b29scy9zb3VyY2VtYXBzLyN0b2Mtc291cmNldXJsXG4gICAgdmFyIHNvdXJjZVVSTCA9IHVzZVNvdXJjZVVSTFxuICAgICAgPyAnXFxuLy9AIHNvdXJjZVVSTD0nICsgKG9wdGlvbnMuc291cmNlVVJMIHx8ICcvbG9kYXNoL3RlbXBsYXRlL3NvdXJjZVsnICsgKHRlbXBsYXRlQ291bnRlcisrKSArICddJylcbiAgICAgIDogJyc7XG5cbiAgICB0cnkge1xuICAgICAgcmVzdWx0ID0gRnVuY3Rpb24oJ18nLCAncmV0dXJuICcgKyBzb3VyY2UgKyBzb3VyY2VVUkwpKGxvZGFzaCk7XG4gICAgfSBjYXRjaChlKSB7XG4gICAgICBlLnNvdXJjZSA9IHNvdXJjZTtcbiAgICAgIHRocm93IGU7XG4gICAgfVxuXG4gICAgaWYgKGRhdGEpIHtcbiAgICAgIHJldHVybiByZXN1bHQoZGF0YSk7XG4gICAgfVxuICAgIC8vIHByb3ZpZGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uJ3Mgc291cmNlIHZpYSBpdHMgYHRvU3RyaW5nYCBtZXRob2QsIGluXG4gICAgLy8gc3VwcG9ydGVkIGVudmlyb25tZW50cywgb3IgdGhlIGBzb3VyY2VgIHByb3BlcnR5IGFzIGEgY29udmVuaWVuY2UgZm9yXG4gICAgLy8gaW5saW5pbmcgY29tcGlsZWQgdGVtcGxhdGVzIGR1cmluZyB0aGUgYnVpbGQgcHJvY2Vzc1xuICAgIHJlc3VsdC5zb3VyY2UgPSBzb3VyY2U7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFeGVjdXRlcyB0aGUgYGNhbGxiYWNrYCBmdW5jdGlvbiBgbmAgdGltZXMsIHJldHVybmluZyBhbiBhcnJheSBvZiB0aGUgcmVzdWx0c1xuICAgKiBvZiBlYWNoIGBjYWxsYmFja2AgZXhlY3V0aW9uLiBUaGUgYGNhbGxiYWNrYCBpcyBib3VuZCB0byBgdGhpc0FyZ2AgYW5kIGludm9rZWRcbiAgICogd2l0aCBvbmUgYXJndW1lbnQ7IChpbmRleCkuXG4gICAqXG4gICAqIEBzdGF0aWNcbiAgICogQG1lbWJlck9mIF9cbiAgICogQGNhdGVnb3J5IFV0aWxpdGllc1xuICAgKiBAcGFyYW0ge051bWJlcn0gbiBUaGUgbnVtYmVyIG9mIHRpbWVzIHRvIGV4ZWN1dGUgdGhlIGNhbGxiYWNrLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gY2FsbGVkIHBlciBpdGVyYXRpb24uXG4gICAqIEBwYXJhbSB7TWl4ZWR9IFt0aGlzQXJnXSBUaGUgYHRoaXNgIGJpbmRpbmcgb2YgYGNhbGxiYWNrYC5cbiAgICogQHJldHVybnMge0FycmF5fSBSZXR1cm5zIGEgbmV3IGFycmF5IG9mIHRoZSByZXN1bHRzIG9mIGVhY2ggYGNhbGxiYWNrYCBleGVjdXRpb24uXG4gICAqIEBleGFtcGxlXG4gICAqXG4gICAqIHZhciBkaWNlUm9sbHMgPSBfLnRpbWVzKDMsIF8ucGFydGlhbChfLnJhbmRvbSwgMSwgNikpO1xuICAgKiAvLyA9PiBbMywgNiwgNF1cbiAgICpcbiAgICogXy50aW1lcygzLCBmdW5jdGlvbihuKSB7IG1hZ2UuY2FzdFNwZWxsKG4pOyB9KTtcbiAgICogLy8gPT4gY2FsbHMgYG1hZ2UuY2FzdFNwZWxsKG4pYCB0aHJlZSB0aW1lcywgcGFzc2luZyBgbmAgb2YgYDBgLCBgMWAsIGFuZCBgMmAgcmVzcGVjdGl2ZWx5XG4gICAqXG4gICAqIF8udGltZXMoMywgZnVuY3Rpb24obikgeyB0aGlzLmNhc3Qobik7IH0sIG1hZ2UpO1xuICAgKiAvLyA9PiBhbHNvIGNhbGxzIGBtYWdlLmNhc3RTcGVsbChuKWAgdGhyZWUgdGltZXNcbiAgICovXG4gIGZ1bmN0aW9uIHRpbWVzKG4sIGNhbGxiYWNrLCB0aGlzQXJnKSB7XG4gICAgbiA9ICtuIHx8IDA7XG4gICAgdmFyIGluZGV4ID0gLTEsXG4gICAgICAgIHJlc3VsdCA9IEFycmF5KG4pO1xuXG4gICAgd2hpbGUgKCsraW5kZXggPCBuKSB7XG4gICAgICByZXN1bHRbaW5kZXhdID0gY2FsbGJhY2suY2FsbCh0aGlzQXJnLCBpbmRleCk7XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICAvKipcbiAgICogVGhlIG9wcG9zaXRlIG9mIGBfLmVzY2FwZWAsIHRoaXMgbWV0aG9kIGNvbnZlcnRzIHRoZSBIVE1MIGVudGl0aWVzXG4gICAqIGAmYW1wO2AsIGAmbHQ7YCwgYCZndDtgLCBgJnF1b3Q7YCwgYW5kIGAmI3gyNztgIGluIGBzdHJpbmdgIHRvIHRoZWlyXG4gICAqIGNvcnJlc3BvbmRpbmcgY2hhcmFjdGVycy5cbiAgICpcbiAgICogQHN0YXRpY1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgVXRpbGl0aWVzXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBzdHJpbmcgVGhlIHN0cmluZyB0byB1bmVzY2FwZS5cbiAgICogQHJldHVybnMge1N0cmluZ30gUmV0dXJucyB0aGUgdW5lc2NhcGVkIHN0cmluZy5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy51bmVzY2FwZSgnTW9lLCBMYXJyeSAmYW1wOyBDdXJseScpO1xuICAgKiAvLyA9PiAnTW9lLCBMYXJyeSAmIEN1cmx5J1xuICAgKi9cbiAgZnVuY3Rpb24gdW5lc2NhcGUoc3RyaW5nKSB7XG4gICAgcmV0dXJuIHN0cmluZyA9PSBudWxsID8gJycgOiAoc3RyaW5nICsgJycpLnJlcGxhY2UocmVFc2NhcGVkSHRtbCwgdW5lc2NhcGVIdG1sQ2hhcik7XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGEgdW5pcXVlIElELiBJZiBgcHJlZml4YCBpcyBwYXNzZWQsIHRoZSBJRCB3aWxsIGJlIGFwcGVuZGVkIHRvIGl0LlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBVdGlsaXRpZXNcbiAgICogQHBhcmFtIHtTdHJpbmd9IFtwcmVmaXhdIFRoZSB2YWx1ZSB0byBwcmVmaXggdGhlIElEIHdpdGguXG4gICAqIEByZXR1cm5zIHtTdHJpbmd9IFJldHVybnMgdGhlIHVuaXF1ZSBJRC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy51bmlxdWVJZCgnY29udGFjdF8nKTtcbiAgICogLy8gPT4gJ2NvbnRhY3RfMTA0J1xuICAgKlxuICAgKiBfLnVuaXF1ZUlkKCk7XG4gICAqIC8vID0+ICcxMDUnXG4gICAqL1xuICBmdW5jdGlvbiB1bmlxdWVJZChwcmVmaXgpIHtcbiAgICByZXR1cm4gKHByZWZpeCA9PSBudWxsID8gJycgOiBwcmVmaXggKyAnJykgKyAoKytpZENvdW50ZXIpO1xuICB9XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLyoqXG4gICAqIEludm9rZXMgYGludGVyY2VwdG9yYCB3aXRoIHRoZSBgdmFsdWVgIGFzIHRoZSBmaXJzdCBhcmd1bWVudCwgYW5kIHRoZW5cbiAgICogcmV0dXJucyBgdmFsdWVgLiBUaGUgcHVycG9zZSBvZiB0aGlzIG1ldGhvZCBpcyB0byBcInRhcCBpbnRvXCIgYSBtZXRob2QgY2hhaW4sXG4gICAqIGluIG9yZGVyIHRvIHBlcmZvcm0gb3BlcmF0aW9ucyBvbiBpbnRlcm1lZGlhdGUgcmVzdWx0cyB3aXRoaW4gdGhlIGNoYWluLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBjYXRlZ29yeSBDaGFpbmluZ1xuICAgKiBAcGFyYW0ge01peGVkfSB2YWx1ZSBUaGUgdmFsdWUgdG8gcGFzcyB0byBgaW50ZXJjZXB0b3JgLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBpbnRlcmNlcHRvciBUaGUgZnVuY3Rpb24gdG8gaW52b2tlLlxuICAgKiBAcmV0dXJucyB7TWl4ZWR9IFJldHVybnMgYHZhbHVlYC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXy5jaGFpbihbMSwgMiwgMywgMjAwXSlcbiAgICogIC5maWx0ZXIoZnVuY3Rpb24obnVtKSB7IHJldHVybiBudW0gJSAyID09IDA7IH0pXG4gICAqICAudGFwKGFsZXJ0KVxuICAgKiAgLm1hcChmdW5jdGlvbihudW0pIHsgcmV0dXJuIG51bSAqIG51bTsgfSlcbiAgICogIC52YWx1ZSgpO1xuICAgKiAvLyA9PiAvLyBbMiwgMjAwXSAoYWxlcnRlZClcbiAgICogLy8gPT4gWzQsIDQwMDAwXVxuICAgKi9cbiAgZnVuY3Rpb24gdGFwKHZhbHVlLCBpbnRlcmNlcHRvcikge1xuICAgIGludGVyY2VwdG9yKHZhbHVlKTtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cblxuICAvKipcbiAgICogUHJvZHVjZXMgdGhlIGB0b1N0cmluZ2AgcmVzdWx0IG9mIHRoZSB3cmFwcGVkIHZhbHVlLlxuICAgKlxuICAgKiBAbmFtZSB0b1N0cmluZ1xuICAgKiBAbWVtYmVyT2YgX1xuICAgKiBAY2F0ZWdvcnkgQ2hhaW5pbmdcbiAgICogQHJldHVybnMge1N0cmluZ30gUmV0dXJucyB0aGUgc3RyaW5nIHJlc3VsdC5cbiAgICogQGV4YW1wbGVcbiAgICpcbiAgICogXyhbMSwgMiwgM10pLnRvU3RyaW5nKCk7XG4gICAqIC8vID0+ICcxLDIsMydcbiAgICovXG4gIGZ1bmN0aW9uIHdyYXBwZXJUb1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5fX3dyYXBwZWRfXyArICcnO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3RzIHRoZSB3cmFwcGVkIHZhbHVlLlxuICAgKlxuICAgKiBAbmFtZSB2YWx1ZU9mXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEBhbGlhcyB2YWx1ZVxuICAgKiBAY2F0ZWdvcnkgQ2hhaW5pbmdcbiAgICogQHJldHVybnMge01peGVkfSBSZXR1cm5zIHRoZSB3cmFwcGVkIHZhbHVlLlxuICAgKiBAZXhhbXBsZVxuICAgKlxuICAgKiBfKFsxLCAyLCAzXSkudmFsdWVPZigpO1xuICAgKiAvLyA9PiBbMSwgMiwgM11cbiAgICovXG4gIGZ1bmN0aW9uIHdyYXBwZXJWYWx1ZU9mKCkge1xuICAgIHJldHVybiB0aGlzLl9fd3JhcHBlZF9fO1xuICB9XG5cbiAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLy8gYWRkIGZ1bmN0aW9ucyB0aGF0IHJldHVybiB3cmFwcGVkIHZhbHVlcyB3aGVuIGNoYWluaW5nXG4gIGxvZGFzaC5hZnRlciA9IGFmdGVyO1xuICBsb2Rhc2guYXNzaWduID0gYXNzaWduO1xuICBsb2Rhc2guYmluZCA9IGJpbmQ7XG4gIGxvZGFzaC5iaW5kQWxsID0gYmluZEFsbDtcbiAgbG9kYXNoLmJpbmRLZXkgPSBiaW5kS2V5O1xuICBsb2Rhc2guY29tcGFjdCA9IGNvbXBhY3Q7XG4gIGxvZGFzaC5jb21wb3NlID0gY29tcG9zZTtcbiAgbG9kYXNoLmNvdW50QnkgPSBjb3VudEJ5O1xuICBsb2Rhc2guZGVib3VuY2UgPSBkZWJvdW5jZTtcbiAgbG9kYXNoLmRlZmF1bHRzID0gZGVmYXVsdHM7XG4gIGxvZGFzaC5kZWZlciA9IGRlZmVyO1xuICBsb2Rhc2guZGVsYXkgPSBkZWxheTtcbiAgbG9kYXNoLmRpZmZlcmVuY2UgPSBkaWZmZXJlbmNlO1xuICBsb2Rhc2guZmlsdGVyID0gZmlsdGVyO1xuICBsb2Rhc2guZmxhdHRlbiA9IGZsYXR0ZW47XG4gIGxvZGFzaC5mb3JFYWNoID0gZm9yRWFjaDtcbiAgbG9kYXNoLmZvckluID0gZm9ySW47XG4gIGxvZGFzaC5mb3JPd24gPSBmb3JPd247XG4gIGxvZGFzaC5mdW5jdGlvbnMgPSBmdW5jdGlvbnM7XG4gIGxvZGFzaC5ncm91cEJ5ID0gZ3JvdXBCeTtcbiAgbG9kYXNoLmluaXRpYWwgPSBpbml0aWFsO1xuICBsb2Rhc2guaW50ZXJzZWN0aW9uID0gaW50ZXJzZWN0aW9uO1xuICBsb2Rhc2guaW52ZXJ0ID0gaW52ZXJ0O1xuICBsb2Rhc2guaW52b2tlID0gaW52b2tlO1xuICBsb2Rhc2gua2V5cyA9IGtleXM7XG4gIGxvZGFzaC5tYXAgPSBtYXA7XG4gIGxvZGFzaC5tYXggPSBtYXg7XG4gIGxvZGFzaC5tZW1vaXplID0gbWVtb2l6ZTtcbiAgbG9kYXNoLm1lcmdlID0gbWVyZ2U7XG4gIGxvZGFzaC5taW4gPSBtaW47XG4gIGxvZGFzaC5vYmplY3QgPSBvYmplY3Q7XG4gIGxvZGFzaC5vbWl0ID0gb21pdDtcbiAgbG9kYXNoLm9uY2UgPSBvbmNlO1xuICBsb2Rhc2gucGFpcnMgPSBwYWlycztcbiAgbG9kYXNoLnBhcnRpYWwgPSBwYXJ0aWFsO1xuICBsb2Rhc2gucGljayA9IHBpY2s7XG4gIGxvZGFzaC5wbHVjayA9IHBsdWNrO1xuICBsb2Rhc2gucmFuZ2UgPSByYW5nZTtcbiAgbG9kYXNoLnJlamVjdCA9IHJlamVjdDtcbiAgbG9kYXNoLnJlc3QgPSByZXN0O1xuICBsb2Rhc2guc2h1ZmZsZSA9IHNodWZmbGU7XG4gIGxvZGFzaC5zb3J0QnkgPSBzb3J0Qnk7XG4gIGxvZGFzaC50YXAgPSB0YXA7XG4gIGxvZGFzaC50aHJvdHRsZSA9IHRocm90dGxlO1xuICBsb2Rhc2gudGltZXMgPSB0aW1lcztcbiAgbG9kYXNoLnRvQXJyYXkgPSB0b0FycmF5O1xuICBsb2Rhc2gudW5pb24gPSB1bmlvbjtcbiAgbG9kYXNoLnVuaXEgPSB1bmlxO1xuICBsb2Rhc2gudmFsdWVzID0gdmFsdWVzO1xuICBsb2Rhc2gud2hlcmUgPSB3aGVyZTtcbiAgbG9kYXNoLndpdGhvdXQgPSB3aXRob3V0O1xuICBsb2Rhc2gud3JhcCA9IHdyYXA7XG4gIGxvZGFzaC56aXAgPSB6aXA7XG5cbiAgLy8gYWRkIGFsaWFzZXNcbiAgbG9kYXNoLmNvbGxlY3QgPSBtYXA7XG4gIGxvZGFzaC5kcm9wID0gcmVzdDtcbiAgbG9kYXNoLmVhY2ggPSBmb3JFYWNoO1xuICBsb2Rhc2guZXh0ZW5kID0gYXNzaWduO1xuICBsb2Rhc2gubWV0aG9kcyA9IGZ1bmN0aW9ucztcbiAgbG9kYXNoLnNlbGVjdCA9IGZpbHRlcjtcbiAgbG9kYXNoLnRhaWwgPSByZXN0O1xuICBsb2Rhc2gudW5pcXVlID0gdW5pcTtcblxuICAvLyBhZGQgZnVuY3Rpb25zIHRvIGBsb2Rhc2gucHJvdG90eXBlYFxuICBtaXhpbihsb2Rhc2gpO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8vIGFkZCBmdW5jdGlvbnMgdGhhdCByZXR1cm4gdW53cmFwcGVkIHZhbHVlcyB3aGVuIGNoYWluaW5nXG4gIGxvZGFzaC5jbG9uZSA9IGNsb25lO1xuICBsb2Rhc2guY2xvbmVEZWVwID0gY2xvbmVEZWVwO1xuICBsb2Rhc2guY29udGFpbnMgPSBjb250YWlucztcbiAgbG9kYXNoLmVzY2FwZSA9IGVzY2FwZTtcbiAgbG9kYXNoLmV2ZXJ5ID0gZXZlcnk7XG4gIGxvZGFzaC5maW5kID0gZmluZDtcbiAgbG9kYXNoLmhhcyA9IGhhcztcbiAgbG9kYXNoLmlkZW50aXR5ID0gaWRlbnRpdHk7XG4gIGxvZGFzaC5pbmRleE9mID0gaW5kZXhPZjtcbiAgbG9kYXNoLmlzQXJndW1lbnRzID0gaXNBcmd1bWVudHM7XG4gIGxvZGFzaC5pc0FycmF5ID0gaXNBcnJheTtcbiAgbG9kYXNoLmlzQm9vbGVhbiA9IGlzQm9vbGVhbjtcbiAgbG9kYXNoLmlzRGF0ZSA9IGlzRGF0ZTtcbiAgbG9kYXNoLmlzRWxlbWVudCA9IGlzRWxlbWVudDtcbiAgbG9kYXNoLmlzRW1wdHkgPSBpc0VtcHR5O1xuICBsb2Rhc2guaXNFcXVhbCA9IGlzRXF1YWw7XG4gIGxvZGFzaC5pc0Zpbml0ZSA9IGlzRmluaXRlO1xuICBsb2Rhc2guaXNGdW5jdGlvbiA9IGlzRnVuY3Rpb247XG4gIGxvZGFzaC5pc05hTiA9IGlzTmFOO1xuICBsb2Rhc2guaXNOdWxsID0gaXNOdWxsO1xuICBsb2Rhc2guaXNOdW1iZXIgPSBpc051bWJlcjtcbiAgbG9kYXNoLmlzT2JqZWN0ID0gaXNPYmplY3Q7XG4gIGxvZGFzaC5pc1BsYWluT2JqZWN0ID0gaXNQbGFpbk9iamVjdDtcbiAgbG9kYXNoLmlzUmVnRXhwID0gaXNSZWdFeHA7XG4gIGxvZGFzaC5pc1N0cmluZyA9IGlzU3RyaW5nO1xuICBsb2Rhc2guaXNVbmRlZmluZWQgPSBpc1VuZGVmaW5lZDtcbiAgbG9kYXNoLmxhc3RJbmRleE9mID0gbGFzdEluZGV4T2Y7XG4gIGxvZGFzaC5taXhpbiA9IG1peGluO1xuICBsb2Rhc2gubm9Db25mbGljdCA9IG5vQ29uZmxpY3Q7XG4gIGxvZGFzaC5yYW5kb20gPSByYW5kb207XG4gIGxvZGFzaC5yZWR1Y2UgPSByZWR1Y2U7XG4gIGxvZGFzaC5yZWR1Y2VSaWdodCA9IHJlZHVjZVJpZ2h0O1xuICBsb2Rhc2gucmVzdWx0ID0gcmVzdWx0O1xuICBsb2Rhc2guc2l6ZSA9IHNpemU7XG4gIGxvZGFzaC5zb21lID0gc29tZTtcbiAgbG9kYXNoLnNvcnRlZEluZGV4ID0gc29ydGVkSW5kZXg7XG4gIGxvZGFzaC50ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICBsb2Rhc2gudW5lc2NhcGUgPSB1bmVzY2FwZTtcbiAgbG9kYXNoLnVuaXF1ZUlkID0gdW5pcXVlSWQ7XG5cbiAgLy8gYWRkIGFsaWFzZXNcbiAgbG9kYXNoLmFsbCA9IGV2ZXJ5O1xuICBsb2Rhc2guYW55ID0gc29tZTtcbiAgbG9kYXNoLmRldGVjdCA9IGZpbmQ7XG4gIGxvZGFzaC5mb2xkbCA9IHJlZHVjZTtcbiAgbG9kYXNoLmZvbGRyID0gcmVkdWNlUmlnaHQ7XG4gIGxvZGFzaC5pbmNsdWRlID0gY29udGFpbnM7XG4gIGxvZGFzaC5pbmplY3QgPSByZWR1Y2U7XG5cbiAgZm9yT3duKGxvZGFzaCwgZnVuY3Rpb24oZnVuYywgbWV0aG9kTmFtZSkge1xuICAgIGlmICghbG9kYXNoLnByb3RvdHlwZVttZXRob2ROYW1lXSkge1xuICAgICAgbG9kYXNoLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IFt0aGlzLl9fd3JhcHBlZF9fXTtcbiAgICAgICAgcHVzaC5hcHBseShhcmdzLCBhcmd1bWVudHMpO1xuICAgICAgICByZXR1cm4gZnVuYy5hcHBseShsb2Rhc2gsIGFyZ3MpO1xuICAgICAgfTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8vIGFkZCBmdW5jdGlvbnMgY2FwYWJsZSBvZiByZXR1cm5pbmcgd3JhcHBlZCBhbmQgdW53cmFwcGVkIHZhbHVlcyB3aGVuIGNoYWluaW5nXG4gIGxvZGFzaC5maXJzdCA9IGZpcnN0O1xuICBsb2Rhc2gubGFzdCA9IGxhc3Q7XG5cbiAgLy8gYWRkIGFsaWFzZXNcbiAgbG9kYXNoLnRha2UgPSBmaXJzdDtcbiAgbG9kYXNoLmhlYWQgPSBmaXJzdDtcblxuICBmb3JPd24obG9kYXNoLCBmdW5jdGlvbihmdW5jLCBtZXRob2ROYW1lKSB7XG4gICAgaWYgKCFsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdKSB7XG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdPSBmdW5jdGlvbihuLCBndWFyZCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gZnVuYyh0aGlzLl9fd3JhcHBlZF9fLCBuLCBndWFyZCk7XG4gICAgICAgIHJldHVybiAobiA9PSBudWxsIHx8IGd1YXJkKSA/IHJlc3VsdCA6IG5ldyBsb2Rhc2gocmVzdWx0KTtcbiAgICAgIH07XG4gICAgfVxuICB9KTtcblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuICAvKipcbiAgICogVGhlIHNlbWFudGljIHZlcnNpb24gbnVtYmVyLlxuICAgKlxuICAgKiBAc3RhdGljXG4gICAqIEBtZW1iZXJPZiBfXG4gICAqIEB0eXBlIFN0cmluZ1xuICAgKi9cbiAgbG9kYXNoLlZFUlNJT04gPSAnMS4wLjAtcmMuMyc7XG5cbiAgLy8gYWRkIFwiQ2hhaW5pbmdcIiBmdW5jdGlvbnMgdG8gdGhlIHdyYXBwZXJcbiAgbG9kYXNoLnByb3RvdHlwZS50b1N0cmluZyA9IHdyYXBwZXJUb1N0cmluZztcbiAgbG9kYXNoLnByb3RvdHlwZS52YWx1ZSA9IHdyYXBwZXJWYWx1ZU9mO1xuICBsb2Rhc2gucHJvdG90eXBlLnZhbHVlT2YgPSB3cmFwcGVyVmFsdWVPZjtcblxuICAvLyBhZGQgYEFycmF5YCBmdW5jdGlvbnMgdGhhdCByZXR1cm4gdW53cmFwcGVkIHZhbHVlc1xuICBlYWNoKFsnam9pbicsICdwb3AnLCAnc2hpZnQnXSwgZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIHZhciBmdW5jID0gYXJyYXlSZWZbbWV0aG9kTmFtZV07XG4gICAgbG9kYXNoLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIGZ1bmMuYXBwbHkodGhpcy5fX3dyYXBwZWRfXywgYXJndW1lbnRzKTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBhZGQgYEFycmF5YCBmdW5jdGlvbnMgdGhhdCByZXR1cm4gdGhlIHdyYXBwZWQgdmFsdWVcbiAgZWFjaChbJ3B1c2gnLCAncmV2ZXJzZScsICdzb3J0JywgJ3Vuc2hpZnQnXSwgZnVuY3Rpb24obWV0aG9kTmFtZSkge1xuICAgIHZhciBmdW5jID0gYXJyYXlSZWZbbWV0aG9kTmFtZV07XG4gICAgbG9kYXNoLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgZnVuYy5hcHBseSh0aGlzLl9fd3JhcHBlZF9fLCBhcmd1bWVudHMpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbiAgfSk7XG5cbiAgLy8gYWRkIGBBcnJheWAgZnVuY3Rpb25zIHRoYXQgcmV0dXJuIG5ldyB3cmFwcGVkIHZhbHVlc1xuICBlYWNoKFsnY29uY2F0JywgJ3NsaWNlJywgJ3NwbGljZSddLCBmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgdmFyIGZ1bmMgPSBhcnJheVJlZlttZXRob2ROYW1lXTtcbiAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gZnVuYy5hcHBseSh0aGlzLl9fd3JhcHBlZF9fLCBhcmd1bWVudHMpO1xuICAgICAgcmV0dXJuIG5ldyBsb2Rhc2gocmVzdWx0KTtcbiAgICB9O1xuICB9KTtcblxuICAvLyBhdm9pZCBhcnJheS1saWtlIG9iamVjdCBidWdzIHdpdGggYEFycmF5I3NoaWZ0YCBhbmQgYEFycmF5I3NwbGljZWBcbiAgLy8gaW4gRmlyZWZveCA8IDEwIGFuZCBJRSA8IDlcbiAgaWYgKGhhc09iamVjdFNwbGljZUJ1Zykge1xuICAgIGVhY2goWydwb3AnLCAnc2hpZnQnLCAnc3BsaWNlJ10sIGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICAgIHZhciBmdW5jID0gYXJyYXlSZWZbbWV0aG9kTmFtZV0sXG4gICAgICAgICAgaXNTcGxpY2UgPSBtZXRob2ROYW1lID09ICdzcGxpY2UnO1xuXG4gICAgICBsb2Rhc2gucHJvdG90eXBlW21ldGhvZE5hbWVdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuX193cmFwcGVkX18sXG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KHZhbHVlLCBhcmd1bWVudHMpO1xuXG4gICAgICAgIGlmICh2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICBkZWxldGUgdmFsdWVbMF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGlzU3BsaWNlID8gbmV3IGxvZGFzaChyZXN1bHQpIDogcmVzdWx0O1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIGFkZCBwc2V1ZG8gcHJpdmF0ZSBwcm9wZXJ0eSB0byBiZSB1c2VkIGFuZCByZW1vdmVkIGR1cmluZyB0aGUgYnVpbGQgcHJvY2Vzc1xuICBsb2Rhc2guX2VhY2ggPSBlYWNoO1xuICBsb2Rhc2guX2l0ZXJhdG9yVGVtcGxhdGUgPSBpdGVyYXRvclRlbXBsYXRlO1xuXG4gIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG4gIC8vIGV4cG9zZSBMby1EYXNoXG4gIC8vIHNvbWUgQU1EIGJ1aWxkIG9wdGltaXplcnMsIGxpa2Ugci5qcywgY2hlY2sgZm9yIHNwZWNpZmljIGNvbmRpdGlvbiBwYXR0ZXJucyBsaWtlIHRoZSBmb2xsb3dpbmc6XG4gIGlmICh0eXBlb2YgZGVmaW5lID09ICdmdW5jdGlvbicgJiYgdHlwZW9mIGRlZmluZS5hbWQgPT0gJ29iamVjdCcgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEV4cG9zZSBMby1EYXNoIHRvIHRoZSBnbG9iYWwgb2JqZWN0IGV2ZW4gd2hlbiBhbiBBTUQgbG9hZGVyIGlzIHByZXNlbnQgaW5cbiAgICAvLyBjYXNlIExvLURhc2ggd2FzIGluamVjdGVkIGJ5IGEgdGhpcmQtcGFydHkgc2NyaXB0IGFuZCBub3QgaW50ZW5kZWQgdG8gYmVcbiAgICAvLyBsb2FkZWQgYXMgYSBtb2R1bGUuIFRoZSBnbG9iYWwgYXNzaWdubWVudCBjYW4gYmUgcmV2ZXJ0ZWQgaW4gdGhlIExvLURhc2hcbiAgICAvLyBtb2R1bGUgdmlhIGl0cyBgbm9Db25mbGljdCgpYCBtZXRob2QuXG4gICAgd2luZG93Ll8gPSBsb2Rhc2g7XG5cbiAgICAvLyBkZWZpbmUgYXMgYW4gYW5vbnltb3VzIG1vZHVsZSBzbywgdGhyb3VnaCBwYXRoIG1hcHBpbmcsIGl0IGNhbiBiZVxuICAgIC8vIHJlZmVyZW5jZWQgYXMgdGhlIFwidW5kZXJzY29yZVwiIG1vZHVsZVxuICAgIGRlZmluZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBsb2Rhc2g7XG4gICAgfSk7XG4gIH1cbiAgLy8gY2hlY2sgZm9yIGBleHBvcnRzYCBhZnRlciBgZGVmaW5lYCBpbiBjYXNlIGEgYnVpbGQgb3B0aW1pemVyIGFkZHMgYW4gYGV4cG9ydHNgIG9iamVjdFxuICBlbHNlIGlmIChmcmVlRXhwb3J0cykge1xuICAgIC8vIGluIE5vZGUuanMgb3IgUmluZ29KUyB2MC44LjArXG4gICAgaWYgKHR5cGVvZiBtb2R1bGUgPT0gJ29iamVjdCcgJiYgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzID09IGZyZWVFeHBvcnRzKSB7XG4gICAgICAobW9kdWxlLmV4cG9ydHMgPSBsb2Rhc2gpLl8gPSBsb2Rhc2g7XG4gICAgfVxuICAgIC8vIGluIE5hcndoYWwgb3IgUmluZ29KUyB2MC43LjAtXG4gICAgZWxzZSB7XG4gICAgICBmcmVlRXhwb3J0cy5fID0gbG9kYXNoO1xuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICAvLyBpbiBhIGJyb3dzZXIgb3IgUmhpbm9cbiAgICB3aW5kb3cuXyA9IGxvZGFzaDtcbiAgfVxufSh0aGlzKSk7XG5cbn0pKHdpbmRvdykiLCJcbm1vZHVsZS5leHBvcnRzID0gamFkZSA9IChmdW5jdGlvbihleHBvcnRzKXtcbi8qIVxuICogSmFkZSAtIHJ1bnRpbWVcbiAqIENvcHlyaWdodChjKSAyMDEwIFRKIEhvbG93YXljaHVrIDx0akB2aXNpb24tbWVkaWEuY2E+XG4gKiBNSVQgTGljZW5zZWRcbiAqL1xuXG4vKipcbiAqIExhbWUgQXJyYXkuaXNBcnJheSgpIHBvbHlmaWxsIGZvciBub3cuXG4gKi9cblxuaWYgKCFBcnJheS5pc0FycmF5KSB7XG4gIEFycmF5LmlzQXJyYXkgPSBmdW5jdGlvbihhcnIpe1xuICAgIHJldHVybiAnW29iamVjdCBBcnJheV0nID09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChhcnIpO1xuICB9O1xufVxuXG4vKipcbiAqIExhbWUgT2JqZWN0LmtleXMoKSBwb2x5ZmlsbCBmb3Igbm93LlxuICovXG5cbmlmICghT2JqZWN0LmtleXMpIHtcbiAgT2JqZWN0LmtleXMgPSBmdW5jdGlvbihvYmope1xuICAgIHZhciBhcnIgPSBbXTtcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgYXJyLnB1c2goa2V5KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGFycjtcbiAgfVxufVxuXG4vKipcbiAqIE1lcmdlIHR3byBhdHRyaWJ1dGUgb2JqZWN0cyBnaXZpbmcgcHJlY2VkZW5jZVxuICogdG8gdmFsdWVzIGluIG9iamVjdCBgYmAuIENsYXNzZXMgYXJlIHNwZWNpYWwtY2FzZWRcbiAqIGFsbG93aW5nIGZvciBhcnJheXMgYW5kIG1lcmdpbmcvam9pbmluZyBhcHByb3ByaWF0ZWx5XG4gKiByZXN1bHRpbmcgaW4gYSBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGFcbiAqIEBwYXJhbSB7T2JqZWN0fSBiXG4gKiBAcmV0dXJuIHtPYmplY3R9IGFcbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmV4cG9ydHMubWVyZ2UgPSBmdW5jdGlvbiBtZXJnZShhLCBiKSB7XG4gIHZhciBhYyA9IGFbJ2NsYXNzJ107XG4gIHZhciBiYyA9IGJbJ2NsYXNzJ107XG5cbiAgaWYgKGFjIHx8IGJjKSB7XG4gICAgYWMgPSBhYyB8fCBbXTtcbiAgICBiYyA9IGJjIHx8IFtdO1xuICAgIGlmICghQXJyYXkuaXNBcnJheShhYykpIGFjID0gW2FjXTtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoYmMpKSBiYyA9IFtiY107XG4gICAgYWMgPSBhYy5maWx0ZXIobnVsbHMpO1xuICAgIGJjID0gYmMuZmlsdGVyKG51bGxzKTtcbiAgICBhWydjbGFzcyddID0gYWMuY29uY2F0KGJjKS5qb2luKCcgJyk7XG4gIH1cblxuICBmb3IgKHZhciBrZXkgaW4gYikge1xuICAgIGlmIChrZXkgIT0gJ2NsYXNzJykge1xuICAgICAgYVtrZXldID0gYltrZXldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBhO1xufTtcblxuLyoqXG4gKiBGaWx0ZXIgbnVsbCBgdmFsYHMuXG4gKlxuICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gKiBAcmV0dXJuIHtNaXhlZH1cbiAqIEBhcGkgcHJpdmF0ZVxuICovXG5cbmZ1bmN0aW9uIG51bGxzKHZhbCkge1xuICByZXR1cm4gdmFsICE9IG51bGw7XG59XG5cbi8qKlxuICogUmVuZGVyIHRoZSBnaXZlbiBhdHRyaWJ1dGVzIG9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqXG4gKiBAcGFyYW0ge09iamVjdH0gZXNjYXBlZFxuICogQHJldHVybiB7U3RyaW5nfVxuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZXhwb3J0cy5hdHRycyA9IGZ1bmN0aW9uIGF0dHJzKG9iaiwgZXNjYXBlZCl7XG4gIHZhciBidWYgPSBbXVxuICAgICwgdGVyc2UgPSBvYmoudGVyc2U7XG5cbiAgZGVsZXRlIG9iai50ZXJzZTtcbiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmopXG4gICAgLCBsZW4gPSBrZXlzLmxlbmd0aDtcblxuICBpZiAobGVuKSB7XG4gICAgYnVmLnB1c2goJycpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICAgIHZhciBrZXkgPSBrZXlzW2ldXG4gICAgICAgICwgdmFsID0gb2JqW2tleV07XG5cbiAgICAgIGlmICgnYm9vbGVhbicgPT0gdHlwZW9mIHZhbCB8fCBudWxsID09IHZhbCkge1xuICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgdGVyc2VcbiAgICAgICAgICAgID8gYnVmLnB1c2goa2V5KVxuICAgICAgICAgICAgOiBidWYucHVzaChrZXkgKyAnPVwiJyArIGtleSArICdcIicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKDAgPT0ga2V5LmluZGV4T2YoJ2RhdGEnKSAmJiAnc3RyaW5nJyAhPSB0eXBlb2YgdmFsKSB7XG4gICAgICAgIGJ1Zi5wdXNoKGtleSArIFwiPSdcIiArIEpTT04uc3RyaW5naWZ5KHZhbCkgKyBcIidcIik7XG4gICAgICB9IGVsc2UgaWYgKCdjbGFzcycgPT0ga2V5ICYmIEFycmF5LmlzQXJyYXkodmFsKSkge1xuICAgICAgICBidWYucHVzaChrZXkgKyAnPVwiJyArIGV4cG9ydHMuZXNjYXBlKHZhbC5qb2luKCcgJykpICsgJ1wiJyk7XG4gICAgICB9IGVsc2UgaWYgKGVzY2FwZWQgJiYgZXNjYXBlZFtrZXldKSB7XG4gICAgICAgIGJ1Zi5wdXNoKGtleSArICc9XCInICsgZXhwb3J0cy5lc2NhcGUodmFsKSArICdcIicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnVmLnB1c2goa2V5ICsgJz1cIicgKyB2YWwgKyAnXCInKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gYnVmLmpvaW4oJyAnKTtcbn07XG5cbi8qKlxuICogRXNjYXBlIHRoZSBnaXZlbiBzdHJpbmcgb2YgYGh0bWxgLlxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBodG1sXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKiBAYXBpIHByaXZhdGVcbiAqL1xuXG5leHBvcnRzLmVzY2FwZSA9IGZ1bmN0aW9uIGVzY2FwZShodG1sKXtcbiAgcmV0dXJuIFN0cmluZyhodG1sKVxuICAgIC5yZXBsYWNlKC8mKD8hKFxcdyt8XFwjXFxkKyk7KS9nLCAnJmFtcDsnKVxuICAgIC5yZXBsYWNlKC88L2csICcmbHQ7JylcbiAgICAucmVwbGFjZSgvPi9nLCAnJmd0OycpXG4gICAgLnJlcGxhY2UoL1wiL2csICcmcXVvdDsnKTtcbn07XG5cbi8qKlxuICogUmUtdGhyb3cgdGhlIGdpdmVuIGBlcnJgIGluIGNvbnRleHQgdG8gdGhlXG4gKiB0aGUgamFkZSBpbiBgZmlsZW5hbWVgIGF0IHRoZSBnaXZlbiBgbGluZW5vYC5cbiAqXG4gKiBAcGFyYW0ge0Vycm9yfSBlcnJcbiAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlbmFtZVxuICogQHBhcmFtIHtTdHJpbmd9IGxpbmVub1xuICogQGFwaSBwcml2YXRlXG4gKi9cblxuZXhwb3J0cy5yZXRocm93ID0gZnVuY3Rpb24gcmV0aHJvdyhlcnIsIGZpbGVuYW1lLCBsaW5lbm8pe1xuICBpZiAoIWZpbGVuYW1lKSB0aHJvdyBlcnI7XG5cbiAgdmFyIGNvbnRleHQgPSAzXG4gICAgLCBzdHIgPSByZXF1aXJlKCdmcycpLnJlYWRGaWxlU3luYyhmaWxlbmFtZSwgJ3V0ZjgnKVxuICAgICwgbGluZXMgPSBzdHIuc3BsaXQoJ1xcbicpXG4gICAgLCBzdGFydCA9IE1hdGgubWF4KGxpbmVubyAtIGNvbnRleHQsIDApXG4gICAgLCBlbmQgPSBNYXRoLm1pbihsaW5lcy5sZW5ndGgsIGxpbmVubyArIGNvbnRleHQpO1xuXG4gIC8vIEVycm9yIGNvbnRleHRcbiAgdmFyIGNvbnRleHQgPSBsaW5lcy5zbGljZShzdGFydCwgZW5kKS5tYXAoZnVuY3Rpb24obGluZSwgaSl7XG4gICAgdmFyIGN1cnIgPSBpICsgc3RhcnQgKyAxO1xuICAgIHJldHVybiAoY3VyciA9PSBsaW5lbm8gPyAnICA+ICcgOiAnICAgICcpXG4gICAgICArIGN1cnJcbiAgICAgICsgJ3wgJ1xuICAgICAgKyBsaW5lO1xuICB9KS5qb2luKCdcXG4nKTtcblxuICAvLyBBbHRlciBleGNlcHRpb24gbWVzc2FnZVxuICBlcnIucGF0aCA9IGZpbGVuYW1lO1xuICBlcnIubWVzc2FnZSA9IChmaWxlbmFtZSB8fCAnSmFkZScpICsgJzonICsgbGluZW5vXG4gICAgKyAnXFxuJyArIGNvbnRleHQgKyAnXFxuXFxuJyArIGVyci5tZXNzYWdlO1xuICB0aHJvdyBlcnI7XG59O1xuXG4gIHJldHVybiBleHBvcnRzO1xuXG59KSh7fSk7XG5cbmphZGUudGVtcGxhdGVzID0ge307XG5qYWRlLnJlbmRlciA9IGZ1bmN0aW9uKG5vZGUsIHRlbXBsYXRlLCBkYXRhKSB7XG4gIHZhciB0bXAgPSBqYWRlLnRlbXBsYXRlc1t0ZW1wbGF0ZV0oZGF0YSk7XG4gIG5vZGUuaW5uZXJIVE1MID0gdG1wO1xufTtcblxuamFkZS50ZW1wbGF0ZXNbXCJsYXlvdXRcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG4gdmFyIGludml0ZSA9IChpbnZpdGVPbmx5KSA/IFwid2luZG93Lmludml0ZU9ubHk9J3RydWUnO1wiIDogJydcbmJ1Zi5wdXNoKCc8IURPQ1RZUEUgaHRtbD48IS0tXFxu4paR4paI4paA4paI4paR4paI4paA4paI4paR4paI4paR4paI4paR4paI4paA4paA4paR4paI4paA4paE4paR4paI4paA4paE4paR4paI4paR4paI4paR4paI4paR4paR4paR4paI4paR4paR4paR4paI4paA4paA4paR4paA4paI4paA4paR4paA4paI4paA4paR4paI4paA4paIXFxu4paR4paI4paA4paA4paR4paI4paR4paI4paR4paI4paE4paI4paR4paI4paA4paA4paR4paI4paA4paE4paR4paI4paA4paE4paR4paI4paR4paI4paR4paI4paR4paR4paR4paI4paR4paR4paR4paI4paA4paA4paR4paR4paI4paR4paR4paR4paI4paR4paR4paI4paR4paIXFxu4paR4paA4paR4paR4paR4paA4paA4paA4paR4paA4paR4paA4paR4paA4paA4paA4paR4paA4paR4paA4paR4paA4paA4paR4paR4paA4paA4paA4paR4paA4paA4paA4paR4paA4paA4paA4paR4paA4paA4paA4paR4paR4paA4paR4paR4paA4paA4paA4paR4paA4paR4paALCBqc2IubWFlLmtoIH4tLT48aHRtbD48aGVhZD4nKTtcbmlmICggdHlwZW9mKHRpdGxlKSAhPT0gJ3VuZGVmaW5lZCcpXG57XG5idWYucHVzaCgnPHRpdGxlPicpO1xudmFyIF9fdmFsX18gPSB0aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC90aXRsZT4nKTtcbn1cbmlmICggdHlwZW9mKG1ldGFfZGVzY3JpcHRpb24pICE9PSAndW5kZWZpbmVkJylcbntcbmJ1Zi5wdXNoKCc8bWV0YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnbmFtZSc6KCdkZXNjcmlwdGlvbicpLCAnY29udGVudCc6KG1ldGFfZGVzY3JpcHRpb24pIH0sIHtcIm5hbWVcIjp0cnVlLFwiY29udGVudFwiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmlmICggdHlwZW9mKG1ldGFfa2V5d29yZHMpICE9PSAndW5kZWZpbmVkJylcbntcbmJ1Zi5wdXNoKCc8bWV0YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnbmFtZSc6KCdrZXl3b3JkcycpLCAnY29udGVudCc6KG1ldGFfa2V5d29yZHMuam9pbignLCAnKSkgfSwge1wibmFtZVwiOnRydWUsXCJjb250ZW50XCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuaWYgKCB0eXBlb2YobWV0YV96aXBjb2RlKSAhPT0gJ3VuZGVmaW5lZCcpXG57XG5idWYucHVzaCgnPG1ldGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ25hbWUnOignemlwY29kZScpLCAnY29udGVudCc6KG1ldGFfemlwY29kZSkgfSwge1wibmFtZVwiOnRydWUsXCJjb250ZW50XCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzxtZXRhIGh0dHAtZXF1aXY9XCJYLVVBLUNvbXBhdGlibGVcIiBjb250ZW50PVwiSUU9RW11bGF0ZUlFOSxjaHJvbWU9MVwiLz48bWV0YSBuYW1lPVwicm9ib3RzXCIgY29udGVudD1cImluZGV4LCBmb2xsb3dcIi8+PG1ldGEgbmFtZT1cImFwcGxlLW1vYmlsZS13ZWItYXBwLWNhcGFibGVcIiBjb250ZW50PVwieWVzXCIvPjxtZXRhIG5hbWU9XCJhcHBsZS1tb2JpbGUtd2ViLWFwcC1zdGF0dXMtYmFyLXN0eWxlXCIgY29udGVudD1cImJsYWNrXCIvPjxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ1c2VyLXNjYWxhYmxlPTAsIGluaXRpYWwtc2NhbGU9MSwgbWF4aW11bS1zY2FsZT0xLCB3aWR0aD1kZXZpY2Utd2lkdGhcIi8+PGxpbmsnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL2ltYWdlcy9mYXZpY29uLmljb1wiKSwgJ3JlbCc6KCdzaG9ydGN1dCBpY29uJyksICd0eXBlJzooJ2ltYWdlL3gtaWNvbicpIH0sIHtcImhyZWZcIjp0cnVlLFwicmVsXCI6dHJ1ZSxcInR5cGVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PGxpbmsnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIlwiICsgKGNhY2hlMlVybCkgKyBcIi9pbWFnZXMvYXBwbGUtdG91Y2gtaWNvbi5wbmdcIiksICdyZWwnOignYXBwbGUtdG91Y2gtaWNvbicpIH0sIHtcImhyZWZcIjp0cnVlLFwicmVsXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsaW5rJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCJcIiArIChjYWNoZTNVcmwpICsgXCIvaW1hZ2VzL2FwcGxlLXRvdWNoLWljb24tNzJ4NzIucG5nXCIpLCAnc2l6ZXMnOihcIjcyeDcyXCIpLCAncmVsJzooJ2FwcGxlLXRvdWNoLWljb24nKSB9LCB7XCJocmVmXCI6dHJ1ZSxcInNpemVzXCI6dHJ1ZSxcInJlbFwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiXCIgKyAoY2FjaGU0VXJsKSArIFwiL2ltYWdlcy9hcHBsZS10b3VjaC1pY29uLTExNHgxMTQucG5nXCIpLCAnc2l6ZXMnOihcIjExNHgxMTRcIiksICdyZWwnOignYXBwbGUtdG91Y2gtaWNvbicpIH0sIHtcImhyZWZcIjp0cnVlLFwic2l6ZXNcIjp0cnVlLFwicmVsXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsaW5rIGhyZWY9XCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9U291cmNlK1NhbnMrUHJvOjIwMCwzMDAsNDAwXCIgcmVsPVwic3R5bGVzaGVldFwiIHR5cGU9XCJ0ZXh0L2Nzc1wiLz4nKTtcbmlmICggY3NzVXJscylcbntcbi8vIGl0ZXJhdGUgY3NzVXJsc1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGNzc1VybHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gY3NzVXJscy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBvYmogPSBjc3NVcmxzWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyAncmVsJzooJ3N0eWxlc2hlZXQnKSwgJ3R5cGUnOigndGV4dC9jc3MnKSwgJ2hyZWYnOihvYmoudXJsKSB9LCB7XCJyZWxcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciAkaW5kZXggaW4gY3NzVXJscykge1xuICAgICAgdmFyIG9iaiA9IGNzc1VybHNbJGluZGV4XTtcblxuYnVmLnB1c2goJzxsaW5rJyk7XG5idWYucHVzaChhdHRycyh7ICdyZWwnOignc3R5bGVzaGVldCcpLCAndHlwZSc6KCd0ZXh0L2NzcycpLCAnaHJlZic6KG9iai51cmwpIH0sIHtcInJlbFwiOnRydWUsXCJ0eXBlXCI6dHJ1ZSxcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG4gICB9XG4gIH1cbn0pLmNhbGwodGhpcyk7XG5cbn1cbmJ1Zi5wdXNoKCc8bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiXCIgKyAoY2FjaGU1VXJsKSArIFwiL3NpdGVzL1wiICsgKGN1cnJlbnREb21haW4pICsgXCIuY3NzXCIpLCAncmVsJzooJ3N0eWxlc2hlZXQnKSwgJ3R5cGUnOigndGV4dC9jc3MnKSB9LCB7XCJocmVmXCI6dHJ1ZSxcInJlbFwiOnRydWUsXCJ0eXBlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xuaWYgKCBzdHlsZSlcbntcbmJ1Zi5wdXNoKCc8bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiL3NpdGVzL1wiICsgKHNpdGVJZCkgKyBcIi5jc3NcIiksICdyZWwnOignc3R5bGVzaGVldCcpLCAndHlwZSc6KCd0ZXh0L2NzcycpIH0sIHtcImhyZWZcIjp0cnVlLFwicmVsXCI6dHJ1ZSxcInR5cGVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5pZiAoIGN2YXJzLmVudiAhPSAncHJvZHVjdGlvbicpXG57XG5idWYucHVzaCgnPHNjcmlwdCcpO1xuYnVmLnB1c2goYXR0cnMoeyAndHlwZSc6KCd0ZXh0L2phdmFzY3JpcHQnKSwgJ3NyYyc6KFwiXCIgKyAoY2FjaGU1VXJsKSArIFwiL2xvY2FsL2hlYWQtMC45OS5sb2FkLm1pbi5qc1wiKSB9LCB7XCJ0eXBlXCI6dHJ1ZSxcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnPjwvc2NyaXB0PicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiIHNyYz1cIi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2hlYWRqcy8wLjk5L2hlYWQubG9hZC5taW4uanNcIj48L3NjcmlwdD4nKTtcbn1cbmlmICgganNVcmxzKVxue1xuYnVmLnB1c2goJzxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPndpbmRvdy5zaXRlTmFtZT1cIicgKyAoKGludGVycCA9IHNpdGVOYW1lKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJ1wiO3dpbmRvdy5zaXRlSWQ9JyArICgoaW50ZXJwID0gc2l0ZUlkKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJzsnICsgKChpbnRlcnAgPSBpbnZpdGUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnd2luZG93LmluaXRpYWxNdXRhbnQ9JyArICgoaW50ZXJwID0gSlNPTi5zdHJpbmdpZnkoaW5pdGlhbE11dGFudCkpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnO3dpbmRvdy5jYWNoZVVybD0nICsgKChpbnRlcnAgPSBKU09OLnN0cmluZ2lmeShjdmFycy5jYWNoZVVybCkpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnO3dpbmRvdy5hdXRoRG9tYWluPVwiJyArICgoaW50ZXJwID0gY3ZhcnMuYXV0aERvbWFpbikgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICdcIjt3aW5kb3cuaGVhZGpzPWhlYWQuanM7aGVhZC5qcy5hcHBseShoZWFkLCcgKyAoKGludGVycCA9IEpTT04uc3RyaW5naWZ5KGN2YXJzLmJhc2VKc1VybHMuY29uY2F0KGpzVXJscykpKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJyk7PC9zY3JpcHQ+Jyk7XG59XG5idWYucHVzaCgnPC9oZWFkPjxib2R5PjxoZWFkZXIgY2xhc3M9XCJoZWFkZXIgdG9nZ2xlclwiPjxoMSBjbGFzcz1cImxvZ29cIj48YSBocmVmPVwiL1wiIGNsYXNzPVwibXV0YW50XCI+UG93ZXI8c3Ryb25nPkJ1bGxldGluPC9zdHJvbmc+PC9hPjwvaDE+PGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPjxkaXYgY2xhc3M9XCJzZWFyY2hcIj48aW5wdXQgaWQ9XCJxdWVyeVwiIHR5cGU9XCJ0ZXh0XCIgcGxhY2Vob2xkZXI9XCJTZWFyY2hcIiBhdXRvY29tcGxldGU9XCJvZmZcIiBjbGFzcz1cInF1ZXJ5XCIvPjxkaXYgdGl0bGU9XCJDbG9zZSFcIiBjbGFzcz1cIm9uY2xpY2stY2xvc2UgdG9nZ2xlclwiPng8L2Rpdj48L2Rpdj48ZGl2IGlkPVwid2FybmluZ1wiIGNsYXNzPVwidG9vbHRpcFwiPjwvZGl2PjxkaXYgY2xhc3M9XCJtZW51LWNvbnRhaW5lclwiPjxtZW51IGlkPVwibWVudVwiIGNsYXNzPVwibWVudVwiPicpO1xuLy8gaXRlcmF0ZSBtZW51XG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgbWVudS5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgJCRsID0gbWVudS5sZW5ndGg7IGkgPCAkJGw7IGkrKykge1xuICAgICAgdmFyIGYgPSBtZW51W2ldO1xuXG5idWYucHVzaCgnPGxpIGNsYXNzPVwicm93XCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtc3VyZic6KGYuaWQpLCAnZGF0YS1zY3JvbGwtdG8nOihcIiNmb3J1bV9cIiArIChmLmlkKSArIFwiXCIpLCAnaHJlZic6KFwiL1wiICsgKGYuc2x1ZykgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3RpdGxlJykgKyAnICcgKyAoXCJmb3J1bS1cIiArIChmLmlkKSArIFwiXCIpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImRhdGEtc3VyZlwiOnRydWUsXCJkYXRhLXNjcm9sbC10b1wiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IGYudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT4nKTtcbmlmICggZi5mb3J1bXMubGVuZ3RoKVxue1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJzdWJtZW51XCI+PG1lbnU+Jyk7XG4vLyBpdGVyYXRlIGYuZm9ydW1zXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgZi5mb3J1bXMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsICQkbCA9IGYuZm9ydW1zLmxlbmd0aDsgaSA8ICQkbDsgaSsrKSB7XG4gICAgICB2YXIgc2YgPSBmLmZvcnVtc1tpXTtcblxuYnVmLnB1c2goJzxsaSBjbGFzcz1cInJvd1wiPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooc2YudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpICsgJyAnICsgKFwiZm9ydW0tXCIgKyAoc2YuaWQpICsgXCJcIikgfSwge1wiY2xhc3NcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBzZi50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPjwvbGk+Jyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgaW4gZi5mb3J1bXMpIHtcbiAgICAgIHZhciBzZiA9IGYuZm9ydW1zW2ldO1xuXG5idWYucHVzaCgnPGxpIGNsYXNzPVwicm93XCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihzZi51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoXCJmb3J1bS1cIiArIChzZi5pZCkgKyBcIlwiKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHNmLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9saT4nKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxuYnVmLnB1c2goJzwvbWVudT48L2Rpdj4nKTtcbn1cbmJ1Zi5wdXNoKCc8L2xpPicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpIGluIG1lbnUpIHtcbiAgICAgIHZhciBmID0gbWVudVtpXTtcblxuYnVmLnB1c2goJzxsaSBjbGFzcz1cInJvd1wiPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXN1cmYnOihmLmlkKSwgJ2RhdGEtc2Nyb2xsLXRvJzooXCIjZm9ydW1fXCIgKyAoZi5pZCkgKyBcIlwiKSwgJ2hyZWYnOihcIi9cIiArIChmLnNsdWcpICsgXCJcIiksIFwiY2xhc3NcIjogKCd0aXRsZScpICsgJyAnICsgKFwiZm9ydW0tXCIgKyAoZi5pZCkgKyBcIlwiKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJkYXRhLXN1cmZcIjp0cnVlLFwiZGF0YS1zY3JvbGwtdG9cIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBmLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+Jyk7XG5pZiAoIGYuZm9ydW1zLmxlbmd0aClcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwic3VibWVudVwiPjxtZW51PicpO1xuLy8gaXRlcmF0ZSBmLmZvcnVtc1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGYuZm9ydW1zLmxlbmd0aCkge1xuICAgIGZvciAodmFyIGkgPSAwLCAkJGwgPSBmLmZvcnVtcy5sZW5ndGg7IGkgPCAkJGw7IGkrKykge1xuICAgICAgdmFyIHNmID0gZi5mb3J1bXNbaV07XG5cbmJ1Zi5wdXNoKCc8bGkgY2xhc3M9XCJyb3dcIj48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KHNmLnVyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSArICcgJyArIChcImZvcnVtLVwiICsgKHNmLmlkKSArIFwiXCIpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gc2YudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT48L2xpPicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpIGluIGYuZm9ydW1zKSB7XG4gICAgICB2YXIgc2YgPSBmLmZvcnVtc1tpXTtcblxuYnVmLnB1c2goJzxsaSBjbGFzcz1cInJvd1wiPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooc2YudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpICsgJyAnICsgKFwiZm9ydW0tXCIgKyAoc2YuaWQpICsgXCJcIikgfSwge1wiY2xhc3NcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBzZi50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPjwvbGk+Jyk7XG4gICB9XG4gIH1cbn0pLmNhbGwodGhpcyk7XG5cbmJ1Zi5wdXNoKCc8L21lbnU+PC9kaXY+Jyk7XG59XG5idWYucHVzaCgnPC9saT4nKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxuYnVmLnB1c2goJzwvbWVudT48L2Rpdj48bWVudSBjbGFzcz1cInRvb2xzXCI+PGEgY2xhc3M9XCJwcm9maWxlIHBob3RvIG11dGFudFwiPjxpbWcgaWQ9XCJwcm9maWxlXCIvPjwvYT48bGkgY2xhc3M9XCJvbmNsaWNrLWxvZ2luXCI+PGEgaHJlZj1cIi9hdXRoL2xvZ2luXCI+TG9naW48L2E+PC9saT48bGkgY2xhc3M9XCJhZG1pbi1vbmx5XCI+PGEgaHJlZj1cIi9hZG1pblwiIGNsYXNzPVwibXV0YW50XCI+QWRtaW48L2E+PC9saT48bGk+PGEgaHJlZj1cIi91c2Vyc1wiIGNsYXNzPVwibXV0YW50IG9uY2xpY2stcHJvZmlsZVwiPlByb2ZpbGU8L2E+PC9saT48bGkgY2xhc3M9XCJvbmNsaWNrLWxvZ291dFwiPjxhIGhyZWY9XCIvYXV0aC9sb2dvdXRcIj5Mb2dvdXQ8L2E+PC9saT48L21lbnU+PC9kaXY+PC9oZWFkZXI+PHNlY3Rpb24gaWQ9XCJsZWZ0X2NvbnRlbnRcIiBjbGFzcz1cImxlZnQtY29udGVudFwiPjxkaXYgaWQ9XCJoYW5kbGVcIiB0aXRsZT1cIlRvZ2dsZVwiIGNsYXNzPVwiaGFuZGxlXCI+PC9kaXY+PGRpdiBpZD1cImxlZnRfY29udGFpbmVyXCI+PC9kaXY+PGRpdiBpZD1cInBhZ2luYXRvclwiIHRpdGxlPVwiR28gdG8gdGhpcyBQYWdlXCI+Jyk7XG5pZiAoIHR5cGVvZiBwYWdlID09ICdudW1iZXInKVxue1xuaWYgKCBwYWdlICE9IDEpXG57XG5pZiAoIHBhZ2UgIT0gMilcbntcbmJ1Zi5wdXNoKCc8YScpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOignUHJldmlvdXMgUGFnZScpLCAnaHJlZic6KFwiXCIgKyAoZnVybC50aHJlYWRVcmkpICsgXCIvcGFnZS9cIiArIChwYWdlIC0gMSkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3BhZ2UnKSArICcgJyArICgncHJldmlvdXMnKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+IDwvYT4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8YScpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOignUHJldmlvdXMgUGFnZScpLCAnaHJlZic6KFwiXCIgKyAoZnVybC50aHJlYWRVcmkpICsgXCJcIiksIFwiY2xhc3NcIjogKCdwYWdlJykgKyAnICcgKyAoJ3ByZXZpb3VzJykgfSwge1widGl0bGVcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPiA8L2E+Jyk7XG59XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3RpdGxlJzooJ1ByZXZpb3VzIFBhZ2UnKSwgJ2hyZWYnOihcIlwiICsgKGZ1cmwudGhyZWFkVXJpKSArIFwiXCIpLCAnc3R5bGUnOihcImRpc3BsYXk6bm9uZTtcIiksIFwiY2xhc3NcIjogKCdwYWdlJykgKyAnICcgKyAoJ3ByZXZpb3VzJykgfSwge1widGl0bGVcIjp0cnVlLFwiaHJlZlwiOnRydWUsXCJzdHlsZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPiA8L2E+Jyk7XG59XG5idWYucHVzaCgnPGRpdiB0aXRsZT1cIkRyYWcgdG8gUGFnZSB0aHJvdWdoXCIgY2xhc3M9XCJjdXJyZW50XCI+PGRpdiBjbGFzcz1cInRvb2x0aXAgcmlnaHRcIj48L2Rpdj48L2Rpdj4nKTtcbmlmICggcGFnZSAhPSBwYWdlc0NvdW50KVxue1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICd0aXRsZSc6KCdOZXh0IFBhZ2UnKSwgJ2hyZWYnOihcIlwiICsgKGZ1cmwudGhyZWFkVXJpKSArIFwiL3BhZ2UvXCIgKyAocGFnZSArIDEpICsgXCJcIiksIFwiY2xhc3NcIjogKCdwYWdlJykgKyAnICcgKyAoJ25leHQnKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+IDwvYT4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8YScpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOignTmV4dCBQYWdlJyksICdocmVmJzooXCJcIiArIChmdXJsLnRocmVhZFVyaSkgKyBcIi9wYWdlL1wiICsgKHBhZ2VzQ291bnQpICsgXCJcIiksICdzdHlsZSc6KFwiZGlzcGxheTpub25lO1wiKSwgXCJjbGFzc1wiOiAoJ3BhZ2UnKSArICcgJyArICgnbmV4dCcpIH0sIHtcInRpdGxlXCI6dHJ1ZSxcImhyZWZcIjp0cnVlLFwic3R5bGVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4gPC9hPicpO1xufVxufVxuZWxzZVxue1xuYnVmLnB1c2goJzxhIHRpdGxlPVwiUHJldmlvdXMgUGFnZVwiIGhyZWY9XCIvXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCIgY2xhc3M9XCJwYWdlIHByZXZpb3VzXCI+IDwvYT48ZGl2IHRpdGxlPVwiRHJhZyB0byBQYWdlIHRocm91Z2hcIiBjbGFzcz1cImN1cnJlbnRcIj48ZGl2IGNsYXNzPVwidG9vbHRpcCByaWdodFwiPjwvZGl2PjwvZGl2PjxhIHRpdGxlPVwiTmV4dCBQYWdlXCIgaHJlZj1cIi9cIiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIiBjbGFzcz1cInBhZ2UgbmV4dFwiPiA8L2E+Jyk7XG59XG5idWYucHVzaCgnPC9kaXY+PC9zZWN0aW9uPjxzZWN0aW9uIGlkPVwibWFpbl9jb250ZW50XCIgY2xhc3M9XCJtYWluLWNvbnRlbnQgY29udGFpbmVyXCI+PC9zZWN0aW9uPjxzZWN0aW9uIGNsYXNzPVwiZXh0cmFcIj48L3NlY3Rpb24+PHNlY3Rpb24gaWQ9XCJhdXRoXCIgc3R5bGU9XCJkaXNwbGF5Om5vbmU7XCI+PC9zZWN0aW9uPicpO1xuaWYgKCBjdmFycy5lbnYgIT0gJ3Byb2R1Y3Rpb24nKVxue1xuYnVmLnB1c2goJzxkaXYgaWQ9XCJtb2NoYVwiPjwvZGl2PicpO1xufVxuYnVmLnB1c2goJzxmb290ZXIgY2xhc3M9XCJvbmNsaWNrLWZvb3Rlci10b2dnbGVcIj48ZGl2IGNsYXNzPVwicG9zdC1yZXBseSBvbmNsaWNrLWZvb3Rlci10b2dnbGVcIj48L2Rpdj48ZGl2IGNsYXNzPVwib25jbGljay1zY3JvbGwtdG9wXCI+VG9wPC9kaXY+PGRpdiBpZD1cInBiX3BhZ2luYXRvclwiPjwvZGl2PjxoNiBjbGFzcz1cIm9uY2xpY2stZm9vdGVyLXRvZ2dsZVwiPjxzbWFsbD4mY29weTsgJyArIGVzY2FwZSgoaW50ZXJwID0gc2l0ZU5hbWUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnICZuYnNwOzwvc21hbGw+PGI+Jyk7XG52YXIgX192YWxfXyA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9iPjwvaDY+PGRpdiBjbGFzcz1cInBvc3QtY29udGFpbmVyXCI+PGZvcm0gYWN0aW9uPVwiL3Jlc291cmNlcy9wb3N0c1wiIG1ldGhvZD1cInBvc3RcIiBjbGFzcz1cInBvc3QgcG9zdC1uZXdcIj48ZGl2IGlkPVwicG9zdF9uZXdcIj48L2Rpdj48ZGl2IGNsYXNzPVwidG9vbHRpcFwiPjwvZGl2PjwvZm9ybT48L2Rpdj48L2Zvb3Rlcj48ZGl2IGlkPVwiY2hhdF9kcmF3ZXJcIj48L2Rpdj48bGluaycpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiXCIgKyAoY2FjaGU1VXJsKSArIFwiL2xvY2FsL2pxdWVyeS11aS5taW4uY3NzXCIpLCAncmVsJzooJ3N0eWxlc2hlZXQnKSwgJ3R5cGUnOigndGV4dC9jc3MnKSB9LCB7XCJocmVmXCI6dHJ1ZSxcInJlbFwiOnRydWUsXCJ0eXBlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xudmFyIF9fdmFsX18gPSBhbmFseXRpY3NcbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2JvZHk+PC9odG1sPicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJob21lcGFnZVwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9wcm9maWxlX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuIGlmICghcC51c2VyX3Bob3RvKSBwLnVzZXJfcGhvdG8gPSBjYWNoZVVybCArICdpbWFnZXMvcHJvZmlsZS5qcGcnXG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi91c2VyL1wiICsgKHAudXNlcl9uYW1lKSArIFwiXCIpLCBcImNsYXNzXCI6ICgndXNlcicpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGRpdiBjbGFzcz1cInByb2ZpbGUgcGhvdG9cIj4nKTtcbmlmICggcC51c2VyX3Bob3RvICYmIHAudXNlcl9waG90by5tYXRjaCgvXmh0dHAvKSlcbntcbmJ1Zi5wdXNoKCc8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICd0aXRsZSc6KHAudXNlcl9uYW1lKSwgJ3NyYyc6KFwiXCIgKyAocC51c2VyX3Bob3RvKSArIFwiXCIpIH0sIHtcInRpdGxlXCI6dHJ1ZSxcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL1wiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5idWYucHVzaCgnPC9kaXY+PC9hPicpO1xufTtcbnZhciBtZWRpYV9wb3N0X21peGluID0gZnVuY3Rpb24oZiwgaSl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KGYubWVkaWFfdXJsKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59O1xudmFyIGh0bWxfcG9zdF9taXhpbiA9IGZ1bmN0aW9uKGYsIHQsIGkpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbmJ1Zi5wdXNoKCc8cCBjbGFzcz1cImJvZHlcIj4nKTtcbnZhciBfX3ZhbF9fID0gZi5odG1sXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9wPicpO1xufTtcbnZhciBwb3N0c19taXhpbiA9IGZ1bmN0aW9uKGYsIGkpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbi8vIGl0ZXJhdGUgZi5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGYucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsICQkbCA9IGYucG9zdHMubGVuZ3RoOyBpIDwgJCRsOyBpKyspIHtcbiAgICAgIHZhciBwID0gZi5wb3N0c1tpXTtcblxuYnVmLnB1c2goJzxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJwb3N0X1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdwb3N0JykgKyAnICcgKyAoXCJjb2xcIiArIChNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSoyKSkgKyBcIlwiKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzoocC51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxoNSBjbGFzcz1cInRpdGxlXCI+Jyk7XG52YXIgX192YWxfXyA9IHAudGl0bGVcbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8c3BhbiBjbGFzcz1cImRhdGVcIj4nICsgZXNjYXBlKChpbnRlcnAgPSBwLmRhdGUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnPC9zcGFuPjwvaDU+PC9hPicpO1xuaWYgKCBwLm1lZGlhX3VybClcbntcbm1lZGlhX3Bvc3RfbWl4aW4ocCwgaSk7XG59XG5lbHNlXG57XG5odG1sX3Bvc3RfbWl4aW4ocCwgaSk7XG59XG5fcG9zdF9wcm9maWxlX21peGluKHAsIGkpO1xuYnVmLnB1c2goJzwvZGl2PicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpIGluIGYucG9zdHMpIHtcbiAgICAgIHZhciBwID0gZi5wb3N0c1tpXTtcblxuYnVmLnB1c2goJzxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJwb3N0X1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdwb3N0JykgKyAnICcgKyAoXCJjb2xcIiArIChNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSoyKSkgKyBcIlwiKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzoocC51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxoNSBjbGFzcz1cInRpdGxlXCI+Jyk7XG52YXIgX192YWxfXyA9IHAudGl0bGVcbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8c3BhbiBjbGFzcz1cImRhdGVcIj4nICsgZXNjYXBlKChpbnRlcnAgPSBwLmRhdGUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnPC9zcGFuPjwvaDU+PC9hPicpO1xuaWYgKCBwLm1lZGlhX3VybClcbntcbm1lZGlhX3Bvc3RfbWl4aW4ocCwgaSk7XG59XG5lbHNlXG57XG5odG1sX3Bvc3RfbWl4aW4ocCwgaSk7XG59XG5fcG9zdF9wcm9maWxlX21peGluKHAsIGkpO1xuYnVmLnB1c2goJzwvZGl2PicpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG59O1xuaWYgKCBmb3J1bXMpXG57XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyBcImNsYXNzXCI6ICgnaG9tZXBhZ2UnKSArICcgJyArIChhY3RpdmVGb3J1bUlkIT0naG9tZXBhZ2UnPydyZXNpemFibGUgZm9ydW0nOicnKSB9LCB7XCJjbGFzc1wiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xuLy8gaXRlcmF0ZSBmb3J1bXNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiBmb3J1bXMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsICQkbCA9IGZvcnVtcy5sZW5ndGg7IGkgPCAkJGw7IGkrKykge1xuICAgICAgdmFyIGYgPSBmb3J1bXNbaV07XG5cbmJ1Zi5wdXNoKCc8ZGl2Jyk7XG5idWYucHVzaChhdHRycyh7ICdpZCc6KFwiZm9ydW1fXCIgKyAoZi5pZCkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ2ZvcnVtJykgKyAnICcgKyAoZi5jbGFzc2VzIHx8ICcnKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxoMiBjbGFzcz1cInRpdGxlXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihmLnVyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IGYudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT48L2gyPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICduYW1lJzooXCJmb3J1bV9cIiArIChmLmlkKSArIFwiXCIpIH0sIHtcIm5hbWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48L2E+PGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPicpO1xucG9zdHNfbWl4aW4oZiwgaSk7XG5idWYucHVzaCgnPC9kaXY+PC9kaXY+Jyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgaW4gZm9ydW1zKSB7XG4gICAgICB2YXIgZiA9IGZvcnVtc1tpXTtcblxuYnVmLnB1c2goJzxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJmb3J1bV9cIiArIChmLmlkKSArIFwiXCIpLCBcImNsYXNzXCI6ICgnZm9ydW0nKSArICcgJyArIChmLmNsYXNzZXMgfHwgJycpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGgyIGNsYXNzPVwidGl0bGVcIj48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KGYudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gZi50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPjwvaDI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ25hbWUnOihcImZvcnVtX1wiICsgKGYuaWQpICsgXCJcIikgfSwge1wibmFtZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPjwvYT48ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+Jyk7XG5wb3N0c19taXhpbihmLCBpKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48L2Rpdj4nKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxwPkNyZWF0ZSBhIGZvcnVtIGZpcnN0PGk+ITwvaT48L3A+Jyk7XG59XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcIm9yZGVyLWNvbnRyb2xcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cIm9yZGVyZXJcIj48ZGl2IGNsYXNzPVwiaW5kaWNhdG9yXCI+PCEtLSBUT0RPIC0tICwgW1xcJ25lYXJlc3RcXCcsIFxcJ05lYXJieVxcJ11dLS0+Jyk7XG52YXIgb3JkZXJzID0gKFtbJ3BvcHVsYXInLCAnUG9wdWxhciddLCBbJ3JlY2VudCcsICdNb3N0IFJlY2VudCddLCBbJ2FjdGl2ZScsICdNb3N0IEFjdGl2ZSddXSk7XG5idWYucHVzaCgnPC9kaXY+PHVsIGlkPVwib3JkZXJcIj4nKTtcbi8vIGl0ZXJhdGUgb3JkZXJzXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2Ygb3JkZXJzLmxlbmd0aCkge1xuICAgIGZvciAodmFyICRpbmRleCA9IDAsICQkbCA9IG9yZGVycy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBvID0gb3JkZXJzWyRpbmRleF07XG5cbmlmICggb1swXSA9PSBhY3RpdmUpXG57XG5idWYucHVzaCgnPGxpJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXZhbHVlJzoob1swXSksIFwiY2xhc3NcIjogKCdhY3RpdmUnKSB9LCB7XCJkYXRhLXZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IG9bMV1cbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvbGk+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGxpJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXZhbHVlJzoob1swXSkgfSwge1wiZGF0YS12YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBvWzFdXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2xpPicpO1xufVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciAkaW5kZXggaW4gb3JkZXJzKSB7XG4gICAgICB2YXIgbyA9IG9yZGVyc1skaW5kZXhdO1xuXG5pZiAoIG9bMF0gPT0gYWN0aXZlKVxue1xuYnVmLnB1c2goJzxsaScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS12YWx1ZSc6KG9bMF0pLCBcImNsYXNzXCI6ICgnYWN0aXZlJykgfSwge1wiZGF0YS12YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBvWzFdXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2xpPicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxsaScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS12YWx1ZSc6KG9bMF0pIH0sIHtcImRhdGEtdmFsdWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gb1sxXVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9saT4nKTtcbn1cbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxuYnVmLnB1c2goJzwvdWw+PGRpdiBjbGFzcz1cIm9uY2xpY2stc2Nyb2xsLXRvcFwiPjwvZGl2PjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJ0aHJlYWRcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX3RocmVhZF9taXhpbiA9IGZ1bmN0aW9uKHQpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXQudXNlcl9waG90bykgdC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxsaScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1pZCc6KHQuaWQpLCAnZGF0YS11c2VyLWlkJzoodC51c2VyX2lkKSwgXCJjbGFzc1wiOiAoJ3RocmVhZCcpIH0sIHtcImRhdGEtaWRcIjp0cnVlLFwiZGF0YS11c2VyLWlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtc3VyZic6KHQuZm9ydW1faWQpLCAnaHJlZic6KHQudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImRhdGEtc3VyZlwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGg0IGNsYXNzPVwidGl0bGVcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oND48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48ZGl2IGNsYXNzPVwicHJvZmlsZSBwaG90b1wiPjxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCJcIiArICh0LnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjwvZGl2PjxkaXYgY2xhc3M9XCJjb250YWluZXJcIj48c3BhbiBjbGFzcz1cInVzZXJuYW1lXCI+Ynk8ZW0+Jyk7XG52YXIgX192YWxfXyA9IHQudXNlcl9uYW1lIC8vIFhYWCB3ZWlyZCB0aGluZ3MgaGFwcGVuZWQgd2hlbiBJIHRyaWVkIHRvIHR1cm4gdGhpcyBpbnRvIGFuIGFuY2hvclxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9lbT48L3NwYW4+PHNwYW4nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHQuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnY3JlYXRlZCcpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSB0LmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L3NwYW4+PGRpdiBjbGFzcz1cImNsZWFyXCI+PC9kaXY+PHNwYW4gY2xhc3M9XCJwb3N0LWNvdW50XCI+Jyk7XG52YXIgX192YWxfXyA9IHQucG9zdF9jb3VudFxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+cG9zdHM8L2k+PC9zcGFuPjxzcGFuIGNsYXNzPVwidmlld3NcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC52aWV3c1xuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+dmlld3M8L2k+PC9zcGFuPjwvZGl2PjwvYT48L2xpPicpO1xufTtcbl90aHJlYWRfbWl4aW4odGhyZWFkKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wibmF2XCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xudmFyIF90aHJlYWRfbWl4aW4gPSBmdW5jdGlvbih0KXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG4gaWYgKCF0LnVzZXJfcGhvdG8pIHQudXNlcl9waG90byA9IGNhY2hlVXJsICsgJ2ltYWdlcy9wcm9maWxlLmpwZydcbmJ1Zi5wdXNoKCc8bGknKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtaWQnOih0LmlkKSwgJ2RhdGEtdXNlci1pZCc6KHQudXNlcl9pZCksIFwiY2xhc3NcIjogKCd0aHJlYWQnKSB9LCB7XCJkYXRhLWlkXCI6dHJ1ZSxcImRhdGEtdXNlci1pZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXN1cmYnOih0LmZvcnVtX2lkKSwgJ2hyZWYnOih0LnVyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSB9LCB7XCJkYXRhLXN1cmZcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxoNCBjbGFzcz1cInRpdGxlXCI+Jyk7XG52YXIgX192YWxfXyA9IHQudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvaDQ+PGRpdiBjbGFzcz1cImJyZWFrXCI+PC9kaXY+PGRpdiBjbGFzcz1cInByb2ZpbGUgcGhvdG9cIj48aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiXCIgKyAodC51c2VyX3Bob3RvKSArIFwiXCIpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2Rpdj48ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PHNwYW4gY2xhc3M9XCJ1c2VybmFtZVwiPmJ5PGVtPicpO1xudmFyIF9fdmFsX18gPSB0LnVzZXJfbmFtZSAvLyBYWFggd2VpcmQgdGhpbmdzIGhhcHBlbmVkIHdoZW4gSSB0cmllZCB0byB0dXJuIHRoaXMgaW50byBhbiBhbmNob3JcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvZW0+PC9zcGFuPjxzcGFuJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXRpbWUnOih0LmNyZWF0ZWRfaXNvKSwgXCJjbGFzc1wiOiAoJ2NyZWF0ZWQnKSB9LCB7XCJkYXRhLXRpbWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gdC5jcmVhdGVkX2h1bWFuXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9zcGFuPjxkaXYgY2xhc3M9XCJjbGVhclwiPjwvZGl2PjxzcGFuIGNsYXNzPVwicG9zdC1jb3VudFwiPicpO1xudmFyIF9fdmFsX18gPSB0LnBvc3RfY291bnRcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzxpPnBvc3RzPC9pPjwvc3Bhbj48c3BhbiBjbGFzcz1cInZpZXdzXCI+Jyk7XG52YXIgX192YWxfXyA9IHQudmlld3NcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzxpPnZpZXdzPC9pPjwvc3Bhbj48L2Rpdj48L2E+PC9saT4nKTtcbn07XG52YXIgc3ViZm9ydW1fbWl4aW4gPSBmdW5jdGlvbihmLCBzZiwgaSl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxsaSBjbGFzcz1cInN1YmZvcnVtXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihzZi51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ3RpdGxlJykgKyAnICcgKyAoJ3N0eWxpc2gnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHNmLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9saT4nKTtcbn07XG52YXIgZm9ydW1fbWl4aW4gPSBmdW5jdGlvbihmLCBpKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGgzIGNsYXNzPVwidGl0bGVcIj5Gb3J1bXM8L2gzPicpO1xuaWYgKCBmLmZvcnVtcylcbntcbmJ1Zi5wdXNoKCc8dWwnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgXCJjbGFzc1wiOiAoJ2ZvcnVtJykgKyAnICcgKyAoXCJcIiArIChmLmNsYXNzZXMgfHwgJycpICsgXCIgZm9ydW0tXCIgKyAoYWN0aXZlRm9ydW1JZCkgKyBcIlwiKSB9LCB7XCJjbGFzc1wiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xuLy8gaXRlcmF0ZSBmLmZvcnVtc1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGYuZm9ydW1zLmxlbmd0aCkge1xuICAgIGZvciAodmFyIGlpID0gMCwgJCRsID0gZi5mb3J1bXMubGVuZ3RoOyBpaSA8ICQkbDsgaWkrKykge1xuICAgICAgdmFyIHNmID0gZi5mb3J1bXNbaWldO1xuXG5zdWJmb3J1bV9taXhpbihmLCBzZiwgaWkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiBmLmZvcnVtcykge1xuICAgICAgdmFyIHNmID0gZi5mb3J1bXNbaWldO1xuXG5zdWJmb3J1bV9taXhpbihmLCBzZiwgaWkpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPC91bD4nKTtcbn1cbn07XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImNyZWF0ZVwiPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLWVkaXQnOigndHJ1ZScpLCAnaHJlZic6KFwiXCIgKyAoZm9ydW0udXJpKSArIFwiL25ld1wiKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpICsgJyAnICsgKCduby1zdXJmJykgKyAnICcgKyAoJ3JlcXVpcmUtbG9naW4nKSArICcgJyArICgnYnV0dG9uJykgfSwge1wiZGF0YS1lZGl0XCI6dHJ1ZSxcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz5DcmVhdGUgVGhyZWFkPC9hPjwvZGl2PjxkaXYgaWQ9XCJ0aHJlYWQtcGFnaW5hdG9yXCI+PC9kaXY+PGRpdiBjbGFzcz1cInNjcm9sbGFibGVcIj4nKTtcbnZhciBfdGhyZWFkX21peGluID0gZnVuY3Rpb24odCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuIGlmICghdC51c2VyX3Bob3RvKSB0LnVzZXJfcGhvdG8gPSBjYWNoZVVybCArICdpbWFnZXMvcHJvZmlsZS5qcGcnXG5idWYucHVzaCgnPGxpJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLWlkJzoodC5pZCksICdkYXRhLXVzZXItaWQnOih0LnVzZXJfaWQpLCBcImNsYXNzXCI6ICgndGhyZWFkJykgfSwge1wiZGF0YS1pZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1zdXJmJzoodC5mb3J1bV9pZCksICdocmVmJzoodC51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiZGF0YS1zdXJmXCI6dHJ1ZSxcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSB0LnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIlwiICsgKHQudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9kaXY+PGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPjxzcGFuIGNsYXNzPVwidXNlcm5hbWVcIj5ieTxlbT4nKTtcbnZhciBfX3ZhbF9fID0gdC51c2VyX25hbWUgLy8gWFhYIHdlaXJkIHRoaW5ncyBoYXBwZW5lZCB3aGVuIEkgdHJpZWQgdG8gdHVybiB0aGlzIGludG8gYW4gYW5jaG9yXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2VtPjwvc3Bhbj48c3BhbicpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS10aW1lJzoodC5jcmVhdGVkX2lzbyksIFwiY2xhc3NcIjogKCdjcmVhdGVkJykgfSwge1wiZGF0YS10aW1lXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHQuY3JlYXRlZF9odW1hblxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvc3Bhbj48ZGl2IGNsYXNzPVwiY2xlYXJcIj48L2Rpdj48c3BhbiBjbGFzcz1cInBvc3QtY291bnRcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC5wb3N0X2NvdW50XG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8aT5wb3N0czwvaT48L3NwYW4+PHNwYW4gY2xhc3M9XCJ2aWV3c1wiPicpO1xudmFyIF9fdmFsX18gPSB0LnZpZXdzXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8aT52aWV3czwvaT48L3NwYW4+PC9kaXY+PC9hPjwvbGk+Jyk7XG59O1xuYnVmLnB1c2goJzx1bCBjbGFzcz1cInRocmVhZHNcIj4nKTtcbi8vIGl0ZXJhdGUgdG9wVGhyZWFkc1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHRvcFRocmVhZHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwLCAkJGwgPSB0b3BUaHJlYWRzLmxlbmd0aDsgaWkgPCAkJGw7IGlpKyspIHtcbiAgICAgIHZhciB0ID0gdG9wVGhyZWFkc1tpaV07XG5cbl90aHJlYWRfbWl4aW4odCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGlpIGluIHRvcFRocmVhZHMpIHtcbiAgICAgIHZhciB0ID0gdG9wVGhyZWFkc1tpaV07XG5cbl90aHJlYWRfbWl4aW4odCk7XG4gICB9XG4gIH1cbn0pLmNhbGwodGhpcyk7XG5cbmJ1Zi5wdXNoKCc8L3VsPjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJwb3N0c1wiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG52YXIgX3Bvc3RfcHJvZmlsZV9taXhpbiA9IGZ1bmN0aW9uKHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXAudXNlcl9waG90bykgcC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvdXNlci9cIiArIChwLnVzZXJfbmFtZSkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3VzZXInKSArICcgJyArICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+Jyk7XG5pZiAoIHAudXNlcl9waG90byAmJiBwLnVzZXJfcGhvdG8ubWF0Y2goL15odHRwLykpXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOihwLnVzZXJfbmFtZSksICdzcmMnOihcIlwiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArIChwLnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvYT4nKTtcbn07XG52YXIgX3Bvc3RfbWl4aW4gPSBmdW5jdGlvbihwLCBpKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihcInBvc3RfXCIgKyAocC5pZCkgKyBcIlwiKSwgJ2RhdGEtdXNlci1pZCc6KHAudXNlcl9pZCksICdkYXRhLXBvc3QtaWQnOihwLmlkKSwgJ2RhdGEtdGhyZWFkLWlkJzoocC50aHJlYWRfaWQpLCAnZGF0YS1mb3J1bS1pZCc6KHAuZm9ydW1faWQpLCBcImNsYXNzXCI6ICgncG9zdCcpICsgJyAnICsgKHAucmVhc29uID8gJ2NlbnNvcmVkJyA6ICcnKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlLFwiZGF0YS1wb3N0LWlkXCI6dHJ1ZSxcImRhdGEtdGhyZWFkLWlkXCI6dHJ1ZSxcImRhdGEtZm9ydW0taWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbmlmICggcC50aHJlYWRfdXJpKVxue1xuYnVmLnB1c2goJzxoNCBjbGFzcz1cInRpdGxlXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnRocmVhZF91cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9oND4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PicpO1xufVxuX3Bvc3RfcHJvZmlsZV9taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PHNwYW4gY2xhc3M9XCJ1c2VybmFtZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnVzZXJfbmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHAuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnZGF0ZScpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48ZGl2IGNsYXNzPVwicG9zdC1jb250ZW50XCI+Jyk7XG5pZiAoIHAuaHRtbClcbntcbmJ1Zi5wdXNoKCc8cCBjbGFzcz1cImJvZHlcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC5odG1sXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9wPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvZGl2PicpO1xuX3Bvc3RfYWN0aW9uc19taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwicmVwbHlcIj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiY2hpbGRyZW5cIj4nKTtcbmlmICggcC5wb3N0cyAmJiBwLnBvc3RzLmxlbmd0aClcbntcbi8vIGl0ZXJhdGUgcC5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHAucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwLCAkJGwgPSBwLnBvc3RzLmxlbmd0aDsgaWkgPCAkJGw7IGlpKyspIHtcbiAgICAgIHZhciBwcCA9IHAucG9zdHNbaWldO1xuXG5fcG9zdF9taXhpbihwcCwgaWkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiBwLnBvc3RzKSB7XG4gICAgICB2YXIgcHAgPSBwLnBvc3RzW2lpXTtcblxuX3Bvc3RfbWl4aW4ocHAsIGlpKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZSBpZiAoIHAubW9yZVBvc3RzKVxue1xuYnVmLnB1c2goJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJsb2FkLW1vcmVcIj5Nb3JlIFBvc3RzPC9hPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufTtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG52YXIgX2JyZWFkY3J1bWJfbWl4aW4gPSBmdW5jdGlvbihwKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG52YXIgcGF0aCA9ICgnJyk7XG52YXIgcGFydHMgPSAocC51cmkuc3BsaXQoJy8nKSk7XG52YXIgcGFydHMgPSAocGFydHMuc3BsaWNlKDEsIHBhcnRzLmxlbmd0aC0yKSk7XG4vLyBpdGVyYXRlIHBhcnRzXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgcGFydHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gcGFydHMubGVuZ3RoOyAkaW5kZXggPCAkJGw7ICRpbmRleCsrKSB7XG4gICAgICB2YXIgcGFydCA9IHBhcnRzWyRpbmRleF07XG5cbmlmICggcGFydCAhPSAndCcpXG57XG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi9cIiArIChwYXRoKSArIFwiXCIgKyAocGFydCkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gcGFydC5yZXBsYWNlKCctJywgJyAnKVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPjxzcGFuPi88L3NwYW4+Jyk7XG59XG4gcGF0aCA9IHBhdGggKyBwYXJ0ICsgJy8nXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyICRpbmRleCBpbiBwYXJ0cykge1xuICAgICAgdmFyIHBhcnQgPSBwYXJ0c1skaW5kZXhdO1xuXG5pZiAoIHBhcnQgIT0gJ3QnKVxue1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvXCIgKyAocGF0aCkgKyBcIlwiICsgKHBhcnQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHBhcnQucmVwbGFjZSgnLScsICcgJylcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT48c3Bhbj4vPC9zcGFuPicpO1xufVxuIHBhdGggPSBwYXRoICsgcGFydCArICcvJ1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPGVtPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2VtPicpO1xufTtcbmlmICggdHlwZW9mKHBvc3QpICE9PSAndW5kZWZpbmVkJylcbntcbiBpZiAoIXBvc3QudXNlcl9waG90bykgcG9zdC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJmb3J1bSByZXNpemFibGVcIj4nKTtcbmlmICggcGFnZSA9PSAxKVxue1xuYnVmLnB1c2goJzxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJwb3N0X1wiICsgKHBvc3QuaWQpICsgXCJcIiksICdkYXRhLXVzZXItaWQnOihwb3N0LnVzZXJfaWQpLCAnZGF0YS1wb3N0LWlkJzoocG9zdC5pZCksIFwiY2xhc3NcIjogKCdwb3N0JykgKyAnICcgKyAoJ2hlYWQnKSArICcgJyArIChwb3N0LnJlYXNvbiA/ICdjZW5zb3JlZCcgOiAnJykgfSwge1wiY2xhc3NcIjp0cnVlLFwiaWRcIjp0cnVlLFwiZGF0YS11c2VyLWlkXCI6dHJ1ZSxcImRhdGEtcG9zdC1pZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxoMyBjbGFzcz1cInRpdGxlXCI+Jyk7XG52YXIgX192YWxfXyA9IHBvc3QudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvaDM+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi91c2VyL1wiICsgKHBvc3QudXNlcl9uYW1lKSArIFwiXCIpLCBcImNsYXNzXCI6ICgndXNlcicpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGRpdiBjbGFzcz1cInByb2ZpbGUgcGhvdG9cIj48aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL1wiICsgKHBvc3QudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9kaXY+PHNwYW4+Jyk7XG52YXIgX192YWxfXyA9IHBvc3QudXNlcl9uYW1lXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L3NwYW4+PC9hPjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHBvc3QuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnZGF0ZScpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwb3N0LmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48ZGl2IGNsYXNzPVwiZWRpdC1jb250YWluZXJcIj48L2Rpdj4nKTtcbmlmICggcG9zdC5odG1sKVxue1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJib2R5XCI+Jyk7XG52YXIgX192YWxfXyA9IHBvc3QuaHRtbFxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvZGl2PicpO1xufVxuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJyZXBseVwiPjwvZGl2PjxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stZm9vdGVyLXRvZ2dsZVwiPlJlcGx5PC9hPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLWVkaXQnOihwb3N0LmlkKSwgJ2hyZWYnOihcIlwiICsgKHBvc3QudXJpLnJlcGxhY2UoL1xcL1xcZCskLywgJycpKSArIFwiL2VkaXQvXCIgKyAocG9zdC5pZCkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3N0eWxpc2gnKSArICcgJyArICgnZWRpdCcpICsgJyAnICsgKCdtdXRhbnQnKSArICcgJyArICgnbm8tc3VyZicpIH0sIHtcImRhdGEtZWRpdFwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+RWRpdDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KHBvc3QudXJpKSwgXCJjbGFzc1wiOiAoJ3N0eWxpc2gnKSArICcgJyArICgncGVybWFsaW5rJykgKyAnICcgKyAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz5QZXJtYWxpbms8L2E+PGEgY2xhc3M9XCJzdHlsaXNoIGNlbnNvciBvbmNsaWNrLWNlbnNvci1wb3N0XCI+Q2Vuc29yPC9hPjwvZGl2PjwvZGl2PicpO1xufVxuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJjaGlsZHJlblwiPicpO1xuaWYgKCBwb3N0LnBvc3RzLmxlbmd0aClcbntcbmJ1Zi5wdXNoKCc8ZGl2Jyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXBhZ2UnOihwYWdlKSB9LCB7XCJkYXRhLXBhZ2VcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbi8vIGl0ZXJhdGUgcG9zdC5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHBvc3QucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gcG9zdC5wb3N0cy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBzcCA9IHBvc3QucG9zdHNbJGluZGV4XTtcblxuaWYgKCBzcC5wYXJlbnRfaWQgIT09IG51bGwpXG57XG5fcG9zdF9taXhpbihzcCwgMCk7XG59XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyICRpbmRleCBpbiBwb3N0LnBvc3RzKSB7XG4gICAgICB2YXIgc3AgPSBwb3N0LnBvc3RzWyRpbmRleF07XG5cbmlmICggc3AucGFyZW50X2lkICE9PSBudWxsKVxue1xuX3Bvc3RfbWl4aW4oc3AsIDApO1xufVxuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPC9kaXY+Jyk7XG59XG5lbHNlIGlmICggcG9zdC5tb3JlUG9zdHMpXG57XG5idWYucHVzaCgnPGEgaHJlZj1cIiNcIj5Mb2FkIG1vcmUgcG9zdHMgLi4uPC9hPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjxwIGNsYXNzPVwib25jbGljay1mb290ZXItdG9nZ2xlXCI+UG9zdCBSZXBseTwvcD48L2Rpdj4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiZm9ydW0gcmVzaXphYmxlXCI+PC9kaXY+Jyk7XG59XG5pZiAoIHR5cGVvZihwb3N0KSAhPT0gJ3VuZGVmaW5lZCcpXG57XG5idWYucHVzaCgnPGRpdiBpZD1cImJyZWFkY3J1bWJcIiBjbGFzcz1cImJyZWFkY3J1bWJcIj4nKTtcbl9icmVhZGNydW1iX21peGluKHBvc3QpO1xuYnVmLnB1c2goJzwvZGl2PicpO1xufVxufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJwb3N0LWVkaXRcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX3Bvc3RfZWRpdF9taXhpbiA9IGZ1bmN0aW9uKHUsIHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbnZhciBodG1sX2lkID0gKHAuaWQgPyBcIl8je3AuaWR9XCIgOiAnJyk7XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihwLmlzX2NvbW1lbnQgPyBodG1sX2lkIDogJ3Bvc3RfZWRpdCcpLCBcImNsYXNzXCI6ICgncG9zdC1lZGl0JykgKyAnICcgKyAoJ29uY2xpY2stc3VibWl0JykgKyAnICcgKyAocC5pc19jb21tZW50ID8gJ2NvbW1lbnQnIDogJycpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGZvcm0nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2FjdGlvbic6KFwiL3Jlc291cmNlcy9wb3N0c1wiKSwgJ21ldGhvZCc6KFwiXCIgKyAocC5tZXRob2QgfHwgJ3B1dCcpICsgXCJcIikgfSwge1wiYWN0aW9uXCI6dHJ1ZSxcIm1ldGhvZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS11c2VyLWlkJzoodS5pZCksIFwiY2xhc3NcIjogKCdzdW1tYXJ5JykgfSwge1wiZGF0YS11c2VyLWlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArICh1LnBob3RvIHx8ICdpbWFnZXMvcHJvZmlsZS5qcGcnKSArIFwiXCIpLCBcImNsYXNzXCI6ICgncHJvZmlsZScpICsgJyAnICsgKCdwaG90bycpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2Rpdj4nKTtcbmlmICggIXAuaXNfY29tbWVudClcbntcbmJ1Zi5wdXNoKCc8aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ25hbWUnOigndGl0bGUnKSwgJ3R5cGUnOigndGV4dCcpLCAncGxhY2Vob2xkZXInOignVGl0bGUnKSwgJ3ZhbHVlJzoocC50aXRsZSksIFwiY2xhc3NcIjogKCd0aXRsZScpIH0sIHtcIm5hbWVcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJwbGFjZWhvbGRlclwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmJ1Zi5wdXNoKCc8dGV4dGFyZWEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJlZGl0b3JcIiArIChwLmlzX2NvbW1lbnQgPyBodG1sX2lkIDogJycpICsgXCJcIiksICduYW1lJzooJ2JvZHknKSwgJ3BsYWNlaG9sZGVyJzooJ0NvbW1lbnQgLi4uJyksIFwiY2xhc3NcIjogKCdib2R5JykgKyAnICcgKyAoJ29uc2hpZnRlbnRlci1zdWJtaXQnKSB9LCB7XCJpZFwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHAuYm9keVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC90ZXh0YXJlYT48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ2lkJyksICd2YWx1ZSc6KHAuaWQpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ2ZvcnVtX2lkJyksICd2YWx1ZSc6KHAuZm9ydW1faWQpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ3BhcmVudF9pZCcpLCAndmFsdWUnOihwLnBhcmVudF9pZCkgfSwge1widHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxpbnB1dCcpO1xuYnVmLnB1c2goYXR0cnMoeyAndHlwZSc6KCdoaWRkZW4nKSwgJ25hbWUnOignY3NyZicpLCAndmFsdWUnOihwLmNzcmYpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiBuYW1lPVwic3VibWl0XCIgdmFsdWU9XCJTYXZlXCI+U2F2ZTwvYnV0dG9uPjxkaXYgY2xhc3M9XCJjbG9zZSBjYW5jZWxcIj5YPC9kaXY+PC9mb3JtPjxkaXYgY2xhc3M9XCJwcmV2aWV3XCI+PC9kaXY+PC9kaXY+Jyk7XG59O1xuaWYgKCB0eXBlb2YocG9zdCkgIT09ICd1bmRlZmluZWQnKVxue1xuX3Bvc3RfZWRpdF9taXhpbih1c2VyLCBwb3N0KTtcbn1cbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wicG9zdC1uZXdcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImZvcnVtIHJlc2l6YWJsZVwiPjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJwcm9maWxlXCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJjb250YWluZXJcIj48aDI+Jyk7XG52YXIgX192YWxfXyA9IHByb2ZpbGUubmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oMj48ZGl2Jyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLXVzZXItaWQnOihcIlwiICsgKHByb2ZpbGUuaWQpICsgXCJcIiksICdkYXRhLXVzZXItbmFtZSc6KFwiXCIgKyAocHJvZmlsZS5uYW1lKSArIFwiXCIpLCBcImNsYXNzXCI6ICgncHJvZmlsZScpIH0sIHtcImRhdGEtdXNlci1pZFwiOnRydWUsXCJkYXRhLXVzZXItbmFtZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxmb3JtJyk7XG5idWYucHVzaChhdHRycyh7ICdhY3Rpb24nOihcIi9yZXNvdXJjZXMvdXNlcnMvXCIgKyAocHJvZmlsZS5pZCkgKyBcIi9hdmF0YXJcIiksICdlbmN0eXBlJzooXCJtdWx0aXBhcnQvZm9ybS1kYXRhXCIpLCAnbWV0aG9kJzooXCJwb3N0XCIpIH0sIHtcImFjdGlvblwiOnRydWUsXCJlbmN0eXBlXCI6dHJ1ZSxcIm1ldGhvZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJhdmF0YXJcIj4nKTtcbmlmICggcHJvZmlsZS5waG90bylcbntcbmlmICggcHJvZmlsZS5waG90by5tYXRjaCgvXmh0dHBzPzovKSlcbntcbmJ1Zi5wdXNoKCc8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKHByb2ZpbGUucGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCIvXCIgKyAocHJvZmlsZS5waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9pbWFnZXMvcHJvZmlsZS5qcGdcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjxpbnB1dCB0eXBlPVwiZmlsZVwiIG5hbWU9XCJhdmF0YXJcIiBzdHlsZT1cImRpc3BsYXk6bm9uZTtcIi8+PC9mb3JtPjwvZGl2Pjx1bD48bGkgY2xhc3M9XCJzaW5jZVwiPjxzcGFuPkpvaW5lZCA8L3NwYW4+Jyk7XG52YXIgX192YWxfXyA9IHByb2ZpbGUuY3JlYXRlZF9odW1hblxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvbGk+PGxpIGNsYXNzPVwiY291bnRcIj48Yj4nKTtcbnZhciBfX3ZhbF9fID0gcHJvZmlsZS5odW1hbl9wb3N0X2NvdW50IFxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvYj48c3Bhbj4gJyArIGVzY2FwZSgoaW50ZXJwID0gcHJvZmlsZS5wb3N0X2NvdW50ID09IDEgPyBcInBvc3RcIiA6IFwicG9zdHNcIikgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICc8L3NwYW4+PC9saT48bGkgY2xhc3M9XCJjaGF0XCI+PGJ1dHRvbiB0aXRsZT1cIkNoYXRcIiBjbGFzcz1cIm9uY2xpY2stY2hhdFwiPlByaXZhdGUgTWVzc2FnZTwvYnV0dG9uPjwvbGk+PC91bD48L2Rpdj4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wicG9zdHMtYnktdXNlclwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG52YXIgX3Bvc3RfcHJvZmlsZV9taXhpbiA9IGZ1bmN0aW9uKHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXAudXNlcl9waG90bykgcC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvdXNlci9cIiArIChwLnVzZXJfbmFtZSkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3VzZXInKSArICcgJyArICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+Jyk7XG5pZiAoIHAudXNlcl9waG90byAmJiBwLnVzZXJfcGhvdG8ubWF0Y2goL15odHRwLykpXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOihwLnVzZXJfbmFtZSksICdzcmMnOihcIlwiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArIChwLnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvYT4nKTtcbn07XG52YXIgX3Bvc3RfbWl4aW4gPSBmdW5jdGlvbihwLCBpKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihcInBvc3RfXCIgKyAocC5pZCkgKyBcIlwiKSwgJ2RhdGEtdXNlci1pZCc6KHAudXNlcl9pZCksICdkYXRhLXBvc3QtaWQnOihwLmlkKSwgJ2RhdGEtdGhyZWFkLWlkJzoocC50aHJlYWRfaWQpLCAnZGF0YS1mb3J1bS1pZCc6KHAuZm9ydW1faWQpLCBcImNsYXNzXCI6ICgncG9zdCcpICsgJyAnICsgKHAucmVhc29uID8gJ2NlbnNvcmVkJyA6ICcnKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlLFwiZGF0YS1wb3N0LWlkXCI6dHJ1ZSxcImRhdGEtdGhyZWFkLWlkXCI6dHJ1ZSxcImRhdGEtZm9ydW0taWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbmlmICggcC50aHJlYWRfdXJpKVxue1xuYnVmLnB1c2goJzxoNCBjbGFzcz1cInRpdGxlXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnRocmVhZF91cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9oND4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PicpO1xufVxuX3Bvc3RfcHJvZmlsZV9taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PHNwYW4gY2xhc3M9XCJ1c2VybmFtZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnVzZXJfbmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHAuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnZGF0ZScpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48ZGl2IGNsYXNzPVwicG9zdC1jb250ZW50XCI+Jyk7XG5pZiAoIHAuaHRtbClcbntcbmJ1Zi5wdXNoKCc8cCBjbGFzcz1cImJvZHlcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC5odG1sXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9wPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvZGl2PicpO1xuX3Bvc3RfYWN0aW9uc19taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwicmVwbHlcIj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiY2hpbGRyZW5cIj4nKTtcbmlmICggcC5wb3N0cyAmJiBwLnBvc3RzLmxlbmd0aClcbntcbi8vIGl0ZXJhdGUgcC5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHAucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwLCAkJGwgPSBwLnBvc3RzLmxlbmd0aDsgaWkgPCAkJGw7IGlpKyspIHtcbiAgICAgIHZhciBwcCA9IHAucG9zdHNbaWldO1xuXG5fcG9zdF9taXhpbihwcCwgaWkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiBwLnBvc3RzKSB7XG4gICAgICB2YXIgcHAgPSBwLnBvc3RzW2lpXTtcblxuX3Bvc3RfbWl4aW4ocHAsIGlpKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZSBpZiAoIHAubW9yZVBvc3RzKVxue1xuYnVmLnB1c2goJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJsb2FkLW1vcmVcIj5Nb3JlIFBvc3RzPC9hPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwicmVzaXphYmxlIGZvcnVtXCI+Jyk7XG5pZiAoIHBvc3RzQnlVc2VyLmxlbmd0aClcbntcbnZhciBsYXN0X3RocmVhZF9pZCA9ICgtMSk7XG4vLyBpdGVyYXRlIHBvc3RzQnlVc2VyXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgcG9zdHNCeVVzZXIubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaSA9IDAsICQkbCA9IHBvc3RzQnlVc2VyLmxlbmd0aDsgaSA8ICQkbDsgaSsrKSB7XG4gICAgICB2YXIgcCA9IHBvc3RzQnlVc2VyW2ldO1xuXG5pZiAoIGxhc3RfdGhyZWFkX2lkICE9IHAudGhyZWFkX2lkKVxue1xuYnVmLnB1c2goJzxoMyBjbGFzcz1cImhlYWRpbmdcIj48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KHAudGhyZWFkX3VyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSArICcgJyArICgndGl0bGUnKSArICcgJyArICgnc3R5bGlzaCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4gPGI+JyArIGVzY2FwZSgoaW50ZXJwID0gcC50aHJlYWRfdGl0bGUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnIDwvYj48L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi91c2VyL1wiICsgKHAudGhyZWFkX3VzZXJuYW1lKSArIFwiXCIpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ2J5JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPmJ5IDxiPicgKyBlc2NhcGUoKGludGVycCA9IHAudGhyZWFkX3VzZXJuYW1lKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJyA8L2I+PC9hPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzoocC5mb3J1bV91cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ2ZvcnVtLWxpbmsnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+aW4gPGI+JyArIGVzY2FwZSgoaW50ZXJwID0gcC5mb3J1bV90aXRsZSkgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICc8L2I+PC9hPjwvaDM+Jyk7XG59XG5fcG9zdF9taXhpbihwLCBpKTtcbnZhciBsYXN0X3RocmVhZF9pZCA9IChwLnRocmVhZF9pZCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGkgaW4gcG9zdHNCeVVzZXIpIHtcbiAgICAgIHZhciBwID0gcG9zdHNCeVVzZXJbaV07XG5cbmlmICggbGFzdF90aHJlYWRfaWQgIT0gcC50aHJlYWRfaWQpXG57XG5idWYucHVzaCgnPGgzIGNsYXNzPVwiaGVhZGluZ1wiPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzoocC50aHJlYWRfdXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpICsgJyAnICsgKCd0aXRsZScpICsgJyAnICsgKCdzdHlsaXNoJykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPiA8Yj4nICsgZXNjYXBlKChpbnRlcnAgPSBwLnRocmVhZF90aXRsZSkgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICcgPC9iPjwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiL3VzZXIvXCIgKyAocC50aHJlYWRfdXNlcm5hbWUpICsgXCJcIiksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSArICcgJyArICgnYnknKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+YnkgPGI+JyArIGVzY2FwZSgoaW50ZXJwID0gcC50aHJlYWRfdXNlcm5hbWUpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnIDwvYj48L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLmZvcnVtX3VyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSArICcgJyArICgnZm9ydW0tbGluaycpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz5pbiA8Yj4nICsgZXNjYXBlKChpbnRlcnAgPSBwLmZvcnVtX3RpdGxlKSA9PSBudWxsID8gJycgOiBpbnRlcnApICsgJzwvYj48L2E+PC9oMz4nKTtcbn1cbl9wb3N0X21peGluKHAsIGkpO1xudmFyIGxhc3RfdGhyZWFkX2lkID0gKHAudGhyZWFkX2lkKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZVxue1xuYnVmLnB1c2goJzxoMz5DaGVjayBiYWNrIGZvciBteSBmaXJzdCBwb3N0PGk+ITwvaT48L2gzPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJwb3N0XCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xudmFyIF9wb3N0X2FjdGlvbnNfbWl4aW4gPSBmdW5jdGlvbihwKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImFjdGlvbnNcIj48YSBjbGFzcz1cInN0eWxpc2ggb25jbGljay1hcHBlbmQtcmVwbHktdWlcIj5Db21tZW50PC9hPjxhJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLWVkaXQnOihwLmlkKSwgJ2hyZWYnOihcIlwiICsgKHAudXJpLnJlcGxhY2UoL1xcL1xcZCskLywgJycpKSArIFwiL2VkaXQvXCIgKyAocC5pZCkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3N0eWxpc2gnKSArICcgJyArICgnZWRpdCcpICsgJyAnICsgKCdtdXRhbnQnKSArICcgJyArICgnbm8tc3VyZicpIH0sIHtcImRhdGEtZWRpdFwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+RWRpdDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KHAudXJpKSwgXCJjbGFzc1wiOiAoJ3N0eWxpc2gnKSArICcgJyArICgncGVybWFsaW5rJykgKyAnICcgKyAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz5QZXJtYWxpbms8L2E+PGEgY2xhc3M9XCJzdHlsaXNoIGNlbnNvciBvbmNsaWNrLWNlbnNvci1wb3N0XCI+Q2Vuc29yPC9hPjwvZGl2PicpO1xufTtcbnZhciBfcG9zdF9wcm9maWxlX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuIGlmICghcC51c2VyX3Bob3RvKSBwLnVzZXJfcGhvdG8gPSBjYWNoZVVybCArICdpbWFnZXMvcHJvZmlsZS5qcGcnXG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi91c2VyL1wiICsgKHAudXNlcl9uYW1lKSArIFwiXCIpLCBcImNsYXNzXCI6ICgndXNlcicpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGRpdiBjbGFzcz1cInByb2ZpbGUgcGhvdG9cIj4nKTtcbmlmICggcC51c2VyX3Bob3RvICYmIHAudXNlcl9waG90by5tYXRjaCgvXmh0dHAvKSlcbntcbmJ1Zi5wdXNoKCc8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICd0aXRsZSc6KHAudXNlcl9uYW1lKSwgJ3NyYyc6KFwiXCIgKyAocC51c2VyX3Bob3RvKSArIFwiXCIpIH0sIHtcInRpdGxlXCI6dHJ1ZSxcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL1wiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5idWYucHVzaCgnPC9kaXY+PC9hPicpO1xufTtcbnZhciBfcG9zdF9taXhpbiA9IGZ1bmN0aW9uKHAsIGkpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbmJ1Zi5wdXNoKCc8ZGl2Jyk7XG5idWYucHVzaChhdHRycyh7ICdpZCc6KFwicG9zdF9cIiArIChwLmlkKSArIFwiXCIpLCAnZGF0YS11c2VyLWlkJzoocC51c2VyX2lkKSwgJ2RhdGEtcG9zdC1pZCc6KHAuaWQpLCAnZGF0YS10aHJlYWQtaWQnOihwLnRocmVhZF9pZCksICdkYXRhLWZvcnVtLWlkJzoocC5mb3J1bV9pZCksIFwiY2xhc3NcIjogKCdwb3N0JykgKyAnICcgKyAocC5yZWFzb24gPyAnY2Vuc29yZWQnIDogJycpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImlkXCI6dHJ1ZSxcImRhdGEtdXNlci1pZFwiOnRydWUsXCJkYXRhLXBvc3QtaWRcIjp0cnVlLFwiZGF0YS10aHJlYWQtaWRcIjp0cnVlLFwiZGF0YS1mb3J1bS1pZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xuaWYgKCBwLnRocmVhZF91cmkpXG57XG5idWYucHVzaCgnPGg0IGNsYXNzPVwidGl0bGVcIj48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KHAudGhyZWFkX3VyaSksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHAudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT48L2g0PicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxoNCBjbGFzcz1cInRpdGxlXCI+Jyk7XG52YXIgX192YWxfXyA9IHAudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvaDQ+Jyk7XG59XG5fcG9zdF9wcm9maWxlX21peGluKHApO1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJjb250YWluZXJcIj48c3BhbiBjbGFzcz1cInVzZXJuYW1lXCI+Jyk7XG52YXIgX192YWxfXyA9IHAudXNlcl9uYW1lXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L3NwYW4+PGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS10aW1lJzoocC5jcmVhdGVkX2lzbyksIFwiY2xhc3NcIjogKCdkYXRlJykgfSwge1wiZGF0YS10aW1lXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHAuY3JlYXRlZF9odW1hblxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvZGl2PjxkaXYgY2xhc3M9XCJwb3N0LWNvbnRlbnRcIj4nKTtcbmlmICggcC5odG1sKVxue1xuYnVmLnB1c2goJzxwIGNsYXNzPVwiYm9keVwiPicpO1xudmFyIF9fdmFsX18gPSBwLmh0bWxcbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L3A+Jyk7XG59XG5idWYucHVzaCgnPC9kaXY+PC9kaXY+Jyk7XG5fcG9zdF9hY3Rpb25zX21peGluKHApO1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJyZXBseVwiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJjaGlsZHJlblwiPicpO1xuaWYgKCBwLnBvc3RzICYmIHAucG9zdHMubGVuZ3RoKVxue1xuLy8gaXRlcmF0ZSBwLnBvc3RzXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgcC5wb3N0cy5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciBpaSA9IDAsICQkbCA9IHAucG9zdHMubGVuZ3RoOyBpaSA8ICQkbDsgaWkrKykge1xuICAgICAgdmFyIHBwID0gcC5wb3N0c1tpaV07XG5cbl9wb3N0X21peGluKHBwLCBpaSk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyIGlpIGluIHAucG9zdHMpIHtcbiAgICAgIHZhciBwcCA9IHAucG9zdHNbaWldO1xuXG5fcG9zdF9taXhpbihwcCwgaWkpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG59XG5lbHNlIGlmICggcC5tb3JlUG9zdHMpXG57XG5idWYucHVzaCgnPGEgaHJlZj1cIiNcIiBjbGFzcz1cImxvYWQtbW9yZVwiPk1vcmUgUG9zdHM8L2E+Jyk7XG59XG5idWYucHVzaCgnPC9kaXY+Jyk7XG59O1xuX3Bvc3RfbWl4aW4ocG9zdCwgMCk7XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcImFkbWluLWRvbWFpbnNcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImRvbWFpbnNcIj48Zm9ybScpO1xuYnVmLnB1c2goYXR0cnMoeyAnYWN0aW9uJzooXCIvcmVzb3VyY2VzL3NpdGVzL1wiICsgKHNpdGVJZCkgKyBcIlwiKSwgJ21ldGhvZCc6KFwicHV0XCIpLCBcImNsYXNzXCI6ICgnb25jbGljay1zdWJtaXQnKSB9LCB7XCJhY3Rpb25cIjp0cnVlLFwibWV0aG9kXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGRpdiBjbGFzcz1cImRvbWFpblwiPjxsYWJlbCBmb3I9XCJkb21haW5cIj5TZWxlY3QgYSBEb21haW48L2xhYmVsPjxzZWxlY3QgaWQ9XCJkb21haW5cIiBuYW1lPVwiZG9tYWluXCI+Jyk7XG4vLyBpdGVyYXRlIHNpdGUuZG9tYWluc1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHNpdGUuZG9tYWlucy5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciAkaW5kZXggPSAwLCAkJGwgPSBzaXRlLmRvbWFpbnMubGVuZ3RoOyAkaW5kZXggPCAkJGw7ICRpbmRleCsrKSB7XG4gICAgICB2YXIgZCA9IHNpdGUuZG9tYWluc1skaW5kZXhdO1xuXG5idWYucHVzaCgnPG9wdGlvbicpO1xuYnVmLnB1c2goYXR0cnMoeyAndmFsdWUnOihkLmlkKSB9LCB7XCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBkLm5hbWVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvb3B0aW9uPicpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciAkaW5kZXggaW4gc2l0ZS5kb21haW5zKSB7XG4gICAgICB2YXIgZCA9IHNpdGUuZG9tYWluc1skaW5kZXhdO1xuXG5idWYucHVzaCgnPG9wdGlvbicpO1xuYnVmLnB1c2goYXR0cnMoeyAndmFsdWUnOihkLmlkKSB9LCB7XCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBkLm5hbWVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvb3B0aW9uPicpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPC9zZWxlY3Q+PC9kaXY+PGJyLz48ZmllbGRzZXQ+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9pbWFnZXMvZmFjZWJvb2tfMzIucG5nXCIpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48bGVnZW5kPkZhY2Vib29rPC9sZWdlbmQ+PGxhYmVsIGZvcj1cImZhY2Vib29rX2NsaWVudF9pZFwiPklEPC9sYWJlbD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJmYWNlYm9va19jbGllbnRfaWRcIiksICd0eXBlJzooJ3RleHQnKSwgJ25hbWUnOignZmFjZWJvb2tDbGllbnRJZCcpLCAncGxhY2Vob2xkZXInOignRmFjZWJvb2sgQVBJIElEIC4uLicpLCAndmFsdWUnOihzaXRlLmNvbmZpZy5mYWNlYm9va0NsaWVudElkKSwgXCJjbGFzc1wiOiAoJ2ZpcnN0JykgfSwge1wiaWRcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsYWJlbCBmb3I9XCJmYWNlYm9va19jbGllbnRfc2VjcmV0XCI+U2VjcmV0PC9sYWJlbD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJmYWNlYm9va19jbGllbnRfc2VjcmV0XCIpLCAndHlwZSc6KCd0ZXh0JyksICduYW1lJzooJ2ZhY2Vib29rQ2xpZW50U2VjcmV0JyksICdwbGFjZWhvbGRlcic6KCdGYWNlYm9vayBzZWNyZXQgLi4uJyksICd2YWx1ZSc6KHNpdGUuY29uZmlnLmZhY2Vib29rQ2xpZW50SWQpIH0sIHtcImlkXCI6dHJ1ZSxcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJwbGFjZWhvbGRlclwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2ZpZWxkc2V0PjxmaWVsZHNldD48aW1nJyk7XG5idWYucHVzaChhdHRycyh7ICdzcmMnOihcIlwiICsgKGNhY2hlVXJsKSArIFwiL2ltYWdlcy90d2l0dGVyXzMyLnBuZ1wiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PGxlZ2VuZD5Ud2l0dGVyPC9sZWdlbmQ+PGxhYmVsIGZvcj1cInR3aXR0ZXJfa2V5XCI+S2V5PC9sYWJlbD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJ0d2l0dGVyX2tleVwiKSwgJ3R5cGUnOigndGV4dCcpLCAnbmFtZSc6KCd0d2l0dGVyQ29uc3VtZXJLZXknKSwgJ3BsYWNlaG9sZGVyJzooJ1R3aXR0ZXIgQVBJIGtleSAuLi4nKSwgJ3ZhbHVlJzooc2l0ZS5jb25maWcudHdpdHRlckNvbnN1bWVyS2V5KSwgXCJjbGFzc1wiOiAoJ2ZpcnN0JykgfSwge1wiaWRcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsYWJlbCBmb3I9XCJ0d2l0dGVyX3NlY3JldFwiPlNlY3JldDwvbGFiZWw+PGlucHV0Jyk7XG5idWYucHVzaChhdHRycyh7ICdpZCc6KFwidHdpdHRlcl9zZWNyZXRcIiksICd0eXBlJzooJ3RleHQnKSwgJ25hbWUnOigndHdpdHRlckNvbnN1bWVyU2VjcmV0JyksICdwbGFjZWhvbGRlcic6KCdUd2l0dGVyIEFQSSBzZWNyZXQgLi4uJyksICd2YWx1ZSc6KHNpdGUuY29uZmlnLnR3aXR0ZXJDb25zdW1lclNlY3JldCkgfSwge1wiaWRcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjwvZmllbGRzZXQ+PGZpZWxkc2V0PjxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCIvaW1hZ2VzL2dvb2dsZV8zMi5wbmdcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsZWdlbmQ+R29vZ2xlKzwvbGVnZW5kPjxsYWJlbCBmb3I9XCJnb29nbGVfa2V5XCI+S2V5PC9sYWJlbD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJnb29nbGVfa2V5XCIpLCAndHlwZSc6KCd0ZXh0JyksICduYW1lJzooJ2dvb2dsZUNvbnN1bWVyS2V5JyksICdwbGFjZWhvbGRlcic6KCdHb29nbGUrIEFQSSBrZXkgLi4uJyksICd2YWx1ZSc6KHNpdGUuY29uZmlnLmdvb2dsZUNvbnN1bWVyS2V5KSwgXCJjbGFzc1wiOiAoJ2ZpcnN0JykgfSwge1wiaWRcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxsYWJlbCBmb3I9XCJnb29nbGVfc2VjcmV0XCI+U2VjcmV0PC9sYWJlbD48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJnb29nbGVfc2VjcmV0XCIpLCAndHlwZSc6KCd0ZXh0JyksICduYW1lJzooJ2dvb2dsZUNvbnN1bWVyU2VjcmV0JyksICdwbGFjZWhvbGRlcic6KCdHb29nbGUrIEFQSSBzZWNyZXQgLi4uJyksICd2YWx1ZSc6KHNpdGUuY29uZmlnLmdvb2dsZUNvbnN1bWVyU2VjcmV0KSB9LCB7XCJpZFwiOnRydWUsXCJ0eXBlXCI6dHJ1ZSxcIm5hbWVcIjp0cnVlLFwicGxhY2Vob2xkZXJcIjp0cnVlLFwidmFsdWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9maWVsZHNldD48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiB2YWx1ZT1cIlNhdmVcIj5TYXZlPC9idXR0b24+PGRpdiBjbGFzcz1cInRvb2x0aXBcIj48L2Rpdj48aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJhY3Rpb25cIiB2YWx1ZT1cImRvbWFpbnNcIi8+PC9mb3JtPjwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJhZG1pbi1nZW5lcmFsXCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xudmFyIGFuYWx5dGljcyA9ICh1bmVzY2FwZShzaXRlLmNvbmZpZy5hbmFseXRpY3MpKTtcbmJ1Zi5wdXNoKCc8Zm9ybScpO1xuYnVmLnB1c2goYXR0cnMoeyAnYWN0aW9uJzooXCIvcmVzb3VyY2VzL3NpdGVzL1wiICsgKHNpdGVJZCkgKyBcIlwiKSwgJ21ldGhvZCc6KFwicHV0XCIpLCBcImNsYXNzXCI6ICgnb25jbGljay1zdWJtaXQnKSArICcgJyArICgnbm8tZm9jdXMnKSB9LCB7XCJhY3Rpb25cIjp0cnVlLFwibWV0aG9kXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGZpZWxkc2V0PjxsYWJlbCBmb3I9XCJuYW1lXCI+VGl0bGU8L2xhYmVsPjxpbnB1dCcpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOignbmFtZScpLCAnbmFtZSc6KCduYW1lJyksICd0eXBlJzooJ3RleHQnKSwgJ3ZhbHVlJzooc2l0ZS5uYW1lKSwgXCJjbGFzc1wiOiAoJ25hbWUnKSB9LCB7XCJpZFwiOnRydWUsXCJjbGFzc1wiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInR5cGVcIjp0cnVlLFwidmFsdWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PGRpdiBjbGFzcz1cImJyZWFrXCI+PC9kaXY+PGxhYmVsIGZvcj1cInBvc3RzX3Blcl9wYWdlXCI+UG9zdHMgcGVyIFBhZ2U8L2xhYmVsPjxpbnB1dCcpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOigncG9zdHNfcGVyX3BhZ2UnKSwgJ25hbWUnOigncG9zdHNQZXJQYWdlJyksICd0eXBlJzooJ3RleHQnKSwgJ3ZhbHVlJzooc2l0ZS5jb25maWcucG9zdHNQZXJQYWdlKSwgJ21heGxlbmd0aCc6KDQpLCBcImNsYXNzXCI6ICgncG9zdHMtcGVyLXBhZ2UnKSB9LCB7XCJpZFwiOnRydWUsXCJjbGFzc1wiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInR5cGVcIjp0cnVlLFwidmFsdWVcIjp0cnVlLFwibWF4bGVuZ3RoXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxsYWJlbD5Qcml2YWN5PC9sYWJlbD48ZGl2IGNsYXNzPVwiYm94XCI+PGlucHV0Jyk7XG5idWYucHVzaChhdHRycyh7ICdpZCc6KCdwcml2YXRlJyksICd0eXBlJzooJ2NoZWNrYm94JyksICd2YWx1ZSc6KCdjaGVja2VkJyksICduYW1lJzooJ3ByaXZhdGUnKSwgJ2NoZWNrZWQnOihzaXRlLmNvbmZpZy5wcml2YXRlKSB9LCB7XCJ0eXBlXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZSxcIm5hbWVcIjp0cnVlLFwiY2hlY2tlZFwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48bGFiZWwgZm9yPVwicHJpdmF0ZVwiIGNsYXNzPVwic3dpdGNoLWNvbnRyb2xcIj48ZGl2IGNsYXNzPVwic3dpdGNoXCI+PC9kaXY+PC9sYWJlbD48c3BhbiBjbGFzcz1cImxhYmVsIGNoZWNrZWRcIj5Pbjwvc3Bhbj48ZGl2IGNsYXNzPVwibm90ZVwiPkhpZGUgY29udGVudCBmcm9tIHNlYXJjaCBlbmdpbmVzICZhbXA7IHRoZSBwdWJsaWM8L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48bGFiZWw+SW52aXRlIE9ubHk8L2xhYmVsPjxkaXYgY2xhc3M9XCJib3hcIj48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooJ2ludml0ZV9vbmx5JyksICd0eXBlJzooJ2NoZWNrYm94JyksICd2YWx1ZSc6KCdjaGVja2VkJyksICduYW1lJzooJ2ludml0ZU9ubHknKSwgJ2NoZWNrZWQnOihzaXRlLmNvbmZpZy5pbnZpdGVPbmx5KSB9LCB7XCJ0eXBlXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZSxcIm5hbWVcIjp0cnVlLFwiY2hlY2tlZFwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48bGFiZWwgZm9yPVwiaW52aXRlX29ubHlcIiBjbGFzcz1cInN3aXRjaC1jb250cm9sXCI+PGRpdiBjbGFzcz1cInN3aXRjaFwiPjwvZGl2PjwvbGFiZWw+PHNwYW4gY2xhc3M9XCJsYWJlbCBjaGVja2VkXCI+T248L3NwYW4+PGRpdiBjbGFzcz1cIm5vdGVcIj5EaXNhbGxvdyB0aGUgcHVibGljIGZyb20gcmVnaXN0ZXJpbmcgLSA8YSBocmVmPVwiL2FkbWluL2ludml0ZXNcIiBjbGFzcz1cIm11dGFudFwiPkludml0ZXM8L2E+PC9kaXY+PC9kaXY+PGRpdiBjbGFzcz1cImJyZWFrIGRvdWJsZVwiPjwvZGl2PjxsYWJlbCBmb3I9XCJrZXl3b3Jkc1wiPktleXdvcmRzPC9sYWJlbD48dGV4dGFyZWEgaWQ9XCJrZXl3b3Jkc1wiIG5hbWU9XCJtZXRhS2V5d29yZHNcIj4nKTtcbnZhciBfX3ZhbF9fID0gc2l0ZS5jb25maWcubWV0YUtleXdvcmRzXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L3RleHRhcmVhPjxkaXYgY2xhc3M9XCJub3RlXCI+U2VwYXJhdGUgbWV0YSBrZXl3b3JkcyB3aXRoIGNvbW1hczwvZGl2PjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxsYWJlbCBmb3I9XCJzdHlsZVwiPlN0eWxlPC9sYWJlbD48dGV4dGFyZWEgaWQ9XCJzdHlsZVwiIG5hbWU9XCJzdHlsZVwiPicpO1xudmFyIF9fdmFsX18gPSBzaXRlLmNvbmZpZy5zdHlsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC90ZXh0YXJlYT48ZGl2IGNsYXNzPVwibm90ZVwiPlBhc3RlPGEgaHJlZj1cImh0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS9jc3NyZWYvXCIgdGFyZ2V0PVwiX2JsYW5rXCI+Q1NTPC9hPm9yIDxhIGhyZWY9XCJodHRwOi8vbGVhcm5ib29zdC5naXRodWIuaW8vc3R5bHVzL1wiIHRhcmdldD1cIl9ibGFua1wiPlN0eWx1czwvYT5jb2RlIGluIGFib3ZlPC9kaXY+PGRpdiBjbGFzcz1cImJyZWFrXCI+PC9kaXY+PGxhYmVsIGZvcj1cImFuYWx5dGljc1wiPkFuYWx5dGljczwvbGFiZWw+PHRleHRhcmVhIGlkPVwiYW5hbHl0aWNzXCIgbmFtZT1cImFuYWx5dGljc1wiPicpO1xudmFyIF9fdmFsX18gPSBhbmFseXRpY3NcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvdGV4dGFyZWE+PGRpdiBjbGFzcz1cIm5vdGVcIj5QYXN0ZSBKYXZhc2NyaXB0IGNvZGUgYWJvdmUsIGV4Y2x1ZGluZyAmbHQ7c2NyaXB0Jmd0OyB0YWdzPC9kaXY+PC9maWVsZHNldD48ZGl2IGNsYXNzPVwidG9vbHRpcFwiPjwvZGl2PjxidXR0b24gdHlwZT1cInN1Ym1pdFwiIHZhbHVlPVwiU2F2ZVwiPlNhdmU8L2J1dHRvbj48aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJhY3Rpb25cIiB2YWx1ZT1cImdlbmVyYWxcIi8+PC9mb3JtPicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJhZG1pbi1pbnZpdGVzXCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xuYnVmLnB1c2goJzxmb3JtIGFjdGlvbj1cIi9yZXNvdXJjZXMvdXNlcnNcIiBtZXRob2Q9XCJwb3N0XCIgY2xhc3M9XCJvbmNsaWNrLXN1Ym1pdFwiPjxmaWVsZHNldD48bGFiZWwgZm9yPVwiZW1haWxzXCI+RW1haWxzPC9sYWJlbD48aW5wdXQgaWQ9XCJlbWFpbHNcIiBuYW1lPVwiZW1haWxzXCIgdHlwZT1cInRleHRcIiBjbGFzcz1cImVtYWlscyBjbGVhclwiLz48ZGl2IGNsYXNzPVwibm90ZVwiPlNlcGFyYXRlZCBieSBjb21tYXM8L2Rpdj48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48bGFiZWwgZm9yPVwibWVzc2FnZVwiPk1lc3NhZ2U8L2xhYmVsPjx0ZXh0YXJlYSBpZD1cIm1lc3NhZ2VcIiBuYW1lPVwibWVzc2FnZVwiPjwvdGV4dGFyZWE+PC9maWVsZHNldD48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiB2YWx1ZT1cIlNlbmRcIj5TZW5kPC9idXR0b24+PGRpdiBkYXRhLW1zZz1cIkludml0ZXMgc2VudCFcIiBjbGFzcz1cInRvb2x0aXBcIj48L2Rpdj48aW5wdXQgdHlwZT1cImhpZGRlblwiIG5hbWU9XCJhY3Rpb25cIiB2YWx1ZT1cImludml0ZXNcIi8+PC9mb3JtPicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJhZG1pbi1uYXZcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPjxtZW51PjxsaSBjbGFzcz1cImdlbmVyYWxcIj48YSBocmVmPVwiL2FkbWluXCIgY2xhc3M9XCJtdXRhbnRcIj5HZW5lcmFsPC9hPjwvbGk+PGxpIGNsYXNzPVwibWVudVwiPjxhIGhyZWY9XCIvYWRtaW4vbWVudVwiIGNsYXNzPVwibXV0YW50XCI+TWVudTwvYT48L2xpPjxsaSBjbGFzcz1cImludml0ZXNcIj48YSBocmVmPVwiL2FkbWluL2ludml0ZXNcIiBjbGFzcz1cIm11dGFudFwiPkludml0ZXM8L2E+PC9saT48bGkgY2xhc3M9XCJkb21haW5zXCI+PGEgaHJlZj1cIi9hZG1pbi9kb21haW5zXCIgY2xhc3M9XCJtdXRhbnRcIj5Eb21haW5zPC9hPjwvbGk+PGxpIGNsYXNzPVwiZmVhdHVyZSB1cGdyYWRlXCI+PGEgaHJlZj1cIi9hZG1pbi91cGdyYWRlXCIgY2xhc3M9XCJtdXRhbnRcIj5QUk88L2E+PC9saT48L21lbnU+PC9kaXY+Jyk7XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcInNlYXJjaFwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG52YXIgX3Bvc3RfcHJvZmlsZV9taXhpbiA9IGZ1bmN0aW9uKHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXAudXNlcl9waG90bykgcC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvdXNlci9cIiArIChwLnVzZXJfbmFtZSkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3VzZXInKSArICcgJyArICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+Jyk7XG5pZiAoIHAudXNlcl9waG90byAmJiBwLnVzZXJfcGhvdG8ubWF0Y2goL15odHRwLykpXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOihwLnVzZXJfbmFtZSksICdzcmMnOihcIlwiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArIChwLnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvYT4nKTtcbn07XG52YXIgX3Bvc3RfbWl4aW4gPSBmdW5jdGlvbihwLCBpKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihcInBvc3RfXCIgKyAocC5pZCkgKyBcIlwiKSwgJ2RhdGEtdXNlci1pZCc6KHAudXNlcl9pZCksICdkYXRhLXBvc3QtaWQnOihwLmlkKSwgJ2RhdGEtdGhyZWFkLWlkJzoocC50aHJlYWRfaWQpLCAnZGF0YS1mb3J1bS1pZCc6KHAuZm9ydW1faWQpLCBcImNsYXNzXCI6ICgncG9zdCcpICsgJyAnICsgKHAucmVhc29uID8gJ2NlbnNvcmVkJyA6ICcnKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlLFwiZGF0YS1wb3N0LWlkXCI6dHJ1ZSxcImRhdGEtdGhyZWFkLWlkXCI6dHJ1ZSxcImRhdGEtZm9ydW0taWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbmlmICggcC50aHJlYWRfdXJpKVxue1xuYnVmLnB1c2goJzxoNCBjbGFzcz1cInRpdGxlXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnRocmVhZF91cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9oND4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PicpO1xufVxuX3Bvc3RfcHJvZmlsZV9taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PHNwYW4gY2xhc3M9XCJ1c2VybmFtZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnVzZXJfbmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHAuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnZGF0ZScpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48ZGl2IGNsYXNzPVwicG9zdC1jb250ZW50XCI+Jyk7XG5pZiAoIHAuaHRtbClcbntcbmJ1Zi5wdXNoKCc8cCBjbGFzcz1cImJvZHlcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC5odG1sXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9wPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvZGl2PicpO1xuX3Bvc3RfYWN0aW9uc19taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwicmVwbHlcIj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiY2hpbGRyZW5cIj4nKTtcbmlmICggcC5wb3N0cyAmJiBwLnBvc3RzLmxlbmd0aClcbntcbi8vIGl0ZXJhdGUgcC5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHAucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwLCAkJGwgPSBwLnBvc3RzLmxlbmd0aDsgaWkgPCAkJGw7IGlpKyspIHtcbiAgICAgIHZhciBwcCA9IHAucG9zdHNbaWldO1xuXG5fcG9zdF9taXhpbihwcCwgaWkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiBwLnBvc3RzKSB7XG4gICAgICB2YXIgcHAgPSBwLnBvc3RzW2lpXTtcblxuX3Bvc3RfbWl4aW4ocHAsIGlpKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZSBpZiAoIHAubW9yZVBvc3RzKVxue1xuYnVmLnB1c2goJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJsb2FkLW1vcmVcIj5Nb3JlIFBvc3RzPC9hPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufTtcbmJ1Zi5wdXNoKCc8ZGl2IGlkPVwiYnJlYWRjcnVtYlwiIGNsYXNzPVwiYnJlYWRjcnVtYlwiPjxkaXYgaWQ9XCJuZXdfaGl0c1wiPjwvZGl2PjwvZGl2PicpO1xudmFyIHN1ZmZpeCA9IChlbHJlcy50b3RhbCA9PSAxID8gJycgOiAncycpO1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJzZWFyY2ggcmVzaXphYmxlXCI+PGVtIGlkPVwiaGl0X2NvdW50XCI+PGI+JyArIGVzY2FwZSgoaW50ZXJwID0gZWxyZXMudG90YWwpID09IG51bGwgPyAnJyA6IGludGVycCkgKyAnIGhpdCcgKyBlc2NhcGUoKGludGVycCA9IHN1ZmZpeCkgPT0gbnVsbCA/ICcnIDogaW50ZXJwKSArICc8L2I+PC9lbT48c3BhbiBpZD1cIm5ld19oaXRfY291bnRcIj48YSBocmVmPVwiI1wiIG9uY2xpY2s9XCJzaG93TmV3SGl0cygpXCI+LSA8c3BhbiBjbGFzcz1cImNvdW50XCI+MCA8L3NwYW4+bmV3ITwvYT48L3NwYW4+PGRpdiBpZD1cIm5ld19wb3N0c1wiPjwvZGl2PicpO1xuaWYgKCBlbHJlcy5oaXRzLmxlbmd0aClcbntcbi8vIGl0ZXJhdGUgZWxyZXMuaGl0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGVscmVzLmhpdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gZWxyZXMuaGl0cy5sZW5ndGg7ICRpbmRleCA8ICQkbDsgJGluZGV4KyspIHtcbiAgICAgIHZhciBoaXQgPSBlbHJlcy5oaXRzWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8IS0tIGFsd2F5cyB1c2UgdGhyZWFkIHRpdGxlLS0+Jyk7XG4gaGl0Ll9zb3VyY2UudGl0bGUgPSBoaXQuX3NvdXJjZS50aHJlYWRfdGl0bGVcbmlmICggZW52ICE9ICdwcm9kdWN0aW9uJylcbntcbmJ1Zi5wdXNoKCc8IS0tIHNob3cgc2NvcmUgaW4gZGV2IG1vZGUtLT4nKTtcbiBoaXQuX3NvdXJjZS50aXRsZSA9IGhpdC5fc291cmNlLnRpdGxlICsgJyAoc2NvcmU6ICcgKyBoaXQuX3Njb3JlICsgJyApJ1xufVxuaWYgKCBoaXQuX3NvdXJjZS5pZCA9PSBoaXQuX3NvdXJjZS50aHJlYWRfaWQpXG57XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cInRocmVhZC1oaXRcIj4nKTtcbl9wb3N0X21peGluKGhpdC5fc291cmNlLCAwKTtcbmJ1Zi5wdXNoKCc8L2Rpdj4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29tbWVudC1oaXRcIj4nKTtcbl9wb3N0X21peGluKGhpdC5fc291cmNlLCAwKTtcbmJ1Zi5wdXNoKCc8L2Rpdj4nKTtcbn1cbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgZm9yICh2YXIgJGluZGV4IGluIGVscmVzLmhpdHMpIHtcbiAgICAgIHZhciBoaXQgPSBlbHJlcy5oaXRzWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8IS0tIGFsd2F5cyB1c2UgdGhyZWFkIHRpdGxlLS0+Jyk7XG4gaGl0Ll9zb3VyY2UudGl0bGUgPSBoaXQuX3NvdXJjZS50aHJlYWRfdGl0bGVcbmlmICggZW52ICE9ICdwcm9kdWN0aW9uJylcbntcbmJ1Zi5wdXNoKCc8IS0tIHNob3cgc2NvcmUgaW4gZGV2IG1vZGUtLT4nKTtcbiBoaXQuX3NvdXJjZS50aXRsZSA9IGhpdC5fc291cmNlLnRpdGxlICsgJyAoc2NvcmU6ICcgKyBoaXQuX3Njb3JlICsgJyApJ1xufVxuaWYgKCBoaXQuX3NvdXJjZS5pZCA9PSBoaXQuX3NvdXJjZS50aHJlYWRfaWQpXG57XG5idWYucHVzaCgnPGRpdiBjbGFzcz1cInRocmVhZC1oaXRcIj4nKTtcbl9wb3N0X21peGluKGhpdC5fc291cmNlLCAwKTtcbmJ1Zi5wdXNoKCc8L2Rpdj4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29tbWVudC1oaXRcIj4nKTtcbl9wb3N0X21peGluKGhpdC5fc291cmNlLCAwKTtcbmJ1Zi5wdXNoKCc8L2Rpdj4nKTtcbn1cbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZVxue1xuYnVmLnB1c2goJzxoND5UcnkgYSBtb3JlIGdlbmVyYWwgc2VhcmNoPGk+ITwvaT48L2g0PicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJzZWFyY2gtZmlsdGVyc1wiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBmb3J1bU9wdGlvbnNfbWl4aW4gPSBmdW5jdGlvbihmb3J1bXMsIHByZWZpeCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuLy8gaXRlcmF0ZSBmb3J1bXNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiBmb3J1bXMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gZm9ydW1zLmxlbmd0aDsgJGluZGV4IDwgJCRsOyAkaW5kZXgrKykge1xuICAgICAgdmFyIGYgPSBmb3J1bXNbJGluZGV4XTtcblxuYnVmLnB1c2goJzxvcHRpb24nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3ZhbHVlJzooZi5pZCkgfSwge1widmFsdWVcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gcHJlZml4ICsgZi50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9vcHRpb24+Jyk7XG5mb3J1bU9wdGlvbnNfbWl4aW4oZi5mb3J1bXMsICctJyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyICRpbmRleCBpbiBmb3J1bXMpIHtcbiAgICAgIHZhciBmID0gZm9ydW1zWyRpbmRleF07XG5cbmJ1Zi5wdXNoKCc8b3B0aW9uJyk7XG5idWYucHVzaChhdHRycyh7ICd2YWx1ZSc6KGYuaWQpIH0sIHtcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHByZWZpeCArIGYudGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvb3B0aW9uPicpO1xuZm9ydW1PcHRpb25zX21peGluKGYuZm9ydW1zLCAnLScpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG59O1xuYnVmLnB1c2goJzxkaXYgaWQ9XCJzZWFyY2hfZmlsdGVyc1wiPjxkaXY+PGxhYmVsPjxoND5GaWx0ZXIgYnkgRm9ydW08L2g0PjxzZWxlY3QgbmFtZT1cImZvcnVtX2lkXCI+PG9wdGlvbiB2YWx1ZT1cIlwiPi0gQWxsIC08L29wdGlvbj4nKTtcbmZvcnVtT3B0aW9uc19taXhpbihtZW51LCAnJyk7XG5idWYucHVzaCgnPC9zZWxlY3Q+PC9sYWJlbD48L2Rpdj48ZGl2PjxsYWJlbD48aDQ+V2l0aGluIGEgVGltZWZyYW1lPC9oND48c2VsZWN0IG5hbWU9XCJ3aXRoaW5cIj48b3B0aW9uIHZhbHVlPVwiXCI+LSBBbnkgVGltZSAtPC9vcHRpb24+PG9wdGlvbiB2YWx1ZT1cImRheVwiPldpdGhpbiBMYXN0IERheTwvb3B0aW9uPjxvcHRpb24gdmFsdWU9XCJ3ZWVrXCI+V2l0aGluIExhc3QgV2Vlazwvb3B0aW9uPjxvcHRpb24gdmFsdWU9XCJtb250aFwiPldpdGhpbiBMYXN0IE1vbnRoPC9vcHRpb24+PC9zZWxlY3Q+PC9sYWJlbD48L2Rpdj48L2Rpdj4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wic2VhcmNoLWZhY2V0c1wiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbmJ1Zi5wdXNoKCc8ZGl2IGlkPVwic2VhcmNoX2ZhY2V0c1wiPjxkaXYgc3R5bGU9XCJoZWlnaHQ6MzBweFwiPjwvZGl2PicpO1xuaWYgKCBmYWNldHMuZm9ydW0ubGVuZ3RoID4gMSlcbntcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiZmFjZXRcIj48ZGl2IGNsYXNzPVwiZmFjZXQtdGl0bGVcIj5IaXRzIGJ5IEZvcnVtPC9kaXY+Jyk7XG4vLyBpdGVyYXRlIGZhY2V0cy5mb3J1bVxuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIGZhY2V0cy5mb3J1bS5sZW5ndGgpIHtcbiAgICBmb3IgKHZhciAkaW5kZXggPSAwLCAkJGwgPSBmYWNldHMuZm9ydW0ubGVuZ3RoOyAkaW5kZXggPCAkJGw7ICRpbmRleCsrKSB7XG4gICAgICB2YXIgZm9ydW0gPSBmYWNldHMuZm9ydW1bJGluZGV4XTtcblxuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooZm9ydW0udXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpICsgJyAnICsgKCdmYWNldC1oaXQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGVtPicpO1xudmFyIF9fdmFsX18gPSBmb3J1bS5oaXRDb3VudFxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9lbT48c3Bhbj4nKTtcbnZhciBfX3ZhbF9fID0gZm9ydW0udGl0bGVcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvc3Bhbj48L2E+Jyk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyICRpbmRleCBpbiBmYWNldHMuZm9ydW0pIHtcbiAgICAgIHZhciBmb3J1bSA9IGZhY2V0cy5mb3J1bVskaW5kZXhdO1xuXG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihmb3J1bS51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgKyAnICcgKyAoJ2ZhY2V0LWhpdCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48ZW0+Jyk7XG52YXIgX192YWxfXyA9IGZvcnVtLmhpdENvdW50XG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2VtPjxzcGFuPicpO1xudmFyIF9fdmFsX18gPSBmb3J1bS50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjwvYT4nKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJfX3RocmVhZHNcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX3RocmVhZF9taXhpbiA9IGZ1bmN0aW9uKHQpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXQudXNlcl9waG90bykgdC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxsaScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1pZCc6KHQuaWQpLCAnZGF0YS11c2VyLWlkJzoodC51c2VyX2lkKSwgXCJjbGFzc1wiOiAoJ3RocmVhZCcpIH0sIHtcImRhdGEtaWRcIjp0cnVlLFwiZGF0YS11c2VyLWlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtc3VyZic6KHQuZm9ydW1faWQpLCAnaHJlZic6KHQudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImRhdGEtc3VyZlwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGg0IGNsYXNzPVwidGl0bGVcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oND48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48ZGl2IGNsYXNzPVwicHJvZmlsZSBwaG90b1wiPjxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCJcIiArICh0LnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjwvZGl2PjxkaXYgY2xhc3M9XCJjb250YWluZXJcIj48c3BhbiBjbGFzcz1cInVzZXJuYW1lXCI+Ynk8ZW0+Jyk7XG52YXIgX192YWxfXyA9IHQudXNlcl9uYW1lIC8vIFhYWCB3ZWlyZCB0aGluZ3MgaGFwcGVuZWQgd2hlbiBJIHRyaWVkIHRvIHR1cm4gdGhpcyBpbnRvIGFuIGFuY2hvclxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9lbT48L3NwYW4+PHNwYW4nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHQuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnY3JlYXRlZCcpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSB0LmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L3NwYW4+PGRpdiBjbGFzcz1cImNsZWFyXCI+PC9kaXY+PHNwYW4gY2xhc3M9XCJwb3N0LWNvdW50XCI+Jyk7XG52YXIgX192YWxfXyA9IHQucG9zdF9jb3VudFxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+cG9zdHM8L2k+PC9zcGFuPjxzcGFuIGNsYXNzPVwidmlld3NcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC52aWV3c1xuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+dmlld3M8L2k+PC9zcGFuPjwvZGl2PjwvYT48L2xpPicpO1xufTtcbmJ1Zi5wdXNoKCc8dWwgY2xhc3M9XCJ0aHJlYWRzXCI+Jyk7XG4vLyBpdGVyYXRlIHRvcFRocmVhZHNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiB0b3BUaHJlYWRzLmxlbmd0aCkge1xuICAgIGZvciAodmFyIGlpID0gMCwgJCRsID0gdG9wVGhyZWFkcy5sZW5ndGg7IGlpIDwgJCRsOyBpaSsrKSB7XG4gICAgICB2YXIgdCA9IHRvcFRocmVhZHNbaWldO1xuXG5fdGhyZWFkX21peGluKHQpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiB0b3BUaHJlYWRzKSB7XG4gICAgICB2YXIgdCA9IHRvcFRocmVhZHNbaWldO1xuXG5fdGhyZWFkX21peGluKHQpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPC91bD4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiX2JyZWFkY3J1bWJcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX2JyZWFkY3J1bWJfbWl4aW4gPSBmdW5jdGlvbihwKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG52YXIgcGF0aCA9ICgnJyk7XG52YXIgcGFydHMgPSAocC51cmkuc3BsaXQoJy8nKSk7XG52YXIgcGFydHMgPSAocGFydHMuc3BsaWNlKDEsIHBhcnRzLmxlbmd0aC0yKSk7XG4vLyBpdGVyYXRlIHBhcnRzXG47KGZ1bmN0aW9uKCl7XG4gIGlmICgnbnVtYmVyJyA9PSB0eXBlb2YgcGFydHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgJGluZGV4ID0gMCwgJCRsID0gcGFydHMubGVuZ3RoOyAkaW5kZXggPCAkJGw7ICRpbmRleCsrKSB7XG4gICAgICB2YXIgcGFydCA9IHBhcnRzWyRpbmRleF07XG5cbmlmICggcGFydCAhPSAndCcpXG57XG5idWYucHVzaCgnPGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihcIi9cIiArIChwYXRoKSArIFwiXCIgKyAocGFydCkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbnZhciBfX3ZhbF9fID0gcGFydC5yZXBsYWNlKCctJywgJyAnKVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9hPjxzcGFuPi88L3NwYW4+Jyk7XG59XG4gcGF0aCA9IHBhdGggKyBwYXJ0ICsgJy8nXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGZvciAodmFyICRpbmRleCBpbiBwYXJ0cykge1xuICAgICAgdmFyIHBhcnQgPSBwYXJ0c1skaW5kZXhdO1xuXG5pZiAoIHBhcnQgIT0gJ3QnKVxue1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvXCIgKyAocGF0aCkgKyBcIlwiICsgKHBhcnQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHBhcnQucmVwbGFjZSgnLScsICcgJylcbmJ1Zi5wdXNoKGVzY2FwZShudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXykpO1xuYnVmLnB1c2goJzwvYT48c3Bhbj4vPC9zcGFuPicpO1xufVxuIHBhdGggPSBwYXRoICsgcGFydCArICcvJ1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPGVtPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2VtPicpO1xufTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiX3Bvc3QtYWN0aW9uc1wiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG59XG5yZXR1cm4gYnVmLmpvaW4oXCJcIik7XG59XG5qYWRlLnRlbXBsYXRlc1tcIl9wb3N0LWVkaXRcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX3Bvc3RfZWRpdF9taXhpbiA9IGZ1bmN0aW9uKHUsIHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbnZhciBodG1sX2lkID0gKHAuaWQgPyBcIl8je3AuaWR9XCIgOiAnJyk7XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihwLmlzX2NvbW1lbnQgPyBodG1sX2lkIDogJ3Bvc3RfZWRpdCcpLCBcImNsYXNzXCI6ICgncG9zdC1lZGl0JykgKyAnICcgKyAoJ29uY2xpY2stc3VibWl0JykgKyAnICcgKyAocC5pc19jb21tZW50ID8gJ2NvbW1lbnQnIDogJycpIH0sIHtcImNsYXNzXCI6dHJ1ZSxcImlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGZvcm0nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2FjdGlvbic6KFwiL3Jlc291cmNlcy9wb3N0c1wiKSwgJ21ldGhvZCc6KFwiXCIgKyAocC5tZXRob2QgfHwgJ3B1dCcpICsgXCJcIikgfSwge1wiYWN0aW9uXCI6dHJ1ZSxcIm1ldGhvZFwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJ0b29sdGlwXCI+PC9kaXY+PGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS11c2VyLWlkJzoodS5pZCksIFwiY2xhc3NcIjogKCdzdW1tYXJ5JykgfSwge1wiZGF0YS11c2VyLWlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArICh1LnBob3RvIHx8ICdpbWFnZXMvcHJvZmlsZS5qcGcnKSArIFwiXCIpLCBcImNsYXNzXCI6ICgncHJvZmlsZScpICsgJyAnICsgKCdwaG90bycpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz48L2Rpdj4nKTtcbmlmICggIXAuaXNfY29tbWVudClcbntcbmJ1Zi5wdXNoKCc8aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ25hbWUnOigndGl0bGUnKSwgJ3R5cGUnOigndGV4dCcpLCAncGxhY2Vob2xkZXInOignVGl0bGUnKSwgJ3ZhbHVlJzoocC50aXRsZSksIFwiY2xhc3NcIjogKCd0aXRsZScpIH0sIHtcIm5hbWVcIjp0cnVlLFwidHlwZVwiOnRydWUsXCJwbGFjZWhvbGRlclwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmJ1Zi5wdXNoKCc8dGV4dGFyZWEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2lkJzooXCJlZGl0b3JcIiArIChwLmlzX2NvbW1lbnQgPyBodG1sX2lkIDogJycpICsgXCJcIiksICduYW1lJzooJ2JvZHknKSwgJ3BsYWNlaG9sZGVyJzooJ0NvbW1lbnQgLi4uJyksIFwiY2xhc3NcIjogKCdib2R5JykgKyAnICcgKyAoJ29uc2hpZnRlbnRlci1zdWJtaXQnKSB9LCB7XCJpZFwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInBsYWNlaG9sZGVyXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHAuYm9keVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC90ZXh0YXJlYT48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ2lkJyksICd2YWx1ZSc6KHAuaWQpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ2ZvcnVtX2lkJyksICd2YWx1ZSc6KHAuZm9ydW1faWQpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48aW5wdXQnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3R5cGUnOignaGlkZGVuJyksICduYW1lJzooJ3BhcmVudF9pZCcpLCAndmFsdWUnOihwLnBhcmVudF9pZCkgfSwge1widHlwZVwiOnRydWUsXCJuYW1lXCI6dHJ1ZSxcInZhbHVlXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjxpbnB1dCcpO1xuYnVmLnB1c2goYXR0cnMoeyAndHlwZSc6KCdoaWRkZW4nKSwgJ25hbWUnOignY3NyZicpLCAndmFsdWUnOihwLmNzcmYpIH0sIHtcInR5cGVcIjp0cnVlLFwibmFtZVwiOnRydWUsXCJ2YWx1ZVwiOnRydWV9KSk7XG5idWYucHVzaCgnLz48YnV0dG9uIHR5cGU9XCJzdWJtaXRcIiBuYW1lPVwic3VibWl0XCIgdmFsdWU9XCJTYXZlXCI+U2F2ZTwvYnV0dG9uPjxkaXYgY2xhc3M9XCJjbG9zZSBjYW5jZWxcIj5YPC9kaXY+PC9mb3JtPjxkaXYgY2xhc3M9XCJwcmV2aWV3XCI+PC9kaXY+PC9kaXY+Jyk7XG59O1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJfcG9zdC1wcm9maWxlXCJdID0gZnVuY3Rpb24obG9jYWxzLCBhdHRycywgZXNjYXBlLCByZXRocm93LCBtZXJnZSkge1xuYXR0cnMgPSBhdHRycyB8fCBqYWRlLmF0dHJzOyBlc2NhcGUgPSBlc2NhcGUgfHwgamFkZS5lc2NhcGU7IHJldGhyb3cgPSByZXRocm93IHx8IGphZGUucmV0aHJvdzsgbWVyZ2UgPSBtZXJnZSB8fCBqYWRlLm1lcmdlO1xudmFyIGJ1ZiA9IFtdO1xud2l0aCAobG9jYWxzIHx8IHt9KSB7XG52YXIgaW50ZXJwO1xudmFyIF9wb3N0X3Byb2ZpbGVfbWl4aW4gPSBmdW5jdGlvbihwKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG4gaWYgKCFwLnVzZXJfcGhvdG8pIHAudXNlcl9waG90byA9IGNhY2hlVXJsICsgJ2ltYWdlcy9wcm9maWxlLmpwZydcbmJ1Zi5wdXNoKCc8YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnaHJlZic6KFwiL3VzZXIvXCIgKyAocC51c2VyX25hbWUpICsgXCJcIiksIFwiY2xhc3NcIjogKCd1c2VyJykgKyAnICcgKyAoJ211dGFudCcpIH0sIHtcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48ZGl2IGNsYXNzPVwicHJvZmlsZSBwaG90b1wiPicpO1xuaWYgKCBwLnVzZXJfcGhvdG8gJiYgcC51c2VyX3Bob3RvLm1hdGNoKC9eaHR0cC8pKVxue1xuYnVmLnB1c2goJzxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3RpdGxlJzoocC51c2VyX25hbWUpLCAnc3JjJzooXCJcIiArIChwLnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1widGl0bGVcIjp0cnVlLFwic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuZWxzZVxue1xuYnVmLnB1c2goJzxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCIvXCIgKyAocC51c2VyX3Bob3RvKSArIFwiXCIpIH0sIHtcInNyY1wiOnRydWV9KSk7XG5idWYucHVzaCgnLz4nKTtcbn1cbmJ1Zi5wdXNoKCc8L2Rpdj48L2E+Jyk7XG59O1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJfcG9zdFwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfcG9zdF9hY3Rpb25zX21peGluID0gZnVuY3Rpb24ocCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuYnVmLnB1c2goJzxkaXYgY2xhc3M9XCJhY3Rpb25zXCI+PGEgY2xhc3M9XCJzdHlsaXNoIG9uY2xpY2stYXBwZW5kLXJlcGx5LXVpXCI+Q29tbWVudDwvYT48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1lZGl0JzoocC5pZCksICdocmVmJzooXCJcIiArIChwLnVyaS5yZXBsYWNlKC9cXC9cXGQrJC8sICcnKSkgKyBcIi9lZGl0L1wiICsgKHAuaWQpICsgXCJcIiksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ2VkaXQnKSArICcgJyArICgnbXV0YW50JykgKyAnICcgKyAoJ25vLXN1cmYnKSB9LCB7XCJkYXRhLWVkaXRcIjp0cnVlLFwiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPkVkaXQ8L2E+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnVyaSksIFwiY2xhc3NcIjogKCdzdHlsaXNoJykgKyAnICcgKyAoJ3Blcm1hbGluaycpICsgJyAnICsgKCdtdXRhbnQnKSB9LCB7XCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+UGVybWFsaW5rPC9hPjxhIGNsYXNzPVwic3R5bGlzaCBjZW5zb3Igb25jbGljay1jZW5zb3ItcG9zdFwiPkNlbnNvcjwvYT48L2Rpdj4nKTtcbn07XG52YXIgX3Bvc3RfcHJvZmlsZV9taXhpbiA9IGZ1bmN0aW9uKHApe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXAudXNlcl9waG90bykgcC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxhJyk7XG5idWYucHVzaChhdHRycyh7ICdocmVmJzooXCIvdXNlci9cIiArIChwLnVzZXJfbmFtZSkgKyBcIlwiKSwgXCJjbGFzc1wiOiAoJ3VzZXInKSArICcgJyArICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+Jyk7XG5pZiAoIHAudXNlcl9waG90byAmJiBwLnVzZXJfcGhvdG8ubWF0Y2goL15odHRwLykpXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAndGl0bGUnOihwLnVzZXJfbmFtZSksICdzcmMnOihcIlwiICsgKHAudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJ0aXRsZVwiOnRydWUsXCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+Jyk7XG59XG5lbHNlXG57XG5idWYucHVzaCgnPGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIi9cIiArIChwLnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvYT4nKTtcbn07XG52YXIgX3Bvc3RfbWl4aW4gPSBmdW5jdGlvbihwLCBpKXtcbnZhciBibG9jayA9IHRoaXMuYmxvY2ssIGF0dHJpYnV0ZXMgPSB0aGlzLmF0dHJpYnV0ZXMgfHwge30sIGVzY2FwZWQgPSB0aGlzLmVzY2FwZWQgfHwge307XG5idWYucHVzaCgnPGRpdicpO1xuYnVmLnB1c2goYXR0cnMoeyAnaWQnOihcInBvc3RfXCIgKyAocC5pZCkgKyBcIlwiKSwgJ2RhdGEtdXNlci1pZCc6KHAudXNlcl9pZCksICdkYXRhLXBvc3QtaWQnOihwLmlkKSwgJ2RhdGEtdGhyZWFkLWlkJzoocC50aHJlYWRfaWQpLCAnZGF0YS1mb3J1bS1pZCc6KHAuZm9ydW1faWQpLCBcImNsYXNzXCI6ICgncG9zdCcpICsgJyAnICsgKHAucmVhc29uID8gJ2NlbnNvcmVkJyA6ICcnKSB9LCB7XCJjbGFzc1wiOnRydWUsXCJpZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlLFwiZGF0YS1wb3N0LWlkXCI6dHJ1ZSxcImRhdGEtdGhyZWFkLWlkXCI6dHJ1ZSxcImRhdGEtZm9ydW0taWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz4nKTtcbmlmICggcC50aHJlYWRfdXJpKVxue1xuYnVmLnB1c2goJzxoNCBjbGFzcz1cInRpdGxlXCI+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2hyZWYnOihwLnRocmVhZF91cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiaHJlZlwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2E+PC9oND4nKTtcbn1cbmVsc2VcbntcbmJ1Zi5wdXNoKCc8aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PicpO1xufVxuX3Bvc3RfcHJvZmlsZV9taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwiY29udGFpbmVyXCI+PHNwYW4gY2xhc3M9XCJ1c2VybmFtZVwiPicpO1xudmFyIF9fdmFsX18gPSBwLnVzZXJfbmFtZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9zcGFuPjxkaXYnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHAuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnZGF0ZScpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSBwLmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L2Rpdj48ZGl2IGNsYXNzPVwicG9zdC1jb250ZW50XCI+Jyk7XG5pZiAoIHAuaHRtbClcbntcbmJ1Zi5wdXNoKCc8cCBjbGFzcz1cImJvZHlcIj4nKTtcbnZhciBfX3ZhbF9fID0gcC5odG1sXG5idWYucHVzaChudWxsID09IF9fdmFsX18gPyBcIlwiIDogX192YWxfXyk7XG5idWYucHVzaCgnPC9wPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PjwvZGl2PicpO1xuX3Bvc3RfYWN0aW9uc19taXhpbihwKTtcbmJ1Zi5wdXNoKCc8ZGl2IGNsYXNzPVwicmVwbHlcIj48L2Rpdj48L2Rpdj48ZGl2IGNsYXNzPVwiY2hpbGRyZW5cIj4nKTtcbmlmICggcC5wb3N0cyAmJiBwLnBvc3RzLmxlbmd0aClcbntcbi8vIGl0ZXJhdGUgcC5wb3N0c1xuOyhmdW5jdGlvbigpe1xuICBpZiAoJ251bWJlcicgPT0gdHlwZW9mIHAucG9zdHMubGVuZ3RoKSB7XG4gICAgZm9yICh2YXIgaWkgPSAwLCAkJGwgPSBwLnBvc3RzLmxlbmd0aDsgaWkgPCAkJGw7IGlpKyspIHtcbiAgICAgIHZhciBwcCA9IHAucG9zdHNbaWldO1xuXG5fcG9zdF9taXhpbihwcCwgaWkpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiBwLnBvc3RzKSB7XG4gICAgICB2YXIgcHAgPSBwLnBvc3RzW2lpXTtcblxuX3Bvc3RfbWl4aW4ocHAsIGlpKTtcbiAgIH1cbiAgfVxufSkuY2FsbCh0aGlzKTtcblxufVxuZWxzZSBpZiAoIHAubW9yZVBvc3RzKVxue1xuYnVmLnB1c2goJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJsb2FkLW1vcmVcIj5Nb3JlIFBvc3RzPC9hPicpO1xufVxuYnVmLnB1c2goJzwvZGl2PicpO1xufTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn1cbmphZGUudGVtcGxhdGVzW1wiX3RocmVhZFwiXSA9IGZ1bmN0aW9uKGxvY2FscywgYXR0cnMsIGVzY2FwZSwgcmV0aHJvdywgbWVyZ2UpIHtcbmF0dHJzID0gYXR0cnMgfHwgamFkZS5hdHRyczsgZXNjYXBlID0gZXNjYXBlIHx8IGphZGUuZXNjYXBlOyByZXRocm93ID0gcmV0aHJvdyB8fCBqYWRlLnJldGhyb3c7IG1lcmdlID0gbWVyZ2UgfHwgamFkZS5tZXJnZTtcbnZhciBidWYgPSBbXTtcbndpdGggKGxvY2FscyB8fCB7fSkge1xudmFyIGludGVycDtcbnZhciBfdGhyZWFkX21peGluID0gZnVuY3Rpb24odCl7XG52YXIgYmxvY2sgPSB0aGlzLmJsb2NrLCBhdHRyaWJ1dGVzID0gdGhpcy5hdHRyaWJ1dGVzIHx8IHt9LCBlc2NhcGVkID0gdGhpcy5lc2NhcGVkIHx8IHt9O1xuIGlmICghdC51c2VyX3Bob3RvKSB0LnVzZXJfcGhvdG8gPSBjYWNoZVVybCArICdpbWFnZXMvcHJvZmlsZS5qcGcnXG5idWYucHVzaCgnPGxpJyk7XG5idWYucHVzaChhdHRycyh7ICdkYXRhLWlkJzoodC5pZCksICdkYXRhLXVzZXItaWQnOih0LnVzZXJfaWQpLCBcImNsYXNzXCI6ICgndGhyZWFkJykgfSwge1wiZGF0YS1pZFwiOnRydWUsXCJkYXRhLXVzZXItaWRcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48YScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1zdXJmJzoodC5mb3J1bV9pZCksICdocmVmJzoodC51cmkpLCBcImNsYXNzXCI6ICgnbXV0YW50JykgfSwge1wiZGF0YS1zdXJmXCI6dHJ1ZSxcImhyZWZcIjp0cnVlfSkpO1xuYnVmLnB1c2goJz48aDQgY2xhc3M9XCJ0aXRsZVwiPicpO1xudmFyIF9fdmFsX18gPSB0LnRpdGxlXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2g0PjxkaXYgY2xhc3M9XCJicmVha1wiPjwvZGl2PjxkaXYgY2xhc3M9XCJwcm9maWxlIHBob3RvXCI+PGltZycpO1xuYnVmLnB1c2goYXR0cnMoeyAnc3JjJzooXCJcIiArIChjYWNoZVVybCkgKyBcIlwiICsgKHQudXNlcl9waG90bykgKyBcIlwiKSB9LCB7XCJzcmNcIjp0cnVlfSkpO1xuYnVmLnB1c2goJy8+PC9kaXY+PGRpdiBjbGFzcz1cImNvbnRhaW5lclwiPjxzcGFuIGNsYXNzPVwidXNlcm5hbWVcIj5ieTxlbT4nKTtcbnZhciBfX3ZhbF9fID0gdC51c2VyX25hbWUgLy8gWFhYIHdlaXJkIHRoaW5ncyBoYXBwZW5lZCB3aGVuIEkgdHJpZWQgdG8gdHVybiB0aGlzIGludG8gYW4gYW5jaG9yXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8L2VtPjwvc3Bhbj48c3BhbicpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS10aW1lJzoodC5jcmVhdGVkX2lzbyksIFwiY2xhc3NcIjogKCdjcmVhdGVkJykgfSwge1wiZGF0YS10aW1lXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+Jyk7XG52YXIgX192YWxfXyA9IHQuY3JlYXRlZF9odW1hblxuYnVmLnB1c2gobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pO1xuYnVmLnB1c2goJzwvc3Bhbj48ZGl2IGNsYXNzPVwiY2xlYXJcIj48L2Rpdj48c3BhbiBjbGFzcz1cInBvc3QtY291bnRcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC5wb3N0X2NvdW50XG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8aT5wb3N0czwvaT48L3NwYW4+PHNwYW4gY2xhc3M9XCJ2aWV3c1wiPicpO1xudmFyIF9fdmFsX18gPSB0LnZpZXdzXG5idWYucHVzaChlc2NhcGUobnVsbCA9PSBfX3ZhbF9fID8gXCJcIiA6IF9fdmFsX18pKTtcbmJ1Zi5wdXNoKCc8aT52aWV3czwvaT48L3NwYW4+PC9kaXY+PC9hPjwvbGk+Jyk7XG59O1xufVxucmV0dXJuIGJ1Zi5qb2luKFwiXCIpO1xufVxuamFkZS50ZW1wbGF0ZXNbXCJfX3RocmVhZHNcIl0gPSBmdW5jdGlvbihsb2NhbHMsIGF0dHJzLCBlc2NhcGUsIHJldGhyb3csIG1lcmdlKSB7XG5hdHRycyA9IGF0dHJzIHx8IGphZGUuYXR0cnM7IGVzY2FwZSA9IGVzY2FwZSB8fCBqYWRlLmVzY2FwZTsgcmV0aHJvdyA9IHJldGhyb3cgfHwgamFkZS5yZXRocm93OyBtZXJnZSA9IG1lcmdlIHx8IGphZGUubWVyZ2U7XG52YXIgYnVmID0gW107XG53aXRoIChsb2NhbHMgfHwge30pIHtcbnZhciBpbnRlcnA7XG52YXIgX3RocmVhZF9taXhpbiA9IGZ1bmN0aW9uKHQpe1xudmFyIGJsb2NrID0gdGhpcy5ibG9jaywgYXR0cmlidXRlcyA9IHRoaXMuYXR0cmlidXRlcyB8fCB7fSwgZXNjYXBlZCA9IHRoaXMuZXNjYXBlZCB8fCB7fTtcbiBpZiAoIXQudXNlcl9waG90bykgdC51c2VyX3Bob3RvID0gY2FjaGVVcmwgKyAnaW1hZ2VzL3Byb2ZpbGUuanBnJ1xuYnVmLnB1c2goJzxsaScpO1xuYnVmLnB1c2goYXR0cnMoeyAnZGF0YS1pZCc6KHQuaWQpLCAnZGF0YS11c2VyLWlkJzoodC51c2VyX2lkKSwgXCJjbGFzc1wiOiAoJ3RocmVhZCcpIH0sIHtcImRhdGEtaWRcIjp0cnVlLFwiZGF0YS11c2VyLWlkXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGEnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtc3VyZic6KHQuZm9ydW1faWQpLCAnaHJlZic6KHQudXJpKSwgXCJjbGFzc1wiOiAoJ211dGFudCcpIH0sIHtcImRhdGEtc3VyZlwiOnRydWUsXCJocmVmXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCc+PGg0IGNsYXNzPVwidGl0bGVcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC50aXRsZVxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9oND48ZGl2IGNsYXNzPVwiYnJlYWtcIj48L2Rpdj48ZGl2IGNsYXNzPVwicHJvZmlsZSBwaG90b1wiPjxpbWcnKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ3NyYyc6KFwiXCIgKyAoY2FjaGVVcmwpICsgXCJcIiArICh0LnVzZXJfcGhvdG8pICsgXCJcIikgfSwge1wic3JjXCI6dHJ1ZX0pKTtcbmJ1Zi5wdXNoKCcvPjwvZGl2PjxkaXYgY2xhc3M9XCJjb250YWluZXJcIj48c3BhbiBjbGFzcz1cInVzZXJuYW1lXCI+Ynk8ZW0+Jyk7XG52YXIgX192YWxfXyA9IHQudXNlcl9uYW1lIC8vIFhYWCB3ZWlyZCB0aGluZ3MgaGFwcGVuZWQgd2hlbiBJIHRyaWVkIHRvIHR1cm4gdGhpcyBpbnRvIGFuIGFuY2hvclxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPC9lbT48L3NwYW4+PHNwYW4nKTtcbmJ1Zi5wdXNoKGF0dHJzKHsgJ2RhdGEtdGltZSc6KHQuY3JlYXRlZF9pc28pLCBcImNsYXNzXCI6ICgnY3JlYXRlZCcpIH0sIHtcImRhdGEtdGltZVwiOnRydWV9KSk7XG5idWYucHVzaCgnPicpO1xudmFyIF9fdmFsX18gPSB0LmNyZWF0ZWRfaHVtYW5cbmJ1Zi5wdXNoKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKTtcbmJ1Zi5wdXNoKCc8L3NwYW4+PGRpdiBjbGFzcz1cImNsZWFyXCI+PC9kaXY+PHNwYW4gY2xhc3M9XCJwb3N0LWNvdW50XCI+Jyk7XG52YXIgX192YWxfXyA9IHQucG9zdF9jb3VudFxuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+cG9zdHM8L2k+PC9zcGFuPjxzcGFuIGNsYXNzPVwidmlld3NcIj4nKTtcbnZhciBfX3ZhbF9fID0gdC52aWV3c1xuYnVmLnB1c2goZXNjYXBlKG51bGwgPT0gX192YWxfXyA/IFwiXCIgOiBfX3ZhbF9fKSk7XG5idWYucHVzaCgnPGk+dmlld3M8L2k+PC9zcGFuPjwvZGl2PjwvYT48L2xpPicpO1xufTtcbmJ1Zi5wdXNoKCc8dWwgY2xhc3M9XCJ0aHJlYWRzXCI+Jyk7XG4vLyBpdGVyYXRlIHRvcFRocmVhZHNcbjsoZnVuY3Rpb24oKXtcbiAgaWYgKCdudW1iZXInID09IHR5cGVvZiB0b3BUaHJlYWRzLmxlbmd0aCkge1xuICAgIGZvciAodmFyIGlpID0gMCwgJCRsID0gdG9wVGhyZWFkcy5sZW5ndGg7IGlpIDwgJCRsOyBpaSsrKSB7XG4gICAgICB2YXIgdCA9IHRvcFRocmVhZHNbaWldO1xuXG5fdGhyZWFkX21peGluKHQpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBmb3IgKHZhciBpaSBpbiB0b3BUaHJlYWRzKSB7XG4gICAgICB2YXIgdCA9IHRvcFRocmVhZHNbaWldO1xuXG5fdGhyZWFkX21peGluKHQpO1xuICAgfVxuICB9XG59KS5jYWxsKHRoaXMpO1xuXG5idWYucHVzaCgnPC91bD4nKTtcbn1cbnJldHVybiBidWYuam9pbihcIlwiKTtcbn0iLCIvLyBub3RoaW5nIHRvIHNlZSBoZXJlLi4uIG5vIGZpbGUgbWV0aG9kcyBmb3IgdGhlIGJyb3dzZXJcbiIsInZhciBmc20sIHR5cGVPZlBhcnQsIG1hY2hpbmUsIHBhcnNlLCBmb3J1bVVyaSwgb3V0JCA9IHR5cGVvZiBleHBvcnRzICE9ICd1bmRlZmluZWQnICYmIGV4cG9ydHMgfHwgdGhpcywgc2xpY2UkID0gW10uc2xpY2U7XG5mc20gPSByZXF1aXJlKCcuL2ZzbS5scycpO1xuLypcbnN0YXRlcyA9XG4gICogXFxpbml0aWFsXG4gICogXFxmb3J1bVxuICAqIFxcbmV3LXRocmVhZFxuICAqIFxcLXRocmVhZC1tYXJrZXJcbiAgKiBcXHRocmVhZFxuICAqIFxcdGhyZWFkLXBhZ2VcbiAgKiBcXC1wYWdlLW1hcmtlclxuICAqIFxcdGhyZWFkLXBlcm1hbGlua1xuICAqIFxcLXBlcm1hbGluay1wYWdlLW1hcmtlclxuICAqIFxcdGhyZWFkLXBlcm1hbGluay1wYWdlXG4gICogXFwtZWRpdC1tYXJrZXJcbiAgKiBcXGVkaXRcbiAgKiBcXGVycm9yXG5cbmlucHV0cyA9XG4gICogXFxzdHJpbmdcbiAgKiBcXG51bWJlclxuICAqIFxcbmV3XG4gICogXFxlZGl0XG4gICogXFx0XG4gICogXFxwYWdlXG4qL1xub3V0JC50eXBlT2ZQYXJ0ID0gdHlwZU9mUGFydCA9IGZ1bmN0aW9uKGkpe1xuICBzd2l0Y2ggKGkpIHtcbiAgY2FzZSAncGFnZSc6XG4gICAgcmV0dXJuICdwYWdlJztcbiAgY2FzZSAndCc6XG4gICAgcmV0dXJuICd0JztcbiAgY2FzZSAnZWRpdCc6XG4gICAgcmV0dXJuICdlZGl0JztcbiAgY2FzZSAnbmV3JzpcbiAgICByZXR1cm4gJ25ldyc7XG4gIGRlZmF1bHQ6XG4gICAgaWYgKGkubWF0Y2goL1tcXC5dLykpIHtcbiAgICAgIHJldHVybiAnZmJkbic7XG4gICAgfVxuICAgIGlmIChpLm1hdGNoKC9eXFxkKyQvKSkge1xuICAgICAgcmV0dXJuICdudW1iZXInO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gJ3N0cmluZyc7XG4gICAgfVxuICB9XG59O1xub3V0JC5tYWNoaW5lID0gbWFjaGluZSA9IHtcbiAgaW5pdGlhbDoge1xuICAgIHN0cmluZzogJ2ZvcnVtJyxcbiAgICBudW1iZXI6ICdmb3J1bScsXG4gICAgJ25ldyc6ICdmb3J1bScsXG4gICAgZWRpdDogJ2ZvcnVtJyxcbiAgICB0OiAnZm9ydW0nLFxuICAgIHBhZ2U6ICdmb3J1bScsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9LFxuICBmb3J1bToge1xuICAgIHN0cmluZzogJ2ZvcnVtJyxcbiAgICBudW1iZXI6ICdmb3J1bScsXG4gICAgJ25ldyc6ICduZXctdGhyZWFkJyxcbiAgICBlZGl0OiAnZm9ydW0nLFxuICAgIHQ6ICctdGhyZWFkLW1hcmtlcicsXG4gICAgcGFnZTogJ2ZvcnVtJyxcbiAgICBmYmRuOiAnZXJyb3InXG4gIH0sXG4gICduZXctdGhyZWFkJzoge1xuICAgIHN0cmluZzogJ2Vycm9yJyxcbiAgICBudW1iZXI6ICdlcnJvcicsXG4gICAgJ25ldyc6ICdlcnJvcicsXG4gICAgZWRpdDogJ2Vycm9yJyxcbiAgICB0OiAnZXJyb3InLFxuICAgIHBhZ2U6ICdlcnJvcicsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9LFxuICAnLXRocmVhZC1tYXJrZXInOiB7XG4gICAgc3RyaW5nOiAndGhyZWFkJyxcbiAgICBudW1iZXI6ICd0aHJlYWQnLFxuICAgICduZXcnOiAndGhyZWFkJyxcbiAgICBlZGl0OiAndGhyZWFkJyxcbiAgICB0OiAndGhyZWFkJyxcbiAgICBwYWdlOiAndGhyZWFkJyxcbiAgICBmYmRuOiAnZXJyb3InXG4gIH0sXG4gIHRocmVhZDoge1xuICAgIHN0cmluZzogJ3RocmVhZC1wZXJtYWxpbmsnLFxuICAgIG51bWJlcjogJ3RocmVhZC1wZXJtYWxpbmsnLFxuICAgICduZXcnOiAnZXJyb3InLFxuICAgIGVkaXQ6ICctZWRpdC1tYXJrZXInLFxuICAgIHQ6ICdlcnJvcicsXG4gICAgcGFnZTogJy1wYWdlLW1hcmtlcicsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9LFxuICAndGhyZWFkLXBlcm1hbGluayc6IHtcbiAgICBzdHJpbmc6ICdlcnJvcicsXG4gICAgbnVtYmVyOiAnZXJyb3InLFxuICAgICduZXcnOiAnZXJyb3InLFxuICAgIGVkaXQ6ICctZWRpdC1tYXJrZXInLFxuICAgIHQ6ICdlcnJvcicsXG4gICAgcGFnZTogJy1wZXJtYWxpbmstcGFnZS1tYXJrZXInLFxuICAgIGZiZG46ICdlcnJvcidcbiAgfSxcbiAgJy1lZGl0LW1hcmtlcic6IHtcbiAgICBzdHJpbmc6ICdlcnJvcicsXG4gICAgbnVtYmVyOiAnZWRpdCcsXG4gICAgJ25ldyc6ICdlcnJvcicsXG4gICAgZWRpdDogJ2Vycm9yJyxcbiAgICB0OiAnZXJyb3InLFxuICAgIHBhZ2U6ICdlcnJvcicsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9LFxuICBlZGl0OiB7XG4gICAgc3RyaW5nOiAnZXJyb3InLFxuICAgIG51bWJlcjogJ2Vycm9yJyxcbiAgICAnbmV3JzogJ2Vycm9yJyxcbiAgICBlZGl0OiAnZXJyb3InLFxuICAgIHQ6ICdlcnJvcicsXG4gICAgcGFnZTogJ2Vycm9yJyxcbiAgICBmYmRuOiAnZXJyb3InXG4gIH0sXG4gICctcGVybWFsaW5rLXBhZ2UtbWFya2VyJzoge1xuICAgIHN0cmluZzogJ2Vycm9yJyxcbiAgICBudW1iZXI6ICd0aHJlYWQtcGVybWFsaW5rLXBhZ2UnLFxuICAgICduZXcnOiAnZXJyb3InLFxuICAgIGVkaXQ6ICdlcnJvcicsXG4gICAgdDogJ2Vycm9yJyxcbiAgICBwYWdlOiAnZXJyb3InLFxuICAgIGZiZG46ICdlcnJvcidcbiAgfSxcbiAgJ3RocmVhZC1wZXJtYWxpbmstcGFnZSc6IHtcbiAgICBzdHJpbmc6ICdlcnJvcicsXG4gICAgbnVtYmVyOiAnZXJyb3InLFxuICAgICduZXcnOiAnZXJyb3InLFxuICAgIGVkaXQ6ICdlcnJvcicsXG4gICAgdDogJ2Vycm9yJyxcbiAgICBwYWdlOiAnZXJyb3InLFxuICAgIGZiZG46ICdlcnJvcidcbiAgfSxcbiAgJy1wYWdlLW1hcmtlcic6IHtcbiAgICBzdHJpbmc6ICdlcnJvcicsXG4gICAgbnVtYmVyOiAndGhyZWFkLXBhZ2UnLFxuICAgICduZXcnOiAnZXJyb3InLFxuICAgIGVkaXQ6ICdlcnJvcicsXG4gICAgdDogJ2Vycm9yJyxcbiAgICBwYWdlOiAnZXJyb3InLFxuICAgIGZiZG46ICdlcnJvcidcbiAgfSxcbiAgJ3RocmVhZC1wYWdlJzoge1xuICAgIHN0cmluZzogJ2Vycm9yJyxcbiAgICBudW1iZXI6ICdlcnJvcicsXG4gICAgJ25ldyc6ICdlcnJvcicsXG4gICAgZWRpdDogJ2Vycm9yJyxcbiAgICB0OiAnZXJyb3InLFxuICAgIHBhZ2U6ICdlcnJvcicsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9LFxuICBlcnJvcjoge1xuICAgIHN0cmluZzogJ2Vycm9yJyxcbiAgICBudW1iZXI6ICdlcnJvcicsXG4gICAgJ25ldyc6ICdlcnJvcicsXG4gICAgZWRpdDogJ2Vycm9yJyxcbiAgICB0OiAnZXJyb3InLFxuICAgIHBhZ2U6ICdlcnJvcicsXG4gICAgZmJkbjogJ2Vycm9yJ1xuICB9XG59O1xub3V0JC5wYXJzZSA9IHBhcnNlID0gZnVuY3Rpb24ocGF0aCl7XG4gIHZhciBwYXJ0cywgaW5wdXRzLCB0eXBlLCBtZXRhLCB1cmlQYXJ0cywgcGFnZSwgbiwgZWRpdCwgaWQ7XG4gIHBhcnRzID0gcmVqZWN0KGZ1bmN0aW9uKGl0KXtcbiAgICByZXR1cm4gaXQgPT09ICcnO1xuICB9KShcbiAgcGF0aC5zcGxpdCgnLycpKTtcbiAgaW5wdXRzID0gbWFwKHR5cGVPZlBhcnQsIHBhcnRzKTtcbiAgdHlwZSA9IGZzbS5uZXdTdGF0ZShtYWNoaW5lLCAnaW5pdGlhbCcsIGlucHV0cyk7XG4gIG1ldGEgPSAoZnVuY3Rpb24oKXtcbiAgICB2YXIgcmVmJCwgcmVmMSQ7XG4gICAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnaW5pdGlhbCc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmNvbXBsZXRlOiB0cnVlXG4gICAgICB9O1xuICAgIGNhc2UgJ2ZvcnVtJzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcnVtVXJpOiBcIi9cIiArIHBhcnRzLmpvaW4oJy8nKVxuICAgICAgfTtcbiAgICBjYXNlICduZXctdGhyZWFkJzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcnVtVXJpOiBcIi9cIiArIHNsaWNlJC5jYWxsKHBhcnRzLCAwLCBwYXJ0cy5sZW5ndGggLSAxKS5qb2luKCcvJylcbiAgICAgIH07XG4gICAgY2FzZSAndGhyZWFkJzpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcnVtVXJpOiBmb3J1bVVyaShwYXRoKSxcbiAgICAgICAgdGhyZWFkVXJpOiBcIi9cIiArIHBhcnRzLmpvaW4oJy8nKVxuICAgICAgfTtcbiAgICBjYXNlICd0aHJlYWQtcGFnZSc6XG4gICAgICByZWYkID0gc3BsaXRBdChwYXJ0cy5sZW5ndGggLSAyLCBwYXJ0cyksIHVyaVBhcnRzID0gcmVmJFswXSwgcmVmMSQgPSByZWYkWzFdLCBwYWdlID0gcmVmMSRbMF0sIG4gPSByZWYxJFsxXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcnVtVXJpOiBmb3J1bVVyaShwYXRoKSxcbiAgICAgICAgdGhyZWFkVXJpOiBcIi9cIiArIHVyaVBhcnRzLmpvaW4oJy8nKSxcbiAgICAgICAgcGFnZTogcGFyc2VJbnQobilcbiAgICAgIH07XG4gICAgY2FzZSAndGhyZWFkLXBlcm1hbGluayc6XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmb3J1bVVyaTogZm9ydW1VcmkocGF0aCksXG4gICAgICAgIHRocmVhZFVyaTogXCIvXCIgKyBwYXJ0cy5qb2luKCcvJyksXG4gICAgICAgIHNsdWc6IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdXG4gICAgICB9O1xuICAgIGNhc2UgJ3RocmVhZC1wZXJtYWxpbmstcGFnZSc6XG4gICAgICByZWYkID0gc3BsaXRBdChwYXJ0cy5sZW5ndGggLSAyLCBwYXJ0cyksIHVyaVBhcnRzID0gcmVmJFswXSwgcmVmMSQgPSByZWYkWzFdLCBwYWdlID0gcmVmMSRbMF0sIG4gPSByZWYxJFsxXTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcnVtVXJpOiBmb3J1bVVyaShwYXRoKSxcbiAgICAgICAgdGhyZWFkVXJpOiBcIi9cIiArIHVyaVBhcnRzLmpvaW4oJy8nKSxcbiAgICAgICAgcGFnZTogcGFyc2VJbnQobilcbiAgICAgIH07XG4gICAgY2FzZSAnZWRpdCc6XG4gICAgICByZWYkID0gc3BsaXRBdChwYXJ0cy5sZW5ndGggLSAyLCBwYXJ0cyksIHVyaVBhcnRzID0gcmVmJFswXSwgcmVmMSQgPSByZWYkWzFdLCBlZGl0ID0gcmVmMSRbMF0sIGlkID0gcmVmMSRbMV07XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmb3J1bVVyaTogZm9ydW1VcmkocGF0aCksXG4gICAgICAgIHRocmVhZFVyaTogXCIvXCIgKyB1cmlQYXJ0cy5qb2luKCcvJyksXG4gICAgICAgIGlkOiBwYXJzZUludChpZClcbiAgICAgIH07XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluY29tcGxldGU6IHRydWVcbiAgICAgIH07XG4gICAgfVxuICB9KCkpO1xuICByZXR1cm4gaW1wb3J0JCh7XG4gICAgdHlwZTogdHlwZSxcbiAgICBwYXJ0czogcGFydHMsXG4gICAgcGF0aDogXCIvXCIgKyBwYXJ0cy5qb2luKCcvJylcbiAgfSwgbWV0YSk7XG59O1xub3V0JC5mb3J1bVVyaSA9IGZvcnVtVXJpID0gZnVuY3Rpb24ocGF0aCl7XG4gIHZhciBwYXJ0cywgaW5wdXRzLCB0LCBmb3J1bVN0YXRlcztcbiAgcGFydHMgPSByZWplY3QoZnVuY3Rpb24oaXQpe1xuICAgIHJldHVybiBpdCA9PT0gJyc7XG4gIH0pKFxuICBwYXRoLnNwbGl0KCcvJykpO1xuICBpbnB1dHMgPSBtYXAodHlwZU9mUGFydCwgcGFydHMpO1xuICB0ID0gZnVuY3Rpb24oc3RhdGUsIGlucHV0KXtcbiAgICByZXR1cm4gZnNtLm5ld1N0YXRlKG1hY2hpbmUsIHN0YXRlLCBbaW5wdXRdKTtcbiAgfTtcbiAgZm9ydW1TdGF0ZXMgPSB0YWtlV2hpbGUoZnVuY3Rpb24oaXQpe1xuICAgIHJldHVybiBpdCA9PT0gJ2luaXRpYWwnIHx8IGl0ID09PSAnZm9ydW0nO1xuICB9KShcbiAgc2Nhbih0LCAnaW5pdGlhbCcsIGlucHV0cykpO1xuICByZXR1cm4gJy8nICsgam9pbignLycpKFxuICB0YWtlKGZvcnVtU3RhdGVzLmxlbmd0aCAtIDEpKFxuICBwYXJ0cykpO1xufTtcbi8qXG5UcnkgdGhlc2UgaW4gdGhlIFJFUEwuXG5cbmZ1cmwucGFyc2UgJy9vdGhlcmdyb3VuZC1mb3J1bSdcbmZ1cmwucGFyc2UgJy9vdGhlcmdyb3VuZC1mb3J1bS9zdXBwb3J0Z3JvdW5kJ1xuZnVybC5wYXJzZSAnL290aGVyZ3JvdW5kLWZvcnVtL25ldycgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyB3ZSBjYW4gaWRlbnRpZnkgdGhlIG5ldyB0aHJlYWQgbWFya2VyXG5mdXJsLnBhcnNlICcvb3RoZXJncm91bmQtZm9ydW0vc3VwcG9ydGdyb3VuZC90L25ldycgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHRocmVhZHMgY2FuIGJlIGNhbGxlZCBcIm5ld1wiXG5mdXJsLnBhcnNlICcvb3RoZXJncm91bmQtZm9ydW0vc3VwcG9ydGdyb3VuZC90L2VkaXQnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAjIHRocmVhZHMgY2FuIGJlIGNhbGxlZCBcImVkaXRcIlxuZnVybC5wYXJzZSAnL290aGVyZ3JvdW5kLWZvcnVtL3N1cHBvcnRncm91bmQvdC9lZGl0L2VkaXQnICAgICAgICAgICAgICAgICAgICAgICAgICAgIyAuLi5idXQgd2UgY2FuIHN0aWxsIGlkZW50aWZ5IHRoZSBlZGl0IG1hcmtlclxuZnVybC5wYXJzZSAnL290aGVyZ3JvdW5kLWZvcnVtL3N1cHBvcnRncm91bmQvdC9lZGl0L2VkaXQvMTIzNCcgICAgICAgICAgICAgICAgICAgICAgIyBhbmQga25vdyB0aGlzIGlzIGFuIGVkaXQgdXJsXG5mdXJsLnBhcnNlICcvb3RoZXJncm91bmQtZm9ydW0vc3VwcG9ydGdyb3VuZC90L25ldy10aGluZycgICAgICAgICAgICAgICAgICBcbmZ1cmwucGFyc2UgJy9vdGhlcmdyb3VuZC1mb3J1bS9zdXBwb3J0Z3JvdW5kL3QvbmV3LXRoaW5nL3BhZ2UvNScgICAgICAgICAgICAgICAgICAgICMgcHJldHR5IHBhZ2UgdXJscyBhcmUgbm90IGEgcHJvYmxlbVxuZnVybC5wYXJzZSAnL290aGVyZ3JvdW5kLWZvcnVtL3N1cHBvcnRncm91bmQvdC90aGlzLWlzLWEtdGVzdC9lZGl0LzIxMDgnXG4qL1xuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCJpZiAodHlwZW9mIGRlZmluZSAhPT0gJ2Z1bmN0aW9uJykgeyB2YXIgZGVmaW5lID0gcmVxdWlyZSgnYW1kZWZpbmUnKShtb2R1bGUsIHJlcXVpcmUpOyB9XG5kZWZpbmUoZnVuY3Rpb24ocmVxdWlyZSl7IHJldHVybiByZXF1aXJlKCcuL3NyYy9Db21wb25lbnQnKTsgfSk7XG4iLCIoZnVuY3Rpb24ocHJvY2VzcyxfX2ZpbGVuYW1lKXsvKiogdmltOiBldDp0cz00OnN3PTQ6c3RzPTRcbiAqIEBsaWNlbnNlIGFtZGVmaW5lIDAuMC41IENvcHlyaWdodCAoYykgMjAxMSwgVGhlIERvam8gRm91bmRhdGlvbiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICogQXZhaWxhYmxlIHZpYSB0aGUgTUlUIG9yIG5ldyBCU0QgbGljZW5zZS5cbiAqIHNlZTogaHR0cDovL2dpdGh1Yi5jb20vanJidXJrZS9hbWRlZmluZSBmb3IgZGV0YWlsc1xuICovXG5cbi8qanNsaW50IG5vZGU6IHRydWUgKi9cbi8qZ2xvYmFsIG1vZHVsZSwgcHJvY2VzcyAqL1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcblxuLyoqXG4gKiBDcmVhdGVzIGEgZGVmaW5lIGZvciBub2RlLlxuICogQHBhcmFtIHtPYmplY3R9IG1vZHVsZSB0aGUgXCJtb2R1bGVcIiBvYmplY3QgdGhhdCBpcyBkZWZpbmVkIGJ5IE5vZGUgZm9yIHRoZVxuICogY3VycmVudCBtb2R1bGUuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVxdWlyZV0uIE5vZGUncyByZXF1aXJlIGZ1bmN0aW9uIGZvciB0aGUgY3VycmVudCBtb2R1bGUuXG4gKiBJdCBvbmx5IG5lZWRzIHRvIGJlIHBhc3NlZCBpbiBOb2RlIHZlcnNpb25zIGJlZm9yZSAwLjUsIHdoZW4gbW9kdWxlLnJlcXVpcmVcbiAqIGRpZCBub3QgZXhpc3QuXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259IGEgZGVmaW5lIGZ1bmN0aW9uIHRoYXQgaXMgdXNhYmxlIGZvciB0aGUgY3VycmVudCBub2RlXG4gKiBtb2R1bGUuXG4gKi9cbmZ1bmN0aW9uIGFtZGVmaW5lKG1vZHVsZSwgcmVxdWlyZSkge1xuICAgIHZhciBkZWZpbmVDYWNoZSA9IHt9LFxuICAgICAgICBsb2FkZXJDYWNoZSA9IHt9LFxuICAgICAgICBhbHJlYWR5Q2FsbGVkID0gZmFsc2UsXG4gICAgICAgIG1ha2VSZXF1aXJlLCBzdHJpbmdSZXF1aXJlO1xuXG4gICAgLyoqXG4gICAgICogVHJpbXMgdGhlIC4gYW5kIC4uIGZyb20gYW4gYXJyYXkgb2YgcGF0aCBzZWdtZW50cy5cbiAgICAgKiBJdCB3aWxsIGtlZXAgYSBsZWFkaW5nIHBhdGggc2VnbWVudCBpZiBhIC4uIHdpbGwgYmVjb21lXG4gICAgICogdGhlIGZpcnN0IHBhdGggc2VnbWVudCwgdG8gaGVscCB3aXRoIG1vZHVsZSBuYW1lIGxvb2t1cHMsXG4gICAgICogd2hpY2ggYWN0IGxpa2UgcGF0aHMsIGJ1dCBjYW4gYmUgcmVtYXBwZWQuIEJ1dCB0aGUgZW5kIHJlc3VsdCxcbiAgICAgKiBhbGwgcGF0aHMgdGhhdCB1c2UgdGhpcyBmdW5jdGlvbiBzaG91bGQgbG9vayBub3JtYWxpemVkLlxuICAgICAqIE5PVEU6IHRoaXMgbWV0aG9kIE1PRElGSUVTIHRoZSBpbnB1dCBhcnJheS5cbiAgICAgKiBAcGFyYW0ge0FycmF5fSBhcnkgdGhlIGFycmF5IG9mIHBhdGggc2VnbWVudHMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdHJpbURvdHMoYXJ5KSB7XG4gICAgICAgIHZhciBpLCBwYXJ0O1xuICAgICAgICBmb3IgKGkgPSAwOyBhcnlbaV07IGkrPSAxKSB7XG4gICAgICAgICAgICBwYXJ0ID0gYXJ5W2ldO1xuICAgICAgICAgICAgaWYgKHBhcnQgPT09ICcuJykge1xuICAgICAgICAgICAgICAgIGFyeS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICAgICAgaSAtPSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJ0ID09PSAnLi4nKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPT09IDEgJiYgKGFyeVsyXSA9PT0gJy4uJyB8fCBhcnlbMF0gPT09ICcuLicpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vRW5kIG9mIHRoZSBsaW5lLiBLZWVwIGF0IGxlYXN0IG9uZSBub24tZG90XG4gICAgICAgICAgICAgICAgICAgIC8vcGF0aCBzZWdtZW50IGF0IHRoZSBmcm9udCBzbyBpdCBjYW4gYmUgbWFwcGVkXG4gICAgICAgICAgICAgICAgICAgIC8vY29ycmVjdGx5IHRvIGRpc2suIE90aGVyd2lzZSwgdGhlcmUgaXMgbGlrZWx5XG4gICAgICAgICAgICAgICAgICAgIC8vbm8gcGF0aCBtYXBwaW5nIGZvciBhIHBhdGggc3RhcnRpbmcgd2l0aCAnLi4nLlxuICAgICAgICAgICAgICAgICAgICAvL1RoaXMgY2FuIHN0aWxsIGZhaWwsIGJ1dCBjYXRjaGVzIHRoZSBtb3N0IHJlYXNvbmFibGVcbiAgICAgICAgICAgICAgICAgICAgLy91c2VzIG9mIC4uXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYXJ5LnNwbGljZShpIC0gMSwgMik7XG4gICAgICAgICAgICAgICAgICAgIGkgLT0gMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3JtYWxpemUobmFtZSwgYmFzZU5hbWUpIHtcbiAgICAgICAgdmFyIGJhc2VQYXJ0cztcblxuICAgICAgICAvL0FkanVzdCBhbnkgcmVsYXRpdmUgcGF0aHMuXG4gICAgICAgIGlmIChuYW1lICYmIG5hbWUuY2hhckF0KDApID09PSAnLicpIHtcbiAgICAgICAgICAgIC8vSWYgaGF2ZSBhIGJhc2UgbmFtZSwgdHJ5IHRvIG5vcm1hbGl6ZSBhZ2FpbnN0IGl0LFxuICAgICAgICAgICAgLy9vdGhlcndpc2UsIGFzc3VtZSBpdCBpcyBhIHRvcC1sZXZlbCByZXF1aXJlIHRoYXQgd2lsbFxuICAgICAgICAgICAgLy9iZSByZWxhdGl2ZSB0byBiYXNlVXJsIGluIHRoZSBlbmQuXG4gICAgICAgICAgICBpZiAoYmFzZU5hbWUpIHtcbiAgICAgICAgICAgICAgICBiYXNlUGFydHMgPSBiYXNlTmFtZS5zcGxpdCgnLycpO1xuICAgICAgICAgICAgICAgIGJhc2VQYXJ0cyA9IGJhc2VQYXJ0cy5zbGljZSgwLCBiYXNlUGFydHMubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgYmFzZVBhcnRzID0gYmFzZVBhcnRzLmNvbmNhdChuYW1lLnNwbGl0KCcvJykpO1xuICAgICAgICAgICAgICAgIHRyaW1Eb3RzKGJhc2VQYXJ0cyk7XG4gICAgICAgICAgICAgICAgbmFtZSA9IGJhc2VQYXJ0cy5qb2luKCcvJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgdGhlIG5vcm1hbGl6ZSgpIGZ1bmN0aW9uIHBhc3NlZCB0byBhIGxvYWRlciBwbHVnaW4nc1xuICAgICAqIG5vcm1hbGl6ZSBtZXRob2QuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFrZU5vcm1hbGl6ZShyZWxOYW1lKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZShuYW1lLCByZWxOYW1lKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlTG9hZChpZCkge1xuICAgICAgICBmdW5jdGlvbiBsb2FkKHZhbHVlKSB7XG4gICAgICAgICAgICBsb2FkZXJDYWNoZVtpZF0gPSB2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxvYWQuZnJvbVRleHQgPSBmdW5jdGlvbiAoaWQsIHRleHQpIHtcbiAgICAgICAgICAgIC8vVGhpcyBvbmUgaXMgZGlmZmljdWx0IGJlY2F1c2UgdGhlIHRleHQgY2FuL3Byb2JhYmx5IHVzZXNcbiAgICAgICAgICAgIC8vZGVmaW5lLCBhbmQgYW55IHJlbGF0aXZlIHBhdGhzIGFuZCByZXF1aXJlcyBzaG91bGQgYmUgcmVsYXRpdmVcbiAgICAgICAgICAgIC8vdG8gdGhhdCBpZCB3YXMgaXQgd291bGQgYmUgZm91bmQgb24gZGlzay4gQnV0IHRoaXMgd291bGQgcmVxdWlyZVxuICAgICAgICAgICAgLy9ib290c3RyYXBwaW5nIGEgbW9kdWxlL3JlcXVpcmUgZmFpcmx5IGRlZXBseSBmcm9tIG5vZGUgY29yZS5cbiAgICAgICAgICAgIC8vTm90IHN1cmUgaG93IGJlc3QgdG8gZ28gYWJvdXQgdGhhdCB5ZXQuXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FtZGVmaW5lIGRvZXMgbm90IGltcGxlbWVudCBsb2FkLmZyb21UZXh0Jyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGxvYWQ7XG4gICAgfVxuXG4gICAgbWFrZVJlcXVpcmUgPSBmdW5jdGlvbiAoc3lzdGVtUmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlLCByZWxJZCkge1xuICAgICAgICBmdW5jdGlvbiBhbWRSZXF1aXJlKGRlcHMsIGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGRlcHMgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgLy9TeW5jaHJvbm91cywgc2luZ2xlIG1vZHVsZSByZXF1aXJlKCcnKVxuICAgICAgICAgICAgICAgIHJldHVybiBzdHJpbmdSZXF1aXJlKHN5c3RlbVJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSwgZGVwcywgcmVsSWQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL0FycmF5IG9mIGRlcGVuZGVuY2llcyB3aXRoIGEgY2FsbGJhY2suXG5cbiAgICAgICAgICAgICAgICAvL0NvbnZlcnQgdGhlIGRlcGVuZGVuY2llcyB0byBtb2R1bGVzLlxuICAgICAgICAgICAgICAgIGRlcHMgPSBkZXBzLm1hcChmdW5jdGlvbiAoZGVwTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RyaW5nUmVxdWlyZShzeXN0ZW1SZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUsIGRlcE5hbWUsIHJlbElkKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vV2FpdCBmb3IgbmV4dCB0aWNrIHRvIGNhbGwgYmFjayB0aGUgcmVxdWlyZSBjYWxsLlxuICAgICAgICAgICAgICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShudWxsLCBkZXBzKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGFtZFJlcXVpcmUudG9VcmwgPSBmdW5jdGlvbiAoZmlsZVBhdGgpIHtcbiAgICAgICAgICAgIGlmIChmaWxlUGF0aC5pbmRleE9mKCcuJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9ybWFsaXplKGZpbGVQYXRoLCBwYXRoLmRpcm5hbWUobW9kdWxlLmZpbGVuYW1lKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlUGF0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gYW1kUmVxdWlyZTtcbiAgICB9O1xuXG4gICAgLy9GYXZvciBleHBsaWNpdCB2YWx1ZSwgcGFzc2VkIGluIGlmIHRoZSBtb2R1bGUgd2FudHMgdG8gc3VwcG9ydCBOb2RlIDAuNC5cbiAgICByZXF1aXJlID0gcmVxdWlyZSB8fCBmdW5jdGlvbiByZXEoKSB7XG4gICAgICAgIHJldHVybiBtb2R1bGUucmVxdWlyZS5hcHBseShtb2R1bGUsIGFyZ3VtZW50cyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHJ1bkZhY3RvcnkoaWQsIGRlcHMsIGZhY3RvcnkpIHtcbiAgICAgICAgdmFyIHIsIGUsIG0sIHJlc3VsdDtcblxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIGUgPSBsb2FkZXJDYWNoZVtpZF0gPSB7fTtcbiAgICAgICAgICAgIG0gPSB7XG4gICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgIHVyaTogX19maWxlbmFtZSxcbiAgICAgICAgICAgICAgICBleHBvcnRzOiBlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgciA9IG1ha2VSZXF1aXJlKHJlcXVpcmUsIGUsIG0sIGlkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vT25seSBzdXBwb3J0IG9uZSBkZWZpbmUgY2FsbCBwZXIgZmlsZVxuICAgICAgICAgICAgaWYgKGFscmVhZHlDYWxsZWQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2FtZGVmaW5lIHdpdGggbm8gbW9kdWxlIElEIGNhbm5vdCBiZSBjYWxsZWQgbW9yZSB0aGFuIG9uY2UgcGVyIGZpbGUuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBhbHJlYWR5Q2FsbGVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy9Vc2UgdGhlIHJlYWwgdmFyaWFibGVzIGZyb20gbm9kZVxuICAgICAgICAgICAgLy9Vc2UgbW9kdWxlLmV4cG9ydHMgZm9yIGV4cG9ydHMsIHNpbmNlXG4gICAgICAgICAgICAvL3RoZSBleHBvcnRzIGluIGhlcmUgaXMgYW1kZWZpbmUgZXhwb3J0cy5cbiAgICAgICAgICAgIGUgPSBtb2R1bGUuZXhwb3J0cztcbiAgICAgICAgICAgIG0gPSBtb2R1bGU7XG4gICAgICAgICAgICByID0gbWFrZVJlcXVpcmUocmVxdWlyZSwgZSwgbSwgbW9kdWxlLmlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vSWYgdGhlcmUgYXJlIGRlcGVuZGVuY2llcywgdGhleSBhcmUgc3RyaW5ncywgc28gbmVlZFxuICAgICAgICAvL3RvIGNvbnZlcnQgdGhlbSB0byBkZXBlbmRlbmN5IHZhbHVlcy5cbiAgICAgICAgaWYgKGRlcHMpIHtcbiAgICAgICAgICAgIGRlcHMgPSBkZXBzLm1hcChmdW5jdGlvbiAoZGVwTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiByKGRlcE5hbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvL0NhbGwgdGhlIGZhY3Rvcnkgd2l0aCB0aGUgcmlnaHQgZGVwZW5kZW5jaWVzLlxuICAgICAgICBpZiAodHlwZW9mIGZhY3RvcnkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IGZhY3RvcnkuYXBwbHkobW9kdWxlLmV4cG9ydHMsIGRlcHMpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzdWx0ID0gZmFjdG9yeTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZXN1bHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgbS5leHBvcnRzID0gcmVzdWx0O1xuICAgICAgICAgICAgaWYgKGlkKSB7XG4gICAgICAgICAgICAgICAgbG9hZGVyQ2FjaGVbaWRdID0gbS5leHBvcnRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3RyaW5nUmVxdWlyZSA9IGZ1bmN0aW9uIChzeXN0ZW1SZXF1aXJlLCBleHBvcnRzLCBtb2R1bGUsIGlkLCByZWxJZCkge1xuICAgICAgICAvL1NwbGl0IHRoZSBJRCBieSBhICEgc28gdGhhdFxuICAgICAgICB2YXIgaW5kZXggPSBpZC5pbmRleE9mKCchJyksXG4gICAgICAgICAgICBvcmlnaW5hbElkID0gaWQsXG4gICAgICAgICAgICBwcmVmaXgsIHBsdWdpbjtcblxuICAgICAgICBpZiAoaW5kZXggPT09IC0xKSB7XG4gICAgICAgICAgICBpZCA9IG5vcm1hbGl6ZShpZCwgcmVsSWQpO1xuXG4gICAgICAgICAgICAvL1N0cmFpZ2h0IG1vZHVsZSBsb29rdXAuIElmIGl0IGlzIG9uZSBvZiB0aGUgc3BlY2lhbCBkZXBlbmRlbmNpZXMsXG4gICAgICAgICAgICAvL2RlYWwgd2l0aCBpdCwgb3RoZXJ3aXNlLCBkZWxlZ2F0ZSB0byBub2RlLlxuICAgICAgICAgICAgaWYgKGlkID09PSAncmVxdWlyZScpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWFrZVJlcXVpcmUoc3lzdGVtUmVxdWlyZSwgZXhwb3J0cywgbW9kdWxlLCByZWxJZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGlkID09PSAnZXhwb3J0cycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZXhwb3J0cztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoaWQgPT09ICdtb2R1bGUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobG9hZGVyQ2FjaGUuaGFzT3duUHJvcGVydHkoaWQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRlckNhY2hlW2lkXTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGVmaW5lQ2FjaGVbaWRdKSB7XG4gICAgICAgICAgICAgICAgcnVuRmFjdG9yeS5hcHBseShudWxsLCBkZWZpbmVDYWNoZVtpZF0pO1xuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkZXJDYWNoZVtpZF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmKHN5c3RlbVJlcXVpcmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN5c3RlbVJlcXVpcmUob3JpZ2luYWxJZCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBtb2R1bGUgd2l0aCBJRDogJyArIGlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvL1RoZXJlIGlzIGEgcGx1Z2luIGluIHBsYXkuXG4gICAgICAgICAgICBwcmVmaXggPSBpZC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuICAgICAgICAgICAgaWQgPSBpZC5zdWJzdHJpbmcoaW5kZXggKyAxLCBpZC5sZW5ndGgpO1xuXG4gICAgICAgICAgICBwbHVnaW4gPSBzdHJpbmdSZXF1aXJlKHN5c3RlbVJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSwgcHJlZml4LCByZWxJZCk7XG5cbiAgICAgICAgICAgIGlmIChwbHVnaW4ubm9ybWFsaXplKSB7XG4gICAgICAgICAgICAgICAgaWQgPSBwbHVnaW4ubm9ybWFsaXplKGlkLCBtYWtlTm9ybWFsaXplKHJlbElkKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vTm9ybWFsaXplIHRoZSBJRCBub3JtYWxseS5cbiAgICAgICAgICAgICAgICBpZCA9IG5vcm1hbGl6ZShpZCwgcmVsSWQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobG9hZGVyQ2FjaGVbaWRdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxvYWRlckNhY2hlW2lkXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGx1Z2luLmxvYWQoaWQsIG1ha2VSZXF1aXJlKHN5c3RlbVJlcXVpcmUsIGV4cG9ydHMsIG1vZHVsZSwgcmVsSWQpLCBtYWtlTG9hZChpZCksIHt9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBsb2FkZXJDYWNoZVtpZF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy9DcmVhdGUgYSBkZWZpbmUgZnVuY3Rpb24gc3BlY2lmaWMgdG8gdGhlIG1vZHVsZSBhc2tpbmcgZm9yIGFtZGVmaW5lLlxuICAgIGZ1bmN0aW9uIGRlZmluZShpZCwgZGVwcywgZmFjdG9yeSkge1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpZCkpIHtcbiAgICAgICAgICAgIGZhY3RvcnkgPSBkZXBzO1xuICAgICAgICAgICAgZGVwcyA9IGlkO1xuICAgICAgICAgICAgaWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGlkICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgZmFjdG9yeSA9IGlkO1xuICAgICAgICAgICAgaWQgPSBkZXBzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRlcHMgJiYgIUFycmF5LmlzQXJyYXkoZGVwcykpIHtcbiAgICAgICAgICAgIGZhY3RvcnkgPSBkZXBzO1xuICAgICAgICAgICAgZGVwcyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghZGVwcykge1xuICAgICAgICAgICAgZGVwcyA9IFsncmVxdWlyZScsICdleHBvcnRzJywgJ21vZHVsZSddO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9TZXQgdXAgcHJvcGVydGllcyBmb3IgdGhpcyBtb2R1bGUuIElmIGFuIElELCB0aGVuIHVzZVxuICAgICAgICAvL2ludGVybmFsIGNhY2hlLiBJZiBubyBJRCwgdGhlbiB1c2UgdGhlIGV4dGVybmFsIHZhcmlhYmxlc1xuICAgICAgICAvL2ZvciB0aGlzIG5vZGUgbW9kdWxlLlxuICAgICAgICBpZiAoaWQpIHtcbiAgICAgICAgICAgIC8vUHV0IHRoZSBtb2R1bGUgaW4gZGVlcCBmcmVlemUgdW50aWwgdGhlcmUgaXMgYVxuICAgICAgICAgICAgLy9yZXF1aXJlIGNhbGwgZm9yIGl0LlxuICAgICAgICAgICAgZGVmaW5lQ2FjaGVbaWRdID0gW2lkLCBkZXBzLCBmYWN0b3J5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJ1bkZhY3RvcnkoaWQsIGRlcHMsIGZhY3RvcnkpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy9kZWZpbmUucmVxdWlyZSwgd2hpY2ggaGFzIGFjY2VzcyB0byBhbGwgdGhlIHZhbHVlcyBpbiB0aGVcbiAgICAvL2NhY2hlLiBVc2VmdWwgZm9yIEFNRCBtb2R1bGVzIHRoYXQgYWxsIGhhdmUgSURzIGluIHRoZSBmaWxlLFxuICAgIC8vYnV0IG5lZWQgdG8gZmluYWxseSBleHBvcnQgYSB2YWx1ZSB0byBub2RlIGJhc2VkIG9uIG9uZSBvZiB0aG9zZVxuICAgIC8vSURzLlxuICAgIGRlZmluZS5yZXF1aXJlID0gZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgIGlmIChsb2FkZXJDYWNoZVtpZF0pIHtcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXJDYWNoZVtpZF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGVmaW5lQ2FjaGVbaWRdKSB7XG4gICAgICAgICAgICBydW5GYWN0b3J5LmFwcGx5KG51bGwsIGRlZmluZUNhY2hlW2lkXSk7XG4gICAgICAgICAgICByZXR1cm4gbG9hZGVyQ2FjaGVbaWRdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGRlZmluZS5hbWQgPSB7fTtcblxuICAgIHJldHVybiBkZWZpbmU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYW1kZWZpbmU7XG5cbn0pKHJlcXVpcmUoXCJfX2Jyb3dzZXJpZnlfcHJvY2Vzc1wiKSxcIi8uLi9ub2RlX21vZHVsZXMveWFjb21wb25lbnQvbm9kZV9tb2R1bGVzL2FtZGVmaW5lL2FtZGVmaW5lLmpzXCIpIiwidmFyIENvbXBvbmVudCwgY2gsIHRlbXBsYXRlcywgQWRtaW5NZW51O1xuQ29tcG9uZW50ID0gcmVxdWlyZSgneWFjb21wb25lbnQnKTtcbmNoID0gcmVxdWlyZSgnLi4vYXBwL2NsaWVudC1oZWxwZXJzLmxzJyk7XG50ZW1wbGF0ZXMgPSByZXF1aXJlKCcuLi9idWlsZC9jb21wb25lbnQtamFkZS5qcycpLnRlbXBsYXRlcztcbm1vZHVsZS5leHBvcnRzID0gQWRtaW5NZW51ID0gKGZ1bmN0aW9uKHN1cGVyY2xhc3Mpe1xuICB2YXIgcHJlZml4LCBvcHRzLCBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKEFkbWluTWVudSwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnQWRtaW5NZW51JywgQWRtaW5NZW51KSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IEFkbWluTWVudTtcbiAgcHJlZml4ID0gJ2xpc3RfJztcbiAgb3B0cyA9IHtcbiAgICBoYW5kbGU6ICdkaXYnLFxuICAgIGl0ZW1zOiAnbGknLFxuICAgIG1heExldmVsczogMixcbiAgICB0b2xlcmFuY2U6ICdwb2ludGVyJyxcbiAgICB0b2xlcmFuY2VFbGVtZW50OiAnPiBkaXYnLFxuICAgIHBsYWNlaG9sZGVyOiAncGxhY2Vob2xkZXInXG4gIH07XG4gIHByb3RvdHlwZS50ZW1wbGF0ZSA9IHRlbXBsYXRlcy5BZG1pbk1lbnU7XG4gIHByb3RvdHlwZS5jdXJyZW50ID0gbnVsbDtcbiAgcHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbigpe1xuICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiB0aGlzJC4kLmZpbmQoJy5jb2wyJykuc2hvdygzMDApO1xuICAgIH0sIDMwMCk7XG4gIH07XG4gIHByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKGl0ZW0pe1xuICAgIHZhciBlLCB4JCwgcmVmJDtcbiAgICBjb25zb2xlLmxvZygnY2xvbmU6JywgaXRlbSk7XG4gICAgZSA9IHRoaXMuJC5maW5kKCcuZGVmYXVsdCcpLmNsb25lKCkucmVtb3ZlQ2xhc3MoJ2RlZmF1bHQnKS5hdHRyKCdpZCcsIGl0ZW0uaWQpO1xuICAgIHgkID0gZS5maW5kKCdpbnB1dCcpO1xuICAgIHgkLmRhdGEoJ21lbnUnLCAocmVmJCA9IGl0ZW0uZGF0YSkgIT0gbnVsbCA/IHJlZiQubWVudSA6IHZvaWQgOCk7XG4gICAgeCQuZGF0YSgndGl0bGUnLCAocmVmJCA9IGl0ZW0uZGF0YSkgIT0gbnVsbCA/IHJlZiQudGl0bGUgOiB2b2lkIDgpO1xuICAgIHgkLnZhbCgocmVmJCA9IGl0ZW0uZGF0YSkgIT0gbnVsbCA/IHJlZiQudGl0bGUgOiB2b2lkIDgpO1xuICAgIHJldHVybiBlO1xuICB9O1xuICBwcm90b3R5cGUuY3VycmVudFN0b3JlID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgZSwgZm9ybSwgeCQ7XG4gICAgaWYgKCEoZSA9IHRoaXMuY3VycmVudCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc29sZS5sb2coJ2hlcmUnKTtcbiAgICBmb3JtID0gdGhpcy4kLmZpbmQoJ2Zvcm0nKTtcbiAgICBpZiAoZm9ybSkge1xuICAgICAgZm9ybS5maW5kKCdpbnB1dFtuYW1lPVwibWVudVwiXScgIT0gbnVsbFxuICAgICAgICA/ICdpbnB1dFtuYW1lPVwibWVudVwiXSdcbiAgICAgICAgOiByZW1vdmUoKSk7XG4gICAgICB4JCA9IGU7XG4gICAgICB4JC5kYXRhKCdmb3JtJywgZm9ybS5zZXJpYWxpemUoKSk7XG4gICAgICB4JC5kYXRhKCd0aXRsZScsIHRoaXMuY3VycmVudC52YWwoKSk7XG4gICAgICBjb25zb2xlLmxvZygnc3RvcmUtbWVudTonLCBlLmRhdGEoJ21lbnUnKSk7XG4gICAgICBjb25zb2xlLmxvZygnc3RvcmUtdGl0bGU6JywgZS5kYXRhKCd0aXRsZScpKTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5jdXJyZW50UmVzdG9yZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGUsIGZvcm0sIHJlc2V0LCByZWYkLCB0aXRsZTtcbiAgICBpZiAoIShlID0gdGhpcy5jdXJyZW50KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZm9ybSA9IHRoaXMuJC5maW5kKCdmb3JtJykpIHtcbiAgICAgIHJlc2V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGZvcm0uZ2V0KDApLnJlc2V0KCk7XG4gICAgICB9O1xuICAgICAgcmVmJCA9IHRoaXMuY3VycmVudC5kYXRhLCBmb3JtID0gcmVmJC5mb3JtLCB0aXRsZSA9IHJlZiQudGl0bGU7XG4gICAgICBlLnZhbCh0aXRsZSk7XG4gICAgICBpZiAobWVudSkge1xuICAgICAgICBmb3JtLmRlc2VyaWFsaXplKGZvcm0pO1xuICAgICAgICB0aGlzLmN1cnJlbnQudmFsKHRpdGxlKTtcbiAgICAgICAgY29uc29sZS5sb2coJ3Jlc3RvcmVkOicsIGZvcm0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzZXQoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5vbkF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNpdGUsIHMsIGkkLCByZWYkLCBsZW4kLCBpdGVtLCB0aGlzJCA9IHRoaXM7XG4gICAgc2l0ZSA9IHRoaXMuc3RhdGUuc2l0ZSgpO1xuICAgIGlmIChzaXRlLmNvbmZpZy5tZW51KSB7XG4gICAgICBzID0gdGhpcy4kLmZpbmQoJy5zb3J0YWJsZScpO1xuICAgICAgZm9yIChpJCA9IDAsIGxlbiQgPSAocmVmJCA9IEpTT04ucGFyc2Uoc2l0ZS5jb25maWcubWVudSkpLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGl0ZW0gPSByZWYkW2kkXTtcbiAgICAgICAgY29uc29sZS5sb2coJ3BhcnNlZDonLCBpdGVtKTtcbiAgICAgICAgaWYgKGl0ZW0uaWQpIHtcbiAgICAgICAgICBpdGVtLmlkID0gcHJlZml4ICsgXCJcIiArIGl0ZW0uaWQ7XG4gICAgICAgICAgcy5hcHBlbmQodGhpcy5jbG9uZShpdGVtKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHMubmVzdGVkU29ydGFibGUob3B0cyk7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzLmZpbmQoJ2lucHV0OmZpcnN0JykuZm9jdXMoKTtcbiAgICAgIH0sIDIwMCk7XG4gICAgICB0aGlzLnNob3coKTtcbiAgICB9XG4gICAgdGhpcy4kLm9uKCdjbGljaycsICcub25jbGljay1hZGQnLCBmdW5jdGlvbihldil7XG4gICAgICB2YXIgcywgbWF4LCBpZCwgZSwgeCQ7XG4gICAgICB0aGlzJC5zaG93KCk7XG4gICAgICBzID0gdGhpcyQuJC5maW5kKCcuc29ydGFibGUnKTtcbiAgICAgIG1heCA9IHBhcnNlSW50KG1heGltdW0obWFwKGZ1bmN0aW9uKGl0KXtcbiAgICAgICAgcmV0dXJuIGl0LmlkLnJlcGxhY2UocHJlZml4LCAnJyk7XG4gICAgICB9KShcbiAgICAgIHMuZmluZCgnbGknKSkpKTtcbiAgICAgIGlkID0gIW1heFxuICAgICAgICA/IDFcbiAgICAgICAgOiBtYXggKyAxO1xuICAgICAgZSA9IHRoaXMkLmNsb25lKHtcbiAgICAgICAgaWQ6IHByZWZpeCArIFwiXCIgKyBpZFxuICAgICAgfSk7XG4gICAgICBjb25zb2xlLmxvZygnY3JlYXRlZDonLCBlKTtcbiAgICAgIHgkID0gdGhpcyQuJC5maW5kKCcuc29ydGFibGUnKTtcbiAgICAgIHgkLmFwcGVuZChlKTtcbiAgICAgIHgkLm5lc3RlZFNvcnRhYmxlKG9wdHMpO1xuICAgICAgeCQuZmluZCgnaW5wdXQnKS5mb2N1cygpO1xuICAgICAgdGhpcyQuY3VycmVudFJlc3RvcmU7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSk7XG4gICAgdGhpcy4kLm9uKCdjbGljaycsICdidXR0b25bdHlwZT1cInN1Ym1pdFwiXScsIGZ1bmN0aW9uKGV2KXtcbiAgICAgIHZhciBtZW51LCBmb3JtO1xuICAgICAgdGhpcyQuY3VycmVudFN0b3JlKCk7XG4gICAgICBtZW51ID0gdGhpcyQuJC5maW5kKCcuc29ydGFibGUnKS5kYXRhKCdtanNOZXN0ZWRTb3J0YWJsZScpLnRvSGllcmFyY2h5KCk7XG4gICAgICBpZiAoIW1lbnUubGVuZ3RoKSB7XG4gICAgICAgIG1lbnUgPSBbbWVudV07XG4gICAgICB9XG4gICAgICBjb25zb2xlLmxvZygnc2F2aW5nLW5lc3RlZC1zb3J0YWJsZTonLCBtZW51KTtcbiAgICAgIGZvcm0gPSB0aGlzJC4kLmZpbmQoJ2Zvcm0nKTtcbiAgICAgIGZvcm0uYXBwZW5kKGNvbnN0cnVjdG9yLiQoJzxpbnB1dD4nKS5hdHRyKCd0eXBlJywgJ2hpZGRlbicpLmF0dHIoJ25hbWUnLCAnbWVudScpLnZhbChKU09OLnN0cmluZ2lmeShtZW51KSkpO1xuICAgICAgcmV0dXJuIHN1Ym1pdEZvcm0oZXYsIGZ1bmN0aW9uKGRhdGEpe1xuICAgICAgICB2YXIgZiwgdCwgcmVmJDtcbiAgICAgICAgZiA9ICQodGhpcyk7XG4gICAgICAgIHQgPSAkKGZvcm0uZmluZCgnLnRvb2x0aXAnKSk7XG4gICAgICAgIHJldHVybiBzaG93VG9vbHRpcCh0LCAhZGF0YS5zdWNjZXNzID8gZGF0YSAhPSBudWxsID8gKHJlZiQgPSBkYXRhLmVycm9ycykgIT0gbnVsbCA/IHJlZiQuam9pbignPGJyPicpIDogdm9pZCA4IDogdm9pZCA4IDogJ1NhdmVkIScpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgdGhpcy4kLm9uKCdibHVyJywgJy5yb3cnLCBmdW5jdGlvbihldil7XG4gICAgICByZXR1cm4gdGhpcyQuY3VycmVudFN0b3JlKCk7XG4gICAgfSk7XG4gICAgdGhpcy4kLm9uKCdjaGFuZ2UnLCAnZm9ybScsIGZ1bmN0aW9uKGV2KXtcbiAgICAgIHJldHVybiB0aGlzJC5jdXJyZW50U3RvcmUoKTtcbiAgICB9KTtcbiAgICB0aGlzLiQub24oJ2NsaWNrJywgJy5yb3cnLCBmdW5jdGlvbihldil7XG4gICAgICB0aGlzJC5jdXJyZW50ID0gJChldi50YXJnZXQpO1xuICAgICAgcmV0dXJuIHRoaXMkLmN1cnJlbnRSZXN0b3JlO1xuICAgIH0pO1xuICAgIHRoaXMuJC5maW5kKCcuc29ydGFibGUnKS5uZXN0ZWRTb3J0YWJsZShvcHRzKTtcbiAgfTtcbiAgcHJvdG90eXBlLm9uRGV0YWNoID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy4kLm9mZigpO1xuICB9O1xuICBmdW5jdGlvbiBBZG1pbk1lbnUoKXtcbiAgICB0aGlzLm9uQXR0YWNoID0gYmluZCQodGhpcywgJ29uQXR0YWNoJywgcHJvdG90eXBlKTtcbiAgICB0aGlzLmN1cnJlbnRSZXN0b3JlID0gYmluZCQodGhpcywgJ2N1cnJlbnRSZXN0b3JlJywgcHJvdG90eXBlKTtcbiAgICB0aGlzLmN1cnJlbnRTdG9yZSA9IGJpbmQkKHRoaXMsICdjdXJyZW50U3RvcmUnLCBwcm90b3R5cGUpO1xuICAgIHRoaXMuY2xvbmUgPSBiaW5kJCh0aGlzLCAnY2xvbmUnLCBwcm90b3R5cGUpO1xuICAgIHRoaXMuc2hvdyA9IGJpbmQkKHRoaXMsICdzaG93JywgcHJvdG90eXBlKTtcbiAgICBBZG1pbk1lbnUuc3VwZXJjbGFzcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG4gIHJldHVybiBBZG1pbk1lbnU7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gIHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gKHRhcmdldCB8fCBvYmopW2tleV0uYXBwbHkob2JqLCBhcmd1bWVudHMpIH07XG59XG5mdW5jdGlvbiBleHRlbmQkKHN1Yiwgc3VwKXtcbiAgZnVuY3Rpb24gZnVuKCl7fSBmdW4ucHJvdG90eXBlID0gKHN1Yi5zdXBlcmNsYXNzID0gc3VwKS5wcm90b3R5cGU7XG4gIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gIGlmICh0eXBlb2Ygc3VwLmV4dGVuZGVkID09ICdmdW5jdGlvbicpIHN1cC5leHRlbmRlZChzdWIpO1xuICByZXR1cm4gc3ViO1xufVxuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCJ2YXIgQ29tcG9uZW50LCBzaCwgdGVtcGxhdGVzLCBQaG90b0Nyb3BwZXI7XG5Db21wb25lbnQgPSByZXF1aXJlKCd5YWNvbXBvbmVudCcpO1xuc2ggPSByZXF1aXJlKCcuLi9hcHAvc2hhcmVkLWhlbHBlcnMubHMnKTtcbnRlbXBsYXRlcyA9IHJlcXVpcmUoJy4uL2J1aWxkL2NvbXBvbmVudC1qYWRlLmpzJykudGVtcGxhdGVzO1xubW9kdWxlLmV4cG9ydHMgPSBQaG90b0Nyb3BwZXIgPSAoZnVuY3Rpb24oc3VwZXJjbGFzcyl7XG4gIHZhciBwcm90b3R5cGUgPSBleHRlbmQkKChpbXBvcnQkKFBob3RvQ3JvcHBlciwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnUGhvdG9Dcm9wcGVyJywgUGhvdG9Dcm9wcGVyKSwgc3VwZXJjbGFzcykucHJvdG90eXBlLCBjb25zdHJ1Y3RvciA9IFBob3RvQ3JvcHBlcjtcbiAgUGhvdG9Dcm9wcGVyLnBjID0gbnVsbDtcbiAgUGhvdG9Dcm9wcGVyLnN0YXJ0ID0gZnVuY3Rpb24oYXJnJCwgY2Ipe1xuICAgIHZhciByZWYkLCB0aXRsZSwgcmVmMSQsIG1vZGUsIHBob3RvLCBhc3BlY3RSYXRpbywgZW5kcG9pbnRVcmw7XG4gICAgcmVmJCA9IGFyZyQgIT0gbnVsbFxuICAgICAgPyBhcmckXG4gICAgICA6IHt9LCB0aXRsZSA9IChyZWYxJCA9IHJlZiQudGl0bGUpICE9IG51bGwgPyByZWYxJCA6IFwiUHJvZmlsZSBQaG90b1wiLCBtb2RlID0gKHJlZjEkID0gcmVmJC5tb2RlKSAhPSBudWxsID8gcmVmMSQgOiAndXBsb2FkJywgcGhvdG8gPSAocmVmMSQgPSByZWYkLnBob3RvKSAhPSBudWxsID8gcmVmMSQgOiBudWxsLCBhc3BlY3RSYXRpbyA9IChyZWYxJCA9IHJlZiQuYXNwZWN0UmF0aW8pICE9IG51bGxcbiAgICAgID8gcmVmMSRcbiAgICAgIDogMSAvIDEsIGVuZHBvaW50VXJsID0gKHJlZjEkID0gcmVmJC5lbmRwb2ludFVybCkgIT0gbnVsbCA/IHJlZjEkIDogbnVsbDtcbiAgICBjYiA9PSBudWxsICYmIChjYiA9IGZ1bmN0aW9uKCl7fSk7XG4gICAgaWYgKCFwaG90bykge1xuICAgICAgcGhvdG8gPSB1c2VyLnBob3RvO1xuICAgIH1cbiAgICBpZiAoIWVuZHBvaW50VXJsKSB7XG4gICAgICBlbmRwb2ludFVybCA9IFwiL3Jlc291cmNlcy91c2Vycy9cIiArIHVzZXIuaWQgKyBcIi9hdmF0YXJcIjtcbiAgICB9XG4gICAgcmV0dXJuIGxhenlMb2FkRmFuY3lib3goZnVuY3Rpb24oKXtcbiAgICAgIFBob3RvQ3JvcHBlci5wYyA9IG5ldyBQaG90b0Nyb3BwZXIoe1xuICAgICAgICBhc3BlY3RSYXRpbzogYXNwZWN0UmF0aW8sXG4gICAgICAgIGVuZHBvaW50VXJsOiBlbmRwb2ludFVybCxcbiAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgdGl0bGU6IHRpdGxlLFxuICAgICAgICAgIHBob3RvOiBwaG90byxcbiAgICAgICAgICBlbmRwb2ludFVybDogZW5kcG9pbnRVcmxcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAobW9kZSA9PT0gJ2Nyb3AnKSB7XG4gICAgICAgIFBob3RvQ3JvcHBlci5wYy5jcm9wTW9kZSgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICQuZmFuY3lib3gub3BlbihQaG90b0Nyb3BwZXIucGMuJCwge1xuICAgICAgICBhZnRlckxvYWQ6IGNiXG4gICAgICB9KTtcbiAgICB9KTtcbiAgfTtcbiAgZnVuY3Rpb24gUGhvdG9Dcm9wcGVyKGFyZyQpe1xuICAgIHZhciB0aXRsZSwgYXNwZWN0UmF0aW87XG4gICAgdGl0bGUgPSBhcmckLnRpdGxlLCBhc3BlY3RSYXRpbyA9IGFyZyQuYXNwZWN0UmF0aW8sIHRoaXMuZW5kcG9pbnRVcmwgPSBhcmckLmVuZHBvaW50VXJsO1xuICAgIHRoaXMuY3JvcCA9IGJpbmQkKHRoaXMsICdjcm9wJywgcHJvdG90eXBlKTtcbiAgICB0aGlzLmFzcGVjdFJhdGlvID0gcGFyc2VGbG9hdChhc3BlY3RSYXRpbyk7XG4gICAgUGhvdG9Dcm9wcGVyLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICBwcm90b3R5cGUudGVtcGxhdGUgPSB0ZW1wbGF0ZXMuUGhvdG9Dcm9wcGVyO1xuICBwcm90b3R5cGUuamNyb3AgPSBudWxsO1xuICBwcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgaWYgKHRoaXMuYXNwZWN0UmF0aW8pIHtcbiAgICAgIHJldHVybiAxO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9XG4gIH07XG4gIHByb3RvdHlwZS5vbkF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICB0aGlzLiQuZmluZCgnLnVwbG9hZCBpbnB1dFt0eXBlPWZpbGVdJykuaHRtbDVVcGxvYWRlcih7XG4gICAgICBuYW1lOiAnYXZhdGFyJyxcbiAgICAgIHBvc3RVcmw6IHRoaXMuZW5kcG9pbnRVcmwsXG4gICAgICBvblN1Y2Nlc3M6IGZ1bmN0aW9uKHhociwgZmlsZSwgckpzb24pe1xuICAgICAgICB2YXIgcjtcbiAgICAgICAgciA9IEpTT04ucGFyc2Uockpzb24pO1xuICAgICAgICB0aGlzJC4kLmZpbmQoJ2ltZycpLmF0dHIoJ3NyYycsIGNhY2hlVXJsICsgXCJcIiArIHIudXJsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMkLmNyb3BNb2RlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuJC5maW5kKCcuY3JvcCAuYnV0dG9uJykuY2xpY2sodGhpcy5jcm9wKTtcbiAgfTtcbiAgcHJvdG90eXBlLnVwbG9hZCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGRhdGEsIGpxeGhyLCB0aGlzJCA9IHRoaXM7XG4gICAgZGF0YSA9IHRoaXMuJC5maW5kKCdmb3JtJykuc2VyaWFsaXplKCk7XG4gICAganF4aHIgPSBjb25zdHJ1Y3Rvci4kLnBvc3QodGhpcy5lbmRwb2ludFVybCwgZGF0YSk7XG4gICAganF4aHIuZG9uZShmdW5jdGlvbihyKXtcbiAgICAgIHJldHVybiB0aGlzJC5jcm9wTW9kZShyKTtcbiAgICB9KTtcbiAgICByZXR1cm4ganF4aHIuZmFpbChmdW5jdGlvbihyKXtcbiAgICAgIHJldHVybiBjb25zb2xlLndhcm4oJ3VwbG9hZCBmYWlsZWQnLCByKTtcbiAgICB9KTtcbiAgfTtcbiAgcHJvdG90eXBlLnVwbG9hZE1vZGUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuJC5maW5kKCcuY3JvcCcpLmhpZGUoKTtcbiAgICByZXR1cm4gdGhpcy4kLmZpbmQoJy51cGxvYWQnKS5zaG93KCk7XG4gIH07XG4gIHByb3RvdHlwZS5jcm9wTW9kZSA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICB0aGlzLiQuZmluZCgnLnVwbG9hZCcpLmhpZGUoKTtcbiAgICB0aGlzLiQuZmluZCgnLmNyb3AnKS5zaG93KCk7XG4gICAgcmV0dXJuIGxhenlMb2FkSmNyb3AoZnVuY3Rpb24oKXtcbiAgICAgIHZhciBvcHRpb25zLCBmYiwgc2F2ZUpjcm9wO1xuICAgICAgaWYgKHRoaXMkLmpjcm9wKSB7XG4gICAgICAgIHRoaXMkLmpjcm9wLmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICAgIG9wdGlvbnMgPSB7XG4gICAgICAgIGFzcGVjdFJhdGlvOiB0aGlzJC5hc3BlY3RSYXRpb1xuICAgICAgfTtcbiAgICAgIGltcG9ydCQob3B0aW9ucywgdGhpcyQuYm94RGltZW5zaW9ucygpKTtcbiAgICAgIGZiID0gY29uc3RydWN0b3IuJC5mYW5jeWJveDtcbiAgICAgIHNhdmVKY3JvcCA9IGZ1bmN0aW9uKGope1xuICAgICAgICByZXR1cm4gdGhpcyQuamNyb3AgPSBqO1xuICAgICAgfTtcbiAgICAgIHJldHVybiB0aGlzJC4kLmZpbmQoJy5jcm9wIGltZycpLkpjcm9wKG9wdGlvbnMsIGZ1bmN0aW9uKCl7XG4gICAgICAgIHNhdmVKY3JvcCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIGZiLnVwZGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIHByb3RvdHlwZS5ib3hEaW1lbnNpb25zID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgZmFuY3lib3hTaWRlTWFyZ2luLCByZXNpemU7XG4gICAgZmFuY3lib3hTaWRlTWFyZ2luID0gMzU7XG4gICAgcmVzaXplID0gMC45NTtcbiAgICByZXR1cm4ge1xuICAgICAgYm94V2lkdGg6IHBhcnNlSW50KGNvbnN0cnVjdG9yLiQod2luZG93KS53aWR0aCgpIC0gZmFuY3lib3hTaWRlTWFyZ2luICogMiksXG4gICAgICBib3hIZWlnaHQ6IHBhcnNlSW50KGNvbnN0cnVjdG9yLiQod2luZG93KS5oZWlnaHQoKSAqIHJlc2l6ZSlcbiAgICB9O1xuICB9O1xuICBwcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uKGV2KXtcbiAgICB2YXIgZGF0YSwganF4aHIsIHRoaXMkID0gdGhpcztcbiAgICBkYXRhID0gdGhpcy5qY3JvcC50ZWxsU2VsZWN0KCk7XG4gICAgaWYgKGRhdGEuaGVpZ2h0ID09PSAwIHx8IGRhdGEud2lkdGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAganF4aHIgPSBjb25zdHJ1Y3Rvci4kLmFqYXgoe1xuICAgICAgdHlwZTogJ1BVVCcsXG4gICAgICBkYXRhOiBkYXRhLFxuICAgICAgdXJsOiB0aGlzLmVuZHBvaW50VXJsXG4gICAgfSk7XG4gICAganF4aHIuZG9uZShmdW5jdGlvbihyKXtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci4kLmZhbmN5Ym94LmNsb3NlKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIGpxeGhyLmZhaWwoZnVuY3Rpb24ocil7XG4gICAgICByZXR1cm4gY29uc29sZS53YXJuKCd1cGxvYWQgZmFpbGVkJywgcik7XG4gICAgfSk7XG4gIH07XG4gIHJldHVybiBQaG90b0Nyb3BwZXI7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gYmluZCQob2JqLCBrZXksIHRhcmdldCl7XG4gIHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gKHRhcmdldCB8fCBvYmopW2tleV0uYXBwbHkob2JqLCBhcmd1bWVudHMpIH07XG59XG5mdW5jdGlvbiBleHRlbmQkKHN1Yiwgc3VwKXtcbiAgZnVuY3Rpb24gZnVuKCl7fSBmdW4ucHJvdG90eXBlID0gKHN1Yi5zdXBlcmNsYXNzID0gc3VwKS5wcm90b3R5cGU7XG4gIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gIGlmICh0eXBlb2Ygc3VwLmV4dGVuZGVkID09ICdmdW5jdGlvbicpIHN1cC5leHRlbmRlZChzdWIpO1xuICByZXR1cm4gc3ViO1xufVxuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCJ2YXIgQ29tcG9uZW50LCB0ZW1wbGF0ZXMsIFBhZ2luYXRvcjtcbkNvbXBvbmVudCA9IHJlcXVpcmUoJ3lhY29tcG9uZW50Jyk7XG50ZW1wbGF0ZXMgPSByZXF1aXJlKCcuLi9idWlsZC9jb21wb25lbnQtamFkZS5qcycpLnRlbXBsYXRlcztcbmZ1bmN0aW9uIGNhbGNQYWdlcyhhY3RpdmVQYWdlLCBzdGVwLCBxdHksIHBhZ2VEaXN0YW5jZSwgcGFnZVF0eSwgcG51bVRvSHJlZil7XG4gIHZhciBiZWcsIGVuZCwgcGFnZXMsIHJlcyQsIGkkLCByZWYkLCBsZW4kLCBudW0sIGZpcnN0TnVtLCBsYXN0TnVtO1xuICBhY3RpdmVQYWdlID0gcGFyc2VJbnQoYWN0aXZlUGFnZSk7XG4gIHN0ZXAgPSBwYXJzZUludChzdGVwKTtcbiAgcXR5ID0gcGFyc2VJbnQocXR5KTtcbiAgcGFnZURpc3RhbmNlID0gcGFyc2VJbnQocGFnZURpc3RhbmNlKTtcbiAgcGFnZVF0eSA9IHBhcnNlSW50KHBhZ2VRdHkpO1xuICBhY3RpdmVQYWdlID0gcGFyc2VJbnQoYWN0aXZlUGFnZSk7XG4gIGJlZyA9IE1hdGgubWF4KGFjdGl2ZVBhZ2UgLSBwYWdlRGlzdGFuY2UsIDEpO1xuICBlbmQgPSBNYXRoLm1pbihhY3RpdmVQYWdlICsgcGFnZURpc3RhbmNlLCBwYWdlUXR5KTtcbiAgaWYgKGFjdGl2ZVBhZ2UgPD0gcGFnZURpc3RhbmNlKSB7XG4gICAgZW5kID0gTWF0aC5taW4oZW5kICsgKHBhZ2VEaXN0YW5jZSAtIGFjdGl2ZVBhZ2UpICsgMSwgcGFnZVF0eSk7XG4gIH0gZWxzZSBpZiAoYWN0aXZlUGFnZSA+PSBwYWdlUXR5IC0gcGFnZURpc3RhbmNlKSB7XG4gICAgYmVnID0gTWF0aC5tYXgoYmVnIC0gKHBhZ2VEaXN0YW5jZSAtIChwYWdlUXR5IC0gYWN0aXZlUGFnZSkpLCAxKTtcbiAgfVxuICByZXMkID0gW107XG4gIGZvciAoaSQgPSAwLCBsZW4kID0gKHJlZiQgPSAoZm4kKCkpKS5sZW5ndGg7IGkkIDwgbGVuJDsgKytpJCkge1xuICAgIG51bSA9IHJlZiRbaSRdO1xuICAgIHJlcyQucHVzaCh7XG4gICAgICBudW06IG51bSxcbiAgICAgIHRpdGxlOiBudW0sXG4gICAgICBocmVmOiBwbnVtVG9IcmVmKG51bSksXG4gICAgICBhY3RpdmU6IGFjdGl2ZVBhZ2UgPT09IG51bVxuICAgIH0pO1xuICB9XG4gIHBhZ2VzID0gcmVzJDtcbiAgZmlyc3ROdW0gPSAxO1xuICBpZiAocGFnZXMubGVuZ3RoICYmIHBhZ2VzWzBdLnRpdGxlICE9PSBmaXJzdE51bSkge1xuICAgIHBhZ2VzLnVuc2hpZnQoe1xuICAgICAgbnVtOiBmaXJzdE51bSxcbiAgICAgIHRpdGxlOiAnRmlyc3QnLFxuICAgICAgaHJlZjogcG51bVRvSHJlZihmaXJzdE51bSlcbiAgICB9KTtcbiAgfVxuICBsYXN0TnVtID0gcGFnZXMubGVuZ3RoIC0gMTtcbiAgaWYgKHBhZ2VzLmxlbmd0aCAmJiBwYWdlc1tsYXN0TnVtXS50aXRsZSAhPT0gcGFnZVF0eSkge1xuICAgIHBhZ2VzLnB1c2goe1xuICAgICAgbnVtOiBwYWdlUXR5LFxuICAgICAgdGl0bGU6ICdMYXN0JyxcbiAgICAgIGhyZWY6IHBudW1Ub0hyZWYocGFnZVF0eSlcbiAgICB9KTtcbiAgfVxuICByZXR1cm4gcGFnZXM7XG4gIGZ1bmN0aW9uIGZuJCgpe1xuICAgIHZhciBpJCwgdG8kLCByZXN1bHRzJCA9IFtdO1xuICAgIGZvciAoaSQgPSBiZWcsIHRvJCA9IGVuZDsgaSQgPD0gdG8kOyArK2kkKSB7XG4gICAgICByZXN1bHRzJC5wdXNoKGkkKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdHMkO1xuICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IFBhZ2luYXRvciA9IChmdW5jdGlvbihzdXBlcmNsYXNzKXtcbiAgdmFyIGRlZmF1bHRMb2NhbHMsIHByb3RvdHlwZSA9IGV4dGVuZCQoKGltcG9ydCQoUGFnaW5hdG9yLCBzdXBlcmNsYXNzKS5kaXNwbGF5TmFtZSA9ICdQYWdpbmF0b3InLCBQYWdpbmF0b3IpLCBzdXBlcmNsYXNzKS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gUGFnaW5hdG9yO1xuICBkZWZhdWx0TG9jYWxzID0ge1xuICAgIGFjdGl2ZVBhZ2U6IDEsXG4gICAgc3RlcDogOCxcbiAgICBxdHk6IDAsXG4gICAgcGFnZURpc3RhbmNlOiA0XG4gIH07XG4gIGZ1bmN0aW9uIFBhZ2luYXRvcihhcmckKXtcbiAgICB2YXIgcmVmJCwgcG51bVRvSHJlZjtcbiAgICByZWYkID0gYXJnJCAhPSBudWxsXG4gICAgICA/IGFyZyRcbiAgICAgIDoge30sIHBudW1Ub0hyZWYgPSByZWYkLnBudW1Ub0hyZWYsIHRoaXMub25QYWdlID0gcmVmJC5vblBhZ2U7XG4gICAgaWYgKCFwbnVtVG9IcmVmKSB7XG4gICAgICBpZiAodGhpcy5vblBhZ2UpIHtcbiAgICAgICAgcG51bVRvSHJlZiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgcmV0dXJuICcjJztcbiAgICAgICAgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHBudW1Ub0hyZWYgPSBmdW5jdGlvbihpdCl7XG4gICAgICAgICAgcmV0dXJuIFwiP3BhZ2U9XCIgKyBpdDtcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5wbnVtVG9IcmVmID0gY29uc3RydWN0b3IuJFIuc3RhdGUocG51bVRvSHJlZik7XG4gICAgUGFnaW5hdG9yLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICBwcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGssIHJlZiQsIHYsIHRoaXMkID0gdGhpcztcbiAgICBmb3IgKGsgaW4gcmVmJCA9IGRlZmF1bHRMb2NhbHMpIHtcbiAgICAgIHYgPSByZWYkW2tdO1xuICAgICAgaWYgKHRoaXMubG9jYWwoaykgPT09IHZvaWQgOCkge1xuICAgICAgICB0aGlzLmxvY2FsKGssIHYpO1xuICAgICAgfVxuICAgIH1cbiAgICB0aGlzLnN0YXRlLnBhZ2VRdHkgPSBjb25zdHJ1Y3Rvci4kUihmdW5jdGlvbihxdHksIHN0ZXApe1xuICAgICAgcmV0dXJuIE1hdGguY2VpbChxdHkgLyBzdGVwKTtcbiAgICB9KS5iaW5kVG8odGhpcy5zdGF0ZS5xdHksIHRoaXMuc3RhdGUuc3RlcCk7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICB2YXIgYmluZGluZ3MsIHJlZiQ7XG4gICAgICBiaW5kaW5ncyA9IFt0aGlzJC5zdGF0ZS5hY3RpdmVQYWdlLCB0aGlzJC5zdGF0ZS5zdGVwLCB0aGlzJC5zdGF0ZS5xdHksIHRoaXMkLnN0YXRlLnBhZ2VEaXN0YW5jZSwgdGhpcyQuc3RhdGUucGFnZVF0eSwgdGhpcyQucG51bVRvSHJlZl07XG4gICAgICByZXR1cm4gdGhpcyQuc3RhdGUucGFnZXMgPSAocmVmJCA9IGNvbnN0cnVjdG9yLiRSKGNhbGNQYWdlcykpLmJpbmRUby5hcHBseShyZWYkLCBiaW5kaW5ncyk7XG4gICAgfSgpO1xuICB9O1xuICBwcm90b3R5cGUudGVtcGxhdGUgPSB0ZW1wbGF0ZXMuUGFnaW5hdG9yO1xuICBwcm90b3R5cGUub25BdHRhY2ggPSBmdW5jdGlvbigpe1xuICAgIHZhciBjLCBoYW5kbGVyO1xuICAgIHRoaXMuJC5zaG93KCk7XG4gICAgaWYgKHRoaXMub25QYWdlKSB7XG4gICAgICBjID0gdGhpcztcbiAgICAgIGhhbmRsZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgcGc7XG4gICAgICAgIHBnID0gcGFyc2VJbnQoY29uc3RydWN0b3IuJCh0aGlzKS5kYXRhKCdwYWdlJykpO1xuICAgICAgICBjLmxvY2FsKCdhY3RpdmVQYWdlJywgcGcpO1xuICAgICAgICBjLnJlbG9hZCgpO1xuICAgICAgICBjLm9uUGFnZShwZywgYyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH07XG4gICAgICByZXR1cm4gdGhpcy4kLm9uKCdjbGljaycsICdhJywgaGFuZGxlcik7XG4gICAgfVxuICB9O1xuICBwcm90b3R5cGUub25EZXRhY2ggPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiB0aGlzLiQub2ZmKCk7XG4gIH07XG4gIHJldHVybiBQYWdpbmF0b3I7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gZXh0ZW5kJChzdWIsIHN1cCl7XG4gIGZ1bmN0aW9uIGZ1bigpe30gZnVuLnByb3RvdHlwZSA9IChzdWIuc3VwZXJjbGFzcyA9IHN1cCkucHJvdG90eXBlO1xuICAoc3ViLnByb3RvdHlwZSA9IG5ldyBmdW4pLmNvbnN0cnVjdG9yID0gc3ViO1xuICBpZiAodHlwZW9mIHN1cC5leHRlbmRlZCA9PSAnZnVuY3Rpb24nKSBzdXAuZXh0ZW5kZWQoc3ViKTtcbiAgcmV0dXJuIHN1Yjtcbn1cbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59IiwidmFyIENvbXBvbmVudCwgdGVtcGxhdGVzLCBBZG1pblVwZ3JhZGU7XG5Db21wb25lbnQgPSByZXF1aXJlKCd5YWNvbXBvbmVudCcpO1xudGVtcGxhdGVzID0gcmVxdWlyZSgnLi4vYnVpbGQvY29tcG9uZW50LWphZGUuanMnKS50ZW1wbGF0ZXM7XG5tb2R1bGUuZXhwb3J0cyA9IEFkbWluVXBncmFkZSA9IChmdW5jdGlvbihzdXBlcmNsYXNzKXtcbiAgdmFyIHByb3RvdHlwZSA9IGV4dGVuZCQoKGltcG9ydCQoQWRtaW5VcGdyYWRlLCBzdXBlcmNsYXNzKS5kaXNwbGF5TmFtZSA9ICdBZG1pblVwZ3JhZGUnLCBBZG1pblVwZ3JhZGUpLCBzdXBlcmNsYXNzKS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gQWRtaW5VcGdyYWRlO1xuICBwcm90b3R5cGUudGVtcGxhdGUgPSB0ZW1wbGF0ZXMuQWRtaW5VcGdyYWRlO1xuICBmdW5jdGlvbiBBZG1pblVwZ3JhZGUoKXtcbiAgICBBZG1pblVwZ3JhZGUuc3VwZXJjbGFzcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICB9XG4gIHJldHVybiBBZG1pblVwZ3JhZGU7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gZXh0ZW5kJChzdWIsIHN1cCl7XG4gIGZ1bmN0aW9uIGZ1bigpe30gZnVuLnByb3RvdHlwZSA9IChzdWIuc3VwZXJjbGFzcyA9IHN1cCkucHJvdG90eXBlO1xuICAoc3ViLnByb3RvdHlwZSA9IG5ldyBmdW4pLmNvbnN0cnVjdG9yID0gc3ViO1xuICBpZiAodHlwZW9mIHN1cC5leHRlbmRlZCA9PSAnZnVuY3Rpb24nKSBzdXAuZXh0ZW5kZWQoc3ViKTtcbiAgcmV0dXJuIHN1Yjtcbn1cbmZ1bmN0aW9uIGltcG9ydCQob2JqLCBzcmMpe1xuICB2YXIgb3duID0ge30uaGFzT3duUHJvcGVydHk7XG4gIGZvciAodmFyIGtleSBpbiBzcmMpIGlmIChvd24uY2FsbChzcmMsIGtleSkpIG9ialtrZXldID0gc3JjW2tleV07XG4gIHJldHVybiBvYmo7XG59IiwidmFyIGxvZGFzaCwgQ29tcG9uZW50LCBQYXJhbGxheEJ1dHRvbiwgU2l0ZVJlZ2lzdGVyLCBzaCwgdGVtcGxhdGVzLCBkZWJvdW5jZSwgU2FsZXMsIHNsaWNlJCA9IFtdLnNsaWNlO1xubG9kYXNoID0gcmVxdWlyZSgnbG9kYXNoJyk7XG5Db21wb25lbnQgPSByZXF1aXJlKCd5YWNvbXBvbmVudCcpO1xuUGFyYWxsYXhCdXR0b24gPSByZXF1aXJlKCcuL1BhcmFsbGF4QnV0dG9uLmxzJyk7XG5TaXRlUmVnaXN0ZXIgPSByZXF1aXJlKCcuL1NpdGVSZWdpc3Rlci5scycpO1xuc2ggPSByZXF1aXJlKCcuLi9hcHAvc2hhcmVkLWhlbHBlcnMubHMnKTtcbnRlbXBsYXRlcyA9IHJlcXVpcmUoJy4uL2J1aWxkL2NvbXBvbmVudC1qYWRlLmpzJykudGVtcGxhdGVzO1xuZGVib3VuY2UgPSBwYXJ0aWFsaXplJC5hcHBseShsb2Rhc2gsIFtsb2Rhc2guZGVib3VuY2UsIFt2b2lkIDgsIDI1MF0sIFswXV0pO1xubW9kdWxlLmV4cG9ydHMgPSBTYWxlcyA9IChmdW5jdGlvbihzdXBlcmNsYXNzKXtcbiAgdmFyIHByb3RvdHlwZSA9IGV4dGVuZCQoKGltcG9ydCQoU2FsZXMsIHN1cGVyY2xhc3MpLmRpc3BsYXlOYW1lID0gJ1NhbGVzJywgU2FsZXMpLCBzdXBlcmNsYXNzKS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gU2FsZXM7XG4gIHByb3RvdHlwZS50ZW1wbGF0ZSA9IHRlbXBsYXRlcy5TYWxlcztcbiAgcHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMubG9jYWwoJ3N1YmRvbWFpbicsICcnKTtcbiAgICByZXR1cm4gdGhpcy5jaGlsZHJlbiA9IHtcbiAgICAgIHJlZ2lzdGVyVG9wOiBuZXcgU2l0ZVJlZ2lzdGVyKHtcbiAgICAgICAgbG9jYWxzOiB7XG4gICAgICAgICAgc3ViZG9tYWluOiB0aGlzLnN0YXRlLnN1YmRvbWFpblxuICAgICAgICB9XG4gICAgICB9LCAnI3JlZ2lzdGVyX3RvcCcsIHRoaXMpLFxuICAgICAgcmVnaXN0ZXJCb3R0b206IG5ldyBTaXRlUmVnaXN0ZXIoe1xuICAgICAgICBsb2NhbHM6IHtcbiAgICAgICAgICBzdWJkb21haW46IHRoaXMuc3RhdGUuc3ViZG9tYWluXG4gICAgICAgIH1cbiAgICAgIH0sICcjcmVnaXN0ZXJfYm90dG9tJywgdGhpcylcbiAgICB9O1xuICB9O1xuICBwcm90b3R5cGUub25BdHRhY2ggPSBmdW5jdGlvbigpe1xuICAgIHZhciB0aGlzJCA9IHRoaXM7XG4gICAgcmV0dXJuIGNvbnN0cnVjdG9yLiRSKGZ1bmN0aW9uKHN1YmRvbWFpbil7XG4gICAgICB2YXIgaSQsIHJlZiQsIGxlbiQsIGMsIHJlc3VsdHMkID0gW107XG4gICAgICBmb3IgKGkkID0gMCwgbGVuJCA9IChyZWYkID0gW3RoaXMkLmNoaWxkcmVuLnJlZ2lzdGVyVG9wLCB0aGlzJC5jaGlsZHJlbi5yZWdpc3RlckJvdHRvbV0pLmxlbmd0aDsgaSQgPCBsZW4kOyArK2kkKSB7XG4gICAgICAgIGMgPSByZWYkW2kkXTtcbiAgICAgICAgcmVzdWx0cyQucHVzaChjLnVwZGF0ZVN1YmRvbWFpbihzdWJkb21haW4pKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHRzJDtcbiAgICB9KS5iaW5kVG8odGhpcy5zdGF0ZS5zdWJkb21haW4pO1xuICB9O1xuICBmdW5jdGlvbiBTYWxlcygpe1xuICAgIFNhbGVzLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICByZXR1cm4gU2FsZXM7XG59KENvbXBvbmVudCkpO1xuZnVuY3Rpb24gcGFydGlhbGl6ZSQoZiwgYXJncywgd2hlcmUpe1xuICB2YXIgY29udGV4dCA9IHRoaXM7XG4gIHJldHVybiBmdW5jdGlvbigpe1xuICAgIHZhciBwYXJhbXMgPSBzbGljZSQuY2FsbChhcmd1bWVudHMpLCBpLFxuICAgICAgICBsZW4gPSBwYXJhbXMubGVuZ3RoLCB3bGVuID0gd2hlcmUubGVuZ3RoLFxuICAgICAgICB0YSA9IGFyZ3MgPyBhcmdzLmNvbmNhdCgpIDogW10sIHR3ID0gd2hlcmUgPyB3aGVyZS5jb25jYXQoKSA6IFtdO1xuICAgIGZvcihpID0gMDsgaSA8IGxlbjsgKytpKSB7IHRhW3R3WzBdXSA9IHBhcmFtc1tpXTsgdHcuc2hpZnQoKTsgfVxuICAgIHJldHVybiBsZW4gPCB3bGVuICYmIGxlbiA/XG4gICAgICBwYXJ0aWFsaXplJC5hcHBseShjb250ZXh0LCBbZiwgdGEsIHR3XSkgOiBmLmFwcGx5KGNvbnRleHQsIHRhKTtcbiAgfTtcbn1cbmZ1bmN0aW9uIGV4dGVuZCQoc3ViLCBzdXApe1xuICBmdW5jdGlvbiBmdW4oKXt9IGZ1bi5wcm90b3R5cGUgPSAoc3ViLnN1cGVyY2xhc3MgPSBzdXApLnByb3RvdHlwZTtcbiAgKHN1Yi5wcm90b3R5cGUgPSBuZXcgZnVuKS5jb25zdHJ1Y3RvciA9IHN1YjtcbiAgaWYgKHR5cGVvZiBzdXAuZXh0ZW5kZWQgPT0gJ2Z1bmN0aW9uJykgc3VwLmV4dGVuZGVkKHN1Yik7XG4gIHJldHVybiBzdWI7XG59XG5mdW5jdGlvbiBpbXBvcnQkKG9iaiwgc3JjKXtcbiAgdmFyIG93biA9IHt9Lmhhc093blByb3BlcnR5O1xuICBmb3IgKHZhciBrZXkgaW4gc3JjKSBpZiAob3duLmNhbGwoc3JjLCBrZXkpKSBvYmpba2V5XSA9IHNyY1trZXldO1xuICByZXR1cm4gb2JqO1xufSIsIihmdW5jdGlvbihwcm9jZXNzKXtmdW5jdGlvbiBmaWx0ZXIgKHhzLCBmbikge1xuICAgIHZhciByZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHhzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChmbih4c1tpXSwgaSwgeHMpKSByZXMucHVzaCh4c1tpXSk7XG4gICAgfVxuICAgIHJldHVybiByZXM7XG59XG5cbi8vIHJlc29sdmVzIC4gYW5kIC4uIGVsZW1lbnRzIGluIGEgcGF0aCBhcnJheSB3aXRoIGRpcmVjdG9yeSBuYW1lcyB0aGVyZVxuLy8gbXVzdCBiZSBubyBzbGFzaGVzLCBlbXB0eSBlbGVtZW50cywgb3IgZGV2aWNlIG5hbWVzIChjOlxcKSBpbiB0aGUgYXJyYXlcbi8vIChzbyBhbHNvIG5vIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHNsYXNoZXMgLSBpdCBkb2VzIG5vdCBkaXN0aW5ndWlzaFxuLy8gcmVsYXRpdmUgYW5kIGFic29sdXRlIHBhdGhzKVxuZnVuY3Rpb24gbm9ybWFsaXplQXJyYXkocGFydHMsIGFsbG93QWJvdmVSb290KSB7XG4gIC8vIGlmIHRoZSBwYXRoIHRyaWVzIHRvIGdvIGFib3ZlIHRoZSByb290LCBgdXBgIGVuZHMgdXAgPiAwXG4gIHZhciB1cCA9IDA7XG4gIGZvciAodmFyIGkgPSBwYXJ0cy5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgdmFyIGxhc3QgPSBwYXJ0c1tpXTtcbiAgICBpZiAobGFzdCA9PSAnLicpIHtcbiAgICAgIHBhcnRzLnNwbGljZShpLCAxKTtcbiAgICB9IGVsc2UgaWYgKGxhc3QgPT09ICcuLicpIHtcbiAgICAgIHBhcnRzLnNwbGljZShpLCAxKTtcbiAgICAgIHVwKys7XG4gICAgfSBlbHNlIGlmICh1cCkge1xuICAgICAgcGFydHMuc3BsaWNlKGksIDEpO1xuICAgICAgdXAtLTtcbiAgICB9XG4gIH1cblxuICAvLyBpZiB0aGUgcGF0aCBpcyBhbGxvd2VkIHRvIGdvIGFib3ZlIHRoZSByb290LCByZXN0b3JlIGxlYWRpbmcgLi5zXG4gIGlmIChhbGxvd0Fib3ZlUm9vdCkge1xuICAgIGZvciAoOyB1cC0tOyB1cCkge1xuICAgICAgcGFydHMudW5zaGlmdCgnLi4nKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcGFydHM7XG59XG5cbi8vIFJlZ2V4IHRvIHNwbGl0IGEgZmlsZW5hbWUgaW50byBbKiwgZGlyLCBiYXNlbmFtZSwgZXh0XVxuLy8gcG9zaXggdmVyc2lvblxudmFyIHNwbGl0UGF0aFJlID0gL14oLitcXC8oPyEkKXxcXC8pPygoPzouKz8pPyhcXC5bXi5dKik/KSQvO1xuXG4vLyBwYXRoLnJlc29sdmUoW2Zyb20gLi4uXSwgdG8pXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLnJlc29sdmUgPSBmdW5jdGlvbigpIHtcbnZhciByZXNvbHZlZFBhdGggPSAnJyxcbiAgICByZXNvbHZlZEFic29sdXRlID0gZmFsc2U7XG5cbmZvciAodmFyIGkgPSBhcmd1bWVudHMubGVuZ3RoOyBpID49IC0xICYmICFyZXNvbHZlZEFic29sdXRlOyBpLS0pIHtcbiAgdmFyIHBhdGggPSAoaSA+PSAwKVxuICAgICAgPyBhcmd1bWVudHNbaV1cbiAgICAgIDogcHJvY2Vzcy5jd2QoKTtcblxuICAvLyBTa2lwIGVtcHR5IGFuZCBpbnZhbGlkIGVudHJpZXNcbiAgaWYgKHR5cGVvZiBwYXRoICE9PSAnc3RyaW5nJyB8fCAhcGF0aCkge1xuICAgIGNvbnRpbnVlO1xuICB9XG5cbiAgcmVzb2x2ZWRQYXRoID0gcGF0aCArICcvJyArIHJlc29sdmVkUGF0aDtcbiAgcmVzb2x2ZWRBYnNvbHV0ZSA9IHBhdGguY2hhckF0KDApID09PSAnLyc7XG59XG5cbi8vIEF0IHRoaXMgcG9pbnQgdGhlIHBhdGggc2hvdWxkIGJlIHJlc29sdmVkIHRvIGEgZnVsbCBhYnNvbHV0ZSBwYXRoLCBidXRcbi8vIGhhbmRsZSByZWxhdGl2ZSBwYXRocyB0byBiZSBzYWZlIChtaWdodCBoYXBwZW4gd2hlbiBwcm9jZXNzLmN3ZCgpIGZhaWxzKVxuXG4vLyBOb3JtYWxpemUgdGhlIHBhdGhcbnJlc29sdmVkUGF0aCA9IG5vcm1hbGl6ZUFycmF5KGZpbHRlcihyZXNvbHZlZFBhdGguc3BsaXQoJy8nKSwgZnVuY3Rpb24ocCkge1xuICAgIHJldHVybiAhIXA7XG4gIH0pLCAhcmVzb2x2ZWRBYnNvbHV0ZSkuam9pbignLycpO1xuXG4gIHJldHVybiAoKHJlc29sdmVkQWJzb2x1dGUgPyAnLycgOiAnJykgKyByZXNvbHZlZFBhdGgpIHx8ICcuJztcbn07XG5cbi8vIHBhdGgubm9ybWFsaXplKHBhdGgpXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbnZhciBpc0Fic29sdXRlID0gcGF0aC5jaGFyQXQoMCkgPT09ICcvJyxcbiAgICB0cmFpbGluZ1NsYXNoID0gcGF0aC5zbGljZSgtMSkgPT09ICcvJztcblxuLy8gTm9ybWFsaXplIHRoZSBwYXRoXG5wYXRoID0gbm9ybWFsaXplQXJyYXkoZmlsdGVyKHBhdGguc3BsaXQoJy8nKSwgZnVuY3Rpb24ocCkge1xuICAgIHJldHVybiAhIXA7XG4gIH0pLCAhaXNBYnNvbHV0ZSkuam9pbignLycpO1xuXG4gIGlmICghcGF0aCAmJiAhaXNBYnNvbHV0ZSkge1xuICAgIHBhdGggPSAnLic7XG4gIH1cbiAgaWYgKHBhdGggJiYgdHJhaWxpbmdTbGFzaCkge1xuICAgIHBhdGggKz0gJy8nO1xuICB9XG4gIFxuICByZXR1cm4gKGlzQWJzb2x1dGUgPyAnLycgOiAnJykgKyBwYXRoO1xufTtcblxuXG4vLyBwb3NpeCB2ZXJzaW9uXG5leHBvcnRzLmpvaW4gPSBmdW5jdGlvbigpIHtcbiAgdmFyIHBhdGhzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAwKTtcbiAgcmV0dXJuIGV4cG9ydHMubm9ybWFsaXplKGZpbHRlcihwYXRocywgZnVuY3Rpb24ocCwgaW5kZXgpIHtcbiAgICByZXR1cm4gcCAmJiB0eXBlb2YgcCA9PT0gJ3N0cmluZyc7XG4gIH0pLmpvaW4oJy8nKSk7XG59O1xuXG5cbmV4cG9ydHMuZGlybmFtZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgdmFyIGRpciA9IHNwbGl0UGF0aFJlLmV4ZWMocGF0aClbMV0gfHwgJyc7XG4gIHZhciBpc1dpbmRvd3MgPSBmYWxzZTtcbiAgaWYgKCFkaXIpIHtcbiAgICAvLyBObyBkaXJuYW1lXG4gICAgcmV0dXJuICcuJztcbiAgfSBlbHNlIGlmIChkaXIubGVuZ3RoID09PSAxIHx8XG4gICAgICAoaXNXaW5kb3dzICYmIGRpci5sZW5ndGggPD0gMyAmJiBkaXIuY2hhckF0KDEpID09PSAnOicpKSB7XG4gICAgLy8gSXQgaXMganVzdCBhIHNsYXNoIG9yIGEgZHJpdmUgbGV0dGVyIHdpdGggYSBzbGFzaFxuICAgIHJldHVybiBkaXI7XG4gIH0gZWxzZSB7XG4gICAgLy8gSXQgaXMgYSBmdWxsIGRpcm5hbWUsIHN0cmlwIHRyYWlsaW5nIHNsYXNoXG4gICAgcmV0dXJuIGRpci5zdWJzdHJpbmcoMCwgZGlyLmxlbmd0aCAtIDEpO1xuICB9XG59O1xuXG5cbmV4cG9ydHMuYmFzZW5hbWUgPSBmdW5jdGlvbihwYXRoLCBleHQpIHtcbiAgdmFyIGYgPSBzcGxpdFBhdGhSZS5leGVjKHBhdGgpWzJdIHx8ICcnO1xuICAvLyBUT0RPOiBtYWtlIHRoaXMgY29tcGFyaXNvbiBjYXNlLWluc2Vuc2l0aXZlIG9uIHdpbmRvd3M/XG4gIGlmIChleHQgJiYgZi5zdWJzdHIoLTEgKiBleHQubGVuZ3RoKSA9PT0gZXh0KSB7XG4gICAgZiA9IGYuc3Vic3RyKDAsIGYubGVuZ3RoIC0gZXh0Lmxlbmd0aCk7XG4gIH1cbiAgcmV0dXJuIGY7XG59O1xuXG5cbmV4cG9ydHMuZXh0bmFtZSA9IGZ1bmN0aW9uKHBhdGgpIHtcbiAgcmV0dXJuIHNwbGl0UGF0aFJlLmV4ZWMocGF0aClbM10gfHwgJyc7XG59O1xuXG5leHBvcnRzLnJlbGF0aXZlID0gZnVuY3Rpb24oZnJvbSwgdG8pIHtcbiAgZnJvbSA9IGV4cG9ydHMucmVzb2x2ZShmcm9tKS5zdWJzdHIoMSk7XG4gIHRvID0gZXhwb3J0cy5yZXNvbHZlKHRvKS5zdWJzdHIoMSk7XG5cbiAgZnVuY3Rpb24gdHJpbShhcnIpIHtcbiAgICB2YXIgc3RhcnQgPSAwO1xuICAgIGZvciAoOyBzdGFydCA8IGFyci5sZW5ndGg7IHN0YXJ0KyspIHtcbiAgICAgIGlmIChhcnJbc3RhcnRdICE9PSAnJykgYnJlYWs7XG4gICAgfVxuXG4gICAgdmFyIGVuZCA9IGFyci5sZW5ndGggLSAxO1xuICAgIGZvciAoOyBlbmQgPj0gMDsgZW5kLS0pIHtcbiAgICAgIGlmIChhcnJbZW5kXSAhPT0gJycpIGJyZWFrO1xuICAgIH1cblxuICAgIGlmIChzdGFydCA+IGVuZCkgcmV0dXJuIFtdO1xuICAgIHJldHVybiBhcnIuc2xpY2Uoc3RhcnQsIGVuZCAtIHN0YXJ0ICsgMSk7XG4gIH1cblxuICB2YXIgZnJvbVBhcnRzID0gdHJpbShmcm9tLnNwbGl0KCcvJykpO1xuICB2YXIgdG9QYXJ0cyA9IHRyaW0odG8uc3BsaXQoJy8nKSk7XG5cbiAgdmFyIGxlbmd0aCA9IE1hdGgubWluKGZyb21QYXJ0cy5sZW5ndGgsIHRvUGFydHMubGVuZ3RoKTtcbiAgdmFyIHNhbWVQYXJ0c0xlbmd0aCA9IGxlbmd0aDtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGlmIChmcm9tUGFydHNbaV0gIT09IHRvUGFydHNbaV0pIHtcbiAgICAgIHNhbWVQYXJ0c0xlbmd0aCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICB2YXIgb3V0cHV0UGFydHMgPSBbXTtcbiAgZm9yICh2YXIgaSA9IHNhbWVQYXJ0c0xlbmd0aDsgaSA8IGZyb21QYXJ0cy5sZW5ndGg7IGkrKykge1xuICAgIG91dHB1dFBhcnRzLnB1c2goJy4uJyk7XG4gIH1cblxuICBvdXRwdXRQYXJ0cyA9IG91dHB1dFBhcnRzLmNvbmNhdCh0b1BhcnRzLnNsaWNlKHNhbWVQYXJ0c0xlbmd0aCkpO1xuXG4gIHJldHVybiBvdXRwdXRQYXJ0cy5qb2luKCcvJyk7XG59O1xuXG59KShyZXF1aXJlKFwiX19icm93c2VyaWZ5X3Byb2Nlc3NcIikpIiwiLypcbmV4cG9ydCBleGFtcGxlID1cbiAgQTpcbiAgICBhOiBcIkJcIlxuICAgIGI6IFwiQ1wiXG4gIEI6XG4gICAgYTogXCJBXCJcbiAgICBiOiBcIkNcIlxuICBDOlxuICAgIGE6IFwiQ1wiXG4gICAgYjogXCJDXCJcbiovXG52YXIgbmV3U3RhdGUsIG91dCQgPSB0eXBlb2YgZXhwb3J0cyAhPSAndW5kZWZpbmVkJyAmJiBleHBvcnRzIHx8IHRoaXM7XG5vdXQkLm5ld1N0YXRlID0gbmV3U3RhdGUgPSBmdW5jdGlvbihtYWNoaW5lLCBzdGF0ZSwgaW5wdXRzKXtcbiAgdmFyIHRyYW5zaXRpb247XG4gIHRyYW5zaXRpb24gPSBmdW5jdGlvbihzLCBpKXtcbiAgICByZXR1cm4gbWFjaGluZVtzXVtpXTtcbiAgfTtcbiAgcmV0dXJuIGZvbGQodHJhbnNpdGlvbiwgc3RhdGUsIGlucHV0cyk7XG59OyIsIihmdW5jdGlvbigpe1xuICB2YXIgZGVmaW5lO1xuICBkZWZpbmUgPSAodHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cgIT09IG51bGwgPyB3aW5kb3cuZGVmaW5lIDogdm9pZCA4KSB8fCByZXF1aXJlKCdhbWRlZmluZScpKG1vZHVsZSwgcmVxdWlyZSk7XG4gIGRlZmluZShmdW5jdGlvbihyZXF1aXJlKXtcbiAgICB2YXIgcmVhY3RpdmVqcywgZG9sbGFyaXNoLCBDb21wb25lbnQ7XG4gICAgcmVhY3RpdmVqcyA9IHJlcXVpcmUoJ3JlYWN0aXZlanMnKTtcbiAgICBkb2xsYXJpc2ggPSB0eXBlb2Ygd2luZG93ICE9ICd1bmRlZmluZWQnICYmIHdpbmRvdyAhPT0gbnVsbFxuICAgICAgPyB3aW5kb3cuJFxuICAgICAgOiByZXF1aXJlKCdjaGVlcmlvJyk7XG4gICAgcmV0dXJuIENvbXBvbmVudCA9IChmdW5jdGlvbigpe1xuICAgICAgQ29tcG9uZW50LmRpc3BsYXlOYW1lID0gJ0NvbXBvbmVudCc7XG4gICAgICB2YXIgcHJvdG90eXBlID0gQ29tcG9uZW50LnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBDb21wb25lbnQ7XG4gICAgICBDb21wb25lbnQuJCA9IGRvbGxhcmlzaDtcbiAgICAgIENvbXBvbmVudC4kUiA9IHJlYWN0aXZlanM7XG4gICAgICBmdW5jdGlvbiBDb21wb25lbnQoYXJnJCwgc2VsZWN0b3IsIHBhcmVudCl7XG4gICAgICAgIHZhciByZWYkLCBsb2NhbHMsIHJlZjEkLCBhdXRvUmVuZGVyLCBhdXRvQXR0YWNoLCByZXMkLCBrLCB2O1xuICAgICAgICByZWYkID0gYXJnJCAhPSBudWxsXG4gICAgICAgICAgPyBhcmckXG4gICAgICAgICAgOiB7fSwgbG9jYWxzID0gKHJlZjEkID0gcmVmJC5sb2NhbHMpICE9IG51bGxcbiAgICAgICAgICA/IHJlZjEkXG4gICAgICAgICAgOiB7fSwgYXV0b1JlbmRlciA9IChyZWYxJCA9IHJlZiQuYXV0b1JlbmRlcikgIT0gbnVsbCA/IHJlZjEkIDogdHJ1ZSwgYXV0b0F0dGFjaCA9IChyZWYxJCA9IHJlZiQuYXV0b0F0dGFjaCkgIT0gbnVsbCA/IHJlZjEkIDogdHJ1ZTtcbiAgICAgICAgdGhpcy5zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgcmVzJCA9IHt9O1xuICAgICAgICBmb3IgKGsgaW4gbG9jYWxzKSB7XG4gICAgICAgICAgdiA9IGxvY2Fsc1trXTtcbiAgICAgICAgICByZXMkW2tdID0gdiAhPSBudWxsICYmIHYuX2lzUmVhY3RpdmVcbiAgICAgICAgICAgID8gdlxuICAgICAgICAgICAgOiBjb25zdHJ1Y3Rvci4kUi5zdGF0ZSh2ID09PSB2b2lkIDggPyBudWxsIDogdik7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zdGF0ZSA9IHJlcyQ7XG4gICAgICAgIGlmICh0aGlzLnNlbGVjdG9yKSB7XG4gICAgICAgICAgaWYgKHRoaXMucGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLiQgPSB0aGlzLnBhcmVudC4kLmZpbmQodGhpcy5zZWxlY3Rvcik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuJCA9IGNvbnN0cnVjdG9yLiQodGhpcy5zZWxlY3Rvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuJHRvcCA9IGNvbnN0cnVjdG9yLiQoJzxkaXY+PGRpdi8+PC9kaXY+Jyk7XG4gICAgICAgICAgdGhpcy4kID0gdGhpcy4kdG9wLmZpbmQoJ2RpdicpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmluaXQpIHtcbiAgICAgICAgICB0aGlzLmluaXQoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMucGFyZW50KSB7XG4gICAgICAgICAgaWYgKGF1dG9SZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChhdXRvQXR0YWNoKSB7XG4gICAgICAgICAgICB0aGlzLmF0dGFjaCgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcHJvdG90eXBlLmlzQ2xpZW50ID0gdHlwZW9mIHdpbmRvdyAhPSAndW5kZWZpbmVkJyAmJiB3aW5kb3cgIT09IG51bGw7XG4gICAgICBwcm90b3R5cGUudGVtcGxhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgICB9O1xuICAgICAgcHJvdG90eXBlLmF0dGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBpJCwgcmVmJCwgY2hpbGQ7XG4gICAgICAgIGlmICghdGhpcy5pc0NsaWVudCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmlzQXR0YWNoZWQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jaGlsZHJlbikge1xuICAgICAgICAgIGZvciAoaSQgaW4gcmVmJCA9IHRoaXMuY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGNoaWxkID0gcmVmJFtpJF07XG4gICAgICAgICAgICBjaGlsZC5hdHRhY2goKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub25BdHRhY2gpIHtcbiAgICAgICAgICB0aGlzLm9uQXR0YWNoKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pc0F0dGFjaGVkID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgcHJvdG90eXBlLmRldGFjaCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBpJCwgcmVmJCwgY2hpbGQ7XG4gICAgICAgIGlmICghdGhpcy5pc0NsaWVudCkge1xuICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGlmICghdGhpcy5pc0F0dGFjaGVkKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuY2hpbGRyZW4pIHtcbiAgICAgICAgICBmb3IgKGkkIGluIHJlZiQgPSB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICBjaGlsZCA9IHJlZiRbaSRdO1xuICAgICAgICAgICAgY2hpbGQuZGV0YWNoKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm9uRGV0YWNoKSB7XG4gICAgICAgICAgdGhpcy5vbkRldGFjaCgpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaXNBdHRhY2hlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH07XG4gICAgICBwcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGxvY2FscywgdGVtcGxhdGVPdXQsICRkb20sIGkkLCByZWYkLCBjaGlsZDtcbiAgICAgICAgdGhpcy4kLmFkZENsYXNzKHRoaXMuY29uc3RydWN0b3IubmFtZSk7XG4gICAgICAgIGxvY2FscyA9IHRoaXMubG9jYWxzKCk7XG4gICAgICAgIHRlbXBsYXRlT3V0ID0gdGhpcy50ZW1wbGF0ZShsb2NhbHMpO1xuICAgICAgICBpZiAodGhpcy5tdXRhdGUgfHwgdGhpcy5jaGlsZHJlbikge1xuICAgICAgICAgICRkb20gPSBjb25zdHJ1Y3Rvci4kKCc8ZGl2IGNsYXNzPVwicmVuZGVyLXdyYXBwZXJcIj4nICsgdGVtcGxhdGVPdXQgKyAnPC9kaXY+Jyk7XG4gICAgICAgICAgaWYgKHRoaXMubXV0YXRlKSB7XG4gICAgICAgICAgICB0aGlzLm11dGF0ZSgkZG9tKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy4kLmh0bWwoJGRvbS5odG1sKCkpO1xuICAgICAgICAgIGlmICh0aGlzLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICBmb3IgKGkkIGluIHJlZiQgPSB0aGlzLmNoaWxkcmVuKSB7XG4gICAgICAgICAgICAgIGNoaWxkID0gcmVmJFtpJF07XG4gICAgICAgICAgICAgIGNoaWxkLiQgPSB0aGlzLiQuZmluZChjaGlsZC5zZWxlY3Rvcik7XG4gICAgICAgICAgICAgIGNoaWxkLnJlbmRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLiQuaHRtbCh0ZW1wbGF0ZU91dCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9O1xuICAgICAgcHJvdG90eXBlLnJlbG9hZCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB0aGlzLmRldGFjaCgpLnJlbmRlcigpLmF0dGFjaCgpO1xuICAgICAgfTtcbiAgICAgIHByb3RvdHlwZS5sb2NhbHMgPSBmdW5jdGlvbihuZXdMb2NhbHMpe1xuICAgICAgICB2YXIgaywgdiwgcmVmJCwgcywgcmVzdWx0cyQgPSB7fTtcbiAgICAgICAgaWYgKG5ld0xvY2Fscykge1xuICAgICAgICAgIGZvciAoayBpbiBuZXdMb2NhbHMpIHtcbiAgICAgICAgICAgIHYgPSBuZXdMb2NhbHNba107XG4gICAgICAgICAgICB0aGlzLmxvY2FsKGssIHYpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKGsgaW4gcmVmJCA9IHRoaXMuc3RhdGUpIHtcbiAgICAgICAgICBzID0gcmVmJFtrXTtcbiAgICAgICAgICByZXN1bHRzJFtrXSA9IHMoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0cyQ7XG4gICAgICB9O1xuICAgICAgcHJvdG90eXBlLmxvY2FsID0gZnVuY3Rpb24oaywgdil7XG4gICAgICAgIHZhciBleGlzdGluZ1I7XG4gICAgICAgIGV4aXN0aW5nUiA9IHRoaXMuc3RhdGVba107XG4gICAgICAgIGlmICh2ID09PSB2b2lkIDgpIHtcbiAgICAgICAgICBpZiAoZXhpc3RpbmdSKSB7XG4gICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdSKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChleGlzdGluZ1IpIHtcbiAgICAgICAgICAgIGlmIChleGlzdGluZ1IudmFsID09PSB2b2lkIDgpIHtcbiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiJ1wiICsgayArIFwiJyBpcyBub3QgcmVhY3RpdmUgc3RhdGUsIHlvdSBjYW4gb25seSBzZXQgcmVhY3RpdmUgc3RhdGVcIik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICByZXR1cm4gZXhpc3RpbmdSKHYgPT09IHZvaWQgOCA/IG51bGwgOiB2KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZVtrXSA9IGNvbnN0cnVjdG9yLiRSLnN0YXRlKHYgPT09IHZvaWQgOCA/IG51bGwgOiB2KTtcbiAgICAgICAgICAgIHJldHVybiB2O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIHByb3RvdHlwZS5odG1sID0gZnVuY3Rpb24od3JhcHBlZCl7XG4gICAgICAgIHdyYXBwZWQgPT0gbnVsbCAmJiAod3JhcHBlZCA9IHRydWUpO1xuICAgICAgICByZXR1cm4gKCh3cmFwcGVkICYmIHRoaXMuJHRvcCkgfHwgdGhpcy4kKS5odG1sKCk7XG4gICAgICB9O1xuICAgICAgcmV0dXJuIENvbXBvbmVudDtcbiAgICB9KCkpO1xuICB9KTtcbn0pLmNhbGwodGhpcyk7XG4iLCJ2YXIgQ29tcG9uZW50LCAkUiwgUGFyYWxsYXhCdXR0b247XG5Db21wb25lbnQgPSByZXF1aXJlKCd5YWNvbXBvbmVudCcpO1xuJFIgPSByZXF1aXJlKCdyZWFjdGl2ZWpzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IFBhcmFsbGF4QnV0dG9uID0gKGZ1bmN0aW9uKHN1cGVyY2xhc3Mpe1xuICB2YXIgcHJvdG90eXBlID0gZXh0ZW5kJCgoaW1wb3J0JChQYXJhbGxheEJ1dHRvbiwgc3VwZXJjbGFzcykuZGlzcGxheU5hbWUgPSAnUGFyYWxsYXhCdXR0b24nLCBQYXJhbGxheEJ1dHRvbiksIHN1cGVyY2xhc3MpLnByb3RvdHlwZSwgY29uc3RydWN0b3IgPSBQYXJhbGxheEJ1dHRvbjtcbiAgcHJvdG90eXBlLnRlbXBsYXRlID0gZnVuY3Rpb24oYXJnJCl7XG4gICAgdmFyIHRpdGxlO1xuICAgIHRpdGxlID0gYXJnJC50aXRsZTtcbiAgICByZXR1cm4gXCI8YnV0dG9uPlwiICsgdGl0bGUgKyBcIjwvYnV0dG9uPlwiO1xuICB9O1xuICBmdW5jdGlvbiBQYXJhbGxheEJ1dHRvbihhcmckKXtcbiAgICB2YXIgcmVmJDtcbiAgICB0aGlzLm9uQ2xpY2sgPSAocmVmJCA9IGFyZyQub25DbGljaykgIT0gbnVsbFxuICAgICAgPyByZWYkXG4gICAgICA6IGZ1bmN0aW9uKCl7fTtcbiAgICBQYXJhbGxheEJ1dHRvbi5zdXBlcmNsYXNzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gIH1cbiAgcHJvdG90eXBlLm9uQXR0YWNoID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgdGhpcyQgPSB0aGlzO1xuICAgIHRoaXMuJC5vbignY2xpY2snLCAnYnV0dG9uJywgZnVuY3Rpb24oKXtcbiAgICAgIHRoaXMkLm9uQ2xpY2soKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KTtcbiAgICB0aGlzLm9uTG9hZFJlc2l6ZSB8fCAodGhpcy5vbkxvYWRSZXNpemUgPSBmdW5jdGlvbigpe1xuICAgICAgdGhpcyQucmVuZGVyTGVmdEhhbGYoKTtcbiAgICAgIHJldHVybiB0aGlzJC5yZW5kZXJUb3BIYWxmKCk7XG4gICAgfSk7XG4gICAgdGhpcy5vblNjcm9sbCB8fCAodGhpcy5vblNjcm9sbCA9IGZ1bmN0aW9uKCl7XG4gICAgICByZXR1cm4gdGhpcyQucmVuZGVyVG9wSGFsZigpO1xuICAgIH0pO1xuICAgIGNvbnN0cnVjdG9yLiQod2luZG93KS5vbignbG9hZCByZXNpemUnLCB0aGlzLm9uTG9hZFJlc2l6ZSk7XG4gICAgY29uc3RydWN0b3IuJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCB0aGlzLm9uU2Nyb2xsKTtcbiAgfTtcbiAgcHJvdG90eXBlLm9uRGV0YWNoID0gZnVuY3Rpb24oKXtcbiAgICB0aGlzLiQub2ZmKCdjbGljaycsICdidXR0b24nKTtcbiAgICBjb25zdHJ1Y3Rvci4kKHdpbmRvdykub2ZmKCdsb2FkIHJlc2l6ZScsIHRoaXMub25Mb2FkUmVzaXplKTtcbiAgICBjb25zdHJ1Y3Rvci4kKHdpbmRvdykub2ZmKCdzY3JvbGwnLCB0aGlzLm9uU2Nyb2xsKTtcbiAgfTtcbiAgcHJvdG90eXBlLnJlbmRlclRvcEhhbGYgPSBmdW5jdGlvbigpe1xuICAgIHZhciAkYnV0dG9uLCBvZmZUb3AsIHNjclRvcCwgaGFsZldpbmRvd0hlaWdodDtcbiAgICAkYnV0dG9uID0gdGhpcy4kLmZpbmQoJ2J1dHRvbicpO1xuICAgIG9mZlRvcCA9ICRidXR0b24ub2Zmc2V0KCkudG9wO1xuICAgIHNjclRvcCA9IGNvbnN0cnVjdG9yLiQod2luZG93KS5zY3JvbGxUb3AoKTtcbiAgICBoYWxmV2luZG93SGVpZ2h0ID0gY29uc3RydWN0b3IuJCh3aW5kb3cpLmhlaWdodCgpIC8gMjtcbiAgICAkYnV0dG9uLnRvZ2dsZUNsYXNzKCd0b3AtaGFsZicsIG9mZlRvcCAtIHNjclRvcCA8IGhhbGZXaW5kb3dIZWlnaHQpO1xuICB9O1xuICBwcm90b3R5cGUucmVuZGVyTGVmdEhhbGYgPSBmdW5jdGlvbigpe1xuICAgIHZhciAkYnV0dG9uLCBvZmZMZWZ0LCBoYWxmV2luZG93V2lkdGg7XG4gICAgJGJ1dHRvbiA9IHRoaXMuJC5maW5kKCdidXR0b24nKTtcbiAgICBvZmZMZWZ0ID0gJGJ1dHRvbi5vZmZzZXQoKS5sZWZ0O1xuICAgIGhhbGZXaW5kb3dXaWR0aCA9IGNvbnN0cnVjdG9yLiQod2luZG93KS53aWR0aCgpIC8gMjtcbiAgICAkYnV0dG9uLnRvZ2dsZUNsYXNzKCdsZWZ0LWhhbGYnLCBvZmZMZWZ0IDwgaGFsZldpbmRvd1dpZHRoKTtcbiAgfTtcbiAgcHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy4kLmZpbmQoJ2J1dHRvbicpLmF0dHIoJ2Rpc2FibGVkJywgbnVsbCk7XG4gICAgdGhpcy5hdHRhY2goKTtcbiAgfTtcbiAgcHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbigpe1xuICAgIHRoaXMuJC5maW5kKCdidXR0b24nKS5hdHRyKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgIHRoaXMuZGV0YWNoKCk7XG4gIH07XG4gIHJldHVybiBQYXJhbGxheEJ1dHRvbjtcbn0oQ29tcG9uZW50KSk7XG5mdW5jdGlvbiBleHRlbmQkKHN1Yiwgc3VwKXtcbiAgZnVuY3Rpb24gZnVuKCl7fSBmdW4ucHJvdG90eXBlID0gKHN1Yi5zdXBlcmNsYXNzID0gc3VwKS5wcm90b3R5cGU7XG4gIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gIGlmICh0eXBlb2Ygc3VwLmV4dGVuZGVkID09ICdmdW5jdGlvbicpIHN1cC5leHRlbmRlZChzdWIpO1xuICByZXR1cm4gc3ViO1xufVxuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn0iLCIoZnVuY3Rpb24oZ2xvYmFsKXt2YXIgbG9kYXNoLCBDb21wb25lbnQsIFBhcmFsbGF4QnV0dG9uLCBBdXRoLCBzaCwgY2gsIHB1cmVWYWxpZGF0aW9ucywgdGVtcGxhdGVzLCBkZWJvdW5jZSwgU2l0ZVJlZ2lzdGVyLCBzbGljZSQgPSBbXS5zbGljZTtcbmxvZGFzaCA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xuQ29tcG9uZW50ID0gcmVxdWlyZSgneWFjb21wb25lbnQnKTtcblBhcmFsbGF4QnV0dG9uID0gcmVxdWlyZSgnLi9QYXJhbGxheEJ1dHRvbi5scycpO1xuQXV0aCA9IHJlcXVpcmUoJy4vQXV0aC5scycpO1xuc2ggPSByZXF1aXJlKCcuLi9hcHAvc2hhcmVkLWhlbHBlcnMubHMnKTtcbmNoID0gcmVxdWlyZSgnLi4vYXBwL2NsaWVudC1oZWxwZXJzLmxzJyk7XG5wdXJlVmFsaWRhdGlvbnMgPSByZXF1aXJlKCcuLi9wbHY4X21vZHVsZXMvcHVyZS12YWxpZGF0aW9ucy5qcycpO1xudGVtcGxhdGVzID0gcmVxdWlyZSgnLi4vYnVpbGQvY29tcG9uZW50LWphZGUuanMnKS50ZW1wbGF0ZXM7XG5kZWJvdW5jZSA9IHBhcnRpYWxpemUkLmFwcGx5KGxvZGFzaCwgW2xvZGFzaC5kZWJvdW5jZSwgW3ZvaWQgOCwgMjUwXSwgWzBdXSk7XG5tb2R1bGUuZXhwb3J0cyA9IFNpdGVSZWdpc3RlciA9IChmdW5jdGlvbihzdXBlcmNsYXNzKXtcbiAgdmFyIHByb3RvdHlwZSA9IGV4dGVuZCQoKGltcG9ydCQoU2l0ZVJlZ2lzdGVyLCBzdXBlcmNsYXNzKS5kaXNwbGF5TmFtZSA9ICdTaXRlUmVnaXN0ZXInLCBTaXRlUmVnaXN0ZXIpLCBzdXBlcmNsYXNzKS5wcm90b3R5cGUsIGNvbnN0cnVjdG9yID0gU2l0ZVJlZ2lzdGVyO1xuICBwcm90b3R5cGUudGVtcGxhdGUgPSB0ZW1wbGF0ZXMuU2l0ZVJlZ2lzdGVyO1xuICBwcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIHRoaXMkID0gdGhpcztcbiAgICB0aGlzLmxvY2FsKCdob3N0bmFtZScsIGdsb2JhbC5lbnYgPT09ICdwcm9kdWN0aW9uJyA/ICcucG93ZXJidWxsZXRpbi5jb20nIDogJy5wYi5jb20nKTtcbiAgICBpZiAoIXRoaXMubG9jYWwoJ3N1YmRvbWFpbicpKSB7XG4gICAgICB0aGlzLmxvY2FsKCdzdWJkb21haW4nLCAnJyk7XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgdmFyIG9uQ2xpY2ssIGxvY2FscztcbiAgICAgIG9uQ2xpY2sgPSBBdXRoLnJlcXVpcmVSZWdpc3RyYXRpb24oZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIHN1YmRvbWFpbjtcbiAgICAgICAgc3ViZG9tYWluID0gdGhpcyQubG9jYWwoJ3N1YmRvbWFpbicpO1xuICAgICAgICByZXR1cm4gY29uc3RydWN0b3IuJC5wb3N0KCcvYWpheC9jYW4taGFzLXNpdGUtcGx6Jywge1xuICAgICAgICAgIGRvbWFpbjogc3ViZG9tYWluICsgdGhpcyQubG9jYWwoJ2hvc3RuYW1lJylcbiAgICAgICAgfSwgZnVuY3Rpb24ocil7XG4gICAgICAgICAgdmFyIGVycm9ycztcbiAgICAgICAgICBlcnJvcnMgPSByLmVycm9ycztcbiAgICAgICAgICBpZiAoZXJyb3JzLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGVycm9ycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGNoLnNob3dUb29sdGlwKGNvbnN0cnVjdG9yLiQoJy5TaXRlUmVnaXN0ZXItZXJyb3JzJyksIGVycm9ycy5qb2luKCc8YnI+JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uID0gXCJodHRwOi8vXCIgKyBzdWJkb21haW4gKyB0aGlzJC5sb2NhbCgnaG9zdG5hbWUnKSArIFwiI29uY2VcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgICBsb2NhbHMgPSB7XG4gICAgICAgIHRpdGxlOiAnQ3JlYXRlJ1xuICAgICAgfTtcbiAgICAgIHJldHVybiB0aGlzJC5jaGlsZHJlbiA9IHtcbiAgICAgICAgYnV5OiBuZXcgUGFyYWxsYXhCdXR0b24oe1xuICAgICAgICAgIG9uQ2xpY2s6IG9uQ2xpY2ssXG4gICAgICAgICAgbG9jYWxzOiBsb2NhbHNcbiAgICAgICAgfSwgJy5TaXRlUmVnaXN0ZXItY3JlYXRlJywgdGhpcyQpXG4gICAgICB9O1xuICAgIH0oKTtcbiAgfTtcbiAgcHJvdG90eXBlLm9uQXR0YWNoID0gZnVuY3Rpb24oKXtcbiAgICB2YXIgY29tcG9uZW50LCAkc2EsICRlcnJvcnMsIGxhc3RWYWwsIHRoaXMkID0gdGhpcztcbiAgICBjb21wb25lbnQgPSB0aGlzO1xuICAgICRzYSA9IHRoaXMuJC5maW5kKCcuU2l0ZVJlZ2lzdGVyLWF2YWlsYWJsZScpO1xuICAgICRlcnJvcnMgPSBjb25zdHJ1Y3Rvci4kKCcuU2l0ZVJlZ2lzdGVyLWVycm9ycycpO1xuICAgIHRoaXMuY2hlY2tTdWJkb21haW5BdmFpbGFiaWxpdHkgPSBjb25zdHJ1Y3Rvci4kUihmdW5jdGlvbihzdWJkb21haW4pe1xuICAgICAgdmFyIGVycm9ycztcbiAgICAgIGVycm9ycyA9IHB1cmVWYWxpZGF0aW9ucy5zdWJkb21haW4oc3ViZG9tYWluKTtcbiAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci4kLmdldCgnL2FqYXgvY2hlY2stZG9tYWluLWF2YWlsYWJpbGl0eScsIHtcbiAgICAgICAgZG9tYWluOiBzdWJkb21haW4gKyB0aGlzJC5sb2NhbCgnaG9zdG5hbWUnKVxuICAgICAgfSwgZnVuY3Rpb24ocmVzKXtcbiAgICAgICAgJHNhLnJlbW92ZUNsYXNzKCdzdWNjZXNzIGVycm9yJyk7XG4gICAgICAgIGlmIChyZXMuYXZhaWxhYmxlKSB7XG4gICAgICAgICAgY29tcG9uZW50LmNoaWxkcmVuLmJ1eS5lbmFibGUoKTtcbiAgICAgICAgICAkc2EuYWRkQ2xhc3MoJ3N1Y2Nlc3MnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb21wb25lbnQuY2hpbGRyZW4uYnV5LmRpc2FibGUoKTtcbiAgICAgICAgICAkc2EuYWRkQ2xhc3MoJ2Vycm9yJyk7XG4gICAgICAgICAgZXJyb3JzLnB1c2goJ0RvbWFpbiBpcyB1bmF2YWlsYWJsZSwgdHJ5IGFnYWluIScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7XG4gICAgICAgICAgcmV0dXJuIGNoLnNob3dUb29sdGlwKCRlcnJvcnMsIGVycm9ycy5qb2luKCc8YnI+JykpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KS5iaW5kVG8odGhpcy5zdGF0ZS5zdWJkb21haW4pO1xuICAgIHRoaXMuJC5vbigna2V5ZG93bicsICdpbnB1dC5TaXRlUmVnaXN0ZXItc3ViZG9tYWluJywgZnVuY3Rpb24oKXtcbiAgICAgIHJldHVybiAkKCcuaG9zdG5hbWUnKS5jc3MoJ29wYWNpdHknLCAwKTtcbiAgICB9KTtcbiAgICByZXR1cm4gdGhpcy4kLm9uKCdrZXl1cCcsICdpbnB1dC5TaXRlUmVnaXN0ZXItc3ViZG9tYWluJywgZGVib3VuY2UoZnVuY3Rpb24oKXtcbiAgICAgIHZhciBuZXdJbnB1dDtcbiAgICAgIG5ld0lucHV0ID0gJCh0aGlzKS52YWwoKTtcbiAgICAgIGlmIChuZXdJbnB1dC5sZW5ndGgpIHtcbiAgICAgICAgJCgnLmhvc3RuYW1lJykuYW5pbWF0ZSh7XG4gICAgICAgICAgb3BhY2l0eTogMSxcbiAgICAgICAgICBsZWZ0OiBuZXdJbnB1dC5sZW5ndGggKiAyNyArIDMyXG4gICAgICAgIH0sIDE1MCk7XG4gICAgICAgIGlmIChuZXdJbnB1dCAhPT0gbGFzdFZhbCkge1xuICAgICAgICAgIGNvbXBvbmVudC5zdGF0ZS5zdWJkb21haW4obmV3SW5wdXQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBsYXN0VmFsID0gbmV3SW5wdXQ7XG4gICAgICB9XG4gICAgfSkpO1xuICB9O1xuICBwcm90b3R5cGUub25EZXRhY2ggPSBmdW5jdGlvbigpe1xuICAgIHNoLnJVbmJpbmQodGhpcy5jaGVja1N1YmRvbWFpbkF2YWlsYWJpbGl0eSk7XG4gICAgZGVsZXRlIHRoaXMuY2hlY2tTdWJkb21haW5BdmFpbGFiaWxpdHk7XG4gICAgcmV0dXJuIHRoaXMuJC5vZmYoJ2tleXVwJywgJ2lucHV0LlNpdGVSZWdpc3Rlci1zdWJkb21haW4nKTtcbiAgfTtcbiAgcHJvdG90eXBlLnVwZGF0ZVN1YmRvbWFpbiA9IGZ1bmN0aW9uKHMpe1xuICAgIHJldHVybiB0aGlzLiQuZmluZCgnaW5wdXQuU2l0ZVJlZ2lzdGVyLXN1YmRvbWFpbicpLnZhbChzKTtcbiAgfTtcbiAgZnVuY3Rpb24gU2l0ZVJlZ2lzdGVyKCl7XG4gICAgU2l0ZVJlZ2lzdGVyLnN1cGVyY2xhc3MuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgfVxuICByZXR1cm4gU2l0ZVJlZ2lzdGVyO1xufShDb21wb25lbnQpKTtcbmZ1bmN0aW9uIHBhcnRpYWxpemUkKGYsIGFyZ3MsIHdoZXJlKXtcbiAgdmFyIGNvbnRleHQgPSB0aGlzO1xuICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICB2YXIgcGFyYW1zID0gc2xpY2UkLmNhbGwoYXJndW1lbnRzKSwgaSxcbiAgICAgICAgbGVuID0gcGFyYW1zLmxlbmd0aCwgd2xlbiA9IHdoZXJlLmxlbmd0aCxcbiAgICAgICAgdGEgPSBhcmdzID8gYXJncy5jb25jYXQoKSA6IFtdLCB0dyA9IHdoZXJlID8gd2hlcmUuY29uY2F0KCkgOiBbXTtcbiAgICBmb3IoaSA9IDA7IGkgPCBsZW47ICsraSkgeyB0YVt0d1swXV0gPSBwYXJhbXNbaV07IHR3LnNoaWZ0KCk7IH1cbiAgICByZXR1cm4gbGVuIDwgd2xlbiAmJiBsZW4gP1xuICAgICAgcGFydGlhbGl6ZSQuYXBwbHkoY29udGV4dCwgW2YsIHRhLCB0d10pIDogZi5hcHBseShjb250ZXh0LCB0YSk7XG4gIH07XG59XG5mdW5jdGlvbiBleHRlbmQkKHN1Yiwgc3VwKXtcbiAgZnVuY3Rpb24gZnVuKCl7fSBmdW4ucHJvdG90eXBlID0gKHN1Yi5zdXBlcmNsYXNzID0gc3VwKS5wcm90b3R5cGU7XG4gIChzdWIucHJvdG90eXBlID0gbmV3IGZ1bikuY29uc3RydWN0b3IgPSBzdWI7XG4gIGlmICh0eXBlb2Ygc3VwLmV4dGVuZGVkID09ICdmdW5jdGlvbicpIHN1cC5leHRlbmRlZChzdWIpO1xuICByZXR1cm4gc3ViO1xufVxuZnVuY3Rpb24gaW1wb3J0JChvYmosIHNyYyl7XG4gIHZhciBvd24gPSB7fS5oYXNPd25Qcm9wZXJ0eTtcbiAgZm9yICh2YXIga2V5IGluIHNyYykgaWYgKG93bi5jYWxsKHNyYywga2V5KSkgb2JqW2tleV0gPSBzcmNba2V5XTtcbiAgcmV0dXJuIG9iajtcbn1cbn0pKHdpbmRvdykiLCIoZnVuY3Rpb24oKXtcbiAgdmFyIHBvc3QsIGNlbnNvciwgc3ViZG9tYWluLCBvdXQkID0gdHlwZW9mIGV4cG9ydHMgIT0gJ3VuZGVmaW5lZCcgJiYgZXhwb3J0cyB8fCB0aGlzO1xuICBvdXQkLnBvc3QgPSBwb3N0ID0gZnVuY3Rpb24ocG9zdCl7XG4gICAgdmFyIGVycm9ycztcbiAgICBlcnJvcnMgPSBbXTtcbiAgICBpZiAoIXBvc3QudXNlcl9pZCkge1xuICAgICAgZXJyb3JzLnB1c2goJ011c3Qgc3BlY2lmeSBhIHVzZXInKTtcbiAgICB9XG4gICAgaWYgKCFwb3N0LmZvcnVtX2lkKSB7XG4gICAgICBlcnJvcnMucHVzaCgnRm9ydW0gY2Fubm90IGJlIGJsYW5rJyk7XG4gICAgfVxuICAgIGlmICghKHBvc3QudGl0bGUgfHwgcG9zdC5wYXJlbnRfaWQpKSB7XG4gICAgICBlcnJvcnMucHVzaCgnVGl0bGUgeW91ciBjcmVhdGlvbiEnKTtcbiAgICB9XG4gICAgaWYgKCFwb3N0LmJvZHkpIHtcbiAgICAgIGVycm9ycy5wdXNoKCdXcml0ZSBzb21ldGhpbmchJyk7XG4gICAgfVxuICAgIHJldHVybiBlcnJvcnM7XG4gIH07XG4gIG91dCQuY2Vuc29yID0gY2Vuc29yID0gZnVuY3Rpb24oYyl7XG4gICAgdmFyIGVycm9ycztcbiAgICBlcnJvcnMgPSBbXTtcbiAgICBpZiAoIWMudXNlcl9pZCkge1xuICAgICAgZXJyb3JzLnB1c2goJ1VzZXIgY2Fubm90IGJlIGJsYW5rJyk7XG4gICAgfVxuICAgIGlmICghYy5wb3N0X2lkKSB7XG4gICAgICBlcnJvcnMucHVzaCgnUG9zdCBjYW5ub3QgYmUgYmxhbmsnKTtcbiAgICB9XG4gICAgaWYgKCFjLnJlYXNvbikge1xuICAgICAgZXJyb3JzLnB1c2goJ1JlYXNvbiBjYW5ub3QgYmUgYmxhbmsnKTtcbiAgICB9XG4gICAgcmV0dXJuIGVycm9ycztcbiAgfTtcbiAgb3V0JC5zdWJkb21haW4gPSBzdWJkb21haW4gPSBmdW5jdGlvbihzdWJkb21haW4pe1xuICAgIHZhciBhbGxvd2VkQ2hhcnMsIGVycm9ycztcbiAgICBhbGxvd2VkQ2hhcnMgPSAvXlthLXowLTlcXC1dKyQvaTtcbiAgICBlcnJvcnMgPSBbXTtcbiAgICBpZiAoIXN1YmRvbWFpbi5tYXRjaChhbGxvd2VkQ2hhcnMpKSB7XG4gICAgICBlcnJvcnMucHVzaCgnSW52YWxpZCBTdWJkb21haW4nKTtcbiAgICB9XG4gICAgcmV0dXJuIGVycm9ycztcbiAgfTtcbn0pLmNhbGwodGhpcyk7XG4iXX0=
;